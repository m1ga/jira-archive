---
title: "[AC-472] Multipart HTTP request composed with errors"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2015-10-29T08:59:37.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Appcelerator Studio 4.3.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Artem Akulshin</td></tr>
<tr><th>Assignee</th><td>Ashraf Abu</td></tr>
<tr><th>Created</th><td>2015-10-18T07:18:58.000+0000</td></tr>
<tr><th>Updated</th><td>2015-10-29T09:00:03.000+0000</td></tr>
</table>

<h3>Description</h3>

I send HTTP multipart request with te following code:

thefile=Titanium.Filesystem.getFile(this.filepath_to_upload);
         
         postdata={
                name: this.guid,
                createDT:this.createDT+"",
                session_length:this.session_length+"",
                device_model:Titanium.Platform.getModel(),
                device_manufacturer:Titanium.Platform.getManufacturer(),
                device_osname:Titanium.Platform.getOsname(),
                device_version:Titanium.Platform.getVersion(),
                device_locale:Titanium.Platform.getLocale(),
                result_type:2,     //for fitness=0, for science=1, for fitness+science =2
                debug:false, 
                file: thefile
            };

client.open("POST", url);
client.setRequestHeader(
			    'Authorization', 
			    'Basic ' + Ti.Utils.base64encode(auth.username+':'+auth.password)
		   );
client.setRequestHeader("enctype", "multipart/form-data");
client.send(postdata);

And the app composes inclosed name tags in the request, for example:

---0Yp7DHdqG1dPhejcf_POatQ2DMYKnOxDBeC
Content-Disposition: form-data; name="name
Content-Type: ; charset=UTF-8
Content-Transfer-Encoding: 8bit

52959e65-8c74-c8c0-be18-90f047f5e9b6
---0Yp7DHdqG1dPhejcf_POatQ2DMYKnOxDBeC
Content-Disposition: form-data; name="device_locale
Content-Type: ; charset=UTF-8
Content-Transfer-Encoding: 8bit

en-US
---0Yp7DHdqG1dPhejcf_POatQ2DMYKnOxDBeC
Content-Disposition: form-data; name="debug
Content-Type: ; charset=UTF-8
Content-Transfer-Encoding: 8bit

Only file field are formed correctly.

This appear in all versions of Titanium SDK 5, but if fall back to version 4 or 3 - all works perfectly.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-472_57049/devcenetr-tcpdump.txt">devcenetr-tcpdump.txt</td></td><td>2015-10-18T07:18:18.000+0000</td><td>5442</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Artem Akulshin 2015-10-20

   The error does not appear under iOS.</li>
<li>Ashraf Abu 2015-10-29

   [~xvk@mail.ru] You can run <code>appc ti sdk install -d -b 5_0_X</code> on terminal to get an updated SDK. This should be fixed with that version of SDK. Let me know if it's working for you.</li>
<li>Artem Akulshin 2015-10-29

   Yes, it is fine with this version. Thank you.</li>
<li>Ashraf Abu 2015-10-29

   Thanks [~xvk@mail.ru] for the reply. Resolving issue! :)</li>
</ol>


<p><a href="/AC/AC-472.json">JSON Source</a></p>