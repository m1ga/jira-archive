---
title: "[AC-921] Crash when launching root activity from another activity"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Needs more info</td></tr>
<tr><th>Resolution Date</th><td>2015-02-03T15:03:46.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Appcelerator Modules</td></tr>
<tr><th>Labels</th><td>android</td></tr>
<tr><th>Reporter</th><td>DeRon Brown</td></tr>
<tr><th>Assignee</th><td>Shuo Liang</td></tr>
<tr><th>Created</th><td>2015-01-15T21:22:47.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:13.000+0000</td></tr>
</table>

<h3>Description</h3>

We are building a Notification for GCM and using an activity that is *not* the main, launcher activity (i.e. the activity that extends TiRootActivity) within the PendingIntent. This activity has no UI, but instead simply tracks some information regarding the notification being clicked and then launches the main, launcher activity from within its onCreate() method. Similar to the following: <a href="https://gist.github.com/deronbrown/d392418360b7c80fa57a" rel="nofollow" target="_blank">https://gist.github.com/deronbrown/d392418360b7c80fa57a</a>

This works as expected most of the time. However, if the app is out of memory when the notification is tapped (i.e. show the GCM notification, open recent apps menu, remove app, then tap notification), the launch activity will not be shown. Instead, the user will see a quick flash of UI and then be dropped back to their previous state (e.g. home screen or wherever the user was when the notification was tapped).

Logs show the proper intent to start the main activity but the activity never displays. This same bug does not appear if you use the main, launcher activity in the PendingIntent. Perhaps TiRootActivity is doing some specific Titanium setup, and when another activity is used this setup does not occur. We were not able to determine the important setup that our activity should be doing based on the TiRootActivity source that is available.

*Test Case:*
* Create TestActivity for PendingIntent: <a href="https://gist.github.com/deronbrown/a9e018762ddabb85f272" rel="nofollow" target="_blank">https://gist.github.com/deronbrown/a9e018762ddabb85f272</a>
* Show a notification using TestActivity in the PendingIntent: <a href="https://gist.github.com/deronbrown/939e4956effaa9528215" rel="nofollow" target="_blank">https://gist.github.com/deronbrown/939e4956effaa9528215</a>
* Once notification displays, open recent apps menu and swipe the Test app away. (Note: This is not the same as force closing).
* Tap the notification to launch the application.

*Expected:* TestActivity should be created, print to logcat, and launch the main activity which should be displayed to the user.
*Actual:* TestActivity is created, prints to logcat, and the user is returned to their initial state before tapping notification. (Main Activity never displays.)


<h3>Comments</h3>

<ol>
<li>Shuo Liang 2015-01-16

   HI,
   
   Please provide a simple test case to reproduce your problem. That will be really helpful to address the problem. 
   
   Regards,
   Shuo</li>
<li>DeRon Brown 2015-01-16

   [~sliang] I have added a test case the end of the description.</li>
<li>Mauro Parra-Miranda 2015-02-03

   Hello,
   please read this guide:
   
   <a href="http://docs.appcelerator.com/titanium/3.0/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/titanium/3.0/#</a>!/guide/How_to_Submit_a_Bug_Report
   
   and provide a testcase in the form of app.js single file. 
   
   Best Regards</li>
</ol>


<p><a href="/AC/AC-921.json">JSON Source</a></p>