---
title: "[AC-948] ListView Marker won't work with sections and templates"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2015-08-30T08:13:52.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>ios, listSections, listView, templates</td></tr>
<tr><th>Reporter</th><td>Sebastian Klaus</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2015-05-18T07:46:12.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:16.000+0000</td></tr>
</table>

<h3>Description</h3>

<code><pre>
Operating System
  Name                        = Mac OS X
  Version                     = 10.10.4
  Architecture                = 64bit
  # CPUs                      = 8
  Memory                      = 17179869184
Node.js
  Node.js Version             = 0.10.38
  npm Version                 = 1.4.28
Titanium CLI
  CLI Version                 = 4.1.0-dev
Titanium SDK
  SDK Version                 = 4.1.0.v20150516202834
  SDK Path                    = /Volumes/Data/Users/sebastian/Library/Application Support/Titanium/mobilesdk/osx/4.1.0.v20150516202834
  Target Platform             = iphone
</pre></code>

Using sections for each row with additional marker will not work when using templates

<code><pre>
var win = Ti.UI.createWindow({backgroundColor: 'white'});
var plainTemplate = {
    childTemplates: [
        {
            type: 'Ti.UI.Label', // Use a label
            bindId: 'rowtitle',  // Bind ID for this label
            properties: {        // Sets the Label.left property
                left: '10dp'
            }
        },
        {
            type: 'Ti.UI.ImageView',  // Use an image view
            bindId: 'pic',            // Bind ID for this image view
            properties: {             // Sets the ImageView.image property
                image: 'KS_nav_ui.png'
            }
        },
        {
            type: 'Ti.UI.Button',   // Use a button
            bindId: 'button',       // Bind ID for this button
            properties: {           // Sets several button properties
                width: '80dp',
                height: '30dp',
                right: '10dp',
                title: 'press me'
            },
            events: {click: report}  // Binds a callback to the button's click event
        }
    ]
};
function report(e) {
    Ti.API.info(e.type);
}
var listView = Ti.UI.createListView({
    // Maps the plainTemplate object to the 'plain' style name
    templates: {'plain': plainTemplate},
    // Use the plain template, that is, the plainTemplate object defined earlier
    // for all data list items in this list view
    defaultItemTemplate: 'plain'
});
var sectionData = [];
var i = 25;
for (var k = 0; k &lt; 25; k++) {
    var section = Ti.UI.createListSection();
    section.setItems([{
        properties: {
            title: 'Row ' + (k + 1)
        },
        rowtitle: {
            text: 'Row ' + (k + 1)
        }
    }]);
    sectionData.push(section);
}
listView.setSections(sectionData);

// Set the initial item threshold
listView.setMarker({sectionIndex: (i - 1), itemIndex: 0});

// Load more data and set a new threshold when item threshold is reached
listView.addEventListener('marker', function (e) {
    var max = i + 25;
    var data = [];
    for (var k = i; k &lt; max; k++) {
        var section = Ti.UI.createListSection();
        section.setItems([{
            properties: {
                title: 'Row ' + (k + 1)
            },
            rowtitle: {
                text: 'Row ' + (k + 1)
            }
        }]);
        listView.appendSection(section);
    }
    i = i + 25;
    listView.setMarker({sectionIndex: (i - 1), itemIndex: 0});
});

win.add(listView);
win.open();
</pre></code>

Replacing the listview create method with 
<code><pre>
var listView = Ti.UI.createListView({
    // Maps the plainTemplate object to the 'plain' style name
    //templates: {'plain': plainTemplate},
    // Use the plain template, that is, the plainTemplate object defined earlier
    // for all data list items in this list view
    //defaultItemTemplate: 'plain'
});
</pre></code>

Let the marker work again

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-948_55462/TestApp.zip">TestApp.zip</td></td><td>2015-05-19T07:27:39.000+0000</td><td>2954631</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Radamantis Torres-Lechuga 2015-05-19

   [~benutzername] we can not replicate this issue, and it looks like the attached test case is not related to this, can you please check and try to share more info on how to replicate? 
   Thanks</li>
<li>Sebastian Klaus 2015-05-19

   Start the TestApp and scroll down. As you see, the marker will not be fired</li>
<li>Harish Mridha 2015-05-19

   Hi
   I have tested new TestApp . marker event fired properly . 
   *Code*
   <code><pre>
   
   listView.addEventListener('marker', function (e) {
   	Ti.API.info("marker Fired when the list view displays the reference item or an item beyond the reference item.");
       var max = i + 25;
       var data = [];
       for (var k = i; k &lt; max; k++) {
           var section = Ti.UI.createListSection();
           section.setItems([{
               properties: {
                   title: 'Row ' + (k + 1)
               },
               rowtitle: {
                   text: 'Row ' + (k + 1)
               }
           }]);
           listView.appendSection(section);
           Ti.API.info('Row ' + (k + 1));
       }
       i = i + 25;
       listView.setMarker({sectionIndex: (i - 1), itemIndex: 0});
   });
   
   </pre></code>
   
   *Log*
   <code><pre>
   
   [INFO] :   Application started
   [INFO] :   TestApp/1.0 (4.0.0.9b7d303)
   [INFO] :   marker Fired when the list view displays the reference item or an item beyond the reference item.
   [INFO] :   Row 26
   [INFO] :   Row 27
   [INFO] :   Row 28
   [INFO] :   Row 29
   [INFO] :   Row 30
   [INFO] :   Row 31
   [INFO] :   Row 32
   [INFO] :   Row 33
   [INFO] :   Row 34
   [INFO] :   Row 35
   [INFO] :   Row 36
   [INFO] :   Row 37
   [INFO] :   Row 38
   [INFO] :   Row 39
   [INFO] :   Row 40
   [INFO] :   Row 41
   [INFO] :   Row 42
   [INFO] :   Row 43
   [INFO] :   Row 44
   [INFO] :   Row 45
   [INFO] :   Row 46
   [INFO] :   Row 47
   [INFO] :   Row 48
   [INFO] :   Row 49
   [INFO] :   Row 50
   
   </pre></code></li>
</ol>


<p><a href="/AC/AC-948.json">JSON Source</a></p>