---
title: "[AC-1043] App crash while quit because of ti.facebook module"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2015-08-25T08:16:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Appcelerator Modules</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>陈 明</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2015-02-12T07:06:12.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:23.000+0000</td></tr>
</table>

<h3>Description</h3>

1 double tap home 
2 quit the app which use the ti.facebook module
3 you can below crash log
[ERROR] :  The application has crashed with an uncaught exception 'NSInternalInconsistencyException'.
[ERROR] :  Reason:
[ERROR] :  An instance 0x1559d000 of class FBSessionManualTokenCachingStrategy was deallocated while key value observers were still registered with it. Current observation info: <NSKeyValueObservationInfo 0x156fabf0> (
[ERROR] :  <NSKeyValueObservance 0x15780fc0: Observer: 0x15598860, Key path: accessToken, Options: <New: NO, Old: NO, Prior: YES> Context: 0x5e002c, Property: 0x168777e0>
[ERROR] :  <NSKeyValueObservance 0x1562fb30: Observer: 0x15598860, Key path: expirationDate, Options: <New: NO, Old: NO, Prior: YES> Context: 0x5e002c, Property: 0x15691230>
[ERROR] :  )
[ERROR] :  Stack trace:
[ERROR] :  
[ERROR] :  0   CoreFoundation                      0x2418a49f <redacted> + 126
[ERROR] :  1   libobjc.A.dylib                     0x319a9c8b objc_exception_throw + 38
[ERROR] :  2   CoreFoundation                      0x2418a3e5 <redacted> + 0
[ERROR] :  3   Foundation                          0x24e33bc5 <redacted> + 288
[ERROR] :  4   libobjc.A.dylib                     0x319c3d5f <redacted> + 166
[ERROR] :  5   Perkd                               0x0039ee33 _ZN3WTI13tryMakeStringIPKcN2TI7UStringES2_EENS_10PassRefPtrINS_10StringImplEEET_T0_T1_ + 13778
[ERROR] :  6   libobjc.A.dylib                     0x319c3d5f <redacted> + 166
[ERROR] :  7   Perkd                               0x0039bea9 _ZN3WTI13tryMakeStringIPKcN2TI7UStringES2_EENS_10PassRefPtrINS_10StringImplEEET_T0_T1_ + 1608
[ERROR] :  8   libobjc.A.dylib                     0x319c3d5f <redacted> + 166
[ERROR] :  9   CoreFoundation                      0x2409100d CFRelease + 600
[ERROR] :  10  CoreFoundation                      0x240a913f <redacted> + 134
[ERROR] :  11  libobjc.A.dylib                     0x319c3d5f <redacted> + 166
[ERROR] :  12  Perkd                               0x000dcec3 Perkd + 106179
[ERROR] :  13  Perkd                               0x000df043 Perkd + 114755
[ERROR] :  14  Perkd                               0x000e7d81 Perkd + 150913
[ERROR] :  15  Foundation                          0x24e9aafb <redacted> + 1118
[ERROR] :  16  libsystem_pthread.dylib             0x3206ce93 <redacted> + 138
[ERROR] :  17  libsystem_pthread.dylib             0x3206ce07 _pthread_start + 118
[ERROR] :  18  libsystem_pthread.dylib             0x3206ab90 thread_start + 8
[ERROR] :  *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'An instance 0x1559d000 of class FBSessionManualTokenCachingStrategy was deallocated while key value observers were still registered with it. Current observation info: <NSKeyValueObservationInfo 0x156fabf0> (
[ERROR] :  <NSKeyValueObservance 0x15780fc0: Observer: 0x15598860, Key path: accessToken, Options: <New: NO, Old: NO, Prior: YES> Context: 0x5e002c, Property: 0x168777e0>
[ERROR] :  <NSKeyValueObservance 0x1562fb30: Observer: 0x15598860, Key path: expirationDate, Options: <New: NO, Old: NO, Prior: YES> Context: 0x5e002c, Property: 0x15691230>
[ERROR] :  )'
[ERROR] :  *** First throw call stack:
[ERROR] :  (0x2418a49f 0x319a9c8b 0x2418a3e5 0x24e33bc5 0x319c3d5f 0x39ee33 0x319c3d5f 0x39bea9 0x319c3d5f 0x2409100d 0x240a913f 0x319c3d5f 0xdcec3 0xdf043 0xe7d81 0x24e9aafb 0x3206ce93 0x3206ce07 0x3206ab90)

<h3>Comments</h3>

<ol>
<li>Shuo Liang 2015-02-13

   HI,
   
   Please provide a simple test case to reproduce your problem. That will be really help to address your issue. Thanks
   Ref about how to create a test case: [<a href="http://docs.appcelerator.com/titanium/3.0/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/titanium/3.0/#</a>!/guide/How_to_Submit_a_Bug_Report-section-29004732_HowtoSubmitaBugReport-CreatingaTestCase]
   
   Regards,
   Shuo</li>
<li>Harish Mridha 2015-08-25

   Hi ,
   I tested the issue you reported. It looks like the feature "ti.facebook " in Appcelerator Studio is working fine for me. I tested this using the *studio build: 4.1.1.201507141126, ti.facebook 4.0.5 , iOS SDK: 8.1 and TiSDK 4.1.0GA*
   I recommend you upgrade SDK and ti.facebook module to the latest build and let us know if you get the error again.
   I will mark this ticket as "resolved" since I can't reproduce it. However, feel free to reopen with additional information if you notice otherwise.
   Thanks
   
   </li>
</ol>


<p><a href="/AC/AC-1043.json">JSON Source</a></p>