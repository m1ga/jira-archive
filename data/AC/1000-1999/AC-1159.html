---
title: "[AC-1159] Backbone fetch() returns undefined when run from TiStudio on Titanium 3.5/Alloy 1.5.1"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2015-02-05T15:58:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>TCSupportTriage</td></tr>
<tr><th>Reporter</th><td>Eric Thiebaut-George</td></tr>
<tr><th>Assignee</th><td>Mostafizur Rahman</td></tr>
<tr><th>Created</th><td>2015-02-03T09:16:18.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:31.000+0000</td></tr>
</table>

<h3>Description</h3>

Titanium 3.5, Alloy 1.5.1, latest TiStudio, iPhone 5s simulator with iOS 8.1.

All alloy.fetch() calls return undefined instead of a promise.

The issue is in <a href="https://github.com/appcelerator/alloy/blob/1_3_X/Alloy/lib/alloy.js" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/blob/1_3_X/Alloy/lib/alloy.js</a> line 139 (latest version):
extendObj.sync = function(method, model, opts) {
    mod.sync(method, model, opts);
};

Should be:

extendObj.sync = function(method, model, opts) {
    return mod.sync(method, model, opts);
};

Note: there is a second instance of the same issue later on in the file, which exposes the same issue and needs to be fixed again.

<h3>Comments</h3>

<ol>
<li>Eric Thiebaut-George 2015-02-04

   Updated description to state that there is a 2nd instance of the same issue in the same file. We hit the same issue in another part of the code and adding the return statement fixes this issue too.</li>
<li>Mauro Parra-Miranda 2015-02-04

   Hello Eric,
   do you mind to provide a simple testcase that shows the issue? Then we can add your fix as suggested fix to engineering. 
   
   Best Regards</li>
<li>Eric Thiebaut-George 2015-02-04

   Hi,
   
   I won't have time to create a self-contained project but basically it happens when using a model that returns a promise and try to execute:
   Alloy.createModel("test").fetch().then(function(data) {
   	Ti.API.log("info", "In then");
   }).catch(function(data) {
   	Ti.API.log("info", "In catch");
   });
   
   This used to work in older versions of Titanium but now breaks. Interestingly enough, it only breaks when compiling from TiStudio, but it works when compiling from the CLI.
   
   So the question is: is fetch() returning a value supported? This is extremely valuable when using an async adapter, as opposed to getting into callback or event hell.
   
   I actually just found someone experiencing the same issue and documenting the same fix:
   <a href="https://github.com/aaronksaunders/tiConnectSampleApp" rel="nofollow" target="_blank">https://github.com/aaronksaunders/tiConnectSampleApp</a>
   
   Look for "Hacking of alloy.js to get promises to work".
   So this project (tiConnectSampleApp) can be used as a sample to show the advantage of adding a return statement in these 2 places.
   
   Looking at the backbone doc for fetch(), it is supposed to return a jqXHR, so in theory it should be able to return something.
   It may be slightly outside of the scope of Titanium - I'll let you decide, but being able to use promises is a great advantage.</li>
<li>Eric Thiebaut-George 2015-02-05

   </li>
<li>Mauro Parra-Miranda 2015-02-05

   </li>
</ol>


<p><a href="/AC/AC-1159.json">JSON Source</a></p>