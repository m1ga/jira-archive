---
title: "[AC-1172] Android HTTPClient: POST with image encoded as base64 sent as GET"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2016-01-07T08:24:05.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>android, defect, httpclient</td></tr>
<tr><th>Reporter</th><td>Ryan Asleson</td></tr>
<tr><th>Assignee</th><td>Sharif AbuDarda</td></tr>
<tr><th>Created</th><td>2015-12-25T21:18:01.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:32.000+0000</td></tr>
</table>

<h3>Description</h3>



<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-1172_57846/IMAG0443.jpg">IMAG0443.jpg</td></td><td>2015-12-25T20:59:56.000+0000</td><td>1886092</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-1172_57844/post-as-base64.txt">post-as-base64.txt</td></td><td>2015-12-25T21:05:13.000+0000</td><td>2647930</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-1172_57845/post-as-binary.txt">post-as-binary.txt</td></td><td>2015-12-25T21:01:58.000+0000</td><td>3228034</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-1172_57859/post-with-both.txt">post-with-both.txt</td></td><td>2015-12-30T22:38:50.000+0000</td><td>5742965</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2015-12-30

   What happens when you keep both of them?
   <code><pre>
       var data = {
   
           "entry.id": entryBean.id
   
           , "_eventName": "uploadPhoto"
   
           , "imageData": selectedImage
   
           , encodedImage: Ti.Utils.base64encode(selectedImage).toString()
   
           , "caption": $.caption.value
   
           , "fileName": getFileNameFrom(selectedImage)
   
       };
   </pre></code>
   
   Or try to make a blob of the image and then try base64encode.
   
   <code><pre>
   image=selectedImage.toBlob(); 
   ...
   encodedImage: Ti.Utils.base64encode(image).toString()
   </pre></code>
   Reply with your response. Thanks.
   </li>
<li>Ryan Asleson 2015-12-30

   
   First, I noticed that the <code>encodedImage</code> key on the <code>data</code> object wasn't in quotes like the others, so I changed it.  Doesn't seem to have made a difference.
   
   Anyway, when I sent the image as both binary data and as base64 like this:
   
   <code><pre>
       var data = {
           "entry.id": entryBean.id
           , "_eventName": "uploadPhoto"
           , "imageData": selectedImage
           , "encodedImage": Ti.Utils.base64encode(selectedImage).toString()
           , "caption": $.caption.value
           , "fileName": getFileNameFrom(selectedImage)
       };
   </pre></code>
   
   The data was correctly sent as a <code>POST</code>.  See attachment post-as-both.txt.
   
   When I tried your suggestion of converting to a blob like this:
   
   <code><pre>    
   var data = {
           "entry.id": entryBean.id
           , "_eventName": "uploadPhoto"
           , "imageData": selectedImage
           //, "encodedImage": Ti.Utils.base64encode(selectedImage).toString()
           , "encodedImage": Ti.Utils.base64encode(selectedImage.toBlob()).toString()
           , "caption": $.caption.value
           , "fileName": getFileNameFrom(selectedImage)
       };
   </pre></code>
   
   I get a runtime error that says this:
   
   Message:  Uncaught TypeError:  Object [object TiBlob] has no method 'toBlob'
   
   Source:  encodedImage: TiUtils.base64encode(selectedImage.toBlob()).toStri
   
   Apparently <code>selectedImage</code> is already a Blob.
   
   Does that help?</li>
<li>Sharif AbuDarda 2016-01-07

   Hello, It looks like when you tried to sent the image as both binary data and as base64, The data was correctly sent as a POST. Which I think resolves your issue. We will resolve this issue. If you have any further requirement please let us know. Thanks.</li>
<li>Ryan Asleson 2016-01-08

   
   Hi, it's definitely *NOT* working correctly.  The problem is that when sending the image as base64 (and only base64), the data is sent as a GET instead of a POST.  See attachment post-as-base64.txt.
   
   My apologies, but I should have mentioned earlier that I do explicitly set the request to be a POST:
   
   <code><pre>
       var data = {
           "entry.id": entryBean.id
           , "_eventName": "uploadPhoto"
           , "imageData": selectedImage
           // , encodedImage: Ti.Utils.base64encode(selectedImage).toString()
           , "caption": $.caption.value
           , "fileName": getFileNameFrom(selectedImage)
       };
       
       var options = http.standardOptions();
       options.url = "mobile/entry/EntryImage.action?_eventName=uploadPhoto";
       options.method = "POST";
       options.data = data;
       options.onComplete = function(response) {
           Ti.API.info("made it to PhotoUpload onComplete!!!!");
           onUploadComplete(response);
       };
       options.onLoginSuccess = closeWindow;
           
       http.send(options);
   </pre></code>
   
   Yes, when I sent the image as both binary and base64 the request was correctly sent as a POST.  The issue is that when the image is sent *only* as base64, it's sent as a GET.
   
   Let me know what you find.  Thank you!!!</li>
</ol>


<p><a href="/AC/AC-1172.json">JSON Source</a></p>