---
title: "[AC-1233] FB Login and Sharing not working proper."
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2015-09-15T04:05:00.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>TCSupportTriage, api, ios</td></tr>
<tr><th>Reporter</th><td>shubham mishra</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2014-08-20T09:36:18.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:37.000+0000</td></tr>
</table>

<h3>Description</h3>

I am working in facebook sharing using graph API but during develoment I'm facing following issues:

1. Login event listener not callback but user has logged In at first time.

2. In Second time some time facebook sharing working but next time it's giving me error which I've attached screenshot for the same. most of the time sharing done in first time but second time it's giving me error.



Below are the code which I'm using. Also I've added "<property name="ti.facebook.appid">xxxxxxxxxxxxxxxxx</property>" in .xml and info.plist with key.

 Please provide me any solution: 

 var data = {
			message:'Post Sharing'
		 };

	    function showFBResult(eventData) {
	    	if (eventData.success) {
	    		       alert('in succes');
	    	} else {
				if (eventData.error) {
					alert(eventData.error);
				} 
			}
		}
	
	    var fb = require('facebook');
		fb.appid = "xxxxxxxxxxxxxxxx";
		fb.permissions = ['publish_stream'];
		fb.forceDialogAuth = true;
		if (!fb.loggedIn) {
		    fb.authorize();
		}else{
	    		fb.requestWithGraphPath('me/feed', data, 'POST', showFBResult);
		}
		
		fb.addEventListener('login', function(e){
				if(e.success){
				    	fb.requestWithGraphPath('me/feed', data, 'POST', showFBResult);
				} else if (e.error) {
					alert(e.error);
				}
		});

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-1233_50587/screen1.png">screen1.png</td></td><td>2014-08-20T09:36:18.000+0000</td><td>37798</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Motiur Rahman 2015-08-19

   Hello,
   
   On latest Ti SDK version FB login and sharing is working as expected. Please try the following code with the latest version of the SDK
   
   *Testing Environment:*
   Command-Line Interface, version 4.1.2,
   FB Module Version: 4.0.5,
   Ti SDK: 4.1.0,
   iOS Version: v8.4,
   Studio Version: 4.1.1
   
   *Test Code*
   <code><pre>
   var win = Ti.UI.createWindow({
   	backgroundColor : 'white',
   	layout : 'vertical'
   });
   
   var share = Ti.UI.createButton({
   	title : 'Share',
   	height : 100,
   	width : 100,
   	top : 100,
   	color : '#000'
   });
   
   // Listen for click events.
   share.addEventListener('click', function() {
   	shareData();
   });
   
   win.add(share);
   
   var fb = require('facebook');
   fb.appid = "APP_ID";
   
   fb.addEventListener('login', function(e) {
   	if (e.success) {
   		alert('Logged in');
   
   	}
   });
   fb.addEventListener('logout', function(e) {
   	alert('Logged out');
   });
   
   win.add(fb.createLoginButton({
   	top : 50,
   	style : fb.BUTTON_STYLE_WIDE
   }));
   
   var data = {
   	message : "Trying out FB Graph API and it's fun!"
   };
   
   function shareData() {
   	fb.requestNewPublishPermissions(['publish_actions'], fb.AUDIENCE_FRIENDS, function(e) {
   		if (e.success) {
   			fb.requestWithGraphPath('me/feed', data, "POST", function(e) {
   				if (e.success) {
   					alert("Success!  From FB: " + e.result);
   				} else {
   					if (e.error) {
   						alert(e.error);
   					} else {
   						alert("Unkown result");
   					}
   				}
   			});
   		} else {
   			Ti.API.debug('Failed authorization due to: ' + e.error);
   		}
   	});
   
   }
   
   win.open();
   
   </pre></code>
   <code><pre>
    &lt;ti:app&gt;
           &lt;ios&gt;
               &lt;plist&gt;
                   &lt;dict&gt;
                       &lt;key&gt;CFBundleURLTypes&lt;/key&gt;
                       &lt;array&gt;
                           &lt;dict&gt;
                               &lt;key&gt;CFBundleURLName&lt;/key&gt;
                               &lt;!-- Application ID same as the id value in the tiapp.xml file --&gt;
                               &lt;string&gt;APP_ID&lt;/string&gt;
                               &lt;key&gt;CFBundleURLSchemes&lt;/key&gt;
                               &lt;array&gt;
                                   &lt;!-- Prefix the Facebook App ID with 'fb' --&gt;
                                   &lt;string&gt;fbFACEBOOK_APP_ID&lt;/string&gt;
                               &lt;/array&gt;
                           &lt;/dict&gt;
                       &lt;/array&gt;
                       &lt;key&gt;FacebookAppID&lt;/key&gt;
                       &lt;!-- Facebook App ID --&gt;
                       &lt;string&gt;FACEBOOK_APP_ID&lt;/string&gt;
                       &lt;key&gt;FacebookDisplayName&lt;/key&gt;
                       &lt;!-- Facebook App Name from developer.facebook.com --&gt;
                       &lt;string&gt;FACEBOOK_APP_NAME&lt;/string&gt;
                   &lt;/dict&gt;
               &lt;/plist&gt;
           &lt;/ios&gt;
       &lt;/ti:app&gt;
   </pre></code>
   
   Thanks.</li>
</ol>


<p><a href="/AC/AC-1233.json">JSON Source</a></p>