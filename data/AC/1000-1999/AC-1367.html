---
title: "[AC-1367] TiDrawableReference.getBitmap(true) fails on the second retry (android)"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2014-06-12T04:40:39.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>android, mobilesdk</td></tr>
<tr><th>Reporter</th><td>grebulon</td></tr>
<tr><th>Assignee</th><td>Ritu Agrawal</td></tr>
<tr><th>Created</th><td>2014-05-26T07:48:19.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:47.000+0000</td></tr>
</table>

<h3>Description</h3>

There's a bug in <code>TiDrawableReference.getBitmap(true)</code>

Calling <code>BitmapFactory.decodeStream(is, null, opts)</code> the second time in the retry loop fails because the input stream (<code>is</code>) has to be rewound.

At the beginning of the retry loop, you need to add something like:
{noformat}
if (i > 0)
  is = getInputStream();
{noformat}
and also make sure that it is not null.

<h3>Comments</h3>

<ol>
<li>Ritu Agrawal 2014-05-27

   Thank you for your suggestion but we need a simple test case to reproduce this issue. </li>
<li>grebulon 2014-05-28

   This is not a suggestion - it is a BUG report. Just find a huge image on the internet (search for very high resolution world map) and load it into an image view. You need to cause an out of memory exception. Or you can manually insert code to simulate this.
   I gave you a very good description of the problem and how to solve it, this should be enough. I don't have time to write your unit tests for you.</li>
<li>Ritu Agrawal 2014-06-12

   We have not been able to reproduce this issue and the reporter has declined to provide a test case.</li>
</ol>


<p><a href="/AC/AC-1367.json">JSON Source</a></p>