---
title: "[AC-1435] TiPaypal does not make a Delayed Chain Payment"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2014-11-05T19:04:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Appcelerator Modules</td></tr>
<tr><th>Labels</th><td>TCSupportTriage</td></tr>
<tr><th>Reporter</th><td>Joseph Sachs</td></tr>
<tr><th>Assignee</th><td>Mauro Parra-Miranda</td></tr>
<tr><th>Created</th><td>2014-10-04T14:09:47.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:51.000+0000</td></tr>
</table>

<h3>Description</h3>

The Module located here: <a href="https://github.com/appcelerator-modules/ti.paypal" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.paypal</a>

+Solution:+ The TiPaypal Module does Not have a property for *actionType*. I think this will solve the issue if added.

+Details:+ While trying to Implement a **Delayed Chain Payment**, I've added the following code:
<code><pre>
button = Paypal.createPaypalButton({
    width: 194, height: 37,
    buttonStyle: Paypal.BUTTON_194x37,
    top: 100,
     
    language: 'en_US',
    textStyle: Paypal.PAYPAL_TEXT_PAY,
     
    appID: payPalAppID,
    paypalEnvironment: Paypal.PAYPAL_ENV_SANDBOX, // Sandbox, None or Live
     
    feePaidByReceiver: true, 
    enableShipping: false,

    actionType: 'PAY_PRIMARY', // Not Part of the Module
     
    advancedPayment: { // The payment itself
        payments: [
            {
                isPrimary: true, // Mark this as the primary vendor; this marks this as a chain payment.
                merchantName: 'Book App',
                paymentType: Paypal.PAYMENT_TYPE_SERVICE,
                subtotal: 20,
                tax: 0,
                shipping: 0,
                recipient: 'owner@somedomain.ca', // Sandbox Business Account
                customID: 'anythingYouWant',
                invoiceItems: [
                    { name: 'Book Title', totalPrice: 20, itemPrice: 20, itemCount: 1 }
                ]
            },
            {
                isPrimary: false, // Delay it?
                merchantName: 'Book Seller',
                paymentType: Paypal.PAYMENT_TYPE_SERVICE,
                subtotal: 10,
                tax: 0,
                shipping: 0,
                recipient: 'tester2@domain.ca', // Sandbox Account
                customID: 'anythingYouWant',
                invoiceItems: [
                    { name: 'Book Title', totalPrice: 10, itemPrice: 10, itemCount: 1 }
                ]
            }
        ],
        ipnUrl: 'someurl.com',
        currency: 'CAD',
        memo: 'Book purchase'
        }
    });
 
        // Events available
    button.addEventListener('paymentCancelled', function (e) {
        alert('Payment cancelled. Please try again!');
        addButtonToWindow();
    });
    button.addEventListener('paymentSuccess', function (e) {
        alert('Payment successfull. Please get your Policy No.!');
        Ti.API.info(JSON.stringify(e));
        transID = e.transactionID; // HERE: This should return payKey, but is returning transactionID.
        win.remove(button);
    });
    button.addEventListener('paymentError', function (e) {
        alert('Payment Error. Please try again!');
            addButtonToWindow();
        });
 
        button.addEventListener('buttonDisplayed', function () {
            win.remove(status);
        });
 
        button.addEventListener('buttonError', function () {
        alert('Button Error.');
    });
 
win.add(button);
</pre></code>

The Code above returns in **paymentSuccess** event:
<code><pre>
transactionID	:	AP-XXXXXXD595635X		
bubbles	:	true
type	:	paymentSuccess
	source 
           .... ....
</pre></code>

The API Explorer <a href="https://devtools-paypal.com/apiexplorer/AdaptivePayments" rel="nofollow" target="_blank">https://devtools-paypal.com/apiexplorer/AdaptivePayments</a> when trying out the same credentials, returns a *''payKey"* property instead of a "transactionID". The PayKey is used later to make the second payment.

The code above does the chain payment immediately, however I'd like it to pay the primary receiver only, and then do the second payment at a later date (before 90 days as PayPal suggests).

+Possible Solution+: The TiPaypal Module does Not have a property for *actionType* . I think this will solve the issue if added, so we can give it a value of: *"PAY_PRIMARY"*.

I've attached a screenshot of the API explorer.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/AC/AC-1435_51805/Screen Shot 2014-10-04 at 10.11.48 AM.png">Screen Shot 2014-10-04 at 10.11.48 AM.png</td></td><td>2014-10-04T14:13:29.000+0000</td><td>116965</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Joseph Sachs 2014-10-04

   Additional Information on Delayed Chain Payments: <a href="https://developer.paypal.com/webapps/developer/docs/classic/adaptive-payments/ht_ap-delayedChainedPayment-curl-etc/" rel="nofollow" target="_blank">https://developer.paypal.com/webapps/developer/docs/classic/adaptive-payments/ht_ap-delayedChainedPayment-curl-etc/</a>
   
   You notice this:
   <code><pre>
   actionType=PAY_PRIMARY
   &receiverList.receiver(0).primary=true    // Receiver designation (there can be only 1 primary receiver)
   &receiverList.receiver(1).primary=false  // Delay second receiver
   </pre></code>
   
   The TiPaypal Module does Not have a property for *actionType*. I think this will solve the issue if added.</li>
<li>Joseph Sachs 2014-10-08

   Update: It seems that Paypal has no support in the iOS nor Android SDK yet: <a href="https://github.com/paypal/PayPal-iOS-SDK/issues/9" rel="nofollow" target="_blank">https://github.com/paypal/PayPal-iOS-SDK/issues/9</a>
   
   You can Close this issue.</li>
<li>Mauro Parra-Miranda 2014-11-05

   Update: It seems that Paypal has no support in the iOS nor Android SDK yet: <a href="https://github.com/paypal/PayPal-iOS-SDK/issues/9" rel="nofollow" target="_blank">https://github.com/paypal/PayPal-iOS-SDK/issues/9</a>
   
   You can Close this issue.</li>
</ol>


<p><a href="/AC/AC-1435.json">JSON Source</a></p>