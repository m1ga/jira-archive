---
title: "[AC-1484] Adding Event to Android calendar has wrong timezone"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2015-07-08T15:47:59.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>TCSupportTriage, android</td></tr>
<tr><th>Reporter</th><td>Stefan Schüller</td></tr>
<tr><th>Assignee</th><td>Radamantis Torres-Lechuga</td></tr>
<tr><th>Created</th><td>2014-12-04T08:04:43.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:37:55.000+0000</td></tr>
</table>

<h3>Description</h3>

Line 204: in EventProxy.java (<a href="https://github.com/appcelerator/titanium_mobile/blob/58198c641d77e17d156431666e80bae732b5c130/android/modules/calendar/src/java/ti/modules/titanium/calendar/EventProxy.java#L204)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/58198c641d77e17d156431666e80bae732b5c130/android/modules/calendar/src/java/ti/modules/titanium/calendar/EventProxy.java#L204)</a>

<code><pre>
eventValues.put(Events.EVENT_TIMEZONE, new Date().toString());
</pre></code>

Appears to be incorrect. The JavaScript method toString on a Date object will produce an output like so "Thu Dec 04 2014 08:47:02 GMT+0100 (CET)" while the Java string Events.EVENT_TIMEZONE needs to be in the format of "GMT +01:00" (<a href="http://docs.oracle.com/javase/7/docs/api/java/util/TimeZone.html)" rel="nofollow" target="_blank">http://docs.oracle.com/javase/7/docs/api/java/util/TimeZone.html)</a>

The result is the following code will not work correctly. The event is added incorrectly which is however only visible in certain Calendars such as the s-planner. The device is set to CET. (See screenshots)

<h4>Test Code</h4>
<code><pre>
var w = Titanium.UI.createWindow({backgroundColor:'#000'});
 
var view = Titanium.UI.createView({});
 
var button = Titanium.UI.createButton({
  height: 100,
  width: 300,
  top: '20%',
  title: 'add event'
});

// events
var events = [
	{
		title: "Event has ümlääüts",
		description: "Event 1 stuff müröälad",
		start: new Date(2014, 12, 4, 17, 0, 0),
		end: new Date(2014, 12, 4, 18, 0, 0),
		allday: false
	}
];


function addEvent(data) {

    var calendar;

	if (Ti.Platform.osname === 'android') {
		calendar = Ti.Calendar.getCalendarById(1);
	} else {
		calendar = Ti.Calendar.defaultCalendar;
	}

    console.log('start: '+data.start);
    console.log('end: '+data.end);

	// Create the event	
	var details = {
	    title: data.title,
	    description: data.description,
	    begin: data.start,
	    end: data.end,
	    allDay: data.allday
	};
	
	var event = calendar.createEvent(details);	
	
	if (Ti.Platform.osname === 'iphone') {
		event.save(Ti.Calendar.SPAN_THISEVENT);
	}
}

function addEvents(events) {
	for(var i in events) {
		addEvent(events[i]);
	}	
} 
  
button.addEventListener('click',function(e)
{
	if (Ti.Platform.osname === 'android') {
		addEvents(events);
	} else {
		if(Ti.Calendar.eventsAuthorization == Ti.Calendar.AUTHORIZATION_AUTHORIZED) {
			addEvents(events);
		} else {
		    Ti.Calendar.requestEventsAuthorization(function(e){
				addEvents(events);
		    });								
		}
	}
});
 
view.add(button);
w.add(view);
w.open();
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/AC/AC-1484_53007/Screenshot_2014-12-04-08-58-29.png">Screenshot_2014-12-04-08-58-29.png</td></td><td>2014-12-04T08:04:43.000+0000</td><td>338012</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/AC/AC-1484_53008/Screenshot_2014-12-04-08-59-01.png">Screenshot_2014-12-04-08-59-01.png</td></td><td>2014-12-04T08:04:43.000+0000</td><td>114264</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/AC/AC-1484_53009/Screenshot_2014-12-04-09-02-13.png">Screenshot_2014-12-04-09-02-13.png</td></td><td>2014-12-04T08:04:43.000+0000</td><td>70545</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/AC/AC-1484.json">JSON Source</a></p>