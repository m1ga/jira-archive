---
title: "[AC-1834] Google Maps Android API v2 doesn't work when I build the app with new CLI"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-06-13T19:07:44.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Appcelerator CLI, Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>android, cli, mapv2</td></tr>
<tr><th>Reporter</th><td>Romain Salles</td></tr>
<tr><th>Assignee</th><td>Daniel Sefton</td></tr>
<tr><th>Created</th><td>2013-05-08T09:53:55.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:40:44.000+0000</td></tr>
</table>

<h3>Description</h3>

I'm trying to integrate the module for *Google Maps Android API v2* in my android app.

<h4>Description</h4>

I have done every steps explained in these 2 pages :

- [Titanium Map API](<a href="http://docs.appcelerator.com/titanium/3.0/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/titanium/3.0/#</a>!/api/Modules.Map)
- [Getting Started Google Maps Android API v2](<a href="https://developers.google.com/maps/documentation/android/start#the_google_maps_api_key)" rel="nofollow" target="_blank">https://developers.google.com/maps/documentation/android/start#the_google_maps_api_key)</a>

And I have implemented a minimal app :

<code><pre>
var win = Titanium.UI.createWindow();
 
var MapModule = require('ti.map');
var mapView = MapModule.createView({
    mapType: MapModule.NORMAL_TYPE,
    region: {latitude:33.74511, longitude:-84.38993,
            latitudeDelta:0.01, longitudeDelta:0.01},
    animate:true,
    regionFit:true,
    userLocation:true
});
win.add(mapView);
 
win.open();
</pre></code>

Until here, everything is ok...
The next logic step is to test this code by building it and installing it on my device (and not in the emulator, since this module is not supported on it : cf. Titanium Map API)
Thus, I build my app with the CLI :

<code><pre>
titanium build \
  --platform android \
  --target device \
  -s 3.1.0.GA \
  --deploy-type test \
  --android-sdk /Users/romainsalles/android-sdk/ \
  --project-dir /Users/romainsalles/Dev/mapv2 \
  --keystore /Users/romainsalles/Dev/mapv2/mapv2-test.keystore \
  --password AWESOME_PASSWORD \
  --alias KEYSTORE_ALIAS \
  --output-dir /Users/romainsalles/Dev/mapv2/build/android \
  --avd-id 4
</pre></code>

<h4>Errors</h4>

The *app opens but I don't have any map*. Nevertheless, I have the map buttons (cf. *mapv2_empty.png*)
The errors obtained are these ones :

<code><pre>
05-07 18:46:12.332: E/Google Maps Android API(28174): Authorization failure.
05-07 18:46:12.572: E/Google Maps Android API(28174): Failed to load map.  Could not contact Google servers.
</pre></code>

I think these errors are due the fact that the app is signed with the Titanium keystore instead of mine. Indeed, the logs of the CLI return :

<code><pre>
[DEBUG] keytool -v -list -keystore "/Users/romainsalles/Library/Application Support/Titanium/mobilesdk/osx/3.1.0.GA/android/dev_keystore" -storepass ******* -alias tidev
[DEBUG] jarsigner -sigalg MD5withRSA -digestalg SHA1 -storepass ******* -keystore "/Users/romainsalles/Library/Application Support/Titanium/mobilesdk/osx/3.1.0.GA/android/dev_keystore" -signedjar /Users/romainsalles/Dev/mapv2/build/android/bin/app.apk /Users/romainsalles/Dev/mapv2/build/android/bin/app-unsigned.apk tidev
</pre></code>

<h4>A (not satisfying) solution</h4>

Then, I have tried to build the app with the plain old titanium commands :

<code><pre>
/Users/romainsalles/Library/Application\ Support/Titanium/mobilesdk/osx/3.1.0.GA/android/builder.py distribute \
  Mapv2 \
  /Users/romainsalles/android-sdk/ \
  /Users/romainsalles/Dev/mapv2 \
  com.mapv2 \
  /Users/romainsalles/Dev/mapv2/mapv2-test.keystore \
  AWESOME_PASSWORD \
  KEYSTORE_ALIAS \
  /Users/romainsalles/Dev/mapv2/build/android \
  4 \
  8
</pre></code>

Then, I download the app on my android and install it (note : the android ask me if accept the different permissions). Then, the *app opens and I can see the map* (cf. *mapv2_ok.png*)

<h4>The issue</h4>

I have worked on this problem a lot, but I didn't found any solution... Did I miss something or is it really impossible to build an app using the * Google Maps Android API v2* with the CLI ?

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-1834_38233/app.js">app.js</td></td><td>2013-05-08T09:53:55.000+0000</td><td>349</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-1834_38231/mapv2_empty.png">mapv2_empty.png</td></td><td>2013-05-08T09:53:55.000+0000</td><td>15784</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-1834_38232/mapv2_ok.png">mapv2_ok.png</td></td><td>2013-05-08T09:53:55.000+0000</td><td>123033</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Romain Salles 2013-06-13

   I see this Jira has been re-assigned.
   I have solved my issue since the creation of this post.
   
   It was an issue with the keystore. I hadn't used yours for my build and, of course, it couldn't work.
   Thus, you can close this Jira.
   
   Sorry for forgetting to update the Jira.</li>
<li>Daniel Sefton 2013-06-13

   Thanks - closing.</li>
</ol>


<p><a href="/AC/AC-1834.json">JSON Source</a></p>