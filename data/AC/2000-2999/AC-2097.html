---
title: "[AC-2097] iOS: Network.HTTPClient is cleaning all request headers"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2013-02-06T18:12:43.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>bug, headers, http, ios, network</td></tr>
<tr><th>Reporter</th><td>Rafael Kellermann Streit</td></tr>
<tr><th>Assignee</th><td>Mauro Parra-Miranda</td></tr>
<tr><th>Created</th><td>2013-02-06T17:15:16.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:41:04.000+0000</td></tr>
</table>

<h3>Description</h3>

I'm working in a application that have this request:

<code><pre>
var xhr = Ti.Network.createHTTPClient();

xhr.setRequestHeader("foo", "bar");
xhr.setRequestHeader("Content-Type", "text/plain");

xhr.open("POST", "<a href="http://foo.bar" rel="nofollow" target="_blank">http://foo.bar</a>");

xhr.send("Foobar");
</pre></code>

But I'm having some problems with it (and other people too: <a href="http://developer.appcelerator.com/question/147651/setrequestheader-doesnt-work)." rel="nofollow" target="_blank">http://developer.appcelerator.com/question/147651/setrequestheader-doesnt-work).</a>

In *TiNetworkHTTPClientProxy.m* we have this following statement (line 384):

<code><pre>
-(void)open:(id)args
{
   ...
   request = [[ASIFormDataRequest requestWithURL:url] retain];
   ... 
}
</pre></code>

I think this is cleaning all headers included in request. Am i correctly?

So, I changed the code to (because the request already exists):

<code><pre>
[request requestWithURL:url];
</pre></code>

And it works fine. If I'm correctly, I will make a PR ASAP to titanium_mobile project.

<h3>Comments</h3>

<ol>
<li>Rafael Kellermann Streit 2013-02-06

   Sorry, apparently I'm wrong. :-(</li>
<li>Daniel Sefton 2013-02-06

   Could you elaborate?</li>
<li>Rafael Kellermann Streit 2013-02-06

   If I put the request headers after the "open" statement, it will works fine, because of request instance will exists.</li>
<li>Daniel Sefton 2013-02-06

   Thanks, I'll close it now.</li>
<li>Mauro Parra-Miranda 2013-11-24

   Invalid issue. </li>
</ol>


<p><a href="/AC/AC-2097.json">JSON Source</a></p>