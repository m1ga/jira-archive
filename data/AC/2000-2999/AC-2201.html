---
title: "[AC-2201] iOS: Apps hang at startup when network connection is poor"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Needs more info</td></tr>
<tr><th>Resolution Date</th><td>2013-02-22T17:10:03.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>analytics, crash, hang, ios, modules, network, startup, triage</td></tr>
<tr><th>Reporter</th><td>Luke Bartolomeo</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2012-10-01T18:48:29.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:41:11.000+0000</td></tr>
</table>

<h3>Description</h3>

Let me start by giving a general description of the behavior I am witnessing.

When using Titanium 2.x, targeting iOS 5 or 6....

If I launch my app in a situation where the device or simulator BELIEVES it has a network connection, but where one is not actually available, the app will hang. True, this might seem to be a rare situation, but it happens quite frequently here in downtown Chicago. My phone reports a 4g connection with AT&T, but the network is unresponsive.

I have witnessed all of the following depending upon my app and whether I am running on the device or in simulator.
<h4>The app hangs forever on the splash screen.</h4>
<h4>The app makes it past the startup screen, but the UI is unresponsive. </h4>
<h4>The app hangs on the startup screen for a long time, but eventually finishes launching normally. </h4>
<h4>The app hangs on the startup screen, and then iOS shuts it down (for taking to long to launch?)</h4>
<h4>Occasionally, the console shows the error "Timing out waiting on main thread. Possibly a deadlock? in TiThreadPerformOnMainThread (TiBase.m:238)"</h4>

I know that a while back, this type of problem could be traced to having analytics enabled, but I am seeing this even with <analytics>false</analytics> in my tiapp.xml

It also appears that the issue is somehow related to the loading of modules, as my apps which do not use modules do not exhibit the bug.

<h4>Steps to reproduce:</h4>

Create a new default Titanium Mobile project. Run in simulator to show that it is working correctly (you can switch between tabs).
Now, set analytics to false in tiapp.xml (just to rule that out as the cause).
Then, fool your computer into thinking you have a network connection when you actually do not. The easiest way to do this is with Apple's Network Link Conditioner Preference pane. You will need to create a new profile with 0% bandwidth and 100% of up and down packets dropped. 

Confirm that your computer appears to have a network connection, but an attempt to access a web page yields NO response.

Run the test app in the simulator. It works just as before.

But finally, try adding a module to the project. I used ti.storekit for my testing. Also, be sure to actually require the module at the beginning of the app.js code.

Run the app in the simulator, and you should find that it either hangs for a long time on the default splash screen, or that the window is unresponsive when you attempt to switch tabs-- for a long time or FOREVER.

As I said, the conditions under which this bug would appear are fairly rare. Apps launch fine when the device knows there is no network connection, and they launch fine when the device HAS a network connection. Usually even when the connection is marginal, the app will eventually launch.

But when the device (or simulator) thinks it has a connection but it actuality it does not, the app will hang at launch.
If anyone could verify that they can reproduce this behavior, I will feel a little better that it is not something wonky on my end. Although, it still won't leave us with a solution yet.

<h4>UPDATE</h4>

When using Little Snitch to monitor network activity, it seems that my little test app STILL is trying to connect to api.appcelerator.com on port 443 at launch. This is even after analytics is set to FALSE in tiapp.xml

Maybe this issue IS related to TIMOB-9090 (reported fixed) and TIMOB-2984 (still open).

<h3>Comments</h3>

<ol>
<li>Craig Jones 2012-10-16

   +1 for the above.
   
   I have an app that connects to the Twitter API and I've getting the same situation in hanging splash screens etc...
   
   Same as above, Analytics disabled, Ti 2.x, iOS 5 & 6.</li>
<li>Eduardo Gomez 2013-02-21

   Luke, can you please provide us logs (Titanium Mobile stack traces) and crash reports, if any?</li>
<li>Eduardo Gomez 2013-02-22

   When time allows, please check and complete [JIRA Ticket Checklist](<a href="http://docs.appcelerator.com/titanium/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/titanium/latest/#</a>!/guide/How_to_Submit_a_Bug_Report-section-29004732_HowtoSubmitaBugReport-JIRATicketChecklist) in order to escalate this issue quicker, thanks.</li>
<li>Mostafizur Rahman 2014-01-18

   Hello,
   
   We tested this issue with latest Ti Studio and SDK 3.2. We can't reproduce this problem. 
    
   
   <h4>Test Environment </h4>
   Mac OX x 10.8.5
   Ti CLI 3.2.0
   Ti SDK 3.2.0.GA
   IOS Simulator 7.0.3 
   
   <h4>Test Code </h4>
   <code><pre>
   var win = Titanium.UI.createWindow({
   	backgroundColor : 'orange'
   });
   
   c = Titanium.Network.createHTTPClient();
   c.setTimeout(10000);
   
   c.onload = function() {
   	Ti.API.info('IN ONLOAD ');
   	Ti.API.info("response " + c.responseData);
   
   };
   c.ondatastream = function(e) {
   
   };
   c.onerror = function(e) {
   	Ti.API.info('XHR Error ' + e.error);
   };
   
   // open the client
   
   c.open('GET', '<a href="https://raw.github.com/appcelerator/Documentation-Examples/master/HTTPClient/data/json.txt" rel="nofollow" target="_blank">https://raw.github.com/appcelerator/Documentation-Examples/master/HTTPClient/data/json.txt</a>');
   
   // send the data
   c.send();
   win.open();
   
   </pre></code>
   
   <h4>Step to Test</h4>
   
   <h4>Create new project for Ti Classic </h4>
   <h4>Update app.js file with test code</h4>
   <h4>Disconnected networks connection </h4>
   <h4>Set analytics false in project tiapp.xml</h4>
   <h4>Run this project in iOS simulator </h4>
   <h4>App will run with 'orange' background color</h4>
   
   
   Thanks
   </li>
<li>Shota Watanabe 2015-02-16

   +1 for this
   I just use 'Network Link Conditioner' and set '100% loss' , it finally reproduced.
   
   </li>
</ol>


<p><a href="/AC/AC-2201.json">JSON Source</a></p>