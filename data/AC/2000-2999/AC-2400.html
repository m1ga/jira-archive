---
title: "[AC-2400] iOS: HTTPClient: autoEncodeURL not used when redirect is followed"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-11-22T22:20:09.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Alloy</td></tr>
<tr><th>Labels</th><td>alloy, encoding, httpclient, ios, ios7, redirect, url</td></tr>
<tr><th>Reporter</th><td>Adam Lynch</td></tr>
<tr><th>Assignee</th><td>Mauro Parra-Miranda</td></tr>
<tr><th>Created</th><td>2013-11-11T18:23:41.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:41:26.000+0000</td></tr>
</table>

<h3>Description</h3>

When trying to GET something which returns a 301, if I set autoEncodeURL to false (via the setter or directly), set autoRedirect to true (or leave it default to that), then the value of the location header returned is encoded before being followed.

To get around this, I had to set autoRedirect to false. Then in the success callback, get the value of the location header returned and issue another GET manually (with autoEncodeURL set to false).

Edit:
This doesn't seem to be a problem on Android

<h3>Comments</h3>

<ol>
<li>Adam Lynch 2013-11-13

   This doesn't seem to be a problem on Android</li>
<li>Mostafizur Rahman 2013-11-21

   Hello,
   
   We have tested this issue with sample below. We canâ€™t reproduce this problem. 
   
   If you continue to encounter the error, please send us your test code and steps to reproduce. We look forward to your feedback.
   
   Regards,
   
   <h4>Test environment: </h4>
   
   OS: MAC OS X 10.8.5
    
   Ti SDK: 3.1.3 GA 
   Ti CLI: 3.2.0
   IOS simulator 7.0
   
   <h4>Test Sample </h4>
   <code><pre>
   var win1 = Titanium.UI.createWindow({
   	 
   });
   
   // Create a Button.
   var aButton = Ti.UI.createButton({
   	title : 'aButton',
   });
   
   // Listen for click events.
   aButton.addEventListener('click', function() {
   
   	var url = "<a href="http://www.example.com/redirect.php" rel="nofollow" target="_blank">http://www.example.com/redirect.php</a>";
   	var client = Ti.Network.createHTTPClient({
   		// function called when the response data is available
   		onload : function(e) {
   			Ti.API.info('e ' + JSON.stringify(e));
   			Ti.API.info("Received HEADERS_RECEIVED: " + this.HEADERS_RECEIVED);
   			Ti.API.info("Received status: " + this.status);
   			Ti.API.info("Received statusText: " + this.statusText);
   			Ti.API.info("Received responseText: " + this.responseText);
   
   			alert('success');
   		},
   		// function called when an error occurs, including a timeout
   		onerror : function(e) {
   			Ti.API.debug(e.error);
   			Ti.API.info("Received HEADERS_RECEIVED: " + this.HEADERS_RECEIVED);
   			Ti.API.info("Received status: " + this.status);
   			Ti.API.info("Received statusText: " + this.statusText);
   			Ti.API.info("Received responseText: " + this.responseText);
   
   			alert('error');
   		},
   		timeout : 5000, // in milliseconds
   		autoRedirect : true,
   		autoEncodeUrl : false,
   
   	});
   	// Prepare the connection.
   
   	client.open("GET", url);
   	// Send the request.
   	client.send();
   
   });
   
   // Add to the parent view.
   win1.add(aButton);
   
   win1.open();
   </pre></code>   
   
   
   <h4>Server side code</h4>
   <code><pre>
   &lt;?php
   
   error_reporting(1);
   Header( "HTTP/1.1 301 Moved Permanently" );
   //Header( "Location: <a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a>" );
   ?&gt;
   </pre></code>
   
   <h4>Step to reproduces</h4>
   1.	Create a new project
   2.	Paste test code in app.js
   3.	Now run on iOS 7 with simulator 7.0 
   4.	Click on button its return success 
   
   
   
   
   </li>
<li>Mauro Parra-Miranda 2013-11-22

   Tested in 3.1.3, works as expected.</li>
</ol>


<p><a href="/AC/AC-2400.json">JSON Source</a></p>