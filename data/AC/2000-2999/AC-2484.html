---
title: "[AC-2484] Ti.CloudPush Version 3.2.0 get Force Close when Unlock Phone on Android 4.4"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-01-10T17:28:53.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>3.2.0, android, sdk, ti.cloudpush</td></tr>
<tr><th>Reporter</th><td>Anh Nguyen</td></tr>
<tr><th>Assignee</th><td>Jon Alter</td></tr>
<tr><th>Created</th><td>2013-12-27T16:36:03.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:41:32.000+0000</td></tr>
</table>

<h3>Description</h3>

Using: Ti.CloudPush Module Version 3.2.0
Last used: Ti.CloudPush Module Version 2.3.2

The App will be Force Closed when Lock then Unlock the phone. On the Console when I debug, looks like this:

{quote}

[ERROR] :  TiApplication: (main) [33375,66355] Sending event: exception on thread: main msg:java.lang.RuntimeException: Unable to instantiate receiver ti.cloudpush.MQTTReceiver: java.lang.ClassNotFoundException: Didn't find class "ti.cloudpush.MQTTReceiver" on path: DexPathList[[zip file "/system/framework/com.google.android.maps.jar", zip file "/data/app/com.mycom.myapp.apk"],nativeLibraryDirectories=[/data/app-lib/com.mycom.myapp, /vendor/lib, /system/lib]]; Titanium 3.2.0,2013/12/20 10:57,d9182d6
[ERROR] :  TiApplication: java.lang.RuntimeException: Unable to instantiate receiver ti.cloudpush.MQTTReceiver: java.lang.ClassNotFoundException: Didn't find class "ti.cloudpush.MQTTReceiver" on path: DexPathList[[zip file "/system/framework/com.google.android.maps.jar", zip file "/data/app/com.mycom.myapp.apk"],nativeLibraryDirectories=[/data/app-lib/com.mycom.myapp, /vendor/lib, /system/lib]]
[ERROR] :  TiApplication: 	at android.app.ActivityThread.handleReceiver(ActivityThread.java:2400)
[ERROR] :  TiApplication: 	at android.app.ActivityThread.access$1700(ActivityThread.java:135)
[ERROR] :  TiApplication: 	at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1272)
[ERROR] :  TiApplication: 	at android.os.Handler.dispatchMessage(Handler.java:102)
[ERROR] :  TiApplication: 	at android.os.Looper.loop(Looper.java:136)
[ERROR] :  TiApplication: 	at android.app.ActivityThread.main(ActivityThread.java:5017)
[ERROR] :  TiApplication: 	at java.lang.reflect.Method.invokeNative(Native Method)
[ERROR] :  TiApplication: 	at java.lang.reflect.Method.invoke(Method.java:515)
[ERROR] :  TiApplication: 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:779)
[ERROR] :  TiApplication: 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:595)
[ERROR] :  TiApplication: 	at dalvik.system.NativeStart.main(Native Method)
[ERROR] :  TiApplication: Caused by: java.lang.ClassNotFoundException: Didn't find class "ti.cloudpush.MQTTReceiver" on path: DexPathList[[zip file "/system/framework/com.google.android.maps.jar", zip file "/data/app/com.mycom.myapp.apk"],nativeLibraryDirectories=[/data/app-lib/com.app/com.mycom.myapp, /vendor/lib, /system/lib]]
[ERROR] :  TiApplication: 	at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:56)
[ERROR] :  TiApplication: 	at java.lang.ClassLoader.loadClass(ClassLoader.java:497)
[ERROR] :  TiApplication: 	at java.lang.ClassLoader.loadClass(ClassLoader.java:457)
[ERROR] :  TiApplication: 	at android.app.ActivityThread.handleReceiver(ActivityThread.java:2395)
[ERROR] :  TiApplication: 	... 10 more

{quote}


When I go back to older version (2.3.2) the app won't get force close any more

<h3>Comments</h3>

<ol>
<li>Ritu Agrawal 2013-12-30

   As of Release 3.2.0, the CloudPush module only supports Google Cloud Messaging (GCM) for push notifications. MQTT support is deprecated and support was removed in Release 3.2.0. Upgrade your application to use the GCM protocol.
   
   MQTT protocol support deprecation was announced back in August and it has finally been removed.
   <a href="http://www.appcelerator.com/blog/2013/08/android-push-notification-deprecating-mqtt-in-favor-of-gcm/" rel="nofollow" target="_blank">http://www.appcelerator.com/blog/2013/08/android-push-notification-deprecating-mqtt-in-favor-of-gcm/</a>
   
   Please update your application to use GCM protocol and let us know if you run into an issue.</li>
<li>Anh Nguyen 2013-12-31

   I am using GCM not MQTT
   I have started build my app in TitaniumSDK 3.1
   I am using payload and push the Payload to Device by TokenDevice
   
   
   						</li>
<li>Ritu Agrawal 2014-01-02

   Reopening this ticket based on the latest feedback from the reporter.</li>
<li>Jon Alter 2014-01-07

   Hi [~anh.nguyen] - If you delete the app from your device and reinstall it, do you still get this error?</li>
<li>Anh Nguyen 2014-01-07

   Yes, I still get that error. 
   I am now rollback to version 2.3.2. and waiting for a proposal to fix this bug. I saw many new features in 3.2.0 and really want to use those features</li>
<li>Jon Alter 2014-01-07

   Can you send me the contents of your "app/build/android/AndroidManifest.xml" file? Thank you.</li>
<li>Jon Alter 2014-01-07

   [~anh.nguyen] - It seems that something is hanging around from the older version of the module. To ensure that is not the case, please try the following:
   <h4>Make sure that there is only one version of the module included in your <code>tiapp.xml</code>.</h4>
   <h4>Delete the application from your device.</h4>
   <h4>Do a clean build of your application. This means deleting the "build" folder and building your application.</h4>
   
   Let me know how it goes!</li>
<li>Anh Nguyen 2014-01-07

   I have re-checked my Customized AndroidManifest.xml file and seen one property look like this:
   <meta-data android:name="com.appcelerator.cloud.push.BroadcastReceiver.ArrivalActivity" android:value="ti.cloudpush.MQTTReceiver"/>
   and this: <receiver android:name="ti.cloudpush.MQTTReceiver">
   I deleted them and now I do not get this error anymore. I don't know why they appear there but any way I fixed it and here is  "app/build/android/AndroidManifest.xml"  after deletion 
   
   
   <?xml version="1.0" encoding="UTF-8"?>
   <manifest xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>" package="com.mycom.myapp" android:versionCode="1" android:versionName="1">
   	<uses-sdk android:minSdkVersion="10" android:targetSdkVersion="18"/>
   	<application android:icon="@drawable/appicon" android:label="myapp" android:name="myappApplication" android:debuggable="true" android:theme="@style/nta.Holo.Light">
   		<activity android:name=".myappActivity" android:label="@string/app_name" android:theme="@style/Theme.Titanium" android:configChanges="keyboardHidden|orientation|screenSize">
   			<intent-filter>
   				<action android:name="android.intent.action.MAIN"/>
   				<category android:name="android.intent.category.LAUNCHER"/>
   			</intent-filter>
   		</activity>
   		<activity android:name="org.appcelerator.titanium.TiActivity" android:configChanges="keyboardHidden|orientation|screenSize"/>
   		<activity android:name="org.appcelerator.titanium.TiTranslucentActivity" android:configChanges="keyboardHidden|orientation|screenSize" android:theme="@android:style/Theme.Translucent"/>
   		<activity android:name="ti.modules.titanium.ui.android.TiPreferencesActivity" android:configChanges="screenSize"/>
   		<activity android:name="ti.modules.titanium.media.TiCameraActivity" android:configChanges="keyboardHidden|orientation|screenSize" android:theme="@android:style/Theme.Translucent.NoTitleBar.Fullscreen"/>
   		<service android:exported="false" android:name="org.appcelerator.titanium.analytics.TiAnalyticsService"/>
   		<service android:name="com.appcelerator.cloud.push.PushService"/>
   		<uses-library android:name="com.google.android.maps"/>
   		<receiver android:name="ti.cloudpush.IntentReceiver"/>
   		<receiver android:name="ti.cloudpush.GCMReceiver" android:permission="com.google.android.c2dm.permission.SEND">
   			<intent-filter>
   				<action android:name="com.google.android.c2dm.intent.RECEIVE"/>
   				<category android:name="com.mycom.myapp"/>
   			</intent-filter>
   		</receiver>
   		<receiver android:name="com.appcelerator.cloud.push.PushBroadcastReceiver">
   			<intent-filter>
   				<action android:name="android.intent.action.PACKAGE_ADDED"/>
   				<action android:name="android.intent.action.PACKAGE_REPLACED"/>
   				<data android:scheme="package" android:path="com.mycom.myapp"/>
   			</intent-filter>
   		</receiver>
   	</application>
   	<supports-screens android:anyDensity="false" android:largeScreens="true" android:normalScreens="true" android:smallScreens="false"/>
   	<uses-permission android:name="android.permission.CALL_PHONE"/>
   	<uses-permission android:name="android.permission.INTERNET"/>
   	<uses-permission android:name="android.permission.GET_ACCOUNTS"/>
   	<uses-permission android:name="android.permission.WAKE_LOCK"/>
   	<uses-permission android:name="com.google.android.c2dm.permission.RECEIVE"/>
   	<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
   	<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>
   	<uses-permission android:name="android.permission.READ_PHONE_STATE"/>
   	<uses-permission android:name="android.permission.VIBRATE"/>
   	<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
   	<uses-permission android:name="com.mycom.myapp.permission.C2D_MESSAGE"/>
   	<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
   	<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
   	<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
   	<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION"/>
   	<uses-permission android:name="android.permission.CAMERA"/>
   	<permission android:name="com.mycom.myapp.permission.C2D_MESSAGE" android:protectionLevel="signature"/>
   </manifest>
   
   Thank you so much JonAlter
   </li>
<li>Anh Nguyen 2014-01-07

   Hi Jon Alter, after I deleted 2 attributes that correspond to MQTTReceiver I did not see Group notification any more. Now all Notifications show in multiple Notifications.
   Do you know what could be the reason? 
   Appreciate your help. </li>
<li>Jon Alter 2014-01-08

    Oh there we go. Remove your custom AndroidManifest from your app so that it can generate a new one. Build the app once and then use the new manifest in "build/android" as the basis for your custom manifest.
    
    Changes where made to what the module needs in the manifest and the custom manifest is over riding that.
    
    You're very welcome. Let me know how it goes.
    
    </li>
<li>Anh Nguyen 2014-01-08

    Thank you, It works now</li>
</ol>


<p><a href="/AC/AC-2484.json">JSON Source</a></p>