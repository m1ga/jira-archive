---
title: "[AC-2785] Sporadic connection failure with HTTPClient."
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2011-06-25T04:03:54.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>httpclient, iphone, mobile, onerror, xhr</td></tr>
<tr><th>Reporter</th><td>Rob Marston</td></tr>
<tr><th>Assignee</th><td>Tony Guntharp</td></tr>
<tr><th>Created</th><td>2011-06-13T14:04:47.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:47:42.000+0000</td></tr>
</table>

<h3>Description</h3>

The following error is thrown approximately 75% of the time when requesting web service via HTTPClient:

Error Domain=ASIHTTPRequestErrorDomain Code=1 "A connection failure occurred" UserInfo=0x6d14d80 {NSUnderlyingError=0x6d13ca0 "The operation couldn't be completed. (kCFErrorDomainCFNetwork error -1005.)", NSLocalizedDescription=A connection failure occurred}

Cannot resolve.

<h3>Comments</h3>

<ol>
<li>Paul Dowsett 2011-06-13

   In order for us to progress this issue, please edit your ticket to include a proper [Use-case](<a href="http://wiki.appcelerator.org/display/guides/Contributing+to+Titanium#ContributingtoTitanium-CreatingGoodUsecases)." rel="nofollow" target="_blank">http://wiki.appcelerator.org/display/guides/Contributing+to+Titanium#ContributingtoTitanium-CreatingGoodUsecases).</a>
   
   Also, please provide a link to the Q&A question where you have sought help from the community prior to raising this ticket. Kindly read the [Submitting Bug Reports](<a href="http://wiki.appcelerator.org/display/guides/Contributing+to+Titanium#ContributingtoTitanium-SubmittingBugReports)" rel="nofollow" target="_blank">http://wiki.appcelerator.org/display/guides/Contributing+to+Titanium#ContributingtoTitanium-SubmittingBugReports)</a> guide for more info about this.
   
   Thank you</li>
<li>Rob Marston 2011-06-13

   Apologies. The community post can be found at <a href="http://developer.appcelerator.com/question/120964/sporadic-server-error-a-connection-failure-occurred." rel="nofollow" target="_blank">http://developer.appcelerator.com/question/120964/sporadic-server-error-a-connection-failure-occurred.</a> Here's the use case:
   
   var curr_marble = {id:1);
   var list = {id:2025};
   var user = {username:'USERNAME',password:'PASSWORD'};
   var auth = 'Basic '+Titanium.Utils.base64encode(user.username+':'+user.password);  
   var xhr = Titanium.Network.createHTTPClient();
   xhr.setTimeout(0);
   xhr.onerror = function(e) {
   Titanium.API.info(e.error);
   };
   xhr.onload = function() {
   Titanium.API.info(this.responseText);
   };
   xhr.open("POST","<a href="http://api.marblejarapp.com/1/marbles.json" rel="nofollow" target="_blank">http://api.marblejarapp.com/1/marbles.json</a>");
   xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
   xhr.setRequestHeader('Authorization',auth);  
   if (Titanium.Network.online) {
   xhr.send({marbletype:curr_marble.id,list:list.id});
   } else {
   alert("Network unavailable, please try again.");
   };
   
   *My username and password have been obfuscated for security purposes. Happy to send you actual login credentials.
   
   Originally I had though the sound (local mp3) that played before the HTTP request was initiated was causing the error but as it turns out it happens regardless. Additional examples and files available. </li>
<li>Paul Dowsett 2011-06-25

   It seems the user has [found the answer](<a href="http://developer.appcelerator.com/question/120964/sporadic-server-error-a-connection-failure-occurred)" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/120964/sporadic-server-error-a-connection-failure-occurred)</a> but not updated this ticket.  :/
   
   The solution was:
   
   <code><pre>
   xhr = Titanium.Network.createHTTPClient({enableKeepAlive:false});
   </pre></code></li>
<li>Paul Dowsett 2011-08-16

   Closing after 30 days of inactivity.</li>
</ol>


<p><a href="/AC/AC-2785.json">JSON Source</a></p>