---
title: "[AC-2979] Android: CommonJS modules are not cached in latest CI builds"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2012-06-21T11:13:54.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Ivan Skugor</td></tr>
<tr><th>Assignee</th><td>Mauro Parra-Miranda</td></tr>
<tr><th>Created</th><td>2012-06-18T06:25:22.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:47:59.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>The problem</h4>

Latest CI builds do not cache CommonJS modules (or at least it seems they don't in some cases). That cause all kind of strange issue (one will be demonstrated in test case).

This commit causes this behavior: <a href="https://github.com/appcelerator/titanium_mobile/commit/70a9f7984281b8e9ab9c8d73ec3afadc79778b8b" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/70a9f7984281b8e9ab9c8d73ec3afadc79778b8b</a>

(before that commit, everything works fine)


<h4>Test case</h4>

<code><pre>
// app.js
function runTest() {
    var test1 = require('test/test1');
    Ti.API.debug(test1.blabla.test);
}

runTest();
runTest();


// test/test1.js
Ti.API.info('Test 1 require');

var test2 = require('test/test2');

var myModule = {
    blabla: {
        test: test2.test + ' Yes, no?'
    }
};

module.exports = myModule;



// test/test2.js
var test = 'Success!';

var objectToExport = {
   test: test
};

module.exports = objectToExport;
</pre></code>


Output:


06-18 13:21:42.790: I/TiAPI(1925): Test 1 require
06-18 13:21:42.800: D/TiAPI(1925): Success! Yes, no?
06-18 13:21:42.800: I/TiAPI(1925): Test 1 require
06-18 13:21:42.800: D/TiAPI(1925): undefined Yes, no?


<h4>Expected output</h4>

There should be only one "Test 1 require" console line and forth line should be identical to second one.

<h3>Comments</h3>

<ol>
<li>Ivan Skugor 2012-06-18

   Btw, this works fine on iOS.</li>
<li>Ivan Skugor 2012-06-21

   </li>
<li>Nikhil Sharma 2012-06-21

   This ticket is duplicate of TIMOB-9662.</li>
<li>Mauro Parra-Miranda 2013-11-24

   DUP issue. </li>
</ol>


<p><a href="/AC/AC-2979.json">JSON Source</a></p>