---
title: "[AC-3020] Memory leak that is easily reproductible on android with table views and images"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2011-12-29T05:41:10.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>android, image, memory, tableview</td></tr>
<tr><th>Reporter</th><td>Romain</td></tr>
<tr><th>Assignee</th><td>Paul Dowsett</td></tr>
<tr><th>Created</th><td>2011-11-07T09:02:03.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:48:03.000+0000</td></tr>
</table>

<h3>Description</h3>

Hi,

We have a memory leak that is easily reproductible on android with table views and images.

We have reproduced this issue with:
  - Titanium version: 1.7.3, 1.7.5, 1.8.0.v20111106143455
  - Google APIs Android 2.2, Google APIs Android 2.3.3
  - a Samsung Galaxy S (android 2.3.6), a Google Nexus S (android 2.3.6) and an HTC Desire HD (android 2.3.3)


*THE ISSUE:*

When we add an image to a row (with 'leftImage' or with an 'imageView'), and we scroll up and down continuously during 20 seconds, our app slows down and eventually crashes.

As you can see in the logs, the free memory decrease until we have a warning 
   _Clamp target GC heap from 33.070MB to 32.000MB_
and later, the error 
   _11-07 17:14:27.167: ERROR/GraphicsJNI(18626): VM won't let us allocate 103600 bytes_
that will generate the final issues:
  - some images of the table view disappear randomly
  - the table view scrolls slower and slower
  - if you continue the process, the app will crash with a OutOfMemoryError (11-07 17:14:45.781: ERROR/TiAnalyticsSvc(18626): java.lang.OutOfMemoryError).

The image used in the rows for the example code is taken from the web at this url (<a href="http://www.sosandroid.fr/andropress/wp-content/uploads/2009/06/appcelerator-titanium1.png)" rel="nofollow" target="_blank">http://www.sosandroid.fr/andropress/wp-content/uploads/2009/06/appcelerator-titanium1.png)</a>, its size is "175 Ã— 148, 14KB". When we check the headers of the request used to retrieve the url, we can see that it has cache directives (Cache-Control:max-age=604800), so we can suppose that it is cached by android.


*ADDITIONAL INFORMATION:*
  - this issue only happens on android
  - this issue only happens if we scroll the table view: A little scrollable table view will crash later, but will crash. A table view which doesn't scroll won't crash
  - if you use bigger images, the app will crash much sooner (this is how we identified the issue)


*FILES ATTACHED:*
  - app.js: code example
  - logs.rtf: logs of the crash

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-3020_24070/app.js">app.js</td></td><td>2011-11-07T09:02:03.000+0000</td><td>451</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-3020_24071/logs.rtf">logs.rtf</td></td><td>2011-11-07T09:02:03.000+0000</td><td>21834</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Romain 2011-11-08

   As precised in this [Q&A](<a href="http://developer.appcelerator.com/question/127884/memory-leak-that-is-easily-reproductible-on-android-with-table-views-and-images#222768)" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/127884/memory-leak-that-is-easily-reproductible-on-android-with-table-views-and-images#222768)</a>, a workaround of this issue is to precise a *className* for the row.
   
   I can't explain why, but it works.
   
   Nevertheless, maybe you should spend time on this big issue (we have lost so much time on it, and I don't think that it is normal to have to make a workaround like this :/)
   
   Thanks in advance,
   
   Romain</li>
<li>Paul Dowsett 2011-12-29

   Romain
   
   It is necessary to set a unique [Titanium.UI.TableViewRow](<a href="http://developer.appcelerator.com/apidoc/mobile/latest/Titanium.UI.TableViewRow-object#properties)" rel="nofollow" target="_blank">http://developer.appcelerator.com/apidoc/mobile/latest/Titanium.UI.TableViewRow-object#properties)</a> className property on each set of rows that has a different layout.
   
   As this seems to have been omitted from the latest set of guides, I have raised TIMOB-6921 to address it.
   
   Cheers</li>
<li>Shak Hossain 2013-12-28

   </li>
</ol>


<p><a href="/AC/AC-3020.json">JSON Source</a></p>