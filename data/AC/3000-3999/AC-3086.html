---
title: "[AC-3086] Cannot use JNI for a native Android Module"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2012-07-17T09:07:35.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Appcelerator Modules, Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>android, jni, module, ndk</td></tr>
<tr><th>Reporter</th><td>Francois Stephany</td></tr>
<tr><th>Assignee</th><td>Mauro Parra-Miranda</td></tr>
<tr><th>Created</th><td>2012-06-20T08:44:21.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:48:08.000+0000</td></tr>
</table>

<h3>Description</h3>

How to reproduce:

- Create a Titanium Module Project in Titanium Studio:
* project name: headphones
* module id: be.tulipemoutarde.headphones
* deployment target: 'Android' / SDK: 2.0.2GA

- Edit the build.properties file to match your setup.
- Create a JNI folder and create an Android.mk, a headphones.c file.
- Edit the HeadphonesModule.java to load the native library and create a method that will call a C function.
- Edit the app.js to call the java method.
- plug an android phone (or if you are brave enough, launch an emulator)
- Get a logcat (e.g., with DDMS)
- run the app on your phone with 'ant install'


You will see "java.lang.unsatisfiedLinkError: Couldn't load headphones: findLibrary returned null"
and "Exception Ljava/lang/UnsatisfiedLinkError; thrown while initializing Lbe/tulipemoutarde/headphones/HeadphonesModule;"

I don't have any errors in the output when it compiles. I guess there's a problem somewhere in the build process (does the libheadphones.so copied in the right directory?), but my knowledge of Ant and the java tools is too limited :/

You can have a look/clone the project. Don't forget to adapt the paths in build.properties ;)

<a href="https://github.com/fstephany/Titanium-JNI-demo" rel="nofollow" target="_blank">https://github.com/fstephany/Titanium-JNI-demo</a>

<h3>Comments</h3>

<ol>
<li>Francois Stephany 2012-07-10

   I've managed to make it work. The process is a bit long but I guess it could be automated in the build.xml?
   
   Here's how to proceed:
   
   * ant clean
   * ndk-build
   * create the directory libs/armeabi-v7a and copy libs/armeabi/libheadphones.so into it.
   * ant dist
   * titanium install
   
   The step where I copy the libheadpones.so in the armeabi-v7a is a bit weird but it works with my Samsung Galaxy S2.
   
   Is there an easiest way to make this work or should I write a script to perform all those operations? </li>
</ol>


<p><a href="/AC/AC-3086.json">JSON Source</a></p>