---
title: "[AC-3296] Enable --multi-dex for android builds"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2014-11-22T00:01:14.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Appcelerator CLI</td></tr>
<tr><th>Labels</th><td>android</td></tr>
<tr><th>Reporter</th><td>Stephen Feather</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2014-11-21T21:11:47.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-08T07:57:43.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
Titanium tooling will not build a project that has more than 65536 total method calls

Currently android has a limit  on the number of methods permitted (65536)
As an example, the latest google-play-services.jar from 3.4.1 has 23600.
For basic S3 support from aws 2.0, a module uses 26800.

By the time you build an empty titanium app you are left with:
<code><pre>
[ERROR] trouble writing output: Too many method references: 68927; max is 65536.
</pre></code>

<h4>Solution</h4>

The solution is to use the --multi-dex option in calling dexer.
The problem will be that --multi-dex cant just be dropped in as it requires a different output. A decision will need to be made on how to modify this.buildBinClassesDex.

Example 
<code><pre>
dexArgs = [
			'-Xmx' + this.dxMaxMemory,
			'-XX:-UseGCOverheadLimit',
			'-Djava.ext.dirs=' + this.androidInfo.sdk.platformTools.path,
			'-jar', this.androidInfo.sdk.dx,
			'--dex', '--multi-dex',
			'--output=' + this.buildBinClassesDex,
			this.buildBinClassesDir,
			path.join(this.platformPath, 'lib', 'titanium-verify.jar')
</pre></code>

<h3>Comments</h3>

<ol>
<li>Chris Barber 2014-11-22

   This ticket was magically created by error. Thanks Jira.</li>
</ol>


<p><a href="/AC/AC-3296.json">JSON Source</a></p>