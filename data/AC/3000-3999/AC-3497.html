---
title: "[AC-3497] Provide ips of api and upload nodes for smtp whitelisting"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Hold</td></tr>
<tr><th>Resolution Date</th><td>2016-05-04T18:35:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Seth Toda</td></tr>
<tr><th>Assignee</th><td>Seth Toda</td></tr>
<tr><th>Created</th><td>2016-04-12T19:09:49.000+0000</td></tr>
<tr><th>Updated</th><td>2016-05-04T18:35:49.000+0000</td></tr>
</table>

<h3>Description</h3>

When I set up email settings in my ArrowDB instance, the google SMTP server works just fine (no errors). However, using my own SMTP server is causing issues - when I save settings, I get the error "The SMTP settings are not valid." which is not at all descriptive. Our SMTP server doesn't even show any logs suggesting the Appcelerator server is trying to connect, so there is absolutely no way to figure out what is wrong.

Please advise what to do in that case. Can the ArrowDB be fixed to provide a more descriptive error when it is "testing" SMTP settings during "Save Changes"?

<h3>Comments</h3>

<ol>
<li>Seth Toda 2016-04-12

   [~parijatsahai], this is a copy of the case, it was moved internally for work. 
   
   The IP addresses aren't static and are subject to change every time we update the cloud infrastructure. Though we are working on a permanent solution to this. 
   
   I suggest testing that a firewall is the issue. Here are some steps for testing your smtp server remotely:
   
   *auth setup*
   <code><pre>
   echo -n "\000emailaddress@email.com\000password" | openssl base64 //resultingPassword
   </pre></code>
   
   *Send the email*
   <code><pre>
   openssl s_client -connect &lt;SMPT SEVER ADDRESS&gt;:PORT
   AUTH PLAIN resultingPassword
   235 2.0.0 OK
   mail from: &lt;emailaddress@email.com&gt;
   250 2.1.0 Ok
   rcpt to: &lt;emailaddress@email.com&gt;
   250 2.1.5 Ok
   data
   354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
   From: Me &lt;emailaddress@email.com&gt;
   To: Me &lt;emailaddress@email.com&gt;
   Subject: Testing this
    
   It is a test!
   .
   250 2.0.0 Ok: queued as 65896680117
   quit
   221 2.0.0 Bye
   closed
   // Mail gets received successfully
   </pre></code></li>
<li>Parijat sahai 2016-04-12

   Please send us the IP addresses anyway for now to test with. We definitely have a firewall that prevents ANY outside connection unless it is whitelisted IP address.  So, if the IP addresses for Appcelerator change, that is certainly not a good thing and should be addressed sooner rather than later. But for the short term, I need the IP addresses. And whenever they change again, I'd like Appcelerator to resend the new IP addresses or provide me with instructions to retrieve them on my own.
   
   How do other customers of Appcelerator handle the SMTP server issue - I'd assume most if not all of them would have firewalls.</li>
<li>Seth Toda 2016-04-12

   
   52.37.208.23  52.38.180.221 52.33.16.197
   </li>
<li>Parijat sahai 2016-04-13

   We whitelisted the ip addresses and ran the test as you suggested as well, but although below test was successful, the SMTP settings on Appcelerator platform continue to give us the same error message as before. Hence, the issue is elsewhere.
   
   root@server:~# openssl s_client -starttls smtp -connect mail.rekonnex.com:587 -quiet -CApath /usr/lib/ssl
   depth=2 C = IL, O = StartCom Ltd., OU = Secure Digital Certificate Signing, CN = StartCom Certification Authority
   verify return:1
   depth=1 C = IL, O = StartCom Ltd., OU = StartCom Certification Authority, CN = StartCom Class 1 DV Server CA
   verify return:1
   depth=0 CN = rekonnex.com
   verify return:1
   250 DSN
   AUTH PLAIN
   334 
   <BASE64-ENCODED USER AND PW>
   235 2.7.0 Authentication successful
   mail from:help@rekonnex.com
   rcpt to:admin@rekonnex.com
   data
   from:help@rekonnex.com
   to:admin@rekonnex.com
   subject: Email Test from Help Account for Appcelerator
   This is a test email
   .
   250 2.1.0 Ok
   250 2.1.5 Ok
   354 End data with <CR><LF>.<CR><LF>
   250 2.0.0 Ok: queued as 3E9A3129594</li>
<li>Parijat sahai 2016-04-13

   As per our tech person, he suspects the following:
   
   "they do not have our root CA in their list of trusted certs"
   
   We use StartComâ€™s root cert. Can you please check if that is a possible issue?  
   </li>
<li>Seth Toda 2016-04-13

   [~parijatsahai], I would suggest trying the different login methods, "plain", "login", etc</li>
<li>Parijat sahai 2016-04-13

   Please elaborate.</li>
</ol>


<p><a href="/AC/AC-3497.json">JSON Source</a></p>