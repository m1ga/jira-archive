---
title: "[AC-4394] Hyperloop iOS - Converted blocks are always returning nil"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2016-08-26T14:59:27.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Appcelerator Studio 4.5.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Hyperloop, Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>blocks, callback, hyperloop</td></tr>
<tr><th>Reporter</th><td>Rodolfo Perottoni</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2016-08-26T01:40:03.000+0000</td></tr>
<tr><th>Updated</th><td>2016-08-26T14:59:27.000+0000</td></tr>
</table>

<h3>Description</h3>

Trying to use the Firebase SDK here.
One of the methods that i'm invoking accepts a callback block. That block is supposed to receive a few parameters.
If i build my project and try to invoke that method, my callback function never receives any parameters back from "native side".

*Why is it happening:*
Seems like HyperLoop is invoking the callback blocks with *nil*, as you can see below. This applies for all the block conversion methods in the generated *.m* files (inside */build/hyperloop/.../.../*)

<code><pre>
+ (id) Block_void_____FIRUser____NSError___:(KrollCallback *) callback {
    return [^(FIRUser * arg0, NSError * arg1) {
        void(^Callback)(void) = ^{
            NSArray *args = nil;
            id _arg0 = (arg0 == nil || [(id)arg0 isEqual:[NSNull null]]) ? (id)[NSNull null] : (id)[HyperloopPointer pointer:(__bridge void *)arg0 encoding:@encode(id)];
            id _arg1 = (arg1 == nil || [(id)arg1 isEqual:[NSNull null]]) ? (id)[NSNull null] : (id)[HyperloopPointer pointer:(__bridge void *)arg1 encoding:@encode(id)];
            args = @[_arg0, _arg1];
            [HyperloopUtils invokeCallback:callback args:nil thisObject:callback];
        };
        if ([NSThread isMainThread]) {
            Callback();
        } else {
            dispatch_async(dispatch_get_main_queue(), Callback);
        }
    } copy];
}
</pre></code>

This line:

<code><pre>
[HyperloopUtils invokeCallback:callback args:nil thisObject:callback];
</pre></code>

is supposed to be like this:

<code><pre>
[HyperloopUtils invokeCallback:callback args:args thisObject:callback];
</pre></code>

Like i said... this applies for every single block conversion methods in generated *.m* files. There is proof of this in the UIKit.m generated when you build the HyperLoop Examples project.





<h3>Comments</h3>

<ol>
<li>Francisco Ruaro Varisco 2016-08-26

   Just as a proof, on our Firebase module the usual return of the callback function (createUserWithEmail) is:
   
   [INFO]  User = null
   [INFO]  error = null
   
   
   While the return after changing the '.m' file generated is:
   
   [INFO]  User = null
   [INFO]  error = Error Domain=FIRAuthErrorDomain Code=17007 "The email address is already in use by another account." UserInfo={NSLocalizedDescription=The email address is already in use by another account., error_name=ERROR_EMAIL_ALREADY_IN_USE}
   </li>
<li>Hans Kn√∂chel 2016-08-26

   </li>
</ol>


<p><a href="/AC/AC-4394.json">JSON Source</a></p>