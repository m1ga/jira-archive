---
title: "[AC-4818] Android manifest in tiapp.xml does not transfer completely to AndroidManifest.xml AND using a custom manifest does not work"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2017-02-23T14:27:45.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>android, manifest, titanium</td></tr>
<tr><th>Reporter</th><td>Michael Kazmier</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2017-02-22T17:59:45.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-02T12:21:29.000+0000</td></tr>
</table>

<h3>Description</h3>

We have added both intent filters and a second activity to the tiapp.xml but it does not fully transfer to the AndroidManifest.xml.  As a work around, we followed the instructions here: 

<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/guide/Maintaining_a_Custom_AndroidManifest.xml

But first we received this error:
{{[ERROR] Detected legacy "/platform" directory in project directory.
[ERROR] Please move the "/platform" directory to "/app/platform" for Alloy 1.8.0 or later.
[ERROR] Alloy compiler failed}}

So we moved the custom AndroidManifest.xml to /app/platform/android/AndroidManifest.xml and we STILL could not get the custom manifest.

There is an example application here: <a href="https://github.com/DaKaZ/multiactive" rel="nofollow" target="_blank">https://github.com/DaKaZ/multiactive</a>   You can see the first activity in the tiapp.xml does not transfer.  You can also see that if you create the custom manifest the auto generated manifest is used, not the custom.

<h3>Comments</h3>

<ol>
<li>Michael Kazmier 2017-02-22

   We found an interesting work around for the first issue - the translation of the tiapp.xml into the AndroidManifest.xml.  If you put the second Activity at the same level of the <manifest> in tiapp.xml it works as desired.  So, for the first bug perhaps all that is needed is a documentation update to explain to a user how to do this?</li>
<li>Sharif AbuDarda 2017-02-23

   This should be the ideal case. You should put all your activity under single manifest section in tiapp.xml. Thanks.</li>
<li>Sharif AbuDarda 2017-02-23

   As documented "Most elements inside the <manifest> will be added as children to the <manifest> element inside of AndroidManifest.xml at build time" in <a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/guide/Maintaining_a_Custom_AndroidManifest.xml</li>
<li>Michael Kazmier 2017-02-23

   There are two problems with the documentation:
   
   1.  Declaring a second activity does not work as described
   2.  The completely custom AndroidManifest.xml does not work
   
   To recreate issue #1, try to use this android section:
   
   <android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>">
   		<manifest xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>" package="com.kaztopia.multiactive" android:versionCode="1" android:versionName="1.0">
   			<uses-sdk android:minSdkVersion="14" android:targetSdkVersion="23"/>
   			<application android:icon="@drawable/appicon" android:label="multiactive" android:name="MultiactiveApplication" android:debuggable="false" android:theme="@style/Theme.AppCompat">
   				<activity android:name=".MultiactiveActivity" android:label="@string/app_name" android:theme="@style/Theme.Titanium" android:configChanges="keyboardHidden|orientation|screenSize" android:exported="true">
   					<intent-filter>
   						<action android:name="android.intent.action.MAIN"/>
   						<category android:name="android.intent.category.LAUNCHER"/>
   					</intent-filter>
   					<intent-filter>
   						<action android:name="android.intent.action.VIEW"/>
   						<category android:name="android.intent.category.DEFAULT"/>
   						<category android:name="android.intent.category.BROWSABLE"/>
   						<data android:scheme="multiactive" />
   					</intent-filter>
   				</activity>
   			<activity url="SecondActivity.js" android:exported="true">
   				<intent-filter>
   					<action android:name="android.intent.action.VIEW"/>
   					<category android:name="android.intent.category.EMBED"/>
   				</intent-filter>
   			</activity>
   				<activity android:name="org.appcelerator.titanium.TiActivity" android:configChanges="keyboardHidden|orientation|screenSize"/>
   				<activity android:name="org.appcelerator.titanium.TiTranslucentActivity" android:configChanges="keyboardHidden|orientation|screenSize" android:theme="@style/Theme.AppCompat.Translucent"/>
   				<activity android:name="ti.modules.titanium.ui.android.TiPreferencesActivity" android:configChanges="screenSize"/>
   				<service android:name="com.appcelerator.aps.APSAnalyticsService" android:exported="false"/>
   			</application>
   			<uses-permission android:name="android.permission.INTERNET"/>
   			<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
   			<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
   			<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
   		</manifest>
   	</android>
   
   
   The above does not work, just check the compiled AndroidManifest.xml for the SecondActivity.  Now try this one:
   
   	<android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>">
   		<manifest xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>" package="com.kaztopia.multiactive" android:versionCode="1" android:versionName="1.0">
   			<uses-sdk android:minSdkVersion="14" android:targetSdkVersion="23"/>
   			<application android:icon="@drawable/appicon" android:label="multiactive" android:name="MultiactiveApplication" android:debuggable="false" android:theme="@style/Theme.AppCompat">
   				<activity android:name=".MultiactiveActivity" android:label="@string/app_name" android:theme="@style/Theme.Titanium" android:configChanges="keyboardHidden|orientation|screenSize" android:exported="true">
   					<intent-filter>
   						<action android:name="android.intent.action.MAIN"/>
   						<category android:name="android.intent.category.LAUNCHER"/>
   					</intent-filter>
   					<intent-filter>
   						<action android:name="android.intent.action.VIEW"/>
   						<category android:name="android.intent.category.DEFAULT"/>
   						<category android:name="android.intent.category.BROWSABLE"/>
   						<data android:scheme="multiactive" />
   					</intent-filter>
   				</activity>
   				<activity android:name="org.appcelerator.titanium.TiActivity" android:configChanges="keyboardHidden|orientation|screenSize"/>
   				<activity android:name="org.appcelerator.titanium.TiTranslucentActivity" android:configChanges="keyboardHidden|orientation|screenSize" android:theme="@style/Theme.AppCompat.Translucent"/>
   				<activity android:name="ti.modules.titanium.ui.android.TiPreferencesActivity" android:configChanges="screenSize"/>
   				<service android:name="com.appcelerator.aps.APSAnalyticsService" android:exported="false"/>
   			</application>
   			<uses-permission android:name="android.permission.INTERNET"/>
   			<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
   			<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
   			<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
   		</manifest>
   		<activities>
   			<activity url="SecondActivity.js" android:exported="true">
   				<intent-filter>
   					<action android:name="android.intent.action.VIEW"/>
   					<category android:name="android.intent.category.EMBED"/>
   				</intent-filter>
   			</activity>
   		</activities>
   	</android>
   </li>
<li>Dirlei Dion√≠sio 2017-03-02

   I'm also having the second problem with SDK 6.0.1 in an Alloy Project, but I found a workaround: put the same custom AndroidManifest.xml in both directories: app/platform/android AND platform/android.
   
   The build process will use platform/android/AndroidManifest.xml and after that, will rewrite the entire folder by app/platform/android.
   
   I know, it's a weird workaround, but it works.
   
   I endorse the claim to have custom android manifest working without workarounds.</li>
</ol>


<p><a href="/AC/AC-4818.json">JSON Source</a></p>