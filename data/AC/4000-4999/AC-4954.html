---
title: "[AC-4954] 'postlayout' event not fired when property \"run-on-main-thread\" is set to true"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2017-05-10T12:20:20.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Alloy, Hyperloop, Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>ios</td></tr>
<tr><th>Reporter</th><td>Fabian Martinez</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2017-05-09T20:14:45.000+0000</td></tr>
<tr><th>Updated</th><td>2017-05-10T12:20:20.000+0000</td></tr>
</table>

<h3>Description</h3>

If I set 
<code><pre>
&lt;property name="run-on-main-thread" type="bool"&gt;true&lt;/property&gt;
</pre></code>
 in tiapp.xml then the 'postlayout' event of any view is not fired.

An alloy test case may be index.js:
<code><pre>
$.win.addEventListener('open', function(e){
    console.log(e);
});
$.viewContent.addEventListener('postlayout', function(e){
    console.log('viewContent');
    console.log(e);
});
$.label.addEventListener('postlayout', function(e){
    console.log('label');
    console.log(e);
});
$.win.addEventListener('postlayout', function(e){
    console.log(e);
});
$.win.open();
</pre></code>

index.xml:
<code><pre>
&lt;Alloy&gt;
    &lt;Window id="win" backgroundColor="#FFF"&gt;
        &lt;View id="viewContent"&gt;
            &lt;Label id="label"&gt;Hello, World&lt;/Label&gt;
        &lt;/View&gt;
    &lt;/Window&gt;
&lt;/Alloy&gt;
</pre></code>

Expected result when preperty set to TRUE: view all the events log in the console.
What's happening: only the "open" event is fired.
If I set the property to FALSE, then all the events are logged.

This happens with 6.0.4.GA and 6.0.2.GA. I have tested this with sdk 6.1.0.v20170508081747 and works as expected (all events are fired).

<h3>Comments</h3>

<ol>
<li>Fabian Martinez 2017-05-09

   The same happens with classic app (non Alloy), Hyperloop enabled, 6.0.4.GA, iOS (iphone7 10.3 emulator).
   If I create a new project and app.js is: 
   
   <code><pre>
   var win = Ti.UI.createWindow({title: 'title', backgroundColor: '#fff' });
   var label = Ti.UI.createLabel({ text: 'message', color: "#333"});
   win.add(label);
   win.addEventListener('open', function(e){
      console.log(e);
   });
   win.addEventListener('postlayout', function(e){
      console.log(e);
   });
   win.open();
   </pre></code>
   
   then the console log is:
   <code><pre>
   [INFO] :   TestProject2/1.0 (6.0.4.74f7d21)
   [TRACE] :  [HYPERLOOP] willStartNewContext &lt;KrollContext: 0x608000269900&gt;
   [INFO] :   {
   [INFO] :       bubbles = 0;
   [INFO] :       cancelBubble = 0;
   [INFO] :       source = "[object TiUIWindow]";
   [INFO] :       type = open;
   [INFO] :   }
   [TRACE] :  [HYPERLOOP] didStartNewContext &lt;KrollContext: 0x608000269900&gt;
   [TRACE] :  Uploaded tiapp metadata with Appcelerator Platform!
   </pre></code>
   
   if I switch to 6.1.0.v20170508081747 and recompile, the console log is:
   <code><pre>
   [INFO] :   TestProject2/1.0 (6.1.0.77cc59d)
   [TRACE] :  [HYPERLOOP] willStartNewContext &lt;KrollContext: 0x608000073040&gt;
   [INFO] :   {
   [INFO] :       bubbles = 0;
   [INFO] :       cancelBubble = 0;
   [INFO] :       source = "[object TiUIWindow]";
   [INFO] :       type = open;
   [INFO] :   }
   [DEBUG] :  Application booted in 191.500962 ms
   [TRACE] :  [HYPERLOOP] didStartNewContext &lt;KrollContext: 0x608000073040&gt;
   [INFO] :   {
   [INFO] :       bubbles = 0;
   [INFO] :       cancelBubble = 0;
   [INFO] :       source = "[object TiUIWindow]";
   [INFO] :       type = postlayout;
   [INFO] :   }
   [TRACE] :  updating tiapp metadata with Appcelerator Platform...
   [TRACE] :  Uploaded tiapp metadata with Appcelerator Platform!
   </pre></code>
   </li>
<li>Hans Knöchel 2017-05-10

   Hey there, I remember we fixed this for 6.1.0, but 6.0.x was already out of the house. Release 6.1.0 is expected to be released around end of this month, you can already use the latest build from [here](<a href="http://builds.appcelerator.com/#6_1_X)" rel="nofollow" target="_blank">http://builds.appcelerator.com/#6_1_X)</a>, I hope that helps!</li>
<li>Fabian Martinez 2017-05-10

   Thank you for your response.
   Is there a release notes draft available to check what the build fixes?
   </li>
<li>Hans Knöchel 2017-05-10

   </li>
</ol>


<p><a href="/AC/AC-4954.json">JSON Source</a></p>