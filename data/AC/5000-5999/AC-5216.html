---
title: "[AC-5216] Ti.Android.requestPermissions callback not firing when first requesting permissions"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Needs more info</td></tr>
<tr><th>Resolution Date</th><td>2017-10-25T22:50:00.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>eric harms</td></tr>
<tr><th>Assignee</th><td>Yordan Banev</td></tr>
<tr><th>Created</th><td>2017-09-20T22:00:38.000+0000</td></tr>
<tr><th>Updated</th><td>2018-07-18T07:34:55.000+0000</td></tr>
</table>

<h3>Description</h3>

Hi,

Having a strange issue requesting permissions with Android.  Running the following code on first run will not show the SUCCESS log, the callback does not fire.  But once the permissions are set and the app is closed and re-opened, the code runs as expected.

<code><pre>
var permissions = ['android.permission.CAMERA', 'android.permission.READ_EXTERNAL_STORAGE'];
Ti.Android.requestPermissions(permissions, function(e) {
    if (e.success) {
        Ti.API.info("SUCCESS");
    } else {
        Ti.API.info("ERROR: " + e.error);
    }
});
</pre></code>

This is right out of the documentation here

<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Android

Please advise if I am doing something wrong here.

Thanks


<h3>Comments</h3>

<ol>
<li>Yordan Banev 2017-09-21

   Make sure you have:
   <code><pre>
   &lt;android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;
       &lt;manifest&gt;
           &lt;uses-permission android:name="android.permission.CAMERA" /&gt;
           &lt;uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /&gt;	
       &lt;/manifest&gt;
   &lt;/android&gt;
   </pre></code>
   in your tiapp.xml file. I was not able to reproduce the issue on any version from 6.0.1.GA to 6.2.0.GA on Android 7 device, having these lines added.</li>
<li>Sharif AbuDarda 2017-10-22

   Hello [~eric.harms@gmail.com], did you tried [~ybanev], guide?</li>
<li>Jordan Silva 2018-07-17

   Hi @Sharif AbuDarda and @Yordan Banev, 
   I'm facing a similar problem. 
   
   When I'm trying to requestCalendarPermissions and the user on Android haven't given the permission, the callback is not being fired.
   
   Steps:
   a. The user doesn't have allowed the access to the calendar for the app. (i.e., calendar permission);
   b. The Calendar Permission is requested through the Ti.Calendar.requestCalendarPermission(callback);
   c. The user accepts or denies the permission.
   d. The event callback is not fired to inform if the user has accepted or not. :(
   
   </li>
<li>Jordan Silva 2018-07-18

   Please ignore my previous comment. 
   I found the bug, was something related to the showing a window (like a dialog) before requesting the permissions, so the request dialog was not being fired.</li>
</ol>


<p><a href="/AC/AC-5216.json">JSON Source</a></p>