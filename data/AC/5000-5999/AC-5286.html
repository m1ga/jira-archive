---
title: "[AC-5286] App crashes when executing evalJS in a webview to change its contents (Ti SDK 6 and Android 4.1.1 only)"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Done</td></tr>
<tr><th>Resolution Date</th><td>2017-12-18T21:12:50.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>David Benko</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2017-10-16T19:57:15.000+0000</td></tr>
<tr><th>Updated</th><td>2017-12-18T21:12:50.000+0000</td></tr>
</table>

<h3>Description</h3>

I have a webview that I use evalJS to call a function inside it that changes the content of its html. The app will crash when the javascript inside the webview try to add a paragraph to the html for example.

This bug is only happening on Android 4.1.1. I tried the following SDKs: 6.1.2, 6.2.2 and SDK 6.3.0.v20171016053946 and the bug is happening in all of them.

The line that causes the app to crash is the following line inside the webview:
<code><pre>
div.appendChild(paragraph);
</pre></code>

Another way to change the content would simply be:
<code><pre>
div.innerHTML = '&lt;p&gt;' + text + '&lt;/p&gt;'
</pre></code>
But this causes crash too.

I also tried to replace evalJS usage with Ti.App.fireEvent and calling SetTextContent inside Ti.App.addEventListener on the webview but the bug still happens.

Code to reproduce:

<code><pre>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id="content"&gt;&lt;/div&gt;
	&lt;script&gt;
		function SetTextContent(text) {
			var div = document.getElementById("content");
			var paragraph = document.createElement('p');
			var textNode = document.createTextNode(text);
			paragraph.appendChild(textNode);
			if (div.hasChildNodes()) {
				div.removeChild(div.childNodes[0]);
			}
			div.appendChild(paragraph); // This line causes the app to crash. If you comment this line everything works fine.
		}
	&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></code>

<code><pre>
var window = Ti.UI.createWindow();
var webView = Ti.UI.createWebView({
	url: '/test.html'
});
window.add(webView);

window.open();

setInterval(function() {
	webView.evalJS('SetTextContent(\'testing' + Math.random() + '\')');
}, 3000);
</pre></code>

<h3>Comments</h3>

<ol>
<li>David Benko 2017-10-18

   Can anyone verify this issue please?</li>
<li>Sharif AbuDarda 2017-11-12

   Hello, Is this only happening on Android 4.1.1? I tried on a different version. wasn't able to reproduce. Can you try on the latest SDK 6.3.0.GA? Thanks.</li>
<li>Mostafizur Rahman 2017-11-20

   Hello [~davidbenko], I just wanted to follow up here. Did you manage to follow the instructions provided earlier? Let us know if you still experience any issue. We would be happy to assist you.
   Best Regards!</li>
<li>David Benko 2017-11-20

   Hello, the test case I provided is now indeed working in SDK 6.3.0. However, the webview is still crashing the app with other use cases. I'll try to provide a new code to reproduce.</li>
<li>Mostafizur Rahman 2017-11-21

   [~davidbenko] Thanks for your feedback. We will be waiting for your new test code.
   
   
   Best</li>
<li>Mostafizur Rahman 2017-11-30

   Hello [~davidbenko], 
   Just passing a followup here.Are you able to get that sorted out?  Please let us know if you need more help with this issue.
   Regards 
   Axway Appcelerator Support</li>
<li>Mostafizur Rahman 2017-12-04

   
   Hello [~davidbenko], Are you still having the issue?Please let us know if you need more help with this issue.
   Regards 
   Axway Appcelerator Support
   
   </li>
<li>David Benko 2017-12-04

   Hello, thanks for getting back to me. I'm working on provide an example to reproduce the issue. My app is large and does a buch of interactions with the webview, so I'm trying reducing the problem to a reproducible test case</li>
<li>Mostafizur Rahman 2017-12-05

   [~davidbenko],Ok. Thanks for your update. We appreciate it. We will be waiting for your reproducible test case.
   
   Best</li>
<li>Mostafizur Rahman 2017-12-17

    Hello [~davidbenko], Did you manage to generate the reproducible test case?</li>
<li>David Benko 2017-12-18

    Hello Mostafizur, I'm having a hard time trying to reduce to a small test case because the app is large. Anyways we already solved the issue by changing some things in our app so the bug is not happening anymore. You can close the issue</li>
</ol>


<p><a href="/AC/AC-5286.json">JSON Source</a></p>