---
title: "[AC-5434] Android module auto upgrade of manifest causes module to fail loading and app to crash"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2017-12-10T21:09:44.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Appcelerator CLI</td></tr>
<tr><th>Labels</th><td>defect</td></tr>
<tr><th>Reporter</th><td>Ophir Oren</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2017-12-10T20:08:59.000+0000</td></tr>
<tr><th>Updated</th><td>2017-12-11T07:46:34.000+0000</td></tr>
</table>

<h3>Description</h3>

When running <code>appc run -p android --build-only -l trace</code> to compile an Android module written for versions earlier than SDK 7.0.0.GA, the CLI offers to upgrade the module. When choosing "yes" to upgrade the module the CLI updates the android module manifest file.

The CLI updates the manifest and setting <code>minsdk: 7.0.0</code>. While compilation completes successfully, when the module is put in to an app it is causing the app to crash on load with an error message that the <code>so</code> file of the module cannot be found:

<code>couldn't find "libti.ga.so"; Titanium 7.0.0,2017/12/05 13:30,undefined</code>

This is because the <code>minsdk</code> is set to an incorrect version, and should be <code>minsdk: 7.0.0.GA</code>.
When manually changing the version, cleaning build and libs folder and recompiling the error message goes away.

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-12-10

   The libs/ directory and build/ directory cleanup was a general issue that could happen to builds when changing api-levels. TIMOB-25592 already takes care of this :).</li>
<li>Ophir Oren 2017-12-11

   @Hans - This is not the same bug.
   TIMOB-25592 is about the build directory while this one is about the minsdk version that is being wrotten by the CLI upgrade.</li>
<li>Ophir Oren 2017-12-11

   Please re-open</li>
<li>Hans Knöchel 2017-12-11

   Thanks for updating the initial description, but this is not an issue. Many other working modules, even core-modules like [Ti.Map](<a href="https://github.com/appcelerator-modules/ti.map/blob/master/android/manifest#L19)" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.map/blob/master/android/manifest#L19)</a> use "7.0.0" and the app handles it fine. The error about the "so" files are because the libs directory does not get cleaned properly without flushing the directory before.
   
   In detail, this is handled by [this 10 lines](<a href="https://github.com/appcelerator/titanium_mobile/pull/9671/files#diff-e409a7861efa1e711ec49a7ff79beee7R415)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9671/files#diff-e409a7861efa1e711ec49a7ff79beee7R415)</a> that delete the directory, recreate it and pre-create the directories needed.</li>
</ol>


<p><a href="/AC/AC-5434.json">JSON Source</a></p>