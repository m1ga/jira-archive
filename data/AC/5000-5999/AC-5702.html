---
title: "[AC-5702] Hyperloop + iOS + Intercom Issue"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2018-04-12T20:58:48.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Hyperloop</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Borja Gomez</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2018-04-12T18:51:02.000+0000</td></tr>
<tr><th>Updated</th><td>2018-04-12T20:58:49.000+0000</td></tr>
</table>

<h3>Description</h3>

I have integrated Intercom iOS SDK (<a href="https://github.com/intercom/intercom-ios)" rel="nofollow" target="_blank">https://github.com/intercom/intercom-ios)</a> using Hyperloop. I have found one issue and it looks like it's Hyperloop fault: Linking Intercom User to a Company. 

In order to do that I need to create an object ICMCompany with two attributes (companyId and name) and then an attribute ICMUserAttributes that includes an attribute companies with an array of one object ICMCompany.

Here you have the code:

      var Intercom = require('Intercom/Intercom');
      var ICMCompany = require("Intercom/ICMCompany");
      var ICMUserAttributes = require("Intercom/ICMUserAttributes");
            
      Intercom.logout();
      Intercom.registerUserWithEmail(userInfo.email);

      var company = new ICMCompany();
      company.name = orgName;
      company.companyId = orgId;

      var userAttributes = new ICMUserAttributes();
      userAttributes.userId = userId;
      userAttributes.name = name;
      userAttributes.customAttributes = {
        "language_override": language,
        "dashboard_url": url
        "is_coach": coach
      }

      var companies =  NSArray.arrayWithObject(company);
      console.log("companies.count " + companies.count);

      userAttributes.companies = companies;
      console.log("userAttributes.companies count " + userAttributes.companies.count);

      Intercom.updateUser(userAttributes);

And the output is 

[INFO]  companies.count 1
[INFO]  userAttributes.companies count 0

It looks like companies are not stored properly in the userAttributes Object. And the final result is that the user gets all the attributes except the companies.

Here you have also the documentation on Intercom: <a href="https://developers.intercom.com/docs/ios-configuration" rel="nofollow" target="_blank">https://developers.intercom.com/docs/ios-configuration</a>



<h3>Comments</h3>

<ol>
<li>Hans Kn√∂chel 2018-04-12

   If the native call goes through, it cannot be a Hyperloop issue. Otherwise you would have received an error log indicating the issue during build / metabase generation. A hint: Try to use the property setters (e.g. <code>setName(name)</code>) to see if it makes a difference or compare it with the native samples. Resolving for now.</li>
</ol>


<p><a href="/AC/AC-5702.json">JSON Source</a></p>