---
title: "[AC-6137] App rejected for using Apple Music API"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Done</td></tr>
<tr><th>Resolution Date</th><td>2019-03-21T19:06:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>David Benko</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2019-02-13T19:05:30.000+0000</td></tr>
<tr><th>Updated</th><td>2019-03-21T19:07:24.000+0000</td></tr>
</table>

<h3>Description</h3>

We are having this issue that the app got rejected from Apple:
Your app uses the Apple Music API but does not display or appropriately use standard media controls, such as "play," "pause," and "skip." If you do not use Apple Music, please remove the API from your binary

I'm using SDK 7.4.0 and found two issues that suggested this was fixed in previous versions: TIMOB-25424 and TIMOB-26681
Also AC-6082 suggests that the problem is in ti.admob module, which we use

We use Ti.Media in our app only for video playback

<h3>Comments</h3>

<ol>
<li>Vijay Singh 2019-02-14

   [~davidbenko] 
   1. Can you try as discussed [here](<a href="https://stackoverflow.com/questions/47487222/appcelerator-apple-music-api)?" rel="nofollow" target="_blank">https://stackoverflow.com/questions/47487222/appcelerator-apple-music-api)?</a>
   2. Can you give a small test case how you are using Ti.Media?
   3. What version of ti.admob module you are using?
   
   Thanks!
   
   
   </li>
<li>David Benko 2019-02-14

   Vijay Singh
   
   1. TIMOB-25424 suggests the issue was fixed in 7.3.0, we are using 7.4.0. Also there was a suggestion to describe to Apple that we do not use Apple Music API, but we already tried that.
   
   2. We have a video player widget:
   <a href="https://gist.github.com/davidbnk/be44ae5c01deafaffd1a4f860b3f6f89" rel="nofollow" target="_blank">https://gist.github.com/davidbnk/be44ae5c01deafaffd1a4f860b3f6f89</a>
   <a href="https://gist.github.com/davidbnk/6c212ac7fb7fa2b412c924cb965cd7ae" rel="nofollow" target="_blank">https://gist.github.com/davidbnk/6c212ac7fb7fa2b412c924cb965cd7ae</a>
   
   3. We are using version 2.2.0 of ti.admob</li>
<li>Vijay Singh 2019-02-15

   [~davidbenko]
   There is few Music API constants which are not properly wrapped under macros.
   See [line 305](<a href="https://github.com/appcelerator/titanium_mobile/blob/849c15e0980281ea9e2c28e9de7d59810e02e906/iphone/Classes/MediaModule.m#L305)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/849c15e0980281ea9e2c28e9de7d59810e02e906/iphone/Classes/MediaModule.m#L305)</a> to [line 322](<a href="https://github.com/appcelerator/titanium_mobile/blob/849c15e0980281ea9e2c28e9de7d59810e02e906/iphone/Classes/MediaModule.m#L305)." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/849c15e0980281ea9e2c28e9de7d59810e02e906/iphone/Classes/MediaModule.m#L305).</a>
   
   So I have created an [SDK 7.4.3](<a href="https://www.dropbox.com/s/n481qghwdm42jmg/7.4.3.zip?dl=0)" rel="nofollow" target="_blank">https://www.dropbox.com/s/n481qghwdm42jmg/7.4.3.zip?dl=0)</a> (7.4.2.GA + wrapping of mentioned code above).
   
   Can you try to build your app using SDK 7.4.3 and upload to App Store.
   
   Thanks!
   </li>
<li>David Benko 2019-02-15

   Vijay Singh
   Thanks will try that and let you know</li>
<li>David Benko 2019-02-15

   I have extracted the SDK at the following location:
   ~/Library/Application\ Support/Titanium/mobilesdk/osx/
   And got the following error when building: <a href="https://pastebin.com/eQFr74Ly" rel="nofollow" target="_blank">https://pastebin.com/eQFr74Ly</a> with the command appc run -p ios -T device</li>
<li>Vijay Singh 2019-02-15

   [~davidbenko] I have updated sdk. Please try now and let me know if you face any issue.
   
   </li>
<li>David Benko 2019-02-20

   Vijay Singh sent for review compiled with your SDK but they still refused</li>
<li>David Benko 2019-02-25

   @Vijay Singh we sent another update without ti.admob and with your custom sdk to exclude the possibility that ti.admob was causing this, but they still refused the app because we used Apple Music API. Do you have any other ideas what is causing this?</li>
<li>David Benko 2019-02-28

   Can anyone help with this? We are over a month without being able to update our app</li>
<li>Vijay Singh 2019-03-12

    [~davidbenko] Sorry for inconvenience caused to you. I have updated [SDK 7.4.3](<a href="https://www.dropbox.com/s/80d7tvbc97ftcap/7.4.3.zip?dl=0)" rel="nofollow" target="_blank">https://www.dropbox.com/s/80d7tvbc97ftcap/7.4.3.zip?dl=0)</a> (which have 7.4.2.GA code + wrapping of music constants used in MediaModule.m + wrapping of '#import "MediaPlayer/MediaPlayer.h"' in MediaModule.h/.m + removing of '#import <MediaPlayer/MediaPlayer.h>' from TiMediavideoPlayer.h and TiMediaVideoPlayerProxy.h).
    
    Solution 1-
    1. Use above sdk to build your app.
    2. *Do not use* NSAppleMusicUsageDescription in your tiapp.xml .
    3. *Do not use* ti.admob module.
    4. Build your app and upload to App Store.
    
    I believe above sdk will fix the issue.
    
    If it gets approved, you can try using ti.admob and upload to App Store.
    
    Please let me know if it works for you.
    
    Can you share defines.h file which is available at <project name>/build/iphone/Classes after building for device (not simulator)?
    
    Thanks!</li>
<li>David Benko 2019-03-14

    Hello Vijay, thanks for your response. As requested here is the defines.h: <a href="https://gist.github.com/davidbnk/c3737d9ca3dad36fd29e1f97258f43aa" rel="nofollow" target="_blank">https://gist.github.com/davidbnk/c3737d9ca3dad36fd29e1f97258f43aa</a>
    We built the app with your SDK and currently waiting for Apple to review. We did not have NSAppleMusicUsageDescription previously and have removed ti.admob.</li>
<li>David Benko 2019-03-16

    Hello Vijay, unfortunately the app got rejected again, but this time I got a response from them saying that:
    "Regarding 4.5.2 issue, from the last submitted iteration of your app, we see that the point of possible concern comes from -[TiStorekitModule showCloudSetupDialog:] that appears to be part of a Titanium SDK. If this method is not in use, it would be appropriate to remove it or its inner functionality. It would be prudent to reach out to the Titanium Mobile SDK developers if you need support there."
    So it actually comes from the ti.storekit module we use. Do you have any insight about this?</li>
<li>David Benko 2019-03-18

    Vijay, we fould that ti.storekit had one release stating "Fix a possible AppStore rejection caused by the "showCloudSetupDialog" API". We gonna update it and try again. </li>
<li>Vijay Singh 2019-03-18

    [~davidbenko] That's cool. I believe with latest release of ti.storekit module, it will get pass Apple review.
    I think we have solved 'NSAppleMusicUsageDescription' related rejection issue with the changes in shared SDK. Once you confirm with your final app approval from Apple, I'll create PR for changes in SDK.
    Thanks!</li>
<li>Vijay Singh 2019-03-21

    [~davidbenko] Did you got any update from Apple?</li>
<li>David Benko 2019-03-21

    Hello, Vijay. Happy to inform that the app got approved today by Apple. Thank you very much</li>
<li>Vijay Singh 2019-03-21

    [~davidbenko] That's good news :)</li>
<li>Sharif AbuDarda 2019-03-21

    Hello [~davidbenko], I believe we can close the ticket? If you have any more issue feel free to open another ticket. Thanks.</li>
</ol>


<p><a href="/AC/AC-6137.json">JSON Source</a></p>