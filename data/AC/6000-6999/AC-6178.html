---
title: "[AC-6178] iOS background fetch is not working. "
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Needs more info</td></tr>
<tr><th>Resolution Date</th><td>2019-05-11T00:23:20.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Alloy, Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>lau.yikonn</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2019-03-23T03:54:16.000+0000</td></tr>
<tr><th>Updated</th><td>2019-05-11T00:23:20.000+0000</td></tr>
</table>

<h3>Description</h3>

<plist>
      <dict>
        <key>UIBackgroundModes</key>
        <array>
          <string>fetch</string>
        </array>
      </dict>
</plist>

var acceptAction = Ti.App.iOS.createUserNotificationAction({
    identifier: "ACCEPT_IDENTIFIER",
    title: "Accept",
    activationMode: Ti.App.iOS.USER_NOTIFICATION_ACTIVATION_MODE_FOREGROUND,
    destructive: false,
    authenticationRequired: true
});
 
var rejectAction = Ti.App.iOS.createUserNotificationAction({
    identifier: "REJECT_IDENTIFIER",
    title: "Reject",
    activationMode: Ti.App.iOS.USER_NOTIFICATION_ACTIVATION_MODE_BACKGROUND,
    destructive: true,
    authenticationRequired: false
});
 
// Create a notification category
var downloadContent = Ti.App.iOS.createUserNotificationCategory({
  identifier: "DOWNLOAD_CONTENT",
  actionsForDefaultContext: [acceptAction, rejectAction]
});    
 
// Register for user notifications and categories
Ti.App.iOS.registerUserNotificationSettings({
    types: [
        Ti.App.iOS.USER_NOTIFICATION_TYPE_ALERT,
        Ti.App.iOS.USER_NOTIFICATION_TYPE_BADGE,
        Ti.App.iOS.USER_NOTIFICATION_TYPE_SOUND
    ],
    categories: [downloadContent]
});

Ti.App.iOS.setMinimumBackgroundFetchInterval(1800);
//app.performFetchWithCompletionHandler()

Ti.App.iOS.addEventListener("backgroundfetch", function(e){
	var fetchID = e.handlerId;
    Ti.App.iOS.scheduleLocalNotification({
        date: new Date(new Date().getTime()),
        alertTitle: "My download",
        alertSubtitle: "Check it out!",
        alertBody: "New content available! Download now?",
        badge: 1,
        attachments: [{
            identifier: "my_attachment",
            url: "default_app_logo.png"
        },{
            identifier: "my_attachment2",
            url: "default_app_logo.png"
        }],
        userInfo: {"url": "<a href="http://www.download.com/resource/asset.json" rel="nofollow" target="_blank">http://www.download.com/resource/asset.json</a>", id:"1"},
        category: "DOWNLOAD_CONTENT"
    });

    Ti.App.iOS.endBackgroundHandler(fetchID);
});

The event never fires and the schedule notification never happend.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6178_66335/index.js">index.js</td></td><td>2019-03-23T08:06:22.000+0000</td><td>880</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6178_66336/tiapp.xml">tiapp.xml</td></td><td>2019-03-23T08:07:01.000+0000</td><td>4019</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Rakhi Mitro 2019-03-23

   	
   Thanks for reaching out! Are you experiencing this on iPhone device? It would be better if you can provide complete simple test case, your full environment details  and detail console logs to reproduce the issue on our end.
   
   </li>
<li>lau.yikonn 2019-03-23

   i've attach the index.js and the tiapp.</li>
<li>Rakhi Mitro 2019-04-07

   [~lau.yikonn],
   Can you please try the sample code from [Background fetch](<a href="https://wiki.appcelerator.org/display/guides2/iOS+Background+Services#iOSBackgroundServices-Backgroundfetch)" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides2/iOS+Background+Services#iOSBackgroundServices-Backgroundfetch)</a> section and let us know how it goes.</li>
<li>Sharif AbuDarda 2019-04-09

   Hello [~lau.yikonn], Can you get back here? did you follow the above guide? let us know how things going.  </li>
<li>Rakhi Mitro 2019-04-24

   Hello,
   Did you find our last reply helpful for your progress? Let us know the updates from your end.</li>
</ol>


<p><a href="/AC/AC-6178.json">JSON Source</a></p>