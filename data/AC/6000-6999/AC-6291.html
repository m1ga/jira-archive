---
title: "[AC-6291] iOS: Cors issue in WKWebView (sdk 8.0.1)"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>8.0.1, 8.1.0.GA, 8.2.0.GA, 8.3.0, 9.0.0.RC, ios, webView</td></tr>
<tr><th>Reporter</th><td>Portal</td></tr>
<tr><th>Assignee</th><td>Vijay Singh</td></tr>
<tr><th>Created</th><td>2019-06-19T07:52:32.000+0000</td></tr>
<tr><th>Updated</th><td>2020-03-19T11:56:47.000+0000</td></tr>
</table>

<h3>Description</h3>

I'm testing an app with sdk 8.0.1 but the webview component has changed (now is WKWebView) and fails to load a SPA with AngularJS ngRoute navigation, showing a cors error:

_Cross origin requests are only supported for HTTP_

The app works fine with sdk 7.4.1.
I think the problem is the WkWebView is missing property allowFileAccessFromFileURLs which seems to solve Cors issues.

*To Reproduce*
1 - Create a window containing a webview with url:'index.html'
2 - Create index.html file containing an AngularJS single page application with angular version 1.4.7 and ngRoute navigation, for example:

<code><pre>
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;test&lt;/title&gt;
    &lt;script src="<a href="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.min.js" rel="nofollow" target="_blank">https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular.min.js</a>"&gt;&lt;/script&gt;
    &lt;script src="<a href="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular-route.js" rel="nofollow" target="_blank">https://ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular-route.js</a>"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body ng-app="myApp"&gt;
    
    &lt;p&gt;&lt;a href="#/!"&gt;Main&lt;/a&gt;&lt;/p&gt;
    
    &lt;a href="#/red"&gt;Red&lt;/a&gt;
    &lt;a href="#/green"&gt;Green&lt;/a&gt;
    &lt;a href="#/blue"&gt;Blue&lt;/a&gt;
    
    &lt;div ng-view&gt;&lt;/div&gt;
    
    &lt;script&gt;
    var app = angular.module("myApp", ["ngRoute"]);
    app.config(function($routeProvider) {
      $routeProvider
      .when("/", {
        templateUrl : "main.html"
      })
      .when("/red", {
        templateUrl : "red.html"
      })
      .when("/green", {
        templateUrl : "green.html"
      })
      .when("/blue", {
        templateUrl : "blue.html"
      });
    });
    &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</pre></code>

*Expected behavior*
The Angular SPA works fine with ngRoute navigation in WkWebview, as did in UIWebView.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6291_66784/Screen Shot 2019-07-24 at 6.43.48 PM.png">Screen Shot 2019-07-24 at 6.43.48 PM.png</td></td><td>2019-07-24T15:44:03.000+0000</td><td>22684</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6291_67089/Screenshot 2019-10-26 at 2.22.43 PM.png">Screenshot 2019-10-26 at 2.22.43 PM.png</td></td><td>2019-10-26T08:25:30.000+0000</td><td>16480</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6291_66857/Simulator Screen Shot - iPad Air 2 - 2019-08-19 at 15.45.08.png">Simulator Screen Shot - iPad Air 2 - 2019-08-19 at 15.45.08.png</td></td><td>2019-08-19T09:47:38.000+0000</td><td>74972</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Muhammad Ahmed Fahad 2019-06-21

   </li>
<li>Portal 2019-07-24

   any news? It starts getting critical because we can't migrate sdk as far as loading local templates causes cors errors.</li>
<li>Muhammad Ahmed Fahad 2019-07-24

   @Portal , if you are using your own API's you can solve your issue by adding this headers to your API's that you access using a webview:
   
   'Access-Control-Allow-Origin': '*'</li>
<li>Portal 2019-07-24

   @Muhammad Ahmed Fahad Unfortunately the issue is not related to an API call, we can't load html files through AngularJS routing because webview doesn't trust anymore ajax calls to load resources with the file URI scheme.</li>
<li>Sharif AbuDarda 2019-07-24

   Hello, I have tested the sample HTML code as a local HTML file in a classic app. I don't see any error during runtime. I have tested with SDK 8.0.2.GA in iOS simulator. The webview loads fine.  !Screen Shot 2019-07-24 at 6.43.48 PM.png|thumbnail! . Try with the latest SDK 8.0.2.GA. Let us know. Thanks.</li>
<li>Portal 2019-07-26

   We tried updating to SDK 8.0.2.GA but keep getting the same error.
   Tested on simulator Ipad Air 2 IOS 12.1.
   
   <code><pre>
   [Error] Cross origin requests are only supported for HTTP.
   (funzione anonima) (angular.min.js:93:225)
   p (angular.min.js:89:99)
   (funzione anonima) (angular.min.js:86:247)
   (funzione anonima) (angular.min.js:119:115)
   $digest (angular.min.js:130:239)
   $apply (angular.min.js:133:520)
   (funzione anonima) (angular.min.js:20)
   d (angular.min.js:19:489)
   Zd (angular.min.js:19:85)
   (funzione anonima) (angular.min.js:293:241)
   a (angular.min.js:174:401)
   c (angular.min.js:35:222)
   [Error] XMLHttpRequest cannot load file:///Users/sviluppo/Library/Developer/CoreSimulator/Devices/640896B1-CF62-4872-B0B8-A456BCC410EC/data/Containers/Bundle/Application/17D7E690-5EBA-4B58-BC33-194984FE1911/Test%20App.app/html/views/main.html due to access control checks.
   (funzione anonima) (angular.min.js:93:225)
   p (angular.min.js:89:99)
   (funzione anonima) (angular.min.js:86:247)
   (funzione anonima) (angular.min.js:119:115)
   $digest (angular.min.js:130:239)
   $apply (angular.min.js:133:520)
   (funzione anonima) (angular.min.js:20)
   d (angular.min.js:19:489)
   Zd (angular.min.js:19:85)
   (funzione anonima) (angular.min.js:293:241)
   a (angular.min.js:174:401)
   c (angular.min.js:35:222)
   </pre></code>
   
   </li>
<li>Rakhi Mitro 2019-08-19

   Hello,
   Tested this with  SDK 8.1.0.GA on Ipad Air 2 and got the following output:
    !Simulator Screen Shot - iPad Air 2 - 2019-08-19 at 15.45.08.png|thumbnail! 
   
   Can you please test this on SDK 8.1.0.GA and let us know the result?
   </li>
<li>Portal 2019-08-20

   Hello, we tried updating to sdk 8.1.0.GA but we keep getting this error during installation:
   
   [ERROR] :  Error: spawn EACCES
       at _errnoException (util.js:992:11)
       at ChildProcess.spawn (internal/child_process.js:323:11)
       at exports.spawn (child_process.js:502:9)
       at iOSBuilder.<anonymous> (/Users/sara.quattrini/Library/Application Support/Titanium/mobilesdk/osx/8.1.0.GA/iphone/cli/commands/_build.js:6012:19)
       at Object.whilst (/Users/sara.quattrini/Library/Application Support/Titanium/mobilesdk/osx/8.1.0.GA/node_modules/async/dist/async.js:5227:5)
       at iOSBuilder.<anonymous> (/Users/sara.quattrini/Library/Application Support/Titanium/mobilesdk/osx/8.1.0.GA/iphone/cli/commands/_build.js:5999:9)
       at checkEntitlements (/Users/sara.quattrini/.appcelerator/install/7.0.11/package/node_modules/appc-cli-titanium/hook/titanium.js:630:15)
       at iOSBuilder.data.fn (/Users/sara.quattrini/.appcelerator/install/7.0.11/package/node_modules/appc-cli-titanium/hook/titanium.js:623:10)
       at /Users/sara.quattrini/.appcelerator/install/7.0.11/package/node_modules/titanium/lib/hook.js:256:13
       at /Users/sara.quattrini/.appcelerator/install/7.0.11/package/node_modules/titanium/node_modules/async/dist/async.js:3853:9
   
   Can you give us some hint to fix it?
   Thanks</li>
<li>Sharif AbuDarda 2019-08-21

   Hello,
   
   Here are a couple of things to try and let us know if this works for you.
   
   * Make sure you have the latest Appc CLI from NPM : sudo npm install -g appcelerator
   * To check which version you are on, run :  npm list -g --depth 0 appcelerator
   * run the setup command with debug and trace flags turned on :  DEBUG=* appc setup -l trace
   
   Next, try a clean install of your Appc CLI:
   
   * Uninstall Appc CLI from NPM global path : sudo npm uninstall -g appcelerator 
   * Remove Appc CLI installed locally : sudo rm -rf .appcelerator 
   * Cache clean from NPM : sudo npm cache clean 
   * Then, reinstall Appc CLI from NPM : sudo npm install -g appcelerator 
   * Run setup : appc setup
   
   Thanks.
   </li>
<li>Portal 2019-08-26

    We managed to install the app with the new SDK but it continues to fail routing showing us just a blank page.
    Could you share with us the working sample tested with SDK 8.1.0.GA? Could it be a problem linked to environment configuration?</li>
<li>Portal 2019-09-05

    Could you share with us the working sample tested with SDK 8.1.0.GA? Could it be a problem linked to environment configuration?</li>
<li>Portal 2019-09-16

    Hi again,
    any news?</li>
<li>Rakhi Mitro 2019-09-16

    Hello ,
    Can you please test this issue on 8.1.1.GA and let us know the results?</li>
<li>Portal 2019-09-16

    Hi,
    we tested 8.1.1.GA and we are getting the same error described for 8.0.2.GA.</li>
<li>Rakhi Mitro 2019-10-26

    Hello,
    Are you able to get that sorted out? Tested this issue on 8.2.1.GA and got the following as output:
     !Screenshot 2019-10-26 at 2.22.43 PM.png|thumbnail! 
     Can you please test this on 8.2.1.GA? Please let us know if you need more help with this issue.</li>
<li>Portal 2019-11-19

    Tested and got same error (iOS 13.0).
    Could you please give us a sample code showing how you are instantiating and loading the webview?
    Thanks</li>
<li>Fazlul Haque 2019-12-30

    Hi [~portal@quix.it], If I just add the index.html on any project then Create a window containing a webview with url:'index.html' using latest SDK 8.3.0.GA, I cannot reproduce the issue on my end. My test code is:
    <code><pre>
    var win = Ti.UI.createWindow();
    var webview = Ti.UI.createWebView({
    	url : 'index.html'
    });
    win.add(webview);
    win.open(); 
    </pre></code>
    
    Can you please test it on latest SDK and let us know if you have the same issue? Thanks</li>
<li>Portal 2020-01-13

    Same error. The error is triggered when trying to navigate to other pages from the index (red, green or blue html from the example), index.html is correctly displayed.
    We seriously need it working, we can't go on with workarounds anymore...</li>
<li>Vijay Singh 2020-02-21

    See TIMOB-27159. Probably it will fix the issue. It has new property 'assetsDirectory' which can be used to whitelist the resources. Let me know if it fixes or share a complete test app. Thanks!</li>
<li>Portal 2020-03-16

    Unfortunately we tried and it doesn't fix the issue because the problem is not linked to titanium impossibility to load the file from resources. The WKWebView enforces strict CORS settings so angularjs is unable to load urls with file scheme.
    The test described in the task is still valid... just try to navigate using angularjs routing inside the webview.</li>
</ol>


<p><a href="/AC/AC-6291.json">JSON Source</a></p>