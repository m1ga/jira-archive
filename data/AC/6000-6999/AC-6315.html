---
title: "[AC-6315] Titanium using wrong javac & dx max memory"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Done</td></tr>
<tr><th>Resolution Date</th><td>2019-11-03T21:18:44.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK & CLI</td></tr>
<tr><th>Labels</th><td>titanium</td></tr>
<tr><th>Reporter</th><td>Yahya Uddin</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2019-07-20T21:43:55.000+0000</td></tr>
<tr><th>Updated</th><td>2019-11-03T21:18:44.000+0000</td></tr>
</table>

<h3>Description</h3>

I am running the following command to compile an app for Android:

<code><pre>
ti build -p android -T device
</pre></code>

The build process runs a bunch of commands. On the bit it builds the java files, on v7.5.1.GA and older, it run a command like so:

<code><pre>
javac -J-Xmx1024M -encoding utf8 -bootclasspath ...
</pre></code>

But on v7.5.1.GA and greater (tested on v7.5.2 and v8.0.0), the build command used more memory like so, ignoring the default values of 1GB as mentioned on the docs:

<code><pre>
javac -J-Xmx3072M -encoding utf8 -bootclasspath ...
</pre></code>

This meant when building my app, I get the following unuseful error message (regardless of log-level):

<code><pre>
[ERROR] Failed to compile Java source files:
[ERROR]
[ERROR]
</pre></code>

(Side note: It would be good to get more information than just this).

When I tried the javac command manually, I found the error:

<code><pre>
Error occurred during initialization of VM
Could not reserve enough space for object heap
Error: Could not create the Java Virtual Machine.
Error: A fatal exception has occurred. Program will exit.
</pre></code>

I tried adjusting the the amount of memory used like so:

<code><pre>
ti config android.javac.maxmemory 1024M
</pre></code>

but it's just ignored it, and still uses 3GB instead.

I solved this issue by adding the following properties to tiapp.xml

<code><pre>
&lt;property name="android.javac.maxmemory" type="string"&gt;1G&lt;/property&gt;
&lt;property name="android.dx.maxmemory" type="string"&gt;1G&lt;/property&gt;
</pre></code>

and the javac command changed correctly.

So the issues are:

 1. Titanium v7.5.2 and greater does not use the correct memory for javac and dexter
 2. When adjusting the config, the memory used in the build does not change
 3. Un-useful error message in console output when build fails (this could be a separate issue)


<h3>Comments</h3>

<ol>
<li>Rakhi Mitro 2019-07-22

   Hello,
   Thanks for sharing with us. Can you please create a new app, run this on 8.0.2.GA and let us know how it goes.</li>
<li>Yahya Uddin 2019-07-22

   Yes this occurred on v8.0.2.GA on an hello world app.</li>
<li>Ewan Harris 2019-07-22

   This was a known change made in TIMOB-26898, however the docs should have been updated to reflect that.
   
   As for the ti config setting not working, it looks like the tiapp and config have different names, with the tiapp being <code>android.javac.maxmemory</code> and the config being <code>android.javac.maxMemory</code>, I believe that's why it failed to work as a config setting for you.</li>
<li>Rakhi Mitro 2019-08-08

   Hello [~yahya12],
   
   Hope you are doing fine today.Would you please reply us regarding previous reviews? We are looking forward to your response.
   
   </li>
<li>Sharif AbuDarda 2019-08-23

   Hello [~eharris], can you please share the docs link where we should update the relevant information. I believe [~bimmel], can get on making the change. Thanks. </li>
<li>Brian Immel 2019-08-23

   Is this the document you're looking for?
   
   <a href="https://wiki.appcelerator.org/display/guides2/Titanium+CLI+Options#TitaniumCLIOptions-android.javac.maxmemory" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides2/Titanium+CLI+Options#TitaniumCLIOptions-android.javac.maxmemory</a></li>
<li>Yahya Uddin 2019-08-25

   @Rakhi Mitro Sorry for the very late reply. What did you want me to reply to exactly?</li>
<li>Rakhi Mitro 2019-08-26

   [~yahya12],
   Did you manage to check Ewan's comment? Is it helpful for you?</li>
<li>Ewan Harris 2019-08-26

   [~sdarda], the docs are already up to date for the change that was made. Looking at the wiki page it was made prior to this ticket being filed also so the change should have been live.
   ?
   [~yahya12], I believe Rahki is referring to my previous comment. Have you managed to fix this error?</li>
<li>Yahya Uddin 2019-08-27

    @Ewan Harris @Sharif AbuDarda Yes sorry. I actually mentioned this inconsistency on the GitHub issue: <a href="https://github.com/appcelerator/titanium_mobile/issues/11068" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/issues/11068</a> . Sorry for the confusion.
    
    </li>
<li>Sharif AbuDarda 2019-11-03

    Looking into the <a href="https://wiki.appcelerator.org/display/guides2/Titanium+CLI+Options#TitaniumCLIOptions-android.javac.maxmemory" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides2/Titanium+CLI+Options#TitaniumCLIOptions-android.javac.maxmemory</a> the docs has been updated. Closing this. Thanks.</li>
</ol>


<p><a href="/AC/AC-6315.json">JSON Source</a></p>