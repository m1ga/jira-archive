---
title: "[AC-6339] Localization Format bug"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>In Progress</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>josh.mocek</td></tr>
<tr><th>Assignee</th><td>Riduanul Islam</td></tr>
<tr><th>Created</th><td>2019-08-20T14:50:20.000+0000</td></tr>
<tr><th>Updated</th><td>2019-12-25T23:19:29.000+0000</td></tr>
</table>

<h3>Description</h3>

Using localization with a localized string defined like this:

<code><pre>
&lt;resources&gt;
	&lt;string name="myTestLabel1"&gt;My test %1$s, test same param %1$s&lt;/string&gt;
	&lt;string name="myTestLabel2" formatted="false"&gt;My test %1$s, test same param %1$s&lt;/string&gt;
&lt;/resources&gt;
</pre></code>

Copy the above code into your <code>app/i18n/en/strings.xml</code> file.

Then paste this code into the index:

<code><pre>
var count = 0;

function doClick(e) {
	count++;
	let override = false;
	let localizedString = '';
	let label2 = undefined;
	let description = <code>${count} - </code>;
	switch (count) {
		case 1:
			description += 'formatted=undefined & 1';
			localizedString = 'myTestLabel1';
			break;
		case 2:
			description += 'formatted=undefined & 2';
			localizedString = 'myTestLabel1';
			label2 = '2';
			break;
		case 3:
			description += 'formatted=false & 1';
			localizedString = 'myTestLabel2';
			break;
		case 4:
			description += 'formatted=false & 2';
			localizedString = 'myTestLabel2';
			label2 = '2';
			break;
		case 5:
			description += 'passing 1 undefined param & 2';
			localizedString = 'myTestLabel2';
			override = true;
			count = 0;
			break;
	}

	let formattedString;
	if (label2 != undefined || override) {
		formattedString = String.format(L(localizedString), '1', label2);
	} else {
		formattedString = String.format(L(localizedString), '1');
	}

	alert(<code>${description} param(s) passed\n--\n${formattedString}</code>);
}

$.index.open();
</pre></code>

You will notice that every odd case has a problem. Ideally case 1 should not output the @. Here is what they look like:

case 1:
Actual: "My test 1, test same param %1$@"
Expected: "My test 1, test same param 1"
case 2:
Actual: "My test 1, test same param 2"
Expected: "My test 1, test same param 2"
case 3:
Actual: "My test 1, test same param %1$@"
Expected: "My test 1, test same param 1"
case 4:
Actual: "My test 1, test same param 2"
Expected: "My test 1, test same param 2"
case 5:
Actual: "My test 1"
Expected: "My test 1, test same param 1"


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6339_66944/app.tss">app.tss</td></td><td>2019-09-13T18:48:16.000+0000</td><td>780</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6339_67190/IMG_1113.PNG">IMG_1113.PNG</td></td><td>2019-12-25T23:17:31.000+0000</td><td>39981</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6339_66859/index.js">index.js</td></td><td>2019-08-20T14:50:15.000+0000</td><td>1074</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6339_66943/index.tss">index.tss</td></td><td>2019-09-13T18:48:11.000+0000</td><td>155</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6339_66942/index.xml">index.xml</td></td><td>2019-09-13T18:48:05.000+0000</td><td>114</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/AC/AC-6339_66860/strings.xml">strings.xml</td></td><td>2019-08-20T14:50:15.000+0000</td><td>188</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2019-09-11

   Hello, Please send the index.xml and index.tss file here. Thanks.</li>
<li>josh.mocek 2019-09-13

   I added them</li>
<li>Rakhi Mitro 2019-09-29

   Hello [~josh.mocek],
   Are you using 8.2.0.GA?</li>
<li>josh.mocek 2019-09-30

   This was on 8.0.0GA</li>
<li>Rakhi Mitro 2019-10-04

   [~josh.mocek],
   Can you please test this issue on 8.2.0.GA and let us know the results?</li>
<li>Riduanul Islam 2019-12-25

   Thanks for reaching. I can't reproduce this issue. Rather I got only this "My test 1, test same param 1" line. See the below output and image: 
   <code><pre>
   [WARN]  My test 1, test same param 1
   [WARN]  My test 1, test same param 1
   [WARN]  My test 1, test same param 1
   [WARN]  My test 1, test same param 1
   </pre></code>
    !IMG_1113.PNG|thumbnail! 
   
   My test environment was: 
   <code><pre>
   Operating System
     Name                        = Mac OS X
     Version                     = 10.14.6
     Architecture                = 64bit
     # CPUs                      = 4
     Memory                      = 8589934592
   
   Node.js
     Node.js Version             = 8.9.4
     npm Version                 = 6.5.0
   
   Titanium CLI
     CLI Version                 = 5.2.2
   
   Titanium SDK
     SDK Version                 = 8.3.0.GA
     Target Platform             = iphone 5S
   
   [INFO]  Building using iOS SDK: 13.2
   </pre></code></li>
</ol>


<p><a href="/AC/AC-6339.json">JSON Source</a></p>