---
title: "[AC-6403] Ti.Geolocation.hasLocationPermissions() is undefined"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2019-10-21T15:20:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Appcelerator Studio 4.5.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Appcelerator CLI, Appcelerator Modules</td></tr>
<tr><th>Labels</th><td>android, geolocation, permissions, sdk-8</td></tr>
<tr><th>Reporter</th><td>Pietro Granati</td></tr>
<tr><th>Assignee</th><td>Yordan Banev</td></tr>
<tr><th>Created</th><td>2019-10-11T10:50:12.000+0000</td></tr>
<tr><th>Updated</th><td>2019-10-21T15:20:40.000+0000</td></tr>
</table>

<h3>Description</h3>

This happens on Android

I've updated my app from SDK 7.5.0 to SDK 8.2.0 <code>Ti.Geolocation.hasLocationPermissions(Titanium.Geolocation.AUTHORIZATION_WHEN_IN_USE)</code> returns <code>undefined</code> instead of true/false.
It has been working for years.

If I create a fresh app with just this request and SDK 8.2.0 everything works.

I'm trying to find which modules causes this.
I've these modules added:
<code><pre>
dk.napp.drawer
ti.cloud
com.drtech.altbeacon
bencoding.android.tools
ti.nfc
ti.paint
ti.map
com.rkam.swiperefreshlayout
ro.mihaiblaga.imei
ti.barcode
yy.logcatcher
ti.animation
ti.identity
org.iotashan.TiTouchImageView
</pre></code>

Tested with 8.2.1.v20191010112656 undefined still present

Update:
I've rolled back to 7.5.1 to going on with the development but now it crashes
<code><pre>
[ERROR] :  TiExceptionHandler: (main) [640,1333] /alloy/controllers/index.js:1351
[ERROR] :  TiExceptionHandler:         gps_autorizzato: Ti.Geolocation.locationServicesAuthorization == Ti.Geolocation.AUTHORIZATION_DENIED ? false : true } });
[ERROR] :  TiExceptionHandler:                                         ^
[ERROR] :  TiExceptionHandler: TypeError: Cannot read property 'locationServicesAuthorization' of undefined
</pre></code>

Update 2, using 8.2.0 I saw that throws an error:

<code><pre>
[ERROR] :  V8Exception: Exception occurred at /alloy/controllers/index.js:3526: Uncaught Error: Attempt to invoke virtual method 'boolean ti.modules.titanium.geolocation.TiLocation.isProvider(java.lang.String)' on a null object reference
</pre></code>


Update 3 and Fix! 
Thank to Yordan we found that I was using ti.playservices 16.1.15 that causes all that trouble

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/AC/AC-6403_67054/appc_info_20191014.txt">appc_info_20191014.txt</td></td><td>2019-10-14T09:38:40.000+0000</td><td>21379</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Jorge Giunta 2019-10-14

   Hello, on iOS with SDK 8.2.0 with permission granted on my device:
   
   <code><pre>
   Ti.API.info(Ti.Geolocation.requestLocationPermissions(Ti.Geolocation.AUTHORIZATION_WHEN_IN_USE));
   </pre></code>
   
   I get on log: 
   
   [ERROR] Script Error {
   [ERROR]     column = 54;
   [ERROR]     line = 1449;
   [ERROR]     message = "undefined is not an object";
   
   When I downgrade to 8.1.0.GA all works like a charm.</li>
<li>Motiur Rahman 2019-10-21

   [~jgiunta], If you use ti.playservices module then try to change the version to fix this issue. 
   
   Thanks!</li>
</ol>


<p><a href="/AC/AC-6403.json">JSON Source</a></p>