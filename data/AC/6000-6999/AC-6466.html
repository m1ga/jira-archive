---
title: "[AC-6466] Duration of TiMediaAudioPlayer"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2020-01-07T14:34:02.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Rainer Schleevoigt</td></tr>
<tr><th>Assignee</th><td>Shak Hossain</td></tr>
<tr><th>Created</th><td>2020-01-06T19:06:54.000+0000</td></tr>
<tr><th>Updated</th><td>2020-01-07T14:34:02.000+0000</td></tr>
</table>

<h3>Description</h3>

Use case:

The user want play a remote source (i.e. HLS). 
First the user starts the downloader. The length of piece is  30 min. (for example)
After 10 sec (100 sec are downloaded) the player will started. After 100 sec. the player ends playing with regular completed event. Why? the player "thinks" at the time of starting that the file is 100 sec. long (this is the length at time of start).
I think this is false behaviour. How can I fix?

Here the dowloader:
<a href="https://github.com/AppWerft/Ti.FFmpeg" rel="nofollow" target="_blank">https://github.com/AppWerft/Ti.FFmpeg</a>


<code><pre>
var FFmpeg = require('ti.ffmpeg')
const URL = "<a href="https://dradiohls-vh.akamaihd.net/i/2020/01/03/eine_musik_worueber_die_welt_erstaunen_soll_von_der_drk_20200103_2230_e87b80e8.mp4/master.m3u8" rel="nofollow" target="_blank">https://dradiohls-vh.akamaihd.net/i/2020/01/03/eine_musik_worueber_die_welt_erstaunen_soll_von_der_drk_20200103_2230_e87b80e8.mp4/master.m3u8</a>");
const hlsClient = FFmpeg.createHLSClient();
const onProgess = (p) =&gt; {
   if (p.time &gt; 10) { //  10 sec. buffer time
      hlsClient.removeEventListener("onProgress",onProgress);
      const Player = Ti.Media.createAudioPlayer();
      Player.url = event.localfile;
      Player.start(); // stops after 100 sec, if download speed is 10x
  }
};
hlsClient.setInput(URL).setFile(Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory,'drw','worueber_die_welt_erstaunen_soll_von_der_.mp3');
// callback as observer:
hlsClient.addEventListener("onProgress",onProgress);
hlsClient.execute();
</pre></code>

 


<h3>Comments</h3>

<ol>
<li>Rainer Schleevoigt 2020-01-07

   I found a dirty solution:
   
   oncomplete event I'm looking in the downloader and if I see the file is longer, than I restart the player at the same position.
   - stop
   - release
   - seeking
   - setting url
   - start
   
   You can close. Better would be a possibility to set the duration of player</li>
</ol>


<p><a href="/AC/AC-6466.json">JSON Source</a></p>