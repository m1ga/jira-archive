---
title: "[ALOY-435] UI Object Allocations with Alloy and Titanium Studio"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2013-03-08T23:05:48.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Runtime</td></tr>
<tr><th>Labels</th><td>Allocations, Alloy, Memory, UI</td></tr>
<tr><th>Reporter</th><td>AppDesign</td></tr>
<tr><th>Assignee</th><td>Tony Lukasavage</td></tr>
<tr><th>Created</th><td>2012-12-19T17:57:45.000+0000</td></tr>
<tr><th>Updated</th><td>2014-01-29T00:07:02.000+0000</td></tr>
</table>

<h3>Description</h3>

The attached project has only 1 window and 1 view with 10 buttons so that you could see the UI count in allocations.

In the attached screen1.png you will see view1 with the 10 buttons. 


In the attached screen2.png - If you click the remove myself button you will see that the view is removed and nulls the global reference to the view and you are returned to the window (white). I stayed on the window for a long time on a couple of tests and it never cleaned up the UI objects from view 1.

In attached screen3.png  I opened view1 and clicked the remove myself button and the objects where cleaned up almost instantly. I can repeat this action over and over again and the objects clean up flawlessly.

This confirms that if you went to a view and never returned to it, it would never be properly cleaned up. 

Here is a link to the simplified project and made it as "hello world" as I could in hopes of making the issue easier to spot.

<a href="http://wwww.appdesigngeeks.com/simpleviewtest.zip" rel="nofollow" target="_blank">http://wwww.appdesigngeeks.com/simpleviewtest.zip</a>

Below is the simplified code from Alloy.js that does the open and close of view1

Alloy.globals.VARS = {
  globalParent:    null,  // Store ref to Parent Window of App
  globalCurrentView:   null,   // Store ref to current view being shown
};

Alloy.globals.GVUpdate = function(inName, inValue)
{
 Alloy.globals.VARS[inName] = inValue;
};

Alloy.globals.GVOpenViewNew = function(viewName)
{
 var openingview = Alloy.createController(viewName); // create controller
 Alloy.globals.VARS.globalParent.add(openingview.getView());
 openingview.init();
 Alloy.globals.VARS['globalCurrentView'] = openingview; 
};

Alloy.globals.CloseView = function()
{
 Alloy.globals.VARS.globalParent.remove(Alloy.globals.VARS.globalCurrentView.getView()); // Remove Current View from Parent
 Alloy.globals.GVUpdate("globalCurrentView", null); // Cleanup by Releasing resources and memory for current view
};



<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-435_34270/screen1 .png">screen1 .png</td></td><td>2012-12-19T17:57:45.000+0000</td><td>388659</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-435_34271/screen2.png">screen2.png</td></td><td>2012-12-19T17:57:45.000+0000</td><td>363100</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-435_34272/screen3.png">screen3.png</td></td><td>2012-12-19T17:57:45.000+0000</td><td>360694</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Tony Lukasavage 2013-01-09

   The linked project is not a valid download link so this is impossible to test. It's also worth noting that memory is not freed the instant that you remove and null a resource. Garbage collection needs to kick in before any of that will happen and that's probably why as you continue to navigate around your app that it is freed. 
   
   Update the project link and we can revisit.</li>
<li>AppDesign 2013-01-10

   Hi Tony,
   
   Sorry about the link, it had an extra w in the www. Here is the correct link <a href="http://www.appdesigngeeks.com/simpleviewtest.zip." rel="nofollow" target="_blank">http://www.appdesigngeeks.com/simpleviewtest.zip.</a>
   
   I understand that garbage collection does not always kick in at a certain time or always right away. I have let the screen sit there for hours and the view never gets cleaned up. I also have another example with more views and if you navigate to a 4th view and then back through the app and never return to the 4th view it will never get cleaned up no matter how many times I navigate around the rest of the views (ex. view1, view2, and view3) in the  sample app or how long I let the app run.
   
   Hope this helps
   
   Thanks
   
   
   </li>
<li>Tony Lukasavage 2013-01-10

   Is the "leak" growing over time though? It sounds like this is a discrete example that doesn't in fact grow but instead represents the memory footprint of your app as it relates to the timing of the garbage collection. I guess what I'm asking is does the number of views in memory grow over time, or is it just this instance that stays there? Because if it doesn't grow, it's not really a leak. If it does grow, are you able to recreate the issue without your custom logic? I have not been able to recreate any leaks without using the custom view management.</li>
<li>Tony Lukasavage 2013-03-08

   Will reopen if more details are given</li>
</ol>


<p><a href="/ALOY/ALOY-435.json">JSON Source</a></p>