---
title: "[ALOY-440] Ti.UI.Picker has no collection binding"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-08-21T03:16:58.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.5.0</td></tr>
<tr><th>Components</th><td>Models, XML</td></tr>
<tr><th>Labels</th><td>qe-manualtest</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Tim Poulsen</td></tr>
<tr><th>Created</th><td>2012-12-20T17:21:38.000+0000</td></tr>
<tr><th>Updated</th><td>2014-08-28T15:15:53.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>original discussion</h4>

<a href="http://developer.appcelerator.com/question/145992/databinding-on-picker" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/145992/databinding-on-picker</a>

<h4>problem</h4>

Collection binding is not implemented for Ti.UI.Picker as it is for Ti.UI.TableView and other generic Titaniums views (View, Window, ScrollView, etc...). 

<h4>solution </h4>

Support collection binding on Ti.UI.Picker just as it is on TableView. It will need special handling as the Ti.UI.Picker requires custom parsing for columns and rows. Something like this should be how it would work for devs:

<code><pre>
&lt;Alloy&gt;
    &lt;Collection src="book" /&gt;
    &lt;Window class="container"&gt;
        &lt;Picker dataCollection="book"&gt;
            &lt;PickerRow title="{title}" /&gt;
        &lt;/Picker&gt;
    &lt;/Window&gt;
&lt;/Alloy&gt;
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-440_50486/android_ActualResult_noSpinner.png">android_ActualResult_noSpinner.png</td></td><td>2014-08-14T23:11:01.000+0000</td><td>40150</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-440_50488/android_ActualResult_withSpinner_PickerRowBinding.png">android_ActualResult_withSpinner_PickerRowBinding.png</td></td><td>2014-08-14T23:11:01.000+0000</td><td>40143</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-440_50487/android_ActualResult_withSpinner.png">android_ActualResult_withSpinner.png</td></td><td>2014-08-14T23:11:01.000+0000</td><td>38795</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2014-06-24

   The original sample doesn't account for columns. Supporting columns could mean any of the following might be expected. What is our goal with this ticket?
   
   <code><pre>
   // single collection, filtering and binding only at Picker level
   &lt;Alloy&gt;
     &lt;Collection src="books"/&gt;
     &lt;Window&gt;
       &lt;Picker id="picker" top="50" dataCollection="books" dataFilter="doFilter"&gt;
         &lt;PickerColumn id="column1"&gt;
           &lt;PickerRow title="{column1}"/&gt;
         &lt;/PickerColumn&gt;
         &lt;!-- Picker shorthand notation --&gt;
         &lt;Column id="column2"&gt;
           &lt;Row title="{column2}"/&gt;
         &lt;/Column&gt;
       &lt;/Picker&gt;
     &lt;/Window&gt;
   &lt;/Alloy&gt;
   </pre></code>
   
   <code><pre>
   // single collection, binding at Picker level, filtering at column level
   &lt;Alloy&gt;
     &lt;Collection src="books"/&gt;
     &lt;Window&gt;
       &lt;Picker id="picker" top="50" dataCollection="books"&gt;
         &lt;PickerColumn id="column1" dataFilter="doFilterOne"&gt;
           &lt;PickerRow title="{title}"/&gt;
         &lt;/PickerColumn&gt;
         &lt;!-- Picker shorthand notation --&gt;
         &lt;Column id="column2" dataFilter="doFilterTwo"&gt;
           &lt;Row title="{genre}"/&gt;
         &lt;/Column&gt;
       &lt;/Picker&gt;
     &lt;/Window&gt;
   &lt;/Alloy&gt;
   </pre></code>
   
   <code><pre>
   // binding and filtering at column level
   &lt;Alloy&gt;
     &lt;Collection src="publishers"/&gt;
     &lt;Collection src="books"/&gt;
     &lt;Window&gt;
       &lt;Picker id="picker" top="50"&gt;
         &lt;PickerColumn id="column1" dataCollection="books"&gt;
           &lt;PickerRow title="{title}"/&gt;
         &lt;/PickerColumn&gt;
         &lt;!-- Picker shorthand notation --&gt;
         &lt;Column id="column2" dataCollection="publishers" dataFilter="doFilter"&gt;
           &lt;Row title="{publisher}"/&gt;
         &lt;/Column&gt;
       &lt;/Picker&gt;
     &lt;/Window&gt;
   &lt;/Alloy&gt;
   </pre></code>
   </li>
<li>Tim Poulsen 2014-07-16

   PR <a href="https://github.com/appcelerator/alloy/pull/483" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/483</a>
   
   Test app: <a href="https://github.com/skypanther/alloy/blob/ALOY-440/test/apps/testing/ALOY-440" rel="nofollow" target="_blank">https://github.com/skypanther/alloy/blob/ALOY-440/test/apps/testing/ALOY-440</a>
   
   Functional test: build the app, it should display a two-column picker with fruits in the left column and colors in the right. Due to the dataTransform applied, the colors should be in all-caps</li>
<li>Tim Poulsen 2014-08-18

   I'm not sure where I got the idea that you could use a <Label> as child of <PickerRow>. I cannot find any samples or docs showing that. While it works on iOS, it is apparently not supported elsewhere. I've updated the test case sample app to remove that and to add the useSpinner=true.
   
   PR: <a href="https://github.com/appcelerator/alloy/pull/508" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/508</a> 
   
   Functional test:
   
   Run the updated ALOY\-440 test app on Android to see the two-column spinner, which is bound to the collections as originally noted.</li>
<li>Feon Sua Xin Miao 2014-08-19

   **APPROVED**</li>
<li>Feon Sua Xin Miao 2014-08-19

   PR merged</li>
<li>Priya Agarwal 2014-08-20

   Verified with:
   
   Appc Studio - 3.4.0.201408180158 
   SDK - 3.4.0.v20140819094113 
   acs - 1.0.16 
   alloy - 1.5.0-dev 
   npm - 1.3.2 
   titanium - 3.4.0-dev 
   titanium-code-processor - 1.1.1 
   OS - mavericks (v10.9.4) 
   Xcode - 6Beta5
   Device - iPhone5s(v8.0), Nexus7(v4.4.4)
   
   Tested with app (test/apps/testing/ALOY-440)
   App runS without error and as expected.
   Able to see the two-column spinner, which is bound to the collections.
   Hence closing the issue.</li>
<li>Federico Casali 2014-08-20

   See attached sample app 'AlloyPicker_dataCollection.zip'.
   
   1. Run the sample on Android
   2. Click on the top ActionBar to add a model from the 'book' collection
   3. Click on the Picker
   
   Results: 
   2. Model item is correctly added and displayed in the TableView
   3. In the picker, the existing rows are not flushed out each time data is fetched from the collection, therefore adding each time the whole collection items plus one.
   
   Reopening. 
   
   
   TiSDK 3.4.0.v20140813022514
   Appcelerator Studio 3.3.1.201408121314 
   CLI 3.4.0-dev
   Alloy 1.5.0-dev</li>
<li>Tim Poulsen 2014-08-20

   PR <a href="https://github.com/appcelerator/alloy/pull/514" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/514</a>
   
   Functional review:
   
   The pull request includes a new test app, test/apps/testing/ALOY\-440c. Use it or the attached AlloyPicker_dataCollection.zip app. Run it for Android. Click the app's title in the action bar several times, after each click, drop down the picker to see that just as many rows are added to it as to the table.</li>
<li>Feon Sua Xin Miao 2014-08-21

   *APPROVED*</li>
<li>Feon Sua Xin Miao 2014-08-21

    PR merged</li>
<li>Federico Casali 2014-08-22

    Verified as working as expected.
    
    Environment:
    TiSDK  3.4.0.v20140820125714
    Appcelerator Studio 3.4.0.201408201526 
    CLI 3.4.0-dev
    Alloy 1.5.0-dev
    
    Closing.</li>
<li>Joe Beuckman 2014-08-26

    Is there a problem with doing this in a Widget? I'm using Alloy 1.6.0-dev
    
    <code><pre>
    &lt;Alloy&gt;
    	&lt;Collection src="StoreLocation"/&gt;	
    	&lt;Window&gt;		
    		&lt;Picker dataCollection="StoreLocation"&gt;
    			&lt;PickerRow title="{store_name}" /&gt;
    		&lt;/Picker&gt;
    	&lt;/Window&gt;	
    &lt;/Alloy&gt;
    </pre></code>
    
    <code>StoreLocation</code> is a model in the widget's <code>models/</code> folder. It uses a syncadapter in the app's <code>lib/alloy/sync</code> folder and I see the models populated correctly after an initial <code>fetch()</code>. When the widget loads, before the fetch can be called, I get {color:red}"'null' is not an object (evaluating '$model.__transform')"{color}</li>
<li>Tim Poulsen 2014-08-26

    Binding is supported on the <PickerColumn> tag, not <Picker> This is to support pickers with multiple columns. We did not add a shortcut by which you'd bind the picker and have that translated to its autogenerated column. So, this should work:
    
    <code><pre>
    // binding and filtering at column level
    &lt;Alloy&gt;
      &lt;Collection src="StoreLocation"/&gt;
      &lt;Window&gt;
        &lt;Picker&gt;
          &lt;PickerColumn dataCollection="storeLocation"&gt;
            &lt;PickerRow title="{store_name}"/&gt;
          &lt;/PickerColumn&gt;
        &lt;/Picker&gt;
      &lt;/Window&gt;
    &lt;/Alloy&gt;
    </pre></code></li>
<li>Joe Beuckman 2014-08-27

    Thanks! The error is gone. However, when I use my syncadapter, the collection looks full but the picker does not populate. I can only load the Picker by manually adding a model.
    
    This reports the correct number of models in the event handler, but the picker remains empty:
    <code><pre>
    Widget.Collections.StoreLocation.on('reset', function(){
        Ti.API.info('collection length = '+Widget.Collections.StoreLocation.length);
    });
    
    Widget.Collections.StoreLocation.fetch();
    </pre></code>
    
    This loads the picker correctly with one test entry:
    <code><pre>
    var model = Widget.createModel('StoreLocation', { store_name: "test" });
    Widget.Collections.StoreLocation.add(model);
    </pre></code>
    
    Do I need to do something besides <code>fetch()</code> to update the picker?
    </li>
<li>Tim Poulsen 2014-08-27

    Hmm, the picker should be responding to the same set of events that any other data-bound control would respond to: fetch, reset, delete, etc. Are you using one of the stock sync adapters? Can you post a test app that shows the problem so I can investigate further?</li>
<li>Joe Beuckman 2014-08-28

    Here is a minimal example of my problem. Thanks for your help. <a href="https://github.com/jbeuckm/AlloyWidgetCollectionPicker" rel="nofollow" target="_blank">https://github.com/jbeuckm/AlloyWidgetCollectionPicker</a></li>
<li>Tim Poulsen 2014-08-28

    What you posted doesn't show create or update methods within your sync adapter. What's triggering the read (fetch) method when you add a model? If you look at <a href="https://github.com/viezel/napp.alloy.adapter.restapi/blob/master/restapi.js" rel="nofollow" target="_blank">https://github.com/viezel/napp.alloy.adapter.restapi/blob/master/restapi.js</a> you'll see that he's triggering fetch as part of the create & update calls.</li>
<li>Joe Beuckman 2014-08-28

    I call fetch() from the widget's controller here: <a href="https://github.com/jbeuckm/AlloyWidgetCollectionPicker/blob/master/app/widgets/CollectionTest/controllers/widget.js#L6" rel="nofollow" target="_blank">https://github.com/jbeuckm/AlloyWidgetCollectionPicker/blob/master/app/widgets/CollectionTest/controllers/widget.js#L6</a>
    
    Note that this works with a ScrollableView or TableView but not Picker.
    </li>
</ol>


<p><a href="/ALOY/ALOY-440.json">JSON Source</a></p>