---
title: "[ALOY-441] Markup event handlers defined as function expressions can't manually be triggered til after controller code is executed"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Alloy 0.3.4</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Runtime</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2012-12-20T22:38:54.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-07T22:25:53.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>problem</h4>

The bulk of this issue was resolved in ALOY-438, but there still remains a small circumstance where unexpected behavior might happen. If a developer uses function expressions (as opposed to function declarations) to create an event handler function for a markup event, they will not be able to manually trigger (or remove) that event handler until after the controller code has executed. This is because in the case of function expressions, the event handler code is not executed until _after_ the developer's controller code, when the function expression is actually defined.

<h4>example showing problem</h4>

<h4>index.xml</h4>
<code><pre>
&lt;Alloy&gt;
    &lt;Window id="win" onClick="handleClick"/&gt;
&lt;/Alloy&gt;
</pre></code>

<h4>index.js (using function expression)</h4>
<code><pre>
// Function expression used to define handleClick. This will work just fine.
var handleClick = function() { 
    // This will be successfully removed as this event will be fired some time
    // after this controller's code has been executed.
    $.win.off("click",handleClick);
};

$.win.open();

// This will not fire "handleClick" because when function expressions are used
// the event handler is not created until _after_ the developer's controller code
$.win.trigger("click");
</pre></code>

<h4>index.js (using function declaration)</h4>
<code><pre>
// With function declarations, the following code will work as expected
function handleClick() { 
    $.win.off("click",handleClick);
};

$.win.open();
$.win.trigger("click");
</pre></code>


<h3>Comments</h3>

<p>No comments</p>

<p><a href="/ALOY/ALOY-441.json">JSON Source</a></p>