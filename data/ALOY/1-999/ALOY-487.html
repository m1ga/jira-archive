---
title: "[ALOY-487] SQL adapter does not accept ID when using PRIMARY KEY"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2013-02-09T01:39:51.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.0.0, 2013 Sprint 03</td></tr>
<tr><th>Components</th><td>Runtime</td></tr>
<tr><th>Labels</th><td>alloy</td></tr>
<tr><th>Reporter</th><td>David S</td></tr>
<tr><th>Assignee</th><td>Tony Lukasavage</td></tr>
<tr><th>Created</th><td>2013-01-25T15:48:13.000+0000</td></tr>
<tr><th>Updated</th><td>2014-01-28T23:28:55.000+0000</td></tr>
</table>

<h3>Description</h3>

If a new model is created that uses a 'INTEGER PRIMARY KEY' designation on a custom id field as specified with an idAttribute field in the model adapter section, when a new model is created and the custom id field is provided at creation time it will not be accepted nor added to the database. 

If custom id field is omitted on model creation, it will insert the model into the database successfully, with an id value one higher than any existing id value that is currently in the database.



<h3>Comments</h3>

<ol>
<li>Tony Lukasavage 2013-01-25

   I believe you had a test case or some code to go with this?</li>
<li>David S 2013-01-25

   I have modified the SQL Keywords example to use this model;
   
   exports.definition = {
   	config: {
   		"columns": {
   			name: 'TEXT',
   			nickname: 'TEXT',
   
   			// column values can have types with keywords
   			fighterId: 'INTEGER PRIMARY KEY' 
   		},
   
   		"adapter": {
   			"type": "sql_new",
   
   			// The table name inside the sqlite database to use for
   			// models and collections based on this definition.
   			"collection_name": "fighters",
   
   			// idAttribute tells Alloy/Backbone to use this column in
   			// my table as its unique identifier field. Without 
   			// specifying this, Alloy's default behavior is to create
   			// and "alloy_id" field which will uniquely identify your
   			// rows in the table with a text GUID.
   			"idAttribute": "fighterId" 
   		}
   	}
   }
   
   I try to add an item with this code which is triggered on the click of the "Fighters" label;
   
   function addTestFighter(e) {
   	// create the test fighter model
   	var model = Alloy.createModel('fighters', {
   		name: 'Name ' + counter,
   		nickname: 'Nickname ' + counter,
   		fighterId: counter * 100
   	});
   	counter++;
   
   	// add model to the collection and save it to sqlite
   	fighters.add(model);
   	model.save();
   
   	// let's refresh so we can see the ids coming from the 
   	// autoincrement field in the sqlite database in the 
   	// row click alerts
   	fighters.fetch();
   }
   </li>
<li>David S 2013-02-01

   Tony, any news on this?</li>
<li>Christina Hustedde 2013-02-08

   Watching, because I'm having this issue as well.</li>
<li>Tony Lukasavage 2013-02-09

   This is a duplicate of ALOY-508 and is resolved for 1.0.0</li>
</ol>


<p><a href="/ALOY/ALOY-487.json">JSON Source</a></p>