---
title: "[ALOY-532] Implement the source mapping API to support alloy debugging"
---
<table>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-03-08T21:59:29.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.1.0, 2013 Sprint 05</td></tr>
<tr><th>Components</th><td>Titanium Studio</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Michael Xia</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-02-21T19:27:28.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-07T22:25:48.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>update (3/8/2013)</h4>

External programs (specifically TiStudio) will be able to query Alloy's source maps by using the new "alloy debugger" command. These source maps are in [Mozilla's source-map format](<a href="https://github.com/mozilla/source-map)." rel="nofollow" target="_blank">https://github.com/mozilla/source-map).</a> The command take the following format (note, most of this information can be found by simple executing "alloy --help"):

<code><pre>alloy debugger -b &lt;original|generated&gt; &lt;SOURCE_MAP_FILE&gt; [options]</pre></code>

<h4>arguments and options</h4>

* - The "-b" must included to make sure Alloy's banner information is not printed, which will return with the source information in JSON format
* - After "debugger" you must type either "original" or "generated". This will indicate whether you are looking for the original or generated file and position
* - SOURCE_MAP_FILE, as you might imagine, is the path to the source map file that you wish to query for information. For more details on the location and filename format of Alloy source maps, check out ALOY-537.
* options
** - "-x, --column" is the column you wish to query from the source map. Default 1.
** - "-y, --line" is the line you wish to query from the source map. Default 1.
** - "-z, --source" when performing a "generated" query, this is the original source file from which we want to know the generated position. The file should be specified as a path relative to the project root. This will be explained more in the examples below. 

<h4>returned data</h4>

* "original" queries
<code><pre>
{
    source: 'app/controllers/index.js', // the original file
    line: 4,
    column: 5,
    name: null // unused, always null
}
</pre></code>
* "generated" queries
<code><pre>
{
    line: 12,
    column: 1
}
</pre></code>

<h4>Examples</h4>

* Find the generated position of line 4, column 1 of "app/alloy.js"
<code><pre>
alloy debugger generated ".map/Resources/app.js.map" --line 4 --column 1 --source "app/alloy.js"

#output
{
    line: 10,
    column 1
}
</pre></code>
* Find the generated position of line 56, column 5 of "app/controllers/index.js"
<code><pre>
alloy debugger generated ".map/Resources/alloy/controllers/index.js.map" --line 56 --column 5 --source "app/controllers/index.js"

<h4>output</h4>
{
    line: 135,
    column 9
}
</pre></code>
* Find the original position of line 135, column 9 of "Resources/alloy/controllers/index.js"
<code><pre>
alloy debugger original ".map/Resources/alloy/controllers/index.js.map" --line 135 --column 9

<h4>output</h4>
{
    source: "app/controllers/index.js"
    line: 56,
    column 5,
    name: null
}
</pre></code>
* Find the original position of some line and column that was auto-generated by Alloy, not by the developer's controller code. It will point you back to the same runtime file, avoiding the confusion of it pointing back to the Alloy template file that it was based on.
<code><pre>
alloy debugger original ".map/Resources/alloy/controllers/index.js.map" --line 3 --column 1

<h4>output</h4>
{
    source: "Resources/alloy/controllers/index.js"
    line: 3,
    column 1,
    name: null
}
</pre></code>

<h4>Additional Notes</h4>

* - The lines and columns are 1-based
* - Whenever an "original" source map query does not refer back to a developer's controller code or app.js code, the same position in the same file will be returned back. This is shown in the final example above.
* - column number is very important when doing "original" queries, not so much for "generated". This means that when doing an "original" query, you'll want to include the column number that actually represents where the code starts, not just 1 or the whitespace before the code. Without a valid column number that refers to the actual location of the code you'll often get unexpected results.

<h4>original</h4>

Here is the proposed syntax for the API: <a href="https://wiki.appcelerator.org/display/tools/Alloy+Debugging." rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/tools/Alloy+Debugging.</a>



<h3>Comments</h3>

<p>No comments</p>

<p><a href="/ALOY/ALOY-532.json">JSON Source</a></p>