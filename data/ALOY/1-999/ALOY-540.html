---
title: "[ALOY-540] Resolve suboptimal compression from uglify-js v2 update"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Sub-task</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Do</td></tr>
<tr><th>Resolution Date</th><td>2018-01-06T03:21:54.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>XML</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Bruce Wayne</td></tr>
<tr><th>Created</th><td>2013-03-01T19:25:27.000+0000</td></tr>
<tr><th>Updated</th><td>2018-01-06T03:23:01.000+0000</td></tr>
</table>

<h3>Description</h3>

The v2 update of uglify-js in Alloy, specifically version 2.2.5, has some suboptimal compressions, which are causing the optimizer.js test spec to fail in certain cases. Specifically the issues are around booleans and cascading of variables in assignments. These issues have been logged with the Uglifyjs2 project in the following links:

* <a href="https://github.com/mishoo/UglifyJS2/issues/137" rel="nofollow" target="_blank">https://github.com/mishoo/UglifyJS2/issues/137</a>
* <a href="https://github.com/mishoo/UglifyJS2/issues/138" rel="nofollow" target="_blank">https://github.com/mishoo/UglifyJS2/issues/138</a>

When these issues are resolved and distributed in an npm release, we need to revisit these compressions and testing to ensure that the fixes are in place, and that new uglify-js version has no regressions that impact alloy.

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2014-07-11

   With update to v2.4.15 of uglify, code is not compressed in the same way, nor as compactly as before. See updates to _generated (known-good) code addressed in <a href="https://github.com/appcelerator/alloy/pull/476." rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/476.</a> As part of this ticket, test the uglify options to see if we can return to the compression results we had before.</li>
<li>Tim Poulsen 2014-07-14

   Issue 137 has been resolved. Issue 138 has not. I've been through each of the compress options (Alloy/commands/compile/ast/compress.js) in succession and none of them returns the compressed output to match that of the previous Uglify version. Stopping progress, though not resolving this ticket; revisit once issue 138 is resolved. </li>
<li>Feon Sua Xin Miao 2018-01-06

   </li>
</ol>


<p><a href="/ALOY/ALOY-540.json">JSON Source</a></p>