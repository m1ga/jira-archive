---
title: "[ALOY-706] Store "classes" and "apiName" on Alloy-created proxies"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-02-04T19:45:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.2.0, 2013 Sprint 12, 2014 Sprint 03</td></tr>
<tr><th>Components</th><td>Runtime, Styling</td></tr>
<tr><th>Labels</th><td>qe-testadded</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-06-13T15:13:09.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-07T22:25:39.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>main issue</h4>

Currently classes assigned to Titanium proxy objects created with XML elements and/or *Alloy.UI.create()* do not store the classes on the proxy object itself. They are used only to generate the style and then are forgotten. To this point this is because any additional assignments to a proxy object can be considered unnecessary overhead. In an effort to make dynamic styling (ALOY-210), and specifically class manipulation (ALOY-613) more intuitive, we should store the classes in an efficient manner so they can be used on subsequent style operations.

To do this, we should add a *classes* and *apiName* property to Ti proxies when they are created via markup or *Alloy.UI.create()*. If there are proxies created by other means, classes can be added as an array or string to be used by further style operations. Here's a few examples:

<code><pre>
var proxy;

proxy = $.UI.create('Ti.UI.Button', {
    classes: ['dark','blue']
});
Ti.API.info(proxy.classes);
Ti.API.info(proxy.apiName);
// OUTPUT: ['dark','blue']
// OUTPUT: 'Ti.UI.Button'

proxy = $.UI.create('Ti.UI.Label', {
    classes: 'dark blue'
});
Ti.API.info(proxy.classes);
Ti.API.info(proxy.apiName);
// OUTPUT: ['dark','blue']
// OUTPUT: 'Ti.UI.Label'

<ImageView id="yoyo" class="images somethingElse"/>
Ti.API.info($.yoyo.classes);
Ti.API.info($.yoyo.apiName);
// OUTPUT: ['images','somethingElse']
// OUTPUT: 'Ti.UI.ImageView'
</pre></code>

<h4>additional considerations</h4>

We need to make sure that this does not cause any excessive overhead on the creation of Titanium proxies with Alloy. A little overhead is acceptable and expected when actually manipulating styles at runtime, but the initial creation of the proxy should remain largely unaffected. We will need to verify proxy creation performance as part of this ticket.

We also need to make sure that all platforms are aware of *classes* and *apiName* being used for this purpose on proxies. We also need to make sure documentation is created in the API docs to show this property.

<h4>crude performance tester</h4>

<h4>index.xml</h4>
<code><pre>
<Alloy>
	<Window>
		<Button onClick="test">test</Button>
	</Window>
</Alloy>
</pre></code>

<h4>index.js</h4>
<code><pre>
$.index.open();

function test() {
	var total = 0;
	var start, thisOne;

	for (var j = 0; j < 10; j++) {
		start = new Date().getTime();
		for (var i = 0; i < 10000; i++) { // only used 100 on android
			Alloy.createController('test');
		}
		thisOne = (new Date().getTime()) - start;
		total += thisOne;
		Ti.API.info('test #' + (j+1) + ': ' + thisOne);
	}

	Ti.API.info('average: ' + (total/10));
}
</pre></code>

<h4>test.xml</h4>
<code><pre>
<Alloy>
	<View class="bob lou"/>
	<View class="bob lou"/>
	<View class="bob lou"/>
	<View class="bob lou"/>
	<View class="bob lou"/>
	<View class="bob lou"/>
	<View class="bob lou"/>
	<View class="bob lou"/>
	<View class="bob lou"/>
	<View class="bob lou"/>
</Alloy>
</pre></code>

<h3>Comments</h3>

<ol>
<li>Tony Lukasavage 2013-06-14

   PR: <a href="https://github.com/appcelerator/alloy/pull/157" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/157</a>
   test app: <a href="https://github.com/appcelerator/alloy/tree/master/test/apps/testing/ALOY-706" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/tree/master/test/apps/testing/ALOY-706</a>
   
   Functional test can pass if the app is run on all supported platforms and all runtime unit tests pass. </li>
<li>Federico Casali 2013-07-30

   Functional and unit tests passed on iOS, Android and MobileWeb platforms.
   
   Titanium SDK 3.1.2.v20130726192706
   Alloy 1.2.0-alpha
   Appcelerator Studio 3.1.3.201307252418
   CLI 3.1.2
   Node 0.8.22
   
   Closing.</li>
<li>Tony Lukasavage 2014-02-04

   PR: <a href="https://github.com/appcelerator/alloy/pull/322" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/322</a>
   
   test should pass all runtime tests now</li>
</ol>


<p><a href="/ALOY/ALOY-706.json">JSON Source</a></p>