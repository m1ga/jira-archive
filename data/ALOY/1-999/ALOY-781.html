---
title: "[ALOY-781] Add option to extract-i18n to remove strings not used in code"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2013-10-02T18:08:02.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>alloy, extraction, i18n</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Tony Lukasavage</td></tr>
<tr><th>Created</th><td>2013-08-12T13:37:51.000+0000</td></tr>
<tr><th>Updated</th><td>2014-01-28T23:19:51.000+0000</td></tr>
</table>

<h3>Description</h3>

I would to have an option for <code>alloy extract-i18n</code> to remove strings that can not be found in the project's JS, TSS and XML files.

Of course this requires TC-2732 to be resolved because ATM, <code>extract-i18n</code> does not account for XML files and <code>textid</code>-like properties.

I will attach a PR for this.

<h3>Comments</h3>

<ol>
<li>Fokke Zandbergen 2013-08-12

   PR: <a href="https://github.com/appcelerator/alloy/pull/218" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/218</a></li>
<li>Tony Lukasavage 2013-08-12

   Can you better define what "unused" strings are?</li>
<li>Tony Lukasavage 2013-08-12

   This seems a little dangerous from my perspective and likely to be misused with bad results. The reason I've allowed extract-i18n in as it is with regex search instead of full AST parsing is that its changes are non-invasive. The changes are additive. That's not to say that we can't do it, I just think the interface will need to be more explicit.
   
   Makes me wonder if the command should be structured differently, with subcommands:
   
   <code><pre>alloy i18n extract ...</pre></code>
   
   instead of 
   
   <code><pre>alloy extract-i18n ...</pre></code>
   
   and then add 
   
   <code><pre>alloy i18n clean ...</pre></code>
   
   so that the very different behavior is more explicit. Not sure, but I do know that if this command gets into the business of actually removing entries, then I don't want it to be regex driven anymore and it should fully parse the JS/TSS into an AST and manipulate that way. The views would naturally be parsed as XML and evaluated in a similar fashion.</li>
<li>Fokke Zandbergen 2013-08-13

   Well I don't actually remove the strings, just wrap them in comments. But I do agree that an <code>extract</code> command also removing stuff might be unexpected behavior. We could do:
   
   <code><pre>
   alloy i18n extract
   alloy i18n clean
   alloy i18n sync // = extract + clean
   </pre></code>
   
   I also agree that proper AST and XML parsing is justifiable, also taking ALOY-782 into consideration (which is required for this issue anyway).</li>
<li>Tony Lukasavage 2013-10-02

   After discussion with Fokke, this ticket will be closed. Further effort here may be made in the next major version of Alloy, but that will likely be covered in entirely separate issues.</li>
</ol>


<p><a href="/ALOY/ALOY-781.json">JSON Source</a></p>