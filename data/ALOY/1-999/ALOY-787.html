---
title: "[ALOY-787] A <Widget> in a widget view should default to the current src"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-07-01T15:01:20.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Alloy 1.2.0</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.5.0</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>alloy, qe-manualtest, view, widget</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2013-08-12T06:47:19.000+0000</td></tr>
<tr><th>Updated</th><td>2015-12-04T08:47:23.000+0000</td></tr>
</table>

<h3>Description</h3>

Considering this view of a widget:

<code><pre>
&lt;Alloy&gt;
  &lt;Window&gt;
    &lt;Widget name="secondView" /&gt;
  &lt;/Window&gt;
&lt;/Alloy&gt;
</pre></code>

I would like the <code>src</code> attribute to automatically default to the widget it is used in. It's clean, better for my keyboard and one less statement to check if I decide to change my widget's name.

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2014-03-31

   [~fokke] Is this ticket still valid? I'm not sure I understand what you're asking for and why you need it. Can you provide a better description? Maybe even a mocked up project showing how you'd like it to work?</li>
<li>Fokke Zandbergen 2014-04-01

   [~skypanther], yes it's still valid.
   
   Imagine a widget with these 2 views:
   
   *widgets/my.widget/views/widget.xml*
   <code><pre>
   &lt;Alloy&gt;
     &lt;Window&gt;
       &lt;Widget src="my.widget" name="other" /&gt;
     &lt;/Window&gt;
   &lt;/Alloy&gt;
   </pre></code>
   
   *widgets/my.widget/views/other.xml*
   <code><pre>
   &lt;Alloy&gt;
     &lt;Label&gt;Hello&lt;/Label&gt;
   &lt;/Alloy&gt;
   </pre></code>
   
   I'd like to be able to leave out the <code>src</code> attribute in the first view.
   
   Why? Because I hate to repeat the id of the widget since a) I'm lazy b) It allows me to easily rename the widget.</li>
<li>Tim Poulsen 2014-04-04

   [~fokke] Widget tags are processed essentially as Require tags. In the case of widgets, the src attribute specifies the folder name from which to get the file specified with the name attribute. There are no properties available at runtime that give me this info automatically. The developer must supply it.</li>
<li>Tim Poulsen 2014-04-04

   Closing as Won't Fix because we don't have a Can't Fix option.</li>
<li>Fokke Zandbergen 2014-04-05

   Thanks for trying anyway :)</li>
<li>Tony Lukasavage 2014-04-30

   Re-opening as this could be implemented by injecting the widget name at compile time, then using it at runtime as a default if no explicit widget src is specified.</li>
<li>Feon Sua Xin Miao 2014-06-30

   PR: <a href="https://github.com/appcelerator/alloy/pull/465" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/465</a>
   Test app: <a href="https://github.com/feons/alloy/tree/ALOY-787/test/apps/testing/ALOY-787" rel="nofollow" target="_blank">https://github.com/feons/alloy/tree/ALOY-787/test/apps/testing/ALOY-787</a>
   
   Functional Test:
   
       1. Run the test app on iOS, it should compile with no error
        Noted that in *widgets/my.widget/views/widget.xml*, src attribute for Widget tag is omitted.</li>
<li>Fokke Zandbergen 2014-06-30

   Thx [~fmiao]!</li>
<li>Fokke Zandbergen 2014-07-01

   Tested on iOS Simulator with provided test app and works fine.</li>
<li>Tim Poulsen 2014-07-01

    PR tested and merged</li>
<li>Federico Casali 2014-08-18

    Verified working as expected on iPhone 5 iOS 7.1.2 - Android Nexus Galaxy 4.3 - MobileWeb
    
    TiSDK  3.4.0.v20140815142514
    Appcelerator Studio 3.3.1.201408140648
    CLI 3.4.0-dev
    Alloy 1.5.0-dev</li>
<li>Andrey Tkachenko 2015-12-03

    It not work in Alloy 1.7.24
    
    <code><pre>
    [ERROR] :  Error with &lt;Widget&gt; at line 5
    [ERROR] :  Child element must be one of the following: [Alloy.Abstract.ItemTemplate]
    [ERROR] :  Alloy compiler failed
    </pre></code>
    
    Inside <code>mywidget/views/widget.xml</code>
    <code><pre>
    &lt;ListView&gt;
                &lt;Templates&gt;
                    &lt;Widget name="templates/showlistOne" /&gt;               
                &lt;/Templates&gt;
                &lt;ListSection&gt;
                	&lt;ListItem template="showlistOne"&gt;&lt;/ListItem&gt;
                &lt;/ListSection&gt;
    &lt;/ListView&gt;
    </pre></code>
    
    widgets/mywidget/views/templates/showlistOne.xml
    
    <code><pre>
    &lt;Alloy&gt;
    	&lt;ItemTemplate name="showlistOne"&gt;
    		&lt;Label text="123" /&gt;
    	&lt;/ItemTemplate&gt;		
    &lt;/Alloy&gt;
    </pre></code>
    
    </li>
<li>Andrey Tkachenko 2015-12-03

    Android</li>
<li>Fokke Zandbergen 2015-12-03

    [~falko] Could you simplify the test case by not using templates, but instead simple views? The first view is missing the Alloy root element as well. Does the following fail as well for you?
    
    *mywidget/views/widget.xml*
    
    <code><pre>
    &lt;Alloy&gt;
      &lt;View&gt;
        &lt;Widget name="foo" /&gt;
      &lt;/View&gt;
    &lt;/Alloy&gt;
    </pre></code>
    
    *mywidget/views/foo.xml*
    
    <code><pre>
    &lt;Alloy&gt;
      &lt;Label&gt;Hello&lt;/Label&gt;
    &lt;/Alloy&gt;
    </pre></code></li>
<li>Andrey Tkachenko 2015-12-03

    I can't edit my comments for this issue to add <code>alloy</code> tag. 
    My example is quite simple.</li>
<li>Feon Sua Xin Miao 2015-12-04

    [~falko], <code>Widget</code> is currently not supported in <code>Templates</code>, a related ticket is here ALOY-1220.
    </li>
<li>Andrey Tkachenko 2015-12-04

    That ticket has not relation to this. Please read carefully. In my case Widget works as Require and not inside ItemTemplate.</li>
<li>Fokke Zandbergen 2015-12-04

    [~falko] I'm afraid what you see *is* variation of ALOY-1220 and ALOY-787:
    
    *This does NOT work:*
    
    <code><pre>
    &lt;Alloy&gt;
    	&lt;ListView&gt;
                &lt;Templates&gt;
                    &lt;Widget name="bar" /&gt;               
                &lt;/Templates&gt;
                &lt;ListSection&gt;
                	&lt;ListItem template="showlistOne"&gt;&lt;/ListItem&gt;
                &lt;/ListSection&gt;
    	&lt;/ListView&gt;
    &lt;/Alloy&gt;
    </pre></code>
    
    As does <code>&lt;Require type="widget" name="bar" /&gt;</code> which both fail with:
    
    <code><pre>
    [ERROR] Error with &lt;Widget&gt; at line 4
    [ERROR] Child element must be one of the following: [Alloy.Abstract.ItemTemplate]
    </pre></code>
    
    *This DOES work:*
    
    <code><pre>
    &lt;Alloy&gt;
    	&lt;ListView&gt;
                &lt;Templates&gt;
                    &lt;Widget src="foo" name="bar" /&gt;               
                &lt;/Templates&gt;
                &lt;ListSection&gt;
                	&lt;ListItem template="showlistOne"&gt;&lt;/ListItem&gt;
                &lt;/ListSection&gt;
    	&lt;/ListView&gt;
    &lt;/Alloy&gt;
    </pre></code>
    
    As does <code>&lt;Require type="widget" src="foo" name="bar" /&gt;</code>.
    
    [~fmiao] I guess the implementation of ALOY-787 is missing a case for when it's used in templates?</li>
<li>Andrey Tkachenko 2015-12-04

    Fokke Zandbergen your simple example also not work.
    
    <code><pre>
    &lt;Alloy&gt;
    	&lt;Window&gt;		
    		&lt;Widget src="test" /&gt;
    	&lt;/Window&gt;
    &lt;/Alloy&gt;
    </pre></code>
    
    <code><pre>
    &lt;Alloy&gt;
    	&lt;Widget src="foo" /&gt;
    &lt;/Alloy&gt;
    </pre></code>
    
    
    <code><pre>
    &lt;Alloy&gt;
    	&lt;Label&gt;ok&lt;/Label&gt;
    &lt;/Alloy&gt;
    </pre></code>
    
    {noformat}
    
    [ERROR] :  widget "foo" view "widget" does not exist.
    [ERROR] :  The following paths were inspected:
    [ERROR] :  /Users/falko/Documents/Appcelerator_Studio_Workspace/test123123/app/widgets/foo/views/android/widget
    [ERROR] :  /Users/falko/Documents/Appcelerator_Studio_Workspace/test123123/app/widgets/foo/views/widget
    [ERROR] :  /Users/falko/.appcelerator/install/5.2.0-55/package/node_modules/appc-cli-titanium/node_modules/alloy/widgets/foo/views/android/widget
    [ERROR] :  /Users/falko/.appcelerator/install/5.2.0-55/package/node_modules/appc-cli-titanium/node_modules/alloy/widgets/foo/views/widget
    [ERROR] :  Alloy compiler failed
    {noformat}
    </li>
<li>Fokke Zandbergen 2015-12-04

    In the *widget.xml* you should have <code>name="foo"</code> and not <code>src="foo"</code></li>
<li>Andrey Tkachenko 2015-12-04

    @Fokke Zandbergen yes you right. But it does not work inside <code>Templates</code>.</li>
<li>Fokke Zandbergen 2015-12-04

    </li>
</ol>


<p><a href="/ALOY/ALOY-787.json">JSON Source</a></p>