---
title: "[ALOY-797] momentjs 2.1 zone() behavior has changed with moment-timezone release"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2014-02-10T16:45:31.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Alloy 1.2.0</td></tr>
<tr><th>Fix Version/s</th><td>2014 Sprint 03</td></tr>
<tr><th>Components</th><td>Builtins</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Alan Leard</td></tr>
<tr><th>Assignee</th><td>Tim Poulsen</td></tr>
<tr><th>Created</th><td>2013-08-19T17:27:53.000+0000</td></tr>
<tr><th>Updated</th><td>2014-02-13T21:35:01.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>
The latest momentjs library has changed the timezone offset functionality breaking the previous implementation.  I believe this is due to the release of the new momentjs timezone library which we may want to start including as well. 

<h4>Test Case</h4>
I have attached a simple test case which includes the momentjs 2.0 library to demonstrate the difference in behavior.

<h4>Resources</h4>
New timezone library: <a href="http://momentjs.com/timezone/" rel="nofollow" target="_blank">http://momentjs.com/timezone/</a>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-797_41717/app.zip">app.zip</td></td><td>2013-08-19T17:27:53.000+0000</td><td>4987698</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2014-02-10

   To use the new timezone library, you also need to generate and include timezone-data for the timezones you plan to support (<a href="http://momentjs.com/timezone/data/)" rel="nofollow" target="_blank">http://momentjs.com/timezone/data/)</a> We'd have to include every timezone to create a universal solution. This seems better done by the individual developers so that they can tailor the code to the timezones they want to support.
   
   Updating the app.zip you attached, I'd have to do something like this (the tz-data could be in a separate file of course)
   
   <code><pre>
   var momentTZ = require('moment-timezone');
   momentTZ.tz.add({
       "zones": {
           "America/Los_Angeles": [
               "-7:52:58 - LMT 1883_10_18_12_7_2 -7:52:58",
               "-8 US P%sT 1946 -8",
               "-8 CA P%sT 1967 -8",
               "-8 US P%sT"
           ]
       },
       "rules": {
           "US": [
               "1918 1919 2 0 8 2 0 1 D",
               "1918 1919 9 0 8 2 0 0 S",
               "1942 1942 1 9 7 2 0 1 W",
               "1945 1945 7 14 7 23 1 1 P",
               "1945 1945 8 30 7 2 0 0 S",
               "1967 2006 9 0 8 2 0 0 S",
               "1967 1973 3 0 8 2 0 1 D",
               "1974 1974 0 6 7 2 0 1 D",
               "1975 1975 1 23 7 2 0 1 D",
               "1976 1986 3 0 8 2 0 1 D",
               "1987 2006 3 1 0 2 0 1 D",
               "2007 9999 2 8 0 2 0 1 D",
               "2007 9999 10 1 0 2 0 0 S"
           ],
           "CA": [
               "1948 1948 2 14 7 2 0 1 D",
               "1949 1949 0 1 7 2 0 0 S",
               "1950 1966 3 0 8 2 0 1 D",
               "1950 1961 8 0 8 2 0 0 S",
               "1962 1966 9 0 8 2 0 0 S"
           ]
       },
       "links": {}
   });
   alert("moment-timezone response:" + momentTZ().tz("America/Los_Angeles").format());
   </pre></code></li>
</ol>


<p><a href="/ALOY/ALOY-797.json">JSON Source</a></p>