---
title: "[ALOY-800] Add support for <Annotation> within <Module module="ti.map" method="createView" platform="android">"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-04-15T14:54:29.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.4.0, 2014 Sprint 08</td></tr>
<tr><th>Components</th><td>Titanium SDK, XML</td></tr>
<tr><th>Labels</th><td>notable, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Tim Poulsen</td></tr>
<tr><th>Assignee</th><td>Tim Poulsen</td></tr>
<tr><th>Created</th><td>2013-08-20T16:02:59.000+0000</td></tr>
<tr><th>Updated</th><td>2014-05-13T23:03:45.000+0000</td></tr>
</table>

<h3>Description</h3>

I would like to be able to add annotations to Android maps using the <Annotation> tag, and style them with the CSS. This will require a small change to store a reference to either the ti.map module or Ti.Map, for Android and iOS respectively.

Given this XML:
<code><pre>
&lt;!-- index.xml --&gt;
&lt;View ns="Ti.Map" id="map" platform="ios"&gt;
  &lt;!-- annotation styled via tss file --&gt;
  &lt;Annotation id="annotation1"/&gt;
&lt;/View&gt;
&lt;Module id="map" module="ti.map" method="createView" platform="android"&gt;
  &lt;Annotation id="annotation1"/&gt;
&lt;/Module&gt;
</pre></code>

The generated code would need to create a reference to the appropriate module, like this:
<code><pre>
/* Pseudo-code of the generated Resources/alloy/controllers/index.js */
// need a reference to the map module
$.__mapModule = (OS_ANDROID) require("ti.map") : Ti.Map;
// rest is pretty much the same, just using the map reference rather than Ti.Map explicitly
$.__views.map = $.__mapModule.createView({
    region: {
        latitude: 37.38,
        latitudeDelta: .2,
        longitude: -122.05,
        longitudeDelta: .2
    },
    id: "map"
});
$.__views.win.add($.__views.map);
$.__views.annotation1 = $.__mapModule.createAnnotation({
    title: "Mountain View",
    latitude: 37.389569,
    longitude: -122.050212,
    id: "annotation1"
});
</pre></code>


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/ALOY/ALOY-800_45895/MapsDemo.zip">MapsDemo.zip</td></td><td>2014-02-13T17:03:43.000+0000</td><td>3702940</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2013-08-20

   There are some platform-specific properties and constants that rely on the reference to the module, e.g. mapType: MapModule.TERRAIN_TYPE, where MapModule is a user-generated reference to ti.map.</li>
<li>Tim Poulsen 2014-02-13

   test app attached</li>
<li>Tim Poulsen 2014-02-13

   PR: <a href="https://github.com/appcelerator/alloy/pull/338" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/338</a>
   
   Test app: use the attached
   
   Functional test:
   
   1. Build the attached app for the iOS simulator or an Android device (or Genymotion emulator). This will not work on the stock Android emulator
   2. On iOS, the resulting app should have two maps, each with one annotation which are declared in the XML and styled in the TSS. The top map implements the iOS7 camera view. On Android, the app will have two maps, each with an annotation. Top map uses standard view type, the bottom map uses the terrain type.</li>
<li>Federico Casali 2014-05-13

   Verified working as expected.
   
   TiSDK  3.3.0.v20140513115438
   Alloy 1.4.0-dev
   Appcelerator Studio 3.3.0.201405011408
   CLI 3.3.0-dev
   
   Verified using both testing/ALOY-800 and attached sample code. 
   
   Closing.</li>
</ol>


<p><a href="/ALOY/ALOY-800.json">JSON Source</a></p>