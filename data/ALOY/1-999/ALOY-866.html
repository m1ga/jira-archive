---
title: "[ALOY-866] Only recompile app.js when necessary"
---
<table>
<tr><th>Type</th><td>Sub-task</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-10-30T19:33:32.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.3.0, 2013 Sprint 22</td></tr>
<tr><th>Components</th><td>Runtime, Tooling</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-10-30T15:53:14.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-07T22:26:02.000+0000</td></tr>
</table>

<h3>Description</h3>

app.js is recompiled on every build now. We should only rebuild when changes occur to the app.js, or alloy is compiled for a platform for which is has not already compiled (meaning it has not already generated a platform-specific app.js).

NOTE: We also need to consider source maps when doing this.

<h3>Comments</h3>

<ol>
<li>Tony Lukasavage 2013-10-30

   PR: <a href="https://github.com/appcelerator/alloy/pull/265" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/265</a>
   
   Functional testing:
   
   <h4>Create a default alloy app</h4>
   <h4>compile the app for ios with <code>alloy compile --platform ios</code></h4>
   <h4>Make sure you see the following line in the alloy log:</h4>
   <code><pre>
   [INFO] [app.js] Titanium entry point processing...
   [TRACE] - Processing "builtins" module...
   [TRACE] - Processing "optimizer" module...
   [TRACE] - Processing "compress" module...
   [INFO]   created:    "Resources/iphone/app.js"
   [DEBUG]  map:        "build/map/Resources/iphone/app.js.map"
   </pre></code>
   <h4>After the compile completes, run it again. This time you should see the following instead in the log:</h4>
   <code><pre>
   [INFO] [app.js] using cached app.js...
   </pre></code>
   <h4>Now, compile for a different platform, <code>alloy compile --platform android</code></h4>
   <h4>You should see a log similar to step 3, citing the android folders this time</h4>
   <h4>Compile again for android, and you should see a log like step 4</h4>
   <h4>GO back and compile again for ios. It should still use the cached app.js, since it is contained in the platform-specific folder and was not overwritten by our android testing. </h4>
   <h4>Make a change to the alloy.js and then compile for both android and ios. Both should generate a log as in step #3 the first time, then the log in step #4 on all subsequent builds.</h4></li>
</ol>


<p><a href="/ALOY/ALOY-866.json">JSON Source</a></p>