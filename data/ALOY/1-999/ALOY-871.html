---
title: "[ALOY-871] Custom TSS device queries"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-05-07T15:57:07.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.4.0</td></tr>
<tr><th>Components</th><td>Samples & Templates</td></tr>
<tr><th>Labels</th><td>notable, qe-testadded</td></tr>
<tr><th>Reporter</th><td>David Bankier</td></tr>
<tr><th>Assignee</th><td>Tim Poulsen</td></tr>
<tr><th>Created</th><td>2013-10-30T22:47:45.000+0000</td></tr>
<tr><th>Updated</th><td>2014-05-29T05:02:20.000+0000</td></tr>
</table>

<h3>Description</h3>

Currently alloy supports the tablet and handheld platform types. It would be nice if users could define custom platform types. For example a user could define in the alloy.js file

<code><pre>
exports.isSmalltablet = function() {
  return OS_ANDROID &&Ti.Platform.Android.physicalSizeCategory ===  Ti.Platform.Android.PHYSICAL_SIZE_CATEGORY_LARGE
}
</pre></code>

and then use <code><pre>platform=smalltablet</pre></code> in the xml and tss files.

<h3>Comments</h3>

<ol>
<li>David Bankier 2013-10-30

   Tony, I'm happy to work on it if you back the idea.</li>
<li>Malcolm Hollingsworth 2013-10-31

   Vote from me.</li>
<li>David Bankier 2013-10-31

   Only just saw this: <a href="https://github.com/appcelerator/alloy/pull/263" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/263</a>
   Guess I'm a day late...</li>
<li>Tony Lukasavage 2013-11-01

   [~mrahman] who is the original reporter of this issue? Can you please note that in situations where you don't preserve it?
   
   [~dbankier] and [~core13] since the conversation already started in that PR, please continue any more feedback there. 
   
   My opinion is that I like the idea of opening up conditionals in the TSS/XML, but definitely not with the <code>platform</code> keyword. <code>platform</code> has a specific meaning, and is unique in that unlike <code>formFactor</code>, <code>platform</code> is processed at compile time. As I stated in the github PR, I suggested a new field, like <code>condition</code>. We'll continue the conversation there.</li>
<li>Malcolm Hollingsworth 2013-11-01

   @Tony - I really like the idea of the new <code>condition</code> field, will say the same thing in the PR.</li>
<li>David Bankier 2013-11-02

   Sorry Tony, my original suggestion was meant to be on form factor but I like the if property on a Alloy.Global constant like you suggested in the PR.</li>
<li>Tim Poulsen 2014-03-28

   PR: <a href="https://github.com/appcelerator/alloy/pull/355" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/355</a>
   
   Functional test:
   
   <h4>Build the associated app for the iOS simulator. </h4>
   <h4>Compare the styles applied to the label to the rules defined in styles/index.tss</h4>
   <h4>From the simulator's Hardware menu, choose Device, then a different device to emulate. </h4>
   <h4>Once the simulator restarts, open the app again. Again, compare the styles applied to those defined.</h4>
   
   The if rules take precedence over other rules.
   </li>
<li>Fokke Zandbergen 2014-03-29

   Thx [~skypanther]! Some questions/ideas though:
   
   *-if=-*
   Looking at the code I understand why, but from the user/dev/syntax perspective I find the <code>if=</code> prefix confusing and unneeded. I mean, all conditionals *are* essentially <code>if</code>'s: *if*<code>[platform=ios]</code>, so when combining them you get: *if*<code>[platform=ios,if=Alloy.Globals.ios7]</code>. Why not just accept <code>[platform=ios,Alloy.globals.ios7]</code>. For the compiler, finding no <code>=</code> simply means assuming what is now done as <code>if=</code>.
   
   *XML*
   I don't see an implementation for supporting these custom conditionals in the XML. Is that coming as well?
   
   *CONSTANT_IOS7*
   Same for the controllers. I know this is more challenging. What about the following idea for both the TSS, XML and JS:  Instead of <code>Alloy.Globals.\*</code> introduce a specific namespace like <code>Alloy.Constants.\*</code>. In the TSS and XML skip the <code>if=</code> and just accept <code>Alloy.Constants.*</code>. In the JS accept <code>CONSTANT_IOS7</code> for <code>Alloy.Constants.iOS7</code>.</li>
<li>Tim Poulsen 2014-03-31

   I need a key/name to hook into in the styler.js script. Discussion on the original PR identified "if" as the preferred choice. There's an appeal to something like [ios,Alloy.globals.ios7] or [tablet,ios]. But we'd still need an attribute name in XML. Feel free to file a separate feature request. 
   
   XML - I'll amend my PR to accept the conditionals in the XML as well.
   
   CONSTANT_IOS7 - Since we already have one global object (Alloy.Globals), I don't see an advantage to adding another (Alloy.Constants) plus a varying set of aliases (CONSTANT_IOS7).</li>
<li>Fokke Zandbergen 2014-04-01

    You got me on the attribute name for XML.
    
    You are also right that in the controller you could just use <code>Alloy.Globals.myCondition</code> and since these are variables only known at run-time the compiler could not strip the code anyway, so forget about that too ;)
    
    Just the XML plz :)</li>
<li>Tim Poulsen 2014-04-01

    PR updated to handle XML now. The functional test app included in the PR now has an XML element demonstrating the new if attribute. </li>
<li>Tim Poulsen 2014-05-07

    PR for ALOY-1004 updates the sample apps for this ticket along with the advanced/custom_tss_queries sample. That PR has been merged, resolving this ticket.</li>
<li>Federico Casali 2014-05-07

    </li>
</ol>


<p><a href="/ALOY/ALOY-871.json">JSON Source</a></p>