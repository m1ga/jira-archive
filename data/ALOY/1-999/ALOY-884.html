---
title: "[ALOY-884] Errors removing orphaned sync adapters when using a widget-specific sync adapter"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-11-24T15:39:35.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.3.0, 2013 Sprint 24</td></tr>
<tr><th>Components</th><td>Models, Tooling</td></tr>
<tr><th>Labels</th><td>alloy, cli, compile, qe-port, sync, widgets</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Tony Lukasavage</td></tr>
<tr><th>Created</th><td>2013-11-23T12:42:42.000+0000</td></tr>
<tr><th>Updated</th><td>2013-12-05T20:27:10.000+0000</td></tr>
</table>

<h3>Description</h3>

After upgrading to Alloy 1.3.0-alpha3 I get errors when building a project that worked fine with Alloy 1.2.x:

<code><pre>
[DEBUG] ----- CLEANING RESOURCES -----
[DEBUG] Removing orphaned controllers...
[DEBUG] Removing orphaned models...
[DEBUG] Removing orphaned styles...
[DEBUG] Removing orphaned sync adapters...
[DEBUG] fs.js:760
[DEBUG]   return binding.unlink(pathModule._makeLong(path));
[DEBUG]                  ^
[ERROR] : EPERM, operation not permitted '/Users/zandbergen/dev/apps/VBG/Resources/iphone/alloy/sync/nl.fokkezb.titabs.gcal
</pre></code>

The problem seems to be that I have widgets that ship with their own custom sync adapter. The sync adapter is provided via:

<code><pre>
/app/widgets/nl.fokkezb.titabs.gcal/assets/alloy/sync/restapi.js
</pre></code>

After the build stops on this error, the file *does* exist under the displayed Resources path.

<h3>Comments</h3>

<ol>
<li>Tony Lukasavage 2013-11-23

   PR: <a href="https://github.com/appcelerator/alloy/pull/278" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/278</a>
   test app: <a href="https://github.com/appcelerator/alloy/tree/master/test/apps/testing/ALOY-884" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/tree/master/test/apps/testing/ALOY-884</a>
   
   Functional test
   
   "Compile" = "alloy compile --platform ios"
   
   <h4>Compile the test app once. This should work without error.</h4>
   <h4>Compile the test app again. This should again work without error.</h4>
   
   Prior to this fix, step 2 would cause the error shown in the description above. It is not necessary to do any runtime evaluation to confirm that this bug is fixed.</li>
<li>Fokke Zandbergen 2013-11-23

   It seemed fixed, but of course cleaning up is only relevant the second run and then it still crashes. When I run the ALOY-884 test using jake and then compile the generated Harness project a second or more time is passes. So I need to check what the difference is with my project(s).</li>
<li>Fokke Zandbergen 2013-11-23

   If you run just <code>alloy compile --platform ios</code> it passes, but when you run <code>ti build -p ios</code> multiple times it fails after the first build. This is true for both my project and the Harness project generated by <code>jake app:run dir=testing/ALOY-884</code>. Note that after generating the project you need to change to its root and run <code>ti build -p ios</code> from there because jake will just generate a new project every time.</li>
<li>Tony Lukasavage 2013-11-24

   re-opening to look at [~fokke]'s case</li>
<li>Tony Lukasavage 2013-11-24

   </li>
<li>Fokke Zandbergen 2013-11-25

   </li>
<li>Federico Casali 2013-12-05

   Cannot reproduce also following latest comments from Tony and Fokke. 
   
   TiSDK 3.2.0.v20131204220843
   CLI 3.2.0-beta
   Alloy 1.3.0-beta
   
   Closing.</li>
</ol>


<p><a href="/ALOY/ALOY-884.json">JSON Source</a></p>