---
title: "[ALOY-907] JavaScript syntax error output is incorrect and confusing"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-12-20T20:27:10.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.4.0, Alloy 1.3.1, 2013 Sprint 26</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Chris Barber</td></tr>
<tr><th>Assignee</th><td>Tony Lukasavage</td></tr>
<tr><th>Created</th><td>2013-12-20T19:14:46.000+0000</td></tr>
<tr><th>Updated</th><td>2014-02-05T17:53:34.000+0000</td></tr>
</table>

<h3>Description</h3>

When building an Alloy app with the following in the index.js controller:

<code><pre>
function doClick(e) {
    alert($.label.text);
}

$.index.open(){};
</pre></code>

Alloy outputs the following error:

<code><pre>
[WARN]  : ERROR: Unexpected token: punc ({) [null:5,14]
[DEBUG]
[DEBUG] C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:199
[ERROR] (message, line, col, pos);
[DEBUG]           ^
[ERROR]
[ERROR] (C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:185:18)
[ERROR] (C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:199:11)
[DEBUG]     at croak (C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:630:9)
[ERROR] (C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:638:9)
[DEBUG]     at unexpected (C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:644:9)
[DEBUG]     at semicolon (C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:664:43)
[DEBUG]     at simple_statement (C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:822:73)
[DEBUG]     at C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:707:19
[DEBUG]     at C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:677:24
[DEBUG]     at C:\Users\Thomas Anderson\AppData\Roaming\npm\node_modules\alloy\node_modules\uglify-js\lib\parse.js:1395:23
[ERROR] Alloy compiler failed
</pre></code>

There are multiple problems with this output:

1) The error is printed as a warning
2) Nowhere does it indicate the actual filename containing the error
3) It displays the entire stack trace of the Alloy code which is irrelevant to the user's app

To resolve this, Alloy should:

1) Show the output as an error, not a warning
2) Show the filename in which the error is found
3) Do not show the stack trace
4) The error should be displayed similar to the Titanium CLI which would look like:

<code><pre>
[ERROR] Failed to minify C:\Users\Thomas Anderson\Documents\Appcelerator_Studio_Workspace\testapp\app\controllers\index.js
[ERROR] Unexpected token: punc ({) [line 5, column 14]
[ERROR]   
[ERROR]     $.index.open(){};
[ERROR]     --------------^
[ERROR]
</pre></code>

<h3>Comments</h3>

<ol>
<li>Tony Lukasavage 2013-12-20

   commit: <a href="https://github.com/appcelerator/alloy/commit/063cd1b6c597044a81314582548a0c5472d22255" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/commit/063cd1b6c597044a81314582548a0c5472d22255</a>
   
   Merged in both master and 1_3_X
   
   <h4>functional test</h4>
   
   <h4>Use the test app from the description</h4>
   <h4>Compile alloy: <code>alloy compile --platform ios</code></h4>
   <h4>Assert that you now get a specific error with the stack trace suppressed, looking something like this:</h4>
   <code><pre>
   [ERROR] Error generating AST for "/Users/tlukasavage/Development/backwards/app/controllers/index.js"
   [ERROR] Unexpected token: punc ({)
   [ERROR] line 5, column 14, position 64
   </pre></code></li>
<li>Olga Romero 2014-01-08

   Tested the app from description.
   <h4>Actual result</h4>
   <code><pre>
   [WARN] :   : ERROR: Unexpected token: punc ({) [null:5,14]
   [ERROR] :  Error generating AST for "/Users/oromero/Documents/Appcelerator_Studio_Workspace2/before/app/controllers/index.js"
   [ERROR] :  Unexpected token: punc ({)
   [ERROR] :  line 5, column 14, position 64
   [ERROR] :  Alloy compiler failed
   </pre></code>
   
   Environment:
   Mac osx 10.9.1
   Appcelerator Studio, build: 3.2.1.201401071645
   Titanium SDK, build: 3.2.1.v20140106195644
   Titanium SDK, build: 3.3.0.v20140106195650
   Node.JS Version: v0.10.13
   NPM Version: 1.3.2
   ├── acs@1.0.11
   ├── alloy@1.3.1-beta
   ├── npm@1.3.2
   ├── titanium@3.2.0
   └── titanium-code-processor@1.1.0
   └── titanium@3.2.0 
   </li>
</ol>


<p><a href="/ALOY/ALOY-907.json">JSON Source</a></p>