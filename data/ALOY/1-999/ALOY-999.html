---
title: "[ALOY-999] Alloy: Add Compile time defines functionality"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Alloy 1.3.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Neville Dastur</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2014-04-20T17:07:48.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-07T22:25:52.000+0000</td></tr>
</table>

<h3>Description</h3>

In most build environments constants can be defined at build time. E.g. -D for  make. This allows us to define a string such as the Git revision of the build or the build time. It would be great if alloy had this ability.

I tried doing it via manipulation of config.json in alloy.jmk, but pre-compile is invoked further into the compile process.

A hook where I could do this would be great:

<code><pre>
task("pre:true-precompile",function(event,logger){
   var now = new Date();

    // Either this ....
    event.alloyConfig.buildDate = now.toUTCString();

    // ... or this
    var fs = require('fs');
    fs.readFile(event.dir.project + '/app/config.json', function(err, data) {
    	var config = JSON.parse( data );

    	config.global.buildDate = now.toUTCString();

    	var newConfig = JSON.stringify( config, null, 4);

    	fs.writeFile(event.dir.project + '/app/config.json', newConfig, function (err) {
		  if (err) throw err;
		  logger.info('New config.json saved.');
		}); 
	});

});
</pre></code>

<h3>Comments</h3>

<ol>
<li>Ritu Agrawal 2014-04-30

   Moving this improvement request to engineering for further evaluation and prioritization.</li>
<li>Neville Dastur 2015-06-02

   Having passed 1st year anniversary I thought I would ask if it was for consideration? Thanks ;)</li>
</ol>


<p><a href="/ALOY/ALOY-999.json">JSON Source</a></p>