---
title: "[ALOY-1149] iOS: Gradient array properties are converted into objects"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-10-02T21:15:15.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Alloy 1.5.0</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.5.1</td></tr>
<tr><th>Components</th><td>Styling</td></tr>
<tr><th>Labels</th><td>qe-3.4.0, qe-manualtest, regression</td></tr>
<tr><th>Reporter</th><td>Federico Casali</td></tr>
<tr><th>Assignee</th><td>Tim Poulsen</td></tr>
<tr><th>Created</th><td>2014-09-26T22:33:46.000+0000</td></tr>
<tr><th>Updated</th><td>2014-11-19T00:07:39.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
Gradients contain properties as array, for example the 'color' property. 
In Alloy, those properties are now converted and passed as objects and an app is crashing if using those properties. 

The issue seems to be introduced after ALOY-1051 as is not reproducible using Alloy version 1.4.1 (and Alloy 1.5.0-rc3 as well - see ALOY-1146, where a regression was introduced breaking Aloy-1051), but is reproducible with Alloy 1.5.0-rc, 1.5.0-rc2 and 1.5.0-rc5.
Is therefore a regression.

<h4>Steps to reproduce</h4>
1. Grab the sample code for ALOY-717 : <a href="https://github.com/appcelerator/alloy/tree/master/test/apps/testing/ALOY-717" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/tree/master/test/apps/testing/ALOY-717</a>
2. Run the sample app on iOS (any version)
Result: App crashes with an "Application Error - Invalid type passed to function at alloy.js"
See error log attached and screenshot. 

3. Edit index.tss and comment the 'colors' property for .bgGradient class:
<code><pre>
'.bgGradient': {
	backgroundGradient: {
		type: 'linear',
        startPoint: { x: '0%', y: '50%' },
        endPoint: { x: '100%', y: '50%' },
        // colors: [
        	// { color: 'red', offset: 0.0},
        	// { color: 'blue', offset: 0.25 },
        	// { color: 'red', offset: 1.0 }
        // ],
	}
}
</pre></code>
and run on iOS devices
Result: app runs fine and no error are thrown. 


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/ALOY/ALOY-1149_51650/gradient_error_log.txt">gradient_error_log.txt</td></td><td>2014-09-26T22:33:46.000+0000</td><td>875</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/ALOY/ALOY-1149_51651/IMG_0452.PNG">IMG_0452.PNG</td></td><td>2014-09-26T22:33:46.000+0000</td><td>67830</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2014-09-29

   PR for 1_5_X <a href="https://github.com/appcelerator/alloy/pull/579" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/579</a>
   
   Since arrays as members of an object seem to be the trigger for this issue, it's probably best to test with any  attributes that accept arrays:
   
   Attributes that accept objects with nested arrays: 
   * backgroundGradient
   * attributedString
   
   Attributes that accept arrays of strings:
   * emailDialog.toRecipients, ccRecipients, bccRecipients
   </li>
<li>Tim Poulsen 2014-10-01

   PR merged in prep for a 1.5.1-rc release</li>
<li>Federico Casali 2014-10-02

   Verified fixed
   
   TiSDK 3.4.0.GA
   Appcelerator Studio 3.4.0.GA
   CLI 3.4.0.GA
   Alloy 1.5.1-rc
   Xcode 6 - iPhone 5, iPhone 6 (iOS 8), Android and MobileWeb
   
   Closing. </li>
<li>Federico Casali 2014-10-02

   Note: With this change, backgroundGradient properties will not be deep merged when using Dynamic Styles as they would be if specified in the TSS/XML files. The last style applied wins.</li>
</ol>


<p><a href="/ALOY/ALOY-1149.json">JSON Source</a></p>