---
title: "[ALOY-1168] Replace underscore with Lo-Dash"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 2.0.0</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Tim Poulsen</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2014-10-15T17:06:40.000+0000</td></tr>
<tr><th>Updated</th><td>2019-08-08T09:54:18.000+0000</td></tr>
</table>

<h3>Description</h3>

Investigate the ramifications of replacing underscore with Lo-Dash. Test Alloy compile-time and runtime code to determine what changes would be needed. 

Create a plan for deprecating, then replacing underscore, if that's the option we take. This will include documenting any differences for developers.

Underscore 1.7.* is incompatible with Alloy. So if we stick with that, we'll need a ticket to update Alloy to support the newest underscore releases.


<h3>Comments</h3>

<ol>
<li>Malcolm Hollingsworth 2014-10-15

   What changed and to what degree that means underscore is no longer a viable library? If one or two things; baby and bath water comes to mind. If everything - then how did this happen on a dot update? </li>
<li>Tim Poulsen 2014-10-15

   With ALOY-1159 we'll be updating to Underscore 1.6.0. The key change between it and 1.7 seems to be:
   
   {quote}
   "Underscore templates no longer accept an initial data object. <code>_.template</code> always returns a function now."
   {quote}
   
    from <a href="http://underscorejs.org/#changelog" rel="nofollow" target="_blank">http://underscorejs.org/#changelog</a> However, even accounting for that difference, the Alloy compiler errors out with a ".split is not a method of undefined" error. The fix for that might be easy, and might be the ultimate change here.
   
   Lodash offers an underscore-compatible version, is faster, offers additional methods which are not provided by underscore, and provides more consistent APIs. See <a href="http://stackoverflow.com/a/13898916/292947" rel="nofollow" target="_blank">http://stackoverflow.com/a/13898916/292947</a> for example. There's also a Backbone-only subset, which devs could possibly drop in for greater speed / smaller size if they're not using other functions. 
   
   If we go with lodash, we would use the underscore version and expose it within Alloy as the <code>_</code> variable so that the change should be transparent to developers. 
   
   </li>
<li>Creative 2015-06-23

   This priority should be higher, the performance and extra functions are a huge help for development.
   
   I've personally added it myself in the Alloy.js file already (by overriding the <code>_</code> variable) but sadly it is overwritten during compilation on each <code>app/models/*.js</code> file, so I cant use it everywhere.
   
   It would be a really nice feature to actually edit the <code>alloy.js</code> yourself, because its very unclear that additional javascript is added during compiletime. Why dont we just have a one-time-only generated alloy.js? </li>
<li>Creative 2015-11-25

   Can we increase the priority for this improvement?
   
   Perhaps even we should aim for a setup where the end user can use an <code>alloypackage.json</code> to decide which packages to require (but somehow still have a default package.json shipped with Alloy which is overwritable and in the root of the project dir).
   
   Imagine a package.json where all modules are automagically loaded into the Alloy namespace...</li>
<li>Brenton House 2016-03-15

   I am getting ready to replace underscore w/ lodash and can submit a PR when it is finished, if so desired.  Is there any reason that the underscore used by the build is tied to the underscore used by the app?  Can those two be separated so that Alloy build uses its own underscore/lodash and the app has its own version?   Thanks!</li>
<li>Brenton House 2016-03-16

   </li>
<li>Feon Sua Xin Miao 2017-12-12

   PR: <a href="https://github.com/appcelerator/alloy/pull/862" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/862</a>
   Note: the pr only take <code>lodash</code> as an npm dependency and use it internally by the Alloy complier.</li>
<li>Feon Sua Xin Miao 2017-12-12

   <a href="https://github.com/appcelerator/alloy/pull/842" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/842</a> includes a version of <code>lodash</code> in the <code>lib</code> folder.</li>
<li>Hans Kn√∂chel 2019-08-08

   Was the lodash change ever merged to Alloy or does it still use Underscore? </li>
<li>Ewan Harris 2019-08-08

    At runtime, alloy still uses underscore. I'll add this into the "Alloy 2.0.0" release just to keep it on my radar</li>
</ol>


<p><a href="/ALOY/ALOY-1168.json">JSON Source</a></p>