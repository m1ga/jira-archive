---
title: "[ALOY-1174] Update sync adapters to support promises in addition to callbacks"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-10-28T15:14:26.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.6.0, Alloy 1.7.0</td></tr>
<tr><th>Components</th><td>Models</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Tim Poulsen</td></tr>
<tr><th>Assignee</th><td>Tim Poulsen</td></tr>
<tr><th>Created</th><td>2014-10-20T19:57:12.000+0000</td></tr>
<tr><th>Updated</th><td>2015-02-14T02:35:25.000+0000</td></tr>
</table>

<h3>Description</h3>

Per comments at [Hacking alloy to get promises to work](<a href="https://github.com/aaronksaunders/tiConnectSampleApp#hacking-of-alloyjs-to-get-promises-to-work)" rel="nofollow" target="_blank">https://github.com/aaronksaunders/tiConnectSampleApp#hacking-of-alloyjs-to-get-promises-to-work)</a>, the core model/collection constructors could be modified simply to support using promises in addition to callbacks. As shown in [Aaron's TiConnect sample](<a href="https://github.com/aaronksaunders/tiConnectSampleApp/blob/master/app/alloy.js#L22)" rel="nofollow" target="_blank">https://github.com/aaronksaunders/tiConnectSampleApp/blob/master/app/alloy.js#L22)</a> the change involves returning the results of the sync call.

Resolving this cannot break existing apps, so extensive testing should be done on all platforms.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/ALOY/ALOY-1174_54111/app.zip">app.zip</td></td><td>2015-02-12T20:46:47.000+0000</td><td>5935536</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2014-10-28

   Community PR for this: <a href="https://github.com/appcelerator/alloy/pull/613" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/613</a>
   
   Passes all tests, all models/* test apps run without issues. Merged.</li>
<li>Feon Sua Xin Miao 2015-01-13

   Backport to 1_6_X : <a href="https://github.com/appcelerator/alloy/pull/655" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/655</a></li>
<li>Tim Poulsen 2015-01-13

   Note to testers: you should be able to build any/all of the test apps that use models/collections without change or errors</li>
<li>Tim Poulsen 2015-02-12

   App that demonstrates the use of promises attached.
   
   The key is the doClick() function in the index.js controller. You'll see that it's fetching from the collection, which now has a new property of <code>promise</code> which contains a promise object. That object's then() method is used to display data when the JSON data source finally returns the data.
   
   If you look to the lib/alloy/sync/customAdapter.js file, you'll see that we're creating and returning a promise.
   
   Perhaps the adapter could be rewritten without the superagent library. But since it is designed to work with promises, it was easiest to adapt Aaron's sample app code keeping superagent in there.</li>
</ol>


<p><a href="/ALOY/ALOY-1174.json">JSON Source</a></p>