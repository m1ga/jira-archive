---
title: "[ALOY-1175] Cannot call methods or access properties on MenuItems declared in markup"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-10-27T14:34:46.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Alloy 1.6.0</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.6.0</td></tr>
<tr><th>Components</th><td>XML</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Benjamin Hatfield</td></tr>
<tr><th>Assignee</th><td>Tim Poulsen</td></tr>
<tr><th>Created</th><td>2014-10-21T21:09:04.000+0000</td></tr>
<tr><th>Updated</th><td>2015-06-25T10:16:23.000+0000</td></tr>
</table>

<h3>Description</h3>

DESCRIPTION:
Cannot call methods or access properties using the <code>id</code> attribute of MenuItems created in XML markup.
Related feature ticket: ALOY-1098

REPRODUCTION:
Run the Alloy application below.  Hit the Expand or Collapse action items or try to expand the action view from the overflow menu.

RESULTS:
Trying to call a method or accessing a property results in 'Cannot read property of undefined<code> or </code>Cannot call method X of undefined<code>.

{noformat}
[ERROR] :  TiExceptionHandler: (main) [3824,3824] ----- Titanium Javascript Runtime Error -----
[ERROR] :  TiExceptionHandler: (main) [0,3824] - In alloy/controllers/index.js:70,28
[ERROR] :  TiExceptionHandler: (main) [1,3825] - Message: Uncaught TypeError: Cannot read property 'actionViewExpanded' of undefined
[ERROR] :  TiExceptionHandler: (main) [0,3825] - Source:         Ti.API.info($.item3.actionViewExpanded);
[ERROR] :  V8Exception: Exception occurred at alloy/controllers/index.js:70: Uncaught TypeError: Cannot read property 'actionViewExpanded' of undefined
{noformat}





</code>index.xml<code>
&lt;code&gt;&lt;pre&gt;
&lt;Alloy&gt;
    &lt;Window id="win"&gt;
        &lt;Menu&gt;
            &lt;MenuItem id="item1" title="Expand" onClick="expand" showAsAction="Titanium.Android.SHOW_AS_ACTION_IF_ROOM" /&gt;
            &lt;MenuItem id="item2" title="Collapse" onClick="collapse" showAsAction="Titanium.Android.SHOW_AS_ACTION_IF_ROOM" /&gt;
            &lt;MenuItem id="item3" title="Alt Text" showAsAction="Titanium.Android.SHOW_AS_ACTION_COLLAPSE_ACTION_VIEW" onExpand="report" onCollapse="report"&gt;
                &lt;ActionView&gt;
                	&lt;View layout="horizontal"&gt;
                    	&lt;Button left="0"&gt;Search&lt;/Button&gt;
                    	&lt;TextField right="0" hintText="Type Something"/&gt;
                    &lt;/View&gt;
                &lt;/ActionView&gt;
            &lt;/MenuItem&gt;
        &lt;/Menu&gt;            
    &lt;/Window&gt;
&lt;/Alloy&gt;
&lt;/pre&gt;&lt;/code&gt;

</code>index.js`
<code><pre>
$.win.open();

function expand (e) {
	$.item3.expandActionView();
};

function collapse(e) {
	$.item3.collapseActionView();
}

function report(e) {
	Ti.API.info(e.type);
	Ti.API.info($.item3.actionViewExpanded);
}
</pre></code>

Classic Examples:
<code><pre>
var win = Ti.UI.createWindow();
var item1 = item2 = item3 = null;
var actionView = Ti.UI.createView({layout: 'horizontal'});
actionView.add(Ti.UI.createButton({title: 'Search', left: 0}));
actionView.add(Ti.UI.createTextField({hintText: 'Type Something', right: '0'}));
win.addEventListener("open", function() {

    win.activity.onCreateOptionsMenu = function(e) {
        var item, menu;
        menu = e.menu;
        menu.clear();
        item1 = menu.add({
            title : "Collapse",
            showAsAction: Ti.Android.SHOW_AS_ACTION_ALWAYS
        });
		item1.addEventListener('click', function (e) {
			item3.collapseActionView();
		});
        item2 = menu.add({
            title : "Expand",
            showAsAction : Ti.Android.SHOW_AS_ACTION_ALWAYS
        });
        item2.addEventListener('click', function (e) {
			item3.expandActionView();
		});
        item3 = menu.add({
        	title : 'Alt Text',
        	showAsAction : Titanium.Android.SHOW_AS_ACTION_COLLAPSE_ACTION_VIEW,
        	actionView: actionView
        });
        item3.addEventListener('collapse', function(e) {
        	Ti.API.info(item3.actionViewExpanded);
        });
        item3.addEventListener('expand', function(e) {
        	Ti.API.info(item3.actionViewExpanded);
        });
    };
});

win.open();
</pre></code>



<h3>Comments</h3>

<ol>
<li>Federico Casali 2014-10-21

   </li>
<li>Tim Poulsen 2014-10-23

   PR <a href="https://github.com/appcelerator/alloy/pull/597" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/597</a>
   
   Functional test:
   
   You can use Ben's app above or the one included with the PR (test/apps/testing/ALOY\-1175). Run on Android. Click Expand, then Back (or title icon). Click Collapse. Expand the menu and click Item 3. You should not get errors and the action view should be expanded/collapsed as expected.</li>
<li>Tim Poulsen 2014-10-24

   Because this & ALOY-1098 depend upon each other, I've combined the fix into a single PR for 1_6_X
   
   <a href="https://github.com/appcelerator/alloy/pull/606" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/606</a>
   
   Test this using the ALOY\-1175 test app included in the PR</li>
<li>Feon Sua Xin Miao 2014-10-27

   PR merged.</li>
<li>Eric Wieber 2015-03-25

   Verified fixed using:
   
   Titanium SDK 4.0.0.v20150323131014
   Studio 4.0.0.201503231407
   Appc NPM: 0.3.34
   Appc CLI 0.2.187
   Alloy 1.6.0-alpha
   
   On: Nexus 6, Android 5.0.1
   
   Able to call methods and access properties on items in view xml. No errors shown.</li>
</ol>


<p><a href="/ALOY/ALOY-1175.json">JSON Source</a></p>