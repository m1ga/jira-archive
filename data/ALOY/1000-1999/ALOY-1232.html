---
title: "[ALOY-1232] --deploy-type ignored on android builds for emulator and device"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-02-17T15:17:09.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.6.0</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>TCSupport, alloy-configuration, android, cli</td></tr>
<tr><th>Reporter</th><td>Pablo Guevara</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2014-12-22T21:51:49.000+0000</td></tr>
<tr><th>Updated</th><td>2015-03-25T19:42:49.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem Description</h4>
The argument --deploy-type or -D is ignored if the target is android, always generating 'development' for emulator and 'test' for device, even if specified the other way. iOS works fine. I didn't test all the others platforms.

<h4>Steps to reproduce</h4>
Since we use these settings to trigger our testing scripts, figured I'd give it a test. Ti.App.deployType seems to work fine here. But your settings from the config.json file do not.
added the following to my alloy.js to test faster:
<code><pre>
console.log('Ti.App.deployType: ', Ti.App.deployType);
console.log('Alloy.CFG: ', Alloy.CFG);
</pre></code>

Results:
Genymotion Google Nexus 5 - 5.0.0 - API 21 - 1080x1920 (5.0.0)
<code><pre>
[INFO]  Ti.App.deployType:  test
[INFO]  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
</pre></code>
<code><pre>
[INFO]  Ti.App.deployType:  development
[INFO]  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
</pre></code>

Genymotion Samsung Galaxy S5 - 4.4.4 - API 19 - 1080x1920 (4.4.4)
<code><pre>
[INFO]  Ti.App.deployType:  test
[INFO]  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
</pre></code>
<code><pre>
[INFO]  Ti.App.deployType:  development
[INFO]  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
</pre></code>

Device Samsung S4
<code><pre>
12-22 20:32:56.028: I/TiAPI(17077):  Ti.App.deployType:  development
12-22 20:32:56.028: I/TiAPI(17077):  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
</pre></code>
<code><pre>
12-22 20:34:35.465: I/TiAPI(18183):  Ti.App.deployType:  test
12-22 20:34:35.475: I/TiAPI(18183):  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
</pre></code>

<h4>Steps to reproduce</h4>
I used these commands for testing:
<code><pre>
ti build -p android -D development --device-id ?
</pre></code>

<code><pre>
ti build -p android -D test --device-id ?
</pre></code>

<code><pre>
ti build -p android -D development -T device
</pre></code>

<code><pre>
ti build -p android -D test -T device
</pre></code>

<h4>Extra info</h4>
Seems like CFG.js doesn't get updated under resources once you switch the deployType flag. Deleting the content of Resources (aka forcing regeneration of CFG.js) will go and use the right config.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-1232_53332/Test.zip">Test.zip</td></td><td>2014-12-22T21:51:49.000+0000</td><td>331498</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Stephen Feather 2014-12-23

   Since we use these settings to trigger our testing scripts, figured I'd give it a test. Ti.App.deployType seems to work fine here. But your settings from the config.json file do not.
   added the following to my alloy.js to test faster:
   <code><pre>
   console.log('Ti.App.deployType: ', Ti.App.deployType);
   console.log('Alloy.CFG: ', Alloy.CFG);
   </pre></code>
   
   Results:
   Genymotion Google Nexus 5 - 5.0.0 - API 21 - 1080x1920 (5.0.0)
   <code><pre>
   [INFO]  Ti.App.deployType:  test
   [INFO]  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
   </pre></code>
   <code><pre>
   [INFO]  Ti.App.deployType:  development
   [INFO]  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
   </pre></code>
   
   Genymotion Samsung Galaxy S5 - 4.4.4 - API 19 - 1080x1920 (4.4.4)
   <code><pre>
   [INFO]  Ti.App.deployType:  test
   [INFO]  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
   </pre></code>
   <code><pre>
   [INFO]  Ti.App.deployType:  development
   [INFO]  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
   </pre></code>
   
   Device Samsung S4
   <code><pre>
   12-22 20:32:56.028: I/TiAPI(17077):  Ti.App.deployType:  development
   12-22 20:32:56.028: I/TiAPI(17077):  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
   </pre></code>
   <code><pre>
   12-22 20:34:35.465: I/TiAPI(18183):  Ti.App.deployType:  test
   12-22 20:34:35.475: I/TiAPI(18183):  Alloy.CFG:  {"dependencies":{},"TEST_STRING":"TEST ENV"}
   </pre></code></li>
<li>Cesar Cavazos 2015-01-29

   My 2 cents here:
   
   Seems like CFG.js doesn't get updated under resources once you switch the deployType flag. Deleting the content of Resources (aka forcing regeneration of CFG.js) will go and use the right config.</li>
<li>Mauro Parra-Miranda 2015-01-29

   [~pablog178] is the original reporter for this ticket. </li>
<li>Tim Poulsen 2015-02-04

   I think this is solved by the change in ALOY-1206. [~mpmiranda] could you test and confirm with the customer that this would resolve their issue? </li>
<li>Feon Sua Xin Miao 2015-02-16

   PR: <a href="https://github.com/appcelerator/alloy/pull/665" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/665</a>
   
   Functional Test:
   Follow the steps to reproduce stated above, and confirm that <code>Resources/alloy/CFG.js</code> has the correct <code>TEST_STRING</code> value for each android build.
   <code><pre>
   // device
   ti build -p android -D development -T device --device-id xxx // should be DEV ENV
   ti build -p android -D test -T device --device-id xxx // should be TEST ENV
   
   // emulator
   ti build -p android -D development  // should be DEV ENV
   ti build -p android -D test // should be TEST ENV
   </pre></code></li>
<li>Tim Poulsen 2015-02-17

   FR & CR pass, merged to master, cherry-picked to 1_6_X</li>
<li>Eric Wieber 2015-03-25

   Verified fixed using:
   
   Titanium SDK 4.0.0.v20150323131014
   Studio 4.0.0.201503231407
   Appc NPM: 0.3.34
   Appc CLI 0.2.187
   Alloy 1.6.0-alpha
   
   The correct <code>TEST_STRING</code> is printed when using <code>-D development</code> and <code>-D test</code>.</li>
</ol>


<p><a href="/ALOY/ALOY-1232.json">JSON Source</a></p>