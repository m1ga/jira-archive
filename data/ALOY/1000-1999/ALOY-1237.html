---
title: "[ALOY-1237] Alloy: Remove all event listeners added via view in $.destroy()"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-05-29T10:52:27.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Alloy 1.5.1</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.7.0</td></tr>
<tr><th>Components</th><td>Runtime</td></tr>
<tr><th>Labels</th><td>events, views</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Tim Poulsen</td></tr>
<tr><th>Created</th><td>2015-02-10T11:57:42.000+0000</td></tr>
<tr><th>Updated</th><td>2015-09-16T06:30:08.000+0000</td></tr>
</table>

<h3>Description</h3>

Too make it easier for developers to clean up the event listeners they've added via the XML view (<code>onClick</code> and other attributes), could we make it so that if you add an event listener that way, that it would also be removed in the <code>$.destroy()</code> method?

The developer would still be responsible for calling that method and for removing listeners he added in the controller, but it would align nicely with the current behaviour of the method where it also cleans up a listener added via the view, which is for the <code><Collection></code> or <code><Model</code>> tag.

For reference:
<a href="https://github.com/appcelerator/alloy/blob/master/test/apps/basics/markup_events/_generated/ios/alloy/controllers/index.js#L44-L49" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/blob/master/test/apps/basics/markup_events/_generated/ios/alloy/controllers/index.js#L44-L49</a>

Perhaps the <code>__defers</code> object could be used for this in some way?

We could even go as far as extending the Backbone <code>$.listenTo()</code> method that if its first argument is a proxy, then it would both pass it on to that proxies' <code>addEventListener</code> method and queue it for removal in <code>$.destroy</code> at the same time.

<h3>Comments</h3>

<ol>
<li>Feon Sua Xin Miao 2015-05-29

   PR merged.</li>
<li>Andrey Tkachenko 2015-09-04

   I have installed Alloy 1.7.6
   Markup of My View:
   <code><pre>
   <Alloy>
   	<View  onClick="onClick" />
   </Alloy>
   </pre></code>
   
   After compile I found empty destroy method body:
   
   <code><pre>
   exports.destroy = function() {};
   </pre></code>
   
   Is it should contains unsubscribe code?
   
   
   
   
   <a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Alloy.Controller-method-destroy</li>
<li>Fokke Zandbergen 2015-09-04

   [~falko] it looks like you're right. The <code>$.destroy()</code> functions should call <code>$.removeListener()</code>.
   
   [~k0sukey] see <a href="https://github.com/appcelerator/alloy/pull/671#issuecomment-137712880" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/671#issuecomment-137712880</a></li>
</ol>


<p><a href="/ALOY/ALOY-1237.json">JSON Source</a></p>