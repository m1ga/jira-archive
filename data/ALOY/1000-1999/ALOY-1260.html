---
title: "[ALOY-1260] Windowsphone not in platforms list in manifest.json"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-04-13T17:39:53.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Alloy 1.6.0</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.6.0</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>qe-4.0.0</td></tr>
<tr><th>Reporter</th><td>Eric Wieber</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2015-04-03T18:26:39.000+0000</td></tr>
<tr><th>Updated</th><td>2015-04-20T21:15:56.000+0000</td></tr>
</table>

<h3>Description</h3>

The manifest.json in the SDK is missing windowsphone (or windows) from the platforms array. This is causing windowsphone assets to be in a default alloy project on Mac, as well as windowsphone assets to be included in a packaged APK, on Mac.
File is: <code>Titanium/mobilesdk/osx/4.0.0.Beta2/manifest.json</code>

*Steps to reproduce issue*:
1. Open Studio
2. Create a new project (default Alloy template)
3. Package the project for Android store
4. Navigate to the APK and rename it to a .zip file
5. Extract the zip

*Actual Results*:
2. Notice that there is a windowsphone folder/assets in the <code>app/assets</code> folder
5. Notice that there are windowsphone assets in <code>/assets/Resources</code> of the extracted APK

*Expected Results*:
There should not be windowsphone resources in the project or APK

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-1260_54797/Screen Shot 2015-04-03 at 11.06.43 AM.png">Screen Shot 2015-04-03 at 11.06.43 AM.png</td></td><td>2015-04-03T18:26:39.000+0000</td><td>162111</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-1260_54798/Screen Shot 2015-04-03 at 11.20.17 AM.png">Screen Shot 2015-04-03 at 11.20.17 AM.png</td></td><td>2015-04-03T18:26:39.000+0000</td><td>37172</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2015-04-03

   Please note that the fix is not to add it to the manifest, but rather, remove the assets.</li>
<li>Chris Barber 2015-04-03

   [~ingo] Sorry, but you are wrong. The suggested fix is the appropriate fix.
   
   <a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/cli/commands/_build.js#L2472-L2480" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/cli/commands/_build.js#L2472-L2480</a>
   
   <code><pre>
   function (cb) {
   	var src = path.join(this.projectDir, 'Resources');
   	warnDupeDrawableFolders.call(this, src);
   	copyDir.call(this, {
   		src: src,
   		dest: this.buildBinAssetsResourcesDir,
   		ignoreRootDirs: ti.availablePlatformsNames // &lt;----------- ['android', 'iphone', 'mobileweb']
   	}, cb);
   },
   </pre></code>
   
   <code>ti.availablePlatformsNames</code> is the array of platforms from the manifest.json file. As we copy files from the Resources directory, we ignore all directories that have a name of another platform.
   
   iOS does the same thing: <a href="https://github.com/appcelerator/titanium_mobile/blob/master/iphone/cli/commands/_build.js#L3470-L3476" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/iphone/cli/commands/_build.js#L3470-L3476</a>
   
   So does Mobile Web: <a href="https://github.com/appcelerator/titanium_mobile/blob/master/mobileweb/cli/commands/_build.js#L403" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/mobileweb/cli/commands/_build.js#L403</a>
   
   Heck, even the Windows Phone platform! <a href="https://github.com/appcelerator/titanium_mobile_windows/blob/master/cli/commands/_build.js#L1243-L1250" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/blob/master/cli/commands/_build.js#L1243-L1250</a>
   
   So, the fix IS to add "windowsphone" to the array of platforms in the SDK's manifest.json.
   
   P.S. This would not be an issue had we taken my suggestion to have explicit "Resources-android", "Resources-ios", "Resources-mobileweb", etc directories in the project root. Putting platform-specific resources in the Resources directory and trying to identify which directories are platforms names is poor design.</li>
<li>Ingo Muschenetz 2015-04-03

   [~cbarber] We are not shipping any Windows Phone functionality in 4.0, so why should we add it to the manifest.json?</li>
<li>Chris Barber 2015-04-03

   [~ingo] Then don't create 4.0 SDK builds containing the Windows Phone platform.</li>
<li>Ingo Muschenetz 2015-04-03

   So I'm not.
   
   <a href="http://jenkins.appcelerator.org/job/titanium_mobile_4.0.x/configure" rel="nofollow" target="_blank">http://jenkins.appcelerator.org/job/titanium_mobile_4.0.x/configure</a>
   
   And I don't see it in the .zip file
   
   <a href="http://builds.appcelerator.com/mobile/4.0.0/mobilesdk-4.0.0.Beta2-osx.zip" rel="nofollow" target="_blank">http://builds.appcelerator.com/mobile/4.0.0/mobilesdk-4.0.0.Beta2-osx.zip</a>
   
   Where is it sneaking in?</li>
<li>Chris Barber 2015-04-03

   [~ingo] Perhaps Eric created the test app with an SDK containing the Windows Phone platform, then switched to 4.0.0.Beta2?</li>
<li>Eric Wieber 2015-04-03

   I only have 4.0.0.Beta2 installed, however you can see the assets here:
   <code><pre>
   /Users/&lt;username&gt;/Library/Application\ Support/Titanium/mobilesdk/osx/4.0.0.Beta2/mobileweb/templates/packages/winstore/<code>ProjectName</code>/images
   </pre></code></li>
<li>Ingo Muschenetz 2015-04-03

   Ah, Windows Hybrid.</li>
<li>Chris Barber 2015-04-03

   No, Windows Hybrid resources would be in the <code>mobileweb</code> directory.</li>
<li>Ingo Muschenetz 2015-04-03

    Isn't that what he's saying? /mobileweb/templates/packages/winstore</li>
<li>Chris Barber 2015-04-03

    This is not a Windows Hybrid related issue. This is an Alloy issue introduced by ALOY-1085. This wouldn't be a problem if "windowsphone" was in the list of platforms in the manifest. Because Windows Phone is not shipping with 4.0.0, then Alloy should be fixed to determine what platforms the SDK supports before copying assets from the app/assets directory to the Resources directory. File a ticket.</li>
<li>Ingo Muschenetz 2015-04-03

    Feon, can you please take a look?</li>
<li>Feon Sua Xin Miao 2015-04-06

    1_6_X: <a href="https://github.com/appcelerator/alloy/pull/680" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/680</a>
    master: <a href="https://github.com/appcelerator/alloy/pull/682" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/682</a>
    
    </li>
<li>Eric Wieber 2015-04-20

    I am still seeing Windows assets in newly created Alloy projects: <code>app/assets/windows</code>.
    Is this intended?</li>
<li>Chris Barber 2015-04-20

    [~ewieber] Yeah, that should be fine as long as the contents of that <code>windows</code> folder is not copied during compile.</li>
<li>Eric Wieber 2015-04-20

    In that case, verified as fixed using: 
    
    MacOS 10.10.3
    Studio 4.0.0.201504170803
    Ti SDK 4.0.0.Beta3
    Appc NPM 0.3.44
    Appc CLI 0.2.250
    Ti CLI 4.0.0-beta7
    Alloy 1.6.0-beta4
    Node v0.10.38
    
    Windowsphone assets are not copied into the apk on packaging.</li>
</ol>


<p><a href="/ALOY/ALOY-1260.json">JSON Source</a></p>