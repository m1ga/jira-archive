---
title: "[ALOY-1287] Alloy styles compilation does not produce the same results accross successive compilations"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-07-29T00:06:48.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.7.0</td></tr>
<tr><th>Components</th><td>Styling</td></tr>
<tr><th>Labels</th><td>defect</td></tr>
<tr><th>Reporter</th><td>Xavier Lacot</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2015-07-01T08:29:12.000+0000</td></tr>
<tr><th>Updated</th><td>2015-07-29T00:06:48.000+0000</td></tr>
</table>

<h3>Description</h3>

In some cases, when the developer overloads in a stylesheets some styles defined in the <code>app.tss</code> files, the alloy compilation won't produce the same resulting javascript accross successive compilations.

Alloy's styler orders style rules to define their priority, but there's a bug with the <code>app.tss</code> global styles being cached and therefore not correctly being counted by the styler during a compilation phase when <code>app.tss</code> didn't change.

Steps to reproduce:

 * create a new alloy app, replace its <code>app</code> folder with the one contained in the attached app.zip file
 * compile once: <code>alloy compile --config platform=ios</code>. Check in <code>Resources/iphone/alloy/controllers/sum.js</code> that the style rules defined in <code>app/styles/sum.tss</code> are applied correctly
 * compile again, the generated javascript in the <code>Resources</code> directory differ. In particular, the <code>Resources/iphone/alloy/controllers/sum.js</code> does only contain rules from the <code>app.tss</code> file.

A PR is being proposed to fix this problem.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-1287_56028/app.zip">app.zip</td></td><td>2015-07-01T08:28:07.000+0000</td><td>7603</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Xavier Lacot 2015-07-01

   A Pull Request is available here: <a href="https://github.com/appcelerator/alloy/pull/704" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/704</a></li>
<li>Fokke Zandbergen 2015-07-07

   I just ran into this bug while creating <a href="https://github.com/appcelerator-developer-relations/appc-sample-ti410" rel="nofollow" target="_blank">https://github.com/appcelerator-developer-relations/appc-sample-ti410</a>, thanks [~xavier]</li>
<li>Fokke Zandbergen 2015-07-07

   Verified the bug using the attached sample app:
   
   First run, correctly mixing style from <code>app.tss</code> and <code>sum.tss</code>
   
   <code><pre>
       $.__views.__alloyId0 = Ti.UI.createView({
           layout: "vertical",
           height: Ti.UI.SIZE,
           top: 10,
           right: 10,
           bottom: 5,
           left: 10,
           backgroundColor: "red",
           id: "__alloyId0"
       });
   </pre></code>
   
   Second run, missing the styles from <code>sum.tss</code>:
   
   <code><pre>
       $.__views.__alloyId0 = Ti.UI.createView({
           top: 14,
           bottom: 15,
           backgroundColor: "red",
           layout: "vertical",
           height: Ti.UI.SIZE,
           right: 10,
           left: 10,
           id: "__alloyId0"
       });
   </pre></code>
   
   Also verified the PR, where both the first and second run correctly mix the style from <code>app.tss</code> and <code>sum.tss</code>.</li>
<li>Feon Sua Xin Miao 2015-07-29

   PR merged.</li>
</ol>


<p><a href="/ALOY/ALOY-1287.json">JSON Source</a></p>