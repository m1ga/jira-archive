---
title: "[ALOY-1478] Data binding fails when binding string or model attribute name has dash, space or quote"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-08-04T00:22:20.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>alloy 1.7.35, alloy 1.8.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.4.0, alloy 1.9.0</td></tr>
<tr><th>Components</th><td>Models, XML</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2016-03-29T12:25:26.000+0000</td></tr>
<tr><th>Updated</th><td>2016-08-04T17:04:38.000+0000</td></tr>
</table>

<h3>Description</h3>

Alloy data binding can't handle complex bindings strings or model attributes names that contain a dash, space or quotes.

This is in part because of the way it renders the compiled <code>\_.template()</code> code, but also because of limitations in <code>\_.template()</code> itself:
<a href="http://stackoverflow.com/a/15956433/4626813" rel="nofollow" target="_blank">http://stackoverflow.com/a/15956433/4626813</a>

<code><pre>
&lt;Alloy&gt;
	&lt;Model src="mymodel" /&gt;
	&lt;Collection src="mymodel" /&gt;
	&lt;Window&gt;
		&lt;ScrollView layout="vertical"&gt;

			&lt;!-- ALL OK --&gt;
			&lt;Label top="30" text="{mymodel.a}" /&gt;

			&lt;!-- COMPILE ERROR --&gt;
			&lt;!-- &lt;Label text="{mymodel.a'b}" /&gt; --&gt;
			&lt;!-- &lt;Label text="he's {mymodel.a}" /&gt; --&gt;

			&lt;!-- RUN-TIME ERROR --&gt;
			&lt;!-- &lt;Label text="{mymodel.a-b}" /&gt; --&gt;
			&lt;!-- &lt;Label text="{mymodel[a-b]}" /&gt; --&gt;
			&lt;!-- &lt;Label text="{mymodel.a b}" /&gt; --&gt;
			&lt;!-- &lt;Label text='{mymodel.a"b}' /&gt; --&gt;

			&lt;ListView&gt;
				&lt;ListSection dataCollection="mymodel"&gt;

					&lt;!-- ALL OK --&gt;
					&lt;ListItem title="{a}" /&gt;

					&lt;!-- COMPILE ERROR --&gt;
					&lt;!-- &lt;ListItem title="{a'b}" /&gt; --&gt;

					&lt;!-- RUN-TIME ERROR --&gt;
					&lt;!-- &lt;ListItem title="{a-b}" /&gt; --&gt;
					&lt;!-- &lt;ListItem title="{[a-b]}" /&gt; --&gt;
					&lt;!-- &lt;ListItem title="{a b}" /&gt; --&gt;
					&lt;!-- &lt;ListItem title='{a"b}' /&gt; --&gt;

				&lt;/ListSection&gt;
			&lt;/ListView&gt;
		&lt;/ScrollView&gt;
	&lt;/Window&gt;
&lt;/Alloy&gt;
</pre></code>

*index.js*

<code><pre>
var test = {
  a: 'a',
  'a-b': 'a-b',
  'a b': 'a b',
  'a"b': 'a"b',
  "a'b": "a'b"
};

Alloy.Models.mymodel.set(test);
Alloy.Collections.mymodel.reset([test]);

$.index.open();
</pre></code>

*mymodel.js*

<code><pre>
exports.definition = {};
</pre></code>

<h3>Comments</h3>

<ol>
<li>Fokke Zandbergen 2016-03-31

   Wil be done as part of ALOY-1480</li>
<li>Fokke Zandbergen 2016-03-31

   Combined PR for ALOY-1478, ALOY-1480, ALOY-1481 and ALOY-1482:
   <a href="https://github.com/appcelerator/alloy/pull/780" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/780</a></li>
<li>Feon Sua Xin Miao 2016-04-24

   PR merged.</li>
<li>Eric Wieber 2016-08-02

   Reopening as I am unable to use model attributes with dashes, spaces, or quotes in the name when using a collection via the dataCollection property. Tested using:
   
   MacOS 10.11.5 (15F31a)
   Ti SDK 5.4.0.v20160801022303
   Appc NPM 4.2.7
   Appc CLI 5.4.0-37
   Alloy 1.9.1
   Xcode 7.3.1 (7D1014)
   
   In the provided code, using a model with dashes, spaces, or quotes in the name is working (simply uncomment the Labels in the scrollview, but outside the listview). However trying to use the dataCollection property and referencing the attributes with spaces, dashes, or quotes in the name will not compile. You can see this by uncommenting the ListItems in the ListSection of the provided code or by using the below example project: (You can make the below project compile by changing the 'dash-dash' and 'space space' attributes in the xml to the 'greeting' and 'subject' attributes)
   
   *index.xml*
   <code><pre>
   &lt;Alloy&gt;
   	&lt;Model src="model-a" /&gt;
   	&lt;Model src="modelb" /&gt;
   	&lt;Collection src="model-a" /&gt;
   	&lt;Window backgroundColor="white" layout="vertical"&gt;
   		&lt;Label top="20" font="{['model-a'].font}" text="{['model-a'].greeting} {modelb['mix it']}" /&gt;
   		&lt;Label font="{['model-a'].font}" text="well {['model-a'].greeting}" /&gt;
   		&lt;Label font="{['model-a'].font}" text="{['model-a'].greeting} {modelb.deep.link}!" /&gt;
   		&lt;Label font="{['model-a'].font}" text="well {['model-a'].greeting} there's {['model-a'].subject}!" /&gt;
   		&lt;ListView height="Ti.UI.SIZE" canScroll="false"&gt;
   			&lt;ListSection dataCollection="model-a"&gt;
   				&lt;ListItem font="{font}" title="well {dash-dash} there {space space}!" /&gt;
   			&lt;/ListSection&gt;
   		&lt;/ListView&gt;
   	&lt;/Window&gt;
   &lt;/Alloy&gt;
   </pre></code>
   
   *index.js*
   <code><pre>
   var attributes = {
     greeting: 'hello',
     'subject': 'world',
     'dash-dash': 'dash',
     'space space': 'space'
   };
   
   Alloy.Models.modelb.set({
     'mix it': 'Mix It!',
     deep: {
       link: 'deep-link'
     }
   });
   
   Alloy.Models['model-a'].set(attributes);
   Alloy.Collections['model-a'].reset([attributes]);
   
   $.index.open();
   </pre></code>
   
   *model-a.js*
   <code><pre>
   exports.definition = {
     extendModel: function(Model) {
       _.extend(Model.prototype, {
         transform: function() {
           var transformed = this.toJSON();
   
           transformed.subject && (transformed.subject = transformed.subject.toUpperCase());
           transformed.font = {
             fontSize: 20,
             fontWeight: 'bold'
           };
   
           return transformed;
         }
       });
   
       return Model;
     }
   };
   </pre></code>
   
   *modelb.js*
   <code><pre>
   exports.definition = {};
   </pre></code>
   
   Is this a limitation of _.template() that we cannot overcome? Can this get another look?</li>
<li>Feon Sua Xin Miao 2016-08-03

   [~ewieber] I looked at this for a bit, the limitation is to use square bracket notation, <code>\[' ']</code>,  for attributes with properties containing special characters.
   
   <code><pre>
   &lt;Alloy&gt;
   	&lt;Model src="model-a" /&gt;
   	&lt;Model src="modelb" /&gt;
   	&lt;Collection src="model-a" /&gt;
   	&lt;Window backgroundColor="white" layout="vertical"&gt;
   		&lt;Label top="20" font="{['model-a'].font}" text="{['model-a'].greeting} {modelb['mix it']}" /&gt;
   		&lt;Label font="{['model-a'].font}" text="well {['model-a'].greeting}" /&gt;
   		&lt;Label font="{['model-a'].font}" text="{['model-a'].greeting} {modelb.deep.link}!" /&gt;
   		&lt;Label font="{['model-a'].font}" text="well {['model-a'].greeting} there's {['model-a'].subject}!" /&gt;
   		&lt;Label font="{['model-a'].font}" text="well {['model-a']['dash-dash']} there's {['model-a'].subject}!" /&gt;
   		&lt;ListView height="Ti.UI.SIZE" canScroll="false"&gt;
   			&lt;ListSection dataCollection="model-a"&gt;
   				&lt;ListItem font="{font}" title="well {['dash-dash']} there {['space space']}!" /&gt;
   			&lt;/ListSection&gt;
   		&lt;/ListView&gt;
   	&lt;/Window&gt;
   &lt;/Alloy&gt;
   
   </pre></code></li>
<li>Eric Wieber 2016-08-04

   Thank you for the second look [~fmiao]. Looking at the first half of the test case, knowing about the square brackets, makes it seem obvious now, but I do not see this notation documented anywhere. [~bimmel], It may be worth noting in the [Alloy Data Binding](<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/guide/Alloy_Data_Binding) docs that the square bracket notation should be used for referencing model attributes with special characters in their names. That said:
   
   Verified fixed using:
   MacOS 10.11.5 (15F31a)
   Studio 4.7.0.201607250649
   Ti SDK 5.4.0.v20160802165655
   Appc NPM 4.2.7
   Appc CLI 5.4.0-37
   Alloy 1.9.1
   Xcode 7.3.1 (7D1014)
   
   Projects compile and run correctly when using data binding with models who's attributes contain spaces, dashes, and quotes. Tested using the provided sample code, tests in the Alloy repo (both modified to use the square bracket notation for collections), and personal test apps.</li>
</ol>


<p><a href="/ALOY/ALOY-1478.json">JSON Source</a></p>