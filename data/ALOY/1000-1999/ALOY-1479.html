---
title: "[ALOY-1479] Regression: Model instance data binding no longer works"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-03-30T21:20:19.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>alloy 1.8.3, alloy 1.8.4</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.2.2, alloy 1.8.4, alloy 1.8.5</td></tr>
<tr><th>Components</th><td>Models</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Fokke Zandbergen</td></tr>
<tr><th>Created</th><td>2016-03-30T13:41:20.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-31T23:27:44.000+0000</td></tr>
</table>

<h3>Description</h3>

Data binding of local model instances throws an exception in Alloy 1.8.3 and 1.8.4 because of [this line change](<a href="https://github.com/appcelerator/alloy/pull/769/files#diff-a59a2178e486f81366775c39e5393695L521)" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/769/files#diff-a59a2178e486f81366775c39e5393695L521)</a> to resolve ALOY-1369.

*XML*

<code><pre>
		&lt;Label top="20" text="{$.modelinstance.foo}" /&gt;
		&lt;Label text="{$.modelinstance.foo} {$.modelinstance.bar}" /&gt;
</pre></code>

*compiled*

<code><pre>
        $.__alloyId4.text = _.template("{$.modelinstance.foo}", {
            modelinstance: transformed
        }, {
            interpolate: /\{([\s\S]+?)\}/g
        });
        $.__alloyId5.text = _.template("{$.modelinstance.foo} {$.modelinstance.bar}", {
            modelinstance: transformed
        }, {
            interpolate: /\{([\s\S]+?)\}/g
        });
</pre></code>

<h3>Comments</h3>

<ol>
<li>Fokke Zandbergen 2016-03-30

   /cc [~cng] [~emerriman] [~fmiao]</li>
<li>Fokke Zandbergen 2016-03-30

   I'm including a test app that covers all of the following cases:
   
   <h4>Simple global model data binding</h4>
   <h4>Complex global model data binding</h4>
   <h4>Complex global model data binding with undefined model attribute</h4>
   <h4>Simple local model instance data binding</h4>
   <h4>Complex local model instance data binding</h4>
   <h4>Complex local model instance data binding with undefined model attribute</h4>
   <h4>Simple global collection data binding</h4>
   <h4>Complex global collection data binding</h4>
   <h4>Complex global collection data binding with undefined model attribute</h4>
   <h4>Simple local collection instance data binding</h4>
   <h4>Complex local collection instance data binding</h4>
   <h4>Complex local collection instance data binding with undefined model attribute</h4>
   <h4>Simple global collection data binding in required view</h4>
   <h4>Complex global collection data binding in required view</h4>
   <h4>Complex global collection data binding in required view with undefined model attribute</h4>
   <h4>Simple local collection instance data binding in required view</h4>
   <h4>Complex local collection instance data binding in required view</h4>
   <h4>Complex local collection instance data binding in required view with undefined model attribute</h4>
   
   The following cases are already covered by the test app for ALOY-1474:
   
   <h4>Simple global model data binding</h4>
   <h4>Complex global model data binding</h4>
   <h4>Simple global model data binding with model transform method</h4>
   <h4>Complex global model data binding with model transform method</h4>
   <h4>Simple global collection data binding</h4>
   <h4>Complex global collection data binding</h4>
   <h4>Complex global collection data binding with controller transform method</h4>
   <h4>Simple global collection data binding with model transform method</h4>
   <h4>Complex global collection data binding with model transform method</h4>
   <h4>Complex global collection data binding with model transform method, overridden by controller transform method</h4>
   
   That should do it.</li>
<li>Fokke Zandbergen 2016-03-30

   PR with test instructions: <a href="https://github.com/appcelerator/alloy/pull/779" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/779</a>
   
   Did you know we had 0 tests for data binding local instances of models or collections?</li>
<li>Feon Sua Xin Miao 2016-03-30

   We do have tests for local instance of collection, i.e
   <a href="https://github.com/appcelerator/alloy/blob/master/test/apps/testing/ALOY-874/" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/blob/master/test/apps/testing/ALOY-874/</a>
   
   Overall, the list you have is bulletproof, and the fix looks good!
   
   </li>
<li>Fokke Zandbergen 2016-03-30

   That's for a collection. Do we also have one for a instance of a model?</li>
<li>Feon Sua Xin Miao 2016-03-30

   We now do! You just added it! :)</li>
<li>Feon Sua Xin Miao 2016-03-30

   PR merged. 
   Alloy@1.8.5</li>
<li>Eric Wieber 2016-03-31

   Verified fixed, using:
   
   MacOS 10.11.4 (15E65)
   Studio 4.5.0.201602170821
   Ti SDK 5.2.2.v20160328141205
   Appc NPM 4.2.5-1
   Appc CLI 5.2.2-3
   Alloy 1.8.5
   Xcode 7.3 (7D175)
   
   Data binding for models is working as expected. Tested using the test app provided by Fokke as well as other created test apps. No exception is encountered and model data is correctly shown.</li>
</ol>


<p><a href="/ALOY/ALOY-1479.json">JSON Source</a></p>