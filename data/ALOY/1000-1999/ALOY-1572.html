---
title: "[ALOY-1572] Alloy doesn't compile external app.js"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-07-10T22:40:26.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>alloy 1.9.11</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.2.3, Alloy 1.9.13</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Flavio De Stefano</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2017-06-23T12:32:48.000+0000</td></tr>
<tr><th>Updated</th><td>2017-07-11T23:17:36.000+0000</td></tr>
</table>

<h3>Description</h3>

If your Alloy project has an <code>app.js</code> in a subdirectory (example: <code>lib/app.js</code>), it is not compiled.

So, if you have a pre-processor constant like <code>OS_IOS</code> or <code>OS_ANDROID</code> in this file,
the result is a runtime error because no var defined <code>OS_IOS</code> is found.

*This is a critical issue, because Alloy produces a broken app!*

PR: <a href="https://github.com/appcelerator/alloy/pull/836" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/836</a>

<h3>Comments</h3>

<ol>
<li>Brian Knorr 2017-06-23

   We are seeing the same issue with the latest Alloy.  As a workaround we are setting all the env vars like OS_IOS on the Alloy object in the alloy.js file.  This way our javascript files in lib can use Alloy.OS_IOS, etc...</li>
<li>Flavio De Stefano 2017-06-23

   I made a PR to avoid to define these constants</li>
<li>Sharif AbuDarda 2017-06-27

   Hello, Please share a sample project for us to test. Also, provide your environment details.</li>
<li>Feon Sua Xin Miao 2017-07-10

   1_9_X: <a href="https://github.com/appcelerator/alloy/pull/838" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/838</a>
   master: <a href="https://github.com/appcelerator/alloy/pull/839" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/839</a></li>
<li>Abir Mukherjee 2017-07-11

   Tested with this environment:
   Node Version: 6.10.3
   NPM Version: 3.10.10
   Mac OS: 10.12.4
   Appc CLI: 6.2.3-master.20
   Appc CLI NPM: 4.2.9
   Titanium SDK version: 6.1.1.GA
   Appcelerator Studio, build: 4.9.0.201705302345
   Xcode 8.3.2
   
   Ran test project with app.js in a subfolder, and there were no compile time or runtime errors.</li>
</ol>


<p><a href="/ALOY/ALOY-1572.json">JSON Source</a></p>