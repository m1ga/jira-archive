---
title: "[ALOY-1574] Unable to use ES6 import/exports in alloy controllers due to bad code generation"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-09-21T01:00:31.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Alloy 1.10.4</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2017-08-02T15:54:56.000+0000</td></tr>
<tr><th>Updated</th><td>2018-01-29T15:52:57.000+0000</td></tr>
</table>

<h3>Description</h3>

If you add imports or exports to an alloy controller, we can now parse the code and handle it in our use of babel/babylon instead of uglify. BUT, we don't "hoist" the imports/exports to the top of the generated code, so it can become embedded underneath a function which is invalid ES6 code. imports and exports must be "moved" up to the global top-level or else the code is invalid.

i.e.
<code><pre>
import 'foo' from 'bar';
export const foo = Math.sqrt(2);
</pre></code>
On a related note, we don't really "handle" ES6 imports/exports anyways down the line, but that's another ticket we can address in titanium CLI/build to just use babel transpilation to generate requires out of them (until the wider JS community has settled how to handle module vs script difference and imports/exports)

<h3>Comments</h3>

<ol>
<li>Feon Sua Xin Miao 2017-09-18

   PR: <a href="https://github.com/appcelerator/alloy/pull/850" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/pull/850</a>
   
   Alloy compile should be able to parse import/export without error.
   *Import*
   1. Default import, i.e. <code>import test from '/test/hello';</code>
   2. Namespace import, i.e. <code>import * as test from '/test/hello';</code>
   3. Named imports, i.e. <code>import { a, b } from '/test/hello';</code>
   4. Empty import, i.e. <code>import '/test/hellot';</code>
   
   *Export*
   1. Inline Named exports , i.e. <code>export const sqrt = Math.sqrt;</code>
   
   *Note*
   Default export, i.e. <code>export default 'abc';</code>,  is not supported in controller.</li>
</ol>


<p><a href="/ALOY/ALOY-1574.json">JSON Source</a></p>