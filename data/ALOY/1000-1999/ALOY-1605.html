---
title: "[ALOY-1605] Android: Unable to build alloy apps using master"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-03-05T11:24:17.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Titanium SDK</td></tr>
<tr><th>Labels</th><td>qe-7.1.0</td></tr>
<tr><th>Reporter</th><td>Josh Longton</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2018-02-13T16:55:14.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-05T11:24:17.000+0000</td></tr>
</table>

<h3>Description</h3>

On master, I am unable to build to Alloy applications

<h4>Steps to reproduce </h4>
<h4>Pull the latest build from master</h4>
<h4>Create a new alloy application</h4>
<h4>Build the default alloy application</h4>

<h4>Error on device</h4>

{noformat}
[ERROR] TiExceptionHandler: (main) [33,33] ----- Titanium Javascript Runtime Error -----
[ERROR] TiExceptionHandler: (main) [1,34] - In /alloy/underscore.js:924,80
[ERROR] TiExceptionHandler: (main) [0,34] - Message: Uncaught TypeError: Cannot read property '_' of undefined
[ERROR] TiExceptionHandler: (main) [0,34] - Source: }var _Mathfloor=Math.floor,_Mathmax=Math.max,root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create,Ctor=function(){},_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};'undefined'==typeof exports?root._=_:('undefined'!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_),_.VERSION='1.8.3';var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)};}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?optimizeCb(value,context,argCount):_.isObject(value)?_.matcher(value):_.property(value)};_.iteratee=function(value,context){return cb(value,context,Infinity)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(2>length||null==obj)return obj;for(var index=1;index<length;index++)for(var key,source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;i<l;i++)key=keys[i],undefinedOnly&&void 0!==obj[key]||(obj[key]=source[key]);return obj}},baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;return Ctor.prototype=null,result},property=function(key){return function(obj){return null==obj?void 0:obj[key]}},MAX_ARRAY_INDEX=9007199254740991,getLength=property('length'),isArrayLike=function(collection){var length=getLength(collection);return'number'==typeof length&&0<=length&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;i<length;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var currentKey,keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;index<length;index++)currentKey=keys?keys[index]:index,results[index]=iteratee(obj[currentKey],currentKey,obj);return results},_.reduce=_.foldl=_.inject=createReduce(1),_.reduceRight=_.foldr=createReduce(-1),_.find=_.detect=function(obj,predicate,context){var key;if(key=isArrayLike(obj)?_.findIndex(obj,predicate,context):_.findKey(obj,predicate,context),void 0!==key&&-1!==key)return obj[key]},_.filter=_.select=function(obj,predicate,context){var results=[];return predicate=cb(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)},_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var currentKey,keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++)if(currentKey=keys?keys[index]:index,!predicate(obj[currentKey],currentKey,obj))return!1;return!0},_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var currentKey,keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++)if(currentKey=keys?keys[index]:index,predicate(obj[currentKey],currentKey,obj))return!0;return!1},_.contains=_.includes=_.include=function(obj,item,fromIndex,guard)
[ERROR] V8Exception: Exception occurred at /alloy/underscore.js:924: Uncaught TypeError: Cannot read property '_' of undefined
{noformat}

<h4>Error on emulator</h4>


{noformat}
[ERROR] TiExceptionHandler: (main) [41,41] ----- Titanium Javascript Runtime Error -----
[ERROR] TiExceptionHandler: (main) [0,41] - In /alloy/underscore.js:15,33
[ERROR] TiExceptionHandler: (main) [0,41] - Message: Uncaught TypeError: Cannot read property '_' of undefined
[ERROR] TiExceptionHandler: (main) [0,41] - Source:   var previousUnderscore = root._;
[WARN]  W/        : Unrecognized GLES max version string in extensions: ANDROID_EMU_CHECKSUM_HELPER_v1
[WARN]  W/        : Process pipe failed
[ERROR] V8Exception: Exception occurred at /alloy/underscore.js:15: Uncaught TypeError: Cannot read property '_' of undefined
[INFO]  TiRootActivity: (main) [0,0] checkpoint, on root activity resume. activity = com.appc.test.TesterActivity@62ba9f6
[WARN]  W/        : Unrecognized GLES max version string in extensions: ANDROID_EMU_CHECKSUM_HELPER_v1
[INFO]  OpenGLRenderer: Initialized EGL, version 1.4
[ERROR] EGL_emulation: tid 6876: eglSurfaceAttrib(1261): error 0x3009 (EGL_BAD_MATCH)
[WARN]  OpenGLRenderer: Failed to set EGL_SWAP_BEHAVIOR on surface 0xb1135dc0, error=EGL_BAD_MATCH
[ERROR] EGL_emulation: tid 6876: eglSurfaceAttrib(1261): error 0x3009 (EGL_BAD_MATCH)
[WARN]  OpenGLRenderer: Failed to set EGL_SWAP_BEHAVIOR on surface 0xb1135e40, error=EGL_BAD_MATCH
{noformat}


<h3>Comments</h3>

<ol>
<li>Ewan Harris 2018-02-13

   This is caused by the babel step introduced into the SDK, it can be solved by using a newer babel <a href="https://github.com/appcelerator/node-titanium-sdk/pull/23" rel="nofollow" target="_blank">https://github.com/appcelerator/node-titanium-sdk/pull/23</a> or <a href="https://github.com/appcelerator/node-titanium-sdk/pull/24" rel="nofollow" target="_blank">https://github.com/appcelerator/node-titanium-sdk/pull/24</a></li>
<li>David Bankier 2018-03-02

   Hmmm... Running two different projects on 7.0.1.GA. Both recently upgraded. One gets this error and the other is fine. The compiled <code>/build/android/assets/alloy/underscore.js</code> files however are different. Not sure how... </li>
<li>David Bankier 2018-03-02

   Ok. In my case, I had a .babelrc file, that once removed, fixed it.</li>
<li>Ewan Harris 2018-03-02

   [~dbankier] Where was the .babelrc located? We don't support overriding our defined config currently but I think babel might walk up the directory tree to find config files.</li>
<li>David Bankier 2018-03-04

   Project root. </li>
<li>Ewan Harris 2018-03-05

   [~dbankier] Thanks for that. I've filed TIMOB-25837 to track that issue.  I'm going to close this ticket as fixed because as far as I aware overriding the default babel config is unsupported at the moment and we fixed the issue in the SDK that caused this</li>
<li>Ewan Harris 2018-03-05

   This was fixed in the SDK in <a href="https://github.com/appcelerator/node-titanium-sdk/pull/25" rel="nofollow" target="_blank">https://github.com/appcelerator/node-titanium-sdk/pull/25</a></li>
</ol>


<p><a href="/ALOY/ALOY-1605.json">JSON Source</a></p>