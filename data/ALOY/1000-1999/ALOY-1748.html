---
title: "[ALOY-1748] Widget - Regression - weird behavior - some exporting functions are not working with CLI 8.1.1"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>9.3.0.GA, Android, CLI8.1.1, Widget, exports, iOS</td></tr>
<tr><th>Reporter</th><td>Francisco Antonio Duran Ramirez</td></tr>
<tr><th>Assignee</th><td>Abir Mukherjee</td></tr>
<tr><th>Created</th><td>2020-12-17T21:05:42.000+0000</td></tr>
<tr><th>Updated</th><td>2021-06-16T15:07:46.000+0000</td></tr>
</table>

<h3>Description</h3>

Hello. Good afternoon.

Basically adding a *widget* to any section, and trying to execute a *functionality* which it was *exported* from the section where it was added the widget; some of the exported functionalities are *not working* with the *CLI 8.1.1*, but if you try to use a lower version it is working pretty good, so that's mean that it is a regression. More details, please try to use the project attached.

* XML
<code><pre>
&lt;Alloy&gt;
     &lt;Widget src="KlassWindow" id="win" /&gt;
&lt;/Alloy&gt;
</pre></code>

* JS
<code><pre>
$.win.open();
$.win.showAlert();
</pre></code>

This part about $.win.showAlert(); it is working with CLI 8.0.0, but not with CLI 8.1.1.

* WIDGET XML
<code><pre>
&lt;Alloy&gt;
     &lt;Window class="container" id="win" /&gt;
&lt;/Alloy&gt;
</pre></code>

* WIDGET JS
<code><pre>
var args = arguments[0] || {};

exports.open = function () {
	$.win.open();
};

exports.showAlert = function() {
	alert("CLI 8.0.0 WORKING!!!");
};
</pre></code>


Please let me know whether you have any doubt or question.

Thanks, and best,
Antonio Duran.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-1748_67755/8.0.0-Working.png">8.0.0-Working.png</td></td><td>2020-12-17T21:05:30.000+0000</td><td>427106</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-1748_67756/8.1.1-NotWorking.png">8.1.1-NotWorking.png</td></td><td>2020-12-17T21:05:30.000+0000</td><td>613677</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/ALOY/ALOY-1748_67757/eightononenotworkingcliwidget.zip">eightononenotworkingcliwidget.zip</td></td><td>2020-12-17T20:59:50.000+0000</td><td>8679352</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>John Staunton 2021-06-15

   Exact same issue here - big issues caused due to this bug, seemingly no way to work around it</li>
<li>John Staunton 2021-06-15

   Bug also exists in CLI 9.0.1</li>
<li>John Staunton 2021-06-16

   A workaround (posted in the TiSlack channel) that seems to work is to change your widget slightly to export the function as:
   
    $.widget.showAlert = function() {
   
   }
   
   instead of exports.showAlert... where 'widget' is the top-level View or Window of your widget</li>
<li>Ewan Harris 2021-06-16

   This is caused by a behaviour change we overlooked when implementing the linked ticket, if a widget is the only node in a view it will become the top level node. So $.win then becomes a reference to the window in the Widget rather than the Widget itself.
   
   Another way to workaround this is to add an empty tag of some kind to the view, so that the Widget tag isn't the only tag in the view. Off the top of my head, I'm not sure how we can maintain the correct behaviour and support ALOY-1256</li>
</ol>


<p><a href="/ALOY/ALOY-1748.json">JSON Source</a></p>