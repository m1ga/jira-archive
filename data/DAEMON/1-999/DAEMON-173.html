---
title: "[DAEMON-173] windowslib: EBUSY error on wptool executable"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-11-21T20:02:48.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Appc Daemon 1.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Appc Daemon 1.0.0</td></tr>
<tr><th>Components</th><td>appcd-plugin-windows</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Ewan Harris</td></tr>
<tr><th>Created</th><td>2017-11-20T16:51:08.000+0000</td></tr>
<tr><th>Updated</th><td>2017-11-21T20:02:48.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

When running appcd exec /system-info/1.x/info/ it seemed to be taking longer than usual to return, checking the logs I saw the below, I think it's possible that two detect processes are attempting to build wptool at the same time. We apparently deal with this inside windowslib but it seems to be flaky, it might be wise to stagger the detects to allow one to build before the other runs

I've had trouble reproducing this in an appc cli build fwiw

<code><pre>
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error Caught exception: Error: EBUSY: resource busy or locked, open 'C:\Users\ewan\Documents\git\appc-daemon\node_modules\windowslib\bin\wptool.exe'
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at Object.fs.openSync (fs.js:646:18)
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at Object.fs.writeFileSync (fs.js:1291:33)
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at Object.callback (C:\Users\ewan\Documents\git\appc-daemon\node_modules\windowslib\lib\wptool.js:596:7)
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at C:\Users\ewan\Documents\git\appc-daemon\node_modules\windowslib\lib\visualstudio.js:423:9
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at Array.forEach (&lt;anonymous&gt;)
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at ChildProcess.&lt;anonymous&gt; (C:\Users\ewan\Documents\git\appc-daemon\node_modules\windowslib\lib\visualstudio.js:415:11)
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at emitTwo (events.js:126:13)
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at ChildProcess.emit (events.js:214:7)
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at maybeClose (internal/child_process.js:925:16)
2017-11-20T16:24:57.446Z appcd:plugin:host:21052 error     at Process.ChildProcess._handle.onexit (internal/child_process.js:209:5)
</pre></code>

<h4>Steps to reproduce</h4>

<h4>Remove wptool.exe from windowslib/bin folder</h4>
<h4>Start the daemon <code>[appc] appcd start</code></h4>
<h4>Query system info <code>[appc] appcd exec /system-info/1.x/info/</code></h4>

<h4>Actual</h4>

Plugin hangs, windows error above shown in logs

<h4>Expected</h4>

No hang

<h3>Comments</h3>

<ol>
<li>Chris Barber 2017-11-20

   FYI, I ran into a similar problem on Linux with invoking a freshly download Node.js executable where I was getting an <code>EBUSY</code> error. I worked around it by implementing a try again loop: <a href="https://github.com/appcelerator/appc-daemon/blob/master/packages/appcd-nodejs/src/nodejs.js#L440." rel="nofollow" target="_blank">https://github.com/appcelerator/appc-daemon/blob/master/packages/appcd-nodejs/src/nodejs.js#L440.</a></li>
</ol>


<p><a href="/DAEMON/DAEMON-173.json">JSON Source</a></p>