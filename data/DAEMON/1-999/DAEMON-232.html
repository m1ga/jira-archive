---
title: "[DAEMON-232] FSWatcher: Events relating to permission changes to a folder are dropped on Windows"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-03-22T14:05:50.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Appc Daemon 1.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Appc Daemon 1.1.0</td></tr>
<tr><th>Components</th><td>appcd-fswatcher</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2018-02-08T17:49:54.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-22T14:05:50.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

In DAEMON-222 changed were made to prevent unnecessary change events (a child item changing for example) on a folder bubbling up, which had the side-effect of causing any change events to not fire for a folder on Windows. The current solutions for tracking information through fs.Stats is lightweight on Windows a potential native module (<a href="https://github.com/xxoo/node-fswin)" rel="nofollow" target="_blank">https://github.com/xxoo/node-fswin)</a> was found but the heaviness of using this module wasn't wanted. This is more than likely going to need to be sovled in the future

It's probable that issues relating to permissions will be prevalent on unixy systems too

<h4>Steps to repro</h4>

TODO

<h3>Comments</h3>

<ol>
<li>Chris Barber 2018-03-22

   <a href="https://github.com/appcelerator/appc-daemon/pull/302" rel="nofollow" target="_blank">https://github.com/appcelerator/appc-daemon/pull/302</a></li>
<li>Chris Barber 2018-03-22

   To test:
   
   1. Create a file called <code>fstest.js</code> in the <code>appc-daemon\packages\appcd-fswatcher</code> directory:
   
   <code><pre>
   const fsw = require('./dist/index');
   const renderTree = fsw.renderTree;
   const FSWatcher = fsw.FSWatcher;
   
   const watcher = new FSWatcher('C:\\Users\\chris\\Desktop', { recursive: true });
   
   watcher.on('change', evt =&gt; {
   	console.log(evt);
   	setTimeout(() =&gt; {
   		console.log(renderTree());
   		console.log();
   	}, 100);
   });
   
   console.log(renderTree());
   console.log();
   </pre></code>
   
   2. Create a <code>Desktop\foo\bar</code> directory.
   
   3. Run <code>node fstest.js</code>
   
   4. In Windows Explorer, right click the <code>foo</code> directory and go to Properties, then click on the Security tab. Click the Edit button and select your user from the list. Start twiddling permissions and clicking the Apply button as you watch the events being emitted.</li>
</ol>


<p><a href="/DAEMON/DAEMON-232.json">JSON Source</a></p>