---
title: "[DAEMON-260] Android configuration issues with the Studio 5.1.0"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-03-13T20:42:26.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Appc Daemon 2.0.0</td></tr>
<tr><th>Components</th><td>androidlib</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Kondal Kolipaka</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2018-06-26T03:47:14.000+0000</td></tr>
<tr><th>Updated</th><td>2019-03-13T20:42:26.000+0000</td></tr>
</table>

<h3>Description</h3>

Hi all.  I am having issues with Studio on my Mac. It seems to randomly not know that I have Android SDKs installed.  It worked last week.  Just this morning, I start up studio and on the dashboard I see that Android is ready to go.  Then an few seconds later it changes to grayed out and the button says download.  I click download and run the install - when I do it recognizes that I already have some versions of the SDK installed.  But once through the install process, the problem still exists.  I have been doing this all morning.  An interesting point is that one of the times I did this process, it worked and I saw the emulators that I have always had available in Studio.   Also note that the preferences pane in Studio sometimes shows that it has found the SDKs and the emulators dropdown is populated, but most of the time it looks like the attached screenshot.  Any help would be greatly appreciated as I am unable to do Android mobile demonstrations and I have several in the near future.  Thanks in advance.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/DAEMON/DAEMON-260_65294/appcd_dump_1530044433964.log">appcd_dump_1530044433964.log</td></td><td>2018-06-26T20:24:15.000+0000</td><td>1547463</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/DAEMON/DAEMON-260_65325/appcddump.txt">appcddump.txt</td></td><td>2018-07-03T04:36:45.000+0000</td><td>1142813</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/DAEMON/DAEMON-260_65309/log">log</td></td><td>2018-06-29T15:26:17.000+0000</td><td>2722541</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/DAEMON/DAEMON-260_65295/Screen Shot 2018-06-26 at 1.18.59 PM.png">Screen Shot 2018-06-26 at 1.18.59 PM.png</td></td><td>2018-06-26T20:24:14.000+0000</td><td>68979</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/DAEMON/DAEMON-260_65326/status.txt">status.txt</td></td><td>2018-07-03T04:36:54.000+0000</td><td>26027</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/DAEMON/DAEMON-260_65299/studio.log">studio.log</td></td><td>2018-06-27T02:00:51.000+0000</td><td>4246119</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/DAEMON/DAEMON-260_65293/tiInfo.rtf">tiInfo.rtf</td></td><td>2018-06-26T20:24:14.000+0000</td><td>16682</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Kondal Kolipaka 2018-06-26

   [~fuzzywhite] If I understand the issue correctly, you're unable to configure Android SDK in the studio and it doesn't update in the studio dashboard page after installing a couple of times.Hope you're on the latest studio RC which is 5.1.0.201806130758 as on June 26th.
   
   Can you please provide the following logs and studio version which you're using.
   
   Before you fetch all the logs, please restart the studio with the following settings
   <h4>Go to Studio Preferences -> Studio -> Trouble Shooting</h4>
   <h4>Select Debug Level to "All" from the drop-down</h4>
   <h4>Click on Apply and restart the studio</h4>
   
   Once studio is launched, verify the android configuration in the dashboard and studio preferences
   <h4> Go to Studio Preferences -> Studio -> Platforms -> Android</h4>
   <h4> If no android SDK is configured or shown here, click on the "Browse" button to select android SDK location. </h4>
   
   *To fetch Studio diagnostic Log:*
   <h4>Go to Help -> Studio -> Run Diagnostic Test</h4>
   
   *To fetch Studio log:*
   <h4>Go to Help -> Studio -> View Log file</h4>
   
   *To fetch Appc Daemon Log:*
   <h4>Go to Help -> Studio -> Generate Appc Daemon Log</h4>
   
   *To fetch Appc ti info*
   <h4>Go to terminal and run <code>appc ti info</code></h4>
   
   Please attach all the logs to the ticket to process further. </li>
<li>Rick White 2018-06-26

   Diagnostic test will not run. Attached screenshot shows the error.  Other requested info is attached.  Thanks very much. [^tiInfo.rtf]  [^appcd_dump_1530044433964.log]  !Screen Shot 2018-06-26 at 1.18.59 PM.png|thumbnail! </li>
<li>Kondal Kolipaka 2018-06-26

   [~rwhite] Can you please add the missing studio log file as mentioned above</li>
<li>Rick White 2018-06-27

   Sorry. Iâ€™ll get that for you in an hour or so. </li>
<li>Rick White 2018-06-27

    [^studio.log] </li>
<li>Kondal Kolipaka 2018-06-27

   Thanks [~rwhite] for providing the logs.
   
   Looks like the problem is with the getting the android system-info from the Appc Daemon with in the 5sec, after making a system-info request if the daemon process doesn't respond with in the 5sec, studio will cancel the request process.
   
   [~cbarber] Why this can happen and how can we trace the root problem for this? I believe 5sec is good enough to fetch the system info from the daemon process.
   
   *Here is the request made by studio:*
   
   <code><pre>
   {"path":"\/system-info\/1.x\/info","id":1530044373934,"type":"call","version":"1.0"}
   </pre></code>
   
   Here is the Appc Daemon [^appcd_dump_1530044433964.log], But I don't see any issue here.
   
   *Error log:*
   <code><pre>
   !MESSAGE (Build 5.1.0.201806130758) [WARNING]  Unable to fetch system-info. Appcd didnt respond within 5 seconds.
   !STACK 1
   org.eclipse.core.runtime.CoreException: Unable to fetch system-info. Appcd didnt respond within 5 seconds.
   	at com.appcelerator.titanium.core.daemon.AppcDaemonManager.executeSync(AppcDaemonManager.java:286)
   	at com.appcelerator.titanium.core.daemon.AppcDaemonManager.getSystemInfo(AppcDaemonManager.java:303)
   	at com.appcelerator.titanium.android.core.DaemonAndroidSDKLocator.loadTiInfo(DaemonAndroidSDKLocator.java:847)
   	at com.appcelerator.titanium.android.core.DaemonAndroidSDKLocator.updateTiInfo(DaemonAndroidSDKLocator.java:231)
   	at com.appcelerator.titanium.android.core.DaemonAndroidSDKLocator.access$0(DaemonAndroidSDKLocator.java:229)
   	at com.appcelerator.titanium.android.core.DaemonAndroidSDKLocator$1.run(DaemonAndroidSDKLocator.java:244)
   	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:56)
   Caused by: org.eclipse.core.runtime.CoreException: Unable to fetch system-info. Appcd didnt respond within 5 seconds.
   	at com.appcelerator.titanium.core.daemon.AppcDaemonManager.executeSync(AppcDaemonManager.java:278)
   </pre></code></li>
<li>Chris Barber 2018-06-28

   I think 5 seconds is most likely insufficient. The first time the system-info is called, it takes time to get warmed up.
   
   There are performance issues too with serializing the giant system-info object. I created DAEMON-230 to look into speeding it up, but without a major effort, it's just not feasible. Querying each type of info separately would be more efficient than system-info.</li>
<li>Kondal Kolipaka 2018-06-29

   <a href="https://github.com/appcelerator/titanium_studio/pull/1085" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_studio/pull/1085</a></li>
<li>Satyam Sekhri 2018-06-29

   FR Passed.
   The login, dashboard and platform configuration works fine with the changes.
   Also no significant changes in performance noticed.</li>
<li>Kondal Kolipaka 2018-06-29

    [~rwhite] Please pick 5.1.0 RC build  - 5.1.0.201806291005 which is published here <a href="http://preview.appcelerator.com/appc-studio/" rel="nofollow" target="_blank">http://preview.appcelerator.com/appc-studio/</a>
    
    Let us know how it goes.</li>
<li>Rick White 2018-06-29

    Unfortunately, the problem still exists with this version .  However, it looks like the log file may have some more valuable info in it.  Attached.
    
     [^log] </li>
<li>Rick White 2018-06-29

    reopening, because it is not resolved.  Thanks</li>
<li>Kondal Kolipaka 2018-07-02

    </li>
<li>Rick White 2018-07-02

    [~kondal kolipaka].  I will ping you on teams around 10 am Singapore time.  Now iOS is not working either.  I am going to need help reconfiguring my Mac to get Appc Studio working again.  Thanks</li>
<li>Kondal Kolipaka 2018-07-03

    Few observations from the today's call with [~rwhite]
    
    <h4><code>appc appcd exec /android/1.x/info</code> is not responding. We have waited for more than 2mins still it doesn't return.</h4>
    <h4> <code>appc appcd exec /system-info/1.x/info</code> is also not responding from the terminal, but <code>appc appcd exec  /ios/1.x/info</code> seems to work fine.</h4>
    
    Please find the  [^appcddump.txt]  [^status.txt] files captured during the session. Looking at the dump file I don't see any issues reported.
    
    [~cbarber]  Could you guide us how can identify the root cause of the problem here.</li>
<li>Chris Barber 2019-03-13

    I'm 99% positive I found the culprit and it's in androidlib.
    
    androidlib's logic was ported from node-titanium-sdk. During the port, the code for executing a command over an adb connection was erroneously changed from a <code>socket.on('end')</code> to a <code>socket.on('close')</code>. When a command that is to buffer until the socket is closed, such as "shell", is executed, the "close" event would never fire. Turns out this needs to be an "end" event.
    
    It was fixed in [this commit](<a href="https://github.com/appcelerator/androidlib/pull/20/commits/099b8d22866b4bd4c574f2a98fed2d1c396990e5)" rel="nofollow" target="_blank">https://github.com/appcelerator/androidlib/pull/20/commits/099b8d22866b4bd4c574f2a98fed2d1c396990e5)</a> and shipped in androidlib@2.4.0.
    
    Since the fix, I haven't seen any hanging. Resolving this issue as fixed.</li>
</ol>


<p><a href="/DAEMON/DAEMON-260.json">JSON Source</a></p>