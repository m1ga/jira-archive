---
title: "[DAEMON-288] SIGINT triggered in core process"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-10-25T20:20:24.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Appc Daemon 3.1.0</td></tr>
<tr><th>Components</th><td>appcd, appcd-nodejs</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Chris Barber</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2019-10-25T19:26:07.000+0000</td></tr>
<tr><th>Updated</th><td>2019-10-25T20:20:24.000+0000</td></tr>
</table>

<h3>Description</h3>

When a process spawns <code>appcd start</code>, then that process is interrupted via CTRL-C (aka SIGINT), then the core daemon process receives the SIGINT also and shutsdown. The daemon should not be receiving the SIGINT.

<h3>Comments</h3>

<ol>
<li>Chris Barber 2019-10-25

   SIGINT is propagated to the spawned core process because it's not detached on macOS and Linux.
   
   The core was set to not detach in this commit: <a href="https://github.com/appcelerator/appc-daemon/commit/00892d87a78e405c1173a6a2164ea9901b0d9b7b#diff-30dc100d38263dd48fd4dd7ae14e0f3c" rel="nofollow" target="_blank">https://github.com/appcelerator/appc-daemon/commit/00892d87a78e405c1173a6a2164ea9901b0d9b7b#diff-30dc100d38263dd48fd4dd7ae14e0f3c</a>
   
   <code><pre>
   // On macOS (and probably Linux), a detached process doesn't stick around to see
   // if the executable exited with an error, so we must not detach the process,
   // but rather disconnect it once the daemon is booted. On Windows, we have to
   // detach it to keep the process running and for some lucky reason, Node sticks
   // around to see if the executable errors.
   detached: process.platform === 'win32' ? detached : false,
   </pre></code>
   
   This seemingly unknown behavior was actually caused by <code>appcd-nodejs</code> forcing all detached processes to be <code>unref()</code>'d which in turned caused the child process <code>"close"</code> event to never be emitted.</li>
<li>Chris Barber 2019-10-25

   PR: <a href="https://github.com/appcelerator/appc-daemon/pull/438" rel="nofollow" target="_blank">https://github.com/appcelerator/appc-daemon/pull/438</a></li>
</ol>


<p><a href="/DAEMON/DAEMON-288.json">JSON Source</a></p>