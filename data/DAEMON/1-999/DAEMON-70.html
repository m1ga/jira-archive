---
title: "[DAEMON-70] appcd-core: Drop priviledges and set uid/gid if root"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-05-03T14:44:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Appc Daemon 1.0.0</td></tr>
<tr><th>Components</th><td>appcd-core</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Chris Barber</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2017-04-10T19:42:32.000+0000</td></tr>
<tr><th>Updated</th><td>2017-10-26T03:05:02.000+0000</td></tr>
</table>

<h3>Description</h3>

In Node, you can only change the user id if Node is launched as root. If the user launching the daemon is root, it would be essential that root privileges be dropped as soon as possible during the daemon initialization.

To check if the daemon is being run as root, check if <code>process.getuid() === 0</code>. If the uid is zero, then get the uid/gid from in the config and call <code>process.setuid()</code> and/or <code>process.setgid()</code>. If there is no uid/gid in the config or the uid/gid is invalid, then the daemon should fatal error and exit.

Note that this only applies to macOS and Linux.

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/DAEMON/DAEMON-70.json">JSON Source</a></p>