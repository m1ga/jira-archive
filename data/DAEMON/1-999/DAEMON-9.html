---
title: "[DAEMON-9] windowslib v2"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-06-05T03:00:18.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Appc Daemon 2.3.0</td></tr>
<tr><th>Components</th><td>windowslib</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Chris Barber</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2016-02-04T07:44:08.000+0000</td></tr>
<tr><th>Updated</th><td>2019-06-05T15:47:07.000+0000</td></tr>
</table>

<h3>Description</h3>

windowslib needs to be updated to ES6 syntax and expose the new detect friendly interface, namely separating the search paths from the actual detection code.

<h3>Comments</h3>

<ol>
<li>Ewan Harris 2017-08-23

   Just dropping some resources for whatever lucky soul picks this up
   
   [vswhere](<a href="https://github.com/Microsoft/vswhere)" rel="nofollow" target="_blank">https://github.com/Microsoft/vswhere)</a> - Detects visual studio versions, we already use the query APIs in windowslib today, Microsoft has committed to always shipping this with a VS2017 install and imo we should use it.
   
   [Device Portal](<a href="https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/device-portal)" rel="nofollow" target="_blank">https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/device-portal)</a> - Once tSurned on by a user on their Windows 10 device, can be accessed through the web browser to perform many actions such as installing apps, performance monitoring, gathering crash data. Backed by REST APIs that should be able to be used <a href="https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/device-portal-api-core" rel="nofollow" target="_blank">https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/device-portal-api-core</a>
   
   [winappdeploycmd](<a href="https://docs.microsoft.com/en-us/windows/uwp/packaging/install-universal-windows-apps-with-the-winappdeploycmd-tool)" rel="nofollow" target="_blank">https://docs.microsoft.com/en-us/windows/uwp/packaging/install-universal-windows-apps-with-the-winappdeploycmd-tool)</a> - Used in windowslib today to install apps to devic over USB. Works over USB or network. For devices over a network it must be paired by the user.</li>
<li>Ewan Harris 2017-12-01

   Started drafting some thoughts here <a href="https://gist.github.com/ewanharris/6d9cea74b5ec55c837564df599ee6cb4" rel="nofollow" target="_blank">https://gist.github.com/ewanharris/6d9cea74b5ec55c837564df599ee6cb4</a>
   Started to set up the v2 branch and scaffold out the project etc.</li>
<li>Chris Barber 2017-12-07

   Reference: Installing the Windows SDK: <a href="https://gist.github.com/ewanharris/12968263f2a49d523d146fed09ba8c2d" rel="nofollow" target="_blank">https://gist.github.com/ewanharris/12968263f2a49d523d146fed09ba8c2d</a></li>
<li>Ewan Harris 2018-02-14

   Seeing as we're punting this for now here's my what's done so far
   
   windowslib (<a href="https://github.com/ewanharris/windowslib/tree/v2)" rel="nofollow" target="_blank">https://github.com/ewanharris/windowslib/tree/v2)</a>
   
   * Detecting devices (uses winappdeploycmd)
   * Detecting visualstudio (uses vswhere)
   * Detecting vswhere
   * Detecting SDKs (8.0 and up), and SDK subcomponents like revisions/extensions
   * Tests for majority of the above
   
   windows-plugin (<a href="https://github.com/ewanharris/appcd-plugin-windows/tree/windowslib_v2)" rel="nofollow" target="_blank">https://github.com/ewanharris/appcd-plugin-windows/tree/windowslib_v2)</a>
   * Started to wire up windowslib 2
   * VS detection and watching is in, tested across a couple of machines and seems to be handling ok, is very manual watching
   * Device detection is in, as it uses winappdeploycmd this is still using polling like, I don't like it but without some reverse engineering and c++ code I think it's the best we're gonna get
   * SDK detection and watching is in, tested across a couple of machines and seems happy. Does a dumb filter atm to remove 8.0, and 8.1, is build on regkeys and detect engine (yay!)</li>
</ol>


<p><a href="/DAEMON/DAEMON-9.json">JSON Source</a></p>