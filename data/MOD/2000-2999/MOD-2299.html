---
title: "[MOD-2299] Encrypted Database: Crashed on iOS 9 Devices after using SDK 5.5.0.GA"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-10-29T01:34:12.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.5.0</td></tr>
<tr><th>Fix Version/s</th><td>appcelerator.encrypteddatabase 2.0.2</td></tr>
<tr><th>Components</th><td>Encrypted SQLite DB</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Shuo Liang</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2016-09-26T13:43:05.000+0000</td></tr>
<tr><th>Updated</th><td>2018-08-06T17:49:31.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Reproduce:</h4>
1. Create a simple app, and add following code.
<code><pre>
var EncryptedDatabase = require('appcelerator.encrypteddatabase');

// Set Password
EncryptedDatabase.setPassword('testisamspassword');

// Open DB
EncryptedDatabase.open('test');
</pre></code>
2. Run the app to a iOS 10 device. 
3. Then run the app to a iOS 9 device.

<h4>Expect Result</h4>
It should work well on both device.

<h4>Actual Result</h4>
1.When running on the iOS 10 device, it works well.
2.When running on the iOS 9 device, the app will be crashed by the following error log
<code><pre>
Sep 26 12:35:29 Alastairs-iPad iSAMS-Testing[510] &lt;Warning&gt;: [INFO] iSAMS-Testing/1.0 (5.5.0.44a2e3f)
Sep 26 12:35:29 Alastairs-iPad iSAMS-Testing[510] &lt;Warning&gt;: [DEBUG] Loading: /var/containers/Bundle/Application/F8DC6717-12AF-4C3E-B5C2-CF3C4BFCFD69/iSAMS-Testing.app/app.js, Resource: app_js
Sep 26 12:35:29 Alastairs-iPad iSAMS-Testing[510] &lt;Warning&gt;: [DEBUG] Loading: /var/containers/Bundle/Application/F8DC6717-12AF-4C3E-B5C2-CF3C4BFCFD69/iSAMS-Testing.app/_app_props_.json, Resource: _app_props__json
Sep 26 12:35:29 Alastairs-iPad iSAMS-Testing[510] &lt;Warning&gt;: [ERROR] db error
Sep 26 12:35:29 Alastairs-iPad iSAMS-Testing[510] &lt;Warning&gt;: [DEBUG] Loading: /var/containers/Bundle/Application/F8DC6717-12AF-4C3E-B5C2-CF3C4BFCFD69/iSAMS-Testing.app/appcelerator.encrypteddatabase.js, Resource: appcelerator_encrypteddatabase_js
Sep 26 12:35:29 Alastairs-iPad iSAMS-Testing[510] &lt;Notice&gt;: dyld: lazy symbol binding failed: Symbol not found: _sqlite3_key
Referenced from: /var/containers/Bundle/Application/F8DC6717-12AF-4C3E-B5C2-CF3C4BFCFD69/iSAMS-Testing.app/iSAMS-Testing
Expected in: dyld shared cache
Sep 26 12:35:29 Alastairs-iPad iSAMS-Testing[510] &lt;Notice&gt;: dyld: Symbol not found: _sqlite3_key
Referenced from: /var/containers/Bundle/Application/F8DC6717-12AF-4C3E-B5C2-CF3C4BFCFD69/iSAMS-Testing.app/iSAMS-Testing
Expected in: dyld shared cache
</pre></code>


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/MOD/MOD-2299_60523/project-broken.pbxproj">project-broken.pbxproj</td></td><td>2016-10-14T08:18:09.000+0000</td><td>284783</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/MOD/MOD-2299_60524/project-fixed.pbxproj">project-fixed.pbxproj</td></td><td>2016-10-14T08:18:09.000+0000</td><td>284783</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/MOD/MOD-2299_60522/screenshot.mov">screenshot.mov</td></td><td>2016-10-14T08:18:19.000+0000</td><td>2243146</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2016-09-26

   Related issue: <a href="http://stackoverflow.com/questions/22512614/sqlite3-key-symbols-not-found-for-architecture-i386" rel="nofollow" target="_blank">http://stackoverflow.com/questions/22512614/sqlite3-key-symbols-not-found-for-architecture-i386</a>
   
   *EDIT*: The problem might be an architecture-issue here:
   !<a href="https://abload.de/img/bildschirmfoto2016-09hdsfk.png" rel="nofollow" target="_blank">https://abload.de/img/bildschirmfoto2016-09hdsfk.png</a>!
   
   So we need to change the value to <code>$(ARCHS_STANDARD)</code>. Although that still not completely  explains why it works on iOS 10 but not iOS 9. Maybe different devices? It would be good to know the exact devices (model and iOS version) to verify my thought. Thx! 
   
   And I currently cannot build the module, so [~cng] might need to help building.</li>
<li>Chris Barber 2016-10-14

   [~cng] Based on the code (<a href="https://github.com/appcelerator/node-appc/blob/master/lib/timodule.js#L238)" rel="nofollow" target="_blank">https://github.com/appcelerator/node-appc/blob/master/lib/timodule.js#L238)</a>, it appears the order in the tiapp.xml dictates the order the modules are added to the Xcode project.</li>
<li>Hans Knöchel 2016-10-14

   TODO: Currently, the <code>hooks</code> directory does not get copied over to the zipped module, so I needed to copy it there manually. [~cbarber] may know where to place it, please see the PR for details.
   
   *PR* (master): <a href="https://github.com/appcelerator-modules/appcelerator.encrypteddatabase/pull/16" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/appcelerator.encrypteddatabase/pull/16</a>
   *PR* (1_3_X): <a href="https://github.com/appcelerator-modules/appcelerator.encrypteddatabase/pull/17" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/appcelerator.encrypteddatabase/pull/17</a>
   
   *Test-Case*:
   <code><pre>
   var EncryptedDatabase = require('appcelerator.encrypteddatabase');
    
   // Set Password
   EncryptedDatabase.setPassword('testisamspassword');
    
   // Open DB
   EncryptedDatabase.open('test');
   </pre></code>
   
   *Side-note*:
   Unfortunately, I have no iOS 9 device in here Germany, so I could not actually test the change. But I can ensure that the <code>sqlite3.dylib</code> gets moved below the <code>libappcelerator.encrypteddatabase.a</code>, so it doesn't conflict. Thanks!</li>
<li>Chee Kiat Ng 2016-10-29

   APPROVED!</li>
<li>Eric Merriman  2018-08-06

   Cleaning up older fixed issues. If this issue should not have been closed as fixed, please reopen.</li>
</ol>


<p><a href="/MOD/MOD-2299.json">JSON Source</a></p>