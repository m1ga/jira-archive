---
title: "[MOD-2363] Android: ti.touchid does not decode Keychain data correctly"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-11-14T21:58:30.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>TouchID</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Gary Mathews</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2017-09-26T18:25:47.000+0000</td></tr>
<tr><th>Updated</th><td>2017-11-14T21:58:30.000+0000</td></tr>
</table>

<h3>Description</h3>

- ti.touchid can sometimes decode decrypted data incorrectly

*TEST CASE*
<code><pre>
var TouchID = require('ti.touchid');
    keychainItem = TouchID.createKeychainItem({
        identifier: 'test_key',
        accessControlMode: TouchID.ACCESS_CONTROL_TOUCH_ID_ANY // remove this to save without fingerprint authentication
    }),
    win = Ti.UI.createWindow({backgroundColor: 'white', layout: 'vertical'});
    queue = [],
    callback = function(e) {
        if (queue.length) {
            queue.shift().close();
        }
        alert(JSON.stringify(e, null, 1));
    };

keychainItem.addEventListener('save', callback);
keychainItem.addEventListener('read', callback);
keychainItem.addEventListener('reset', callback);
keychainItem.addEventListener('update', callback);

button('SAVE', function() {
    showFingerprint();
    keychainItem.save('86c8153c-6d2c-421a-8e79-eae8ad0831ba');
});
button('READ', function() {
    showFingerprint();
    keychainItem.read();
});
button('RESET', function() {
    showFingerprint();
    keychainItem.reset();
});
button('UPDATE', function() {
    showFingerprint();
    keychainItem.update('test_update');
});

win.open();

function showFingerprint() {
    if (keychainItem.accessControlMode !== TouchID.ACCESS_CONTROL_TOUCH_ID_ANY) return;
    var win = Ti.UI.createWindow({backgroundColor: 'white'}),
        img = Ti.UI.createImageView({image: '<a href="http://bit.ly/2ur2X4u" rel="nofollow" target="_blank">http://bit.ly/2ur2X4u</a>', width: 64, height: 64});
    queue.push(win);
    win.add(img);
    win.open();
}
function button(title, click) {
    var btn = Ti.UI.createButton({title: title, width: Ti.UI.FILL});
    btn.addEventListener('click', click);
    win.add(btn);
}
</pre></code>
- SAVE and then READ data
- READ callback should return the full string <code>86c8153c-6d2c-421a-8e79-eae8ad0831ba</code>

<h3>Comments</h3>

<ol>
<li>Gary Mathews 2017-09-26

   ti.touchid: <a href="https://github.com/appcelerator-modules/ti.touchid/pull/35" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/pull/35</a></li>
</ol>


<p><a href="/MOD/MOD-2363.json">JSON Source</a></p>