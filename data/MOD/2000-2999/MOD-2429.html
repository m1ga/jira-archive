---
title: "[MOD-2429] Arrow Push Custom Notification Sounds for Android 8+ Not Found"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-12-20T18:27:48.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>CloudPush</td></tr>
<tr><th>Labels</th><td>arrow, push</td></tr>
<tr><th>Reporter</th><td>Ken Rucker</td></tr>
<tr><th>Assignee</th><td>Yordan Banev</td></tr>
<tr><th>Created</th><td>2018-05-16T19:34:18.000+0000</td></tr>
<tr><th>Updated</th><td>2019-12-20T18:27:54.000+0000</td></tr>
</table>

<h3>Description</h3>

Titanium 7.1.1.GA

When sending Arrow Push notifications with a custom sound file to an Android device running Android 8 or above, the sound is not found and depending on the status of the app (foreground or background, the app either only plays the device default sound, or crashes the app.

A sample payload:

<code><pre>
{
  "alert": "My Alert Text",
  "icon": "q",
  "badge": " 1",
  "sound": "popq.wav",
  "vibrate": "false",
  "title": "My Title",
  "priority": "high",
  "content-available": 0
}
</pre></code>

The sounds are located at:
/resources/popq.wav (For iOS)
/resources/sound/popq.wav (for Android)

Note: The docs state to specify the sound without the extension. However, I am only able to get the push notification custom sounds to work on both Android and iOS WITH the extension specified. If you do not specify an extension, then you get the default notification sound on both Android and iOS. I am using WAV because that sound format is supported by both Android and iOS. Icon works fine with not including the extension.

With app in foreground:
<code><pre>
[WARN] :   W/System.err: java.io.FileNotFoundException: /sdcard/cocoafish/sound/com.walkthelot.qalerts/popq.wav (No such file or directory)
[WARN] :   W/System.err: 	at java.io.FileOutputStream.open0(Native Method)
[WARN] :   W/System.err: 	at java.io.FileOutputStream.open(FileOutputStream.java:287)
[WARN] :   W/System.err: 	at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:223)
[WARN] :   W/System.err: 	at java.io.FileOutputStream.&lt;init&gt;(FileOutputStream.java:110)
[WARN] :   W/System.err: 	at com.appcelerator.aps.APSCloudPush.getAndTransferFile(APSCloudPush.java:544)
[WARN] :   W/System.err: 	at com.appcelerator.aps.APSCloudPush.showTrayNotification(APSCloudPush.java:443)
[WARN] :   W/System.err: 	at com.appcelerator.aps.APSCloudPush.receivePayload(APSCloudPush.java:269)
[WARN] :   W/System.err: 	at com.appcelerator.aps.GCMReceiver.onReceive(GCMReceiver.java:30)
[WARN] :   W/System.err: 	at android.app.ActivityThread.handleReceiver(ActivityThread.java:3187)
[WARN] :   W/System.err: 	at android.app.ActivityThread.-wrap17(Unknown Source:0)
[WARN] :   W/System.err: 	at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1672)
[WARN] :   W/System.err: 	at android.os.Handler.dispatchMessage(Handler.java:106)
[WARN] :   W/System.err: 	at android.os.Looper.loop(Looper.java:164)
[WARN] :   W/System.err: 	at android.app.ActivityThread.main(ActivityThread.java:6494)
[WARN] :   W/System.err: 	at java.lang.reflect.Method.invoke(Native Method)
[WARN] :   W/System.err: 	at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:438)
[WARN] :   W/System.err: 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:807)
[WARN] :   Notification: Use of stream types is deprecated for operations other than volume control
[WARN] :   Notification: See the documentation of setSound() for what to use instead with android.media.AudioAttributes to qualify your playback use case
</pre></code>
When app is closed I get an Android error that APP Name has stopped, and no notification comes through.

This all works flawlessly on iOS and any Android device running Android API 25 or LOWER. The app is in production on both iOS and Android stores. For Android installations greater than API 25 I just disable the option for the user to choose a custom sound.

<h3>Comments</h3>

<ol>
<li>Yordan Banev 2018-06-05

   APS_SDK: <a href="https://github.com/appcelerator/aps_sdk/pull/320" rel="nofollow" target="_blank">https://github.com/appcelerator/aps_sdk/pull/320</a></li>
<li>Michael Scholz 2018-08-06

   Any status/progress update on this issue?</li>
<li>Ken Rucker 2018-08-06

   Sadly, I know I haven't heard zip and the latest SDK's have not fixed it.</li>
<li>Michael Scholz 2018-08-06

   I'm wondering if other modules like Ti.goosh has this issue resolved. I was testing with it and it worked well in many regards. I did not check for this issue specifically. I have seen a related issue posted back in March 2018. It has been 6 months.</li>
<li>Ken Rucker 2018-09-10

   I doubt it since the issue is related to basically having permissions/access to the custom sound file in the Android app container.</li>
<li>Joshua Quick 2018-10-02

   I'll ask the test team to re-test, but I suspect this issue still exists when running on Android 7.0 and above. It's due to a breaking-change that Google has made where external apps need to be given permission to read another app's files.
   <a href="https://developer.android.com/about/versions/nougat/android-7.0-changes#sharing-files" rel="nofollow" target="_blank">https://developer.android.com/about/versions/nougat/android-7.0-changes#sharing-files</a>
   
   The problem here is that their is a design issue on Google's end where there is no way to grant the system permission without using *hack* (grant it to Google's "com.android.systemui" system app), which is not guaranteed to work on all devices and OS versions.
   
   You can see Google's bug reports on this issue below. Supposedly they fixed it in Android 9.0, but we would have to see if the issue is still outstanding in Android 7.0 - 8.x.
   <a href="https://issuetracker.google.com/issues/36524161" rel="nofollow" target="_blank">https://issuetracker.google.com/issues/36524161</a>
   <a href="https://issuetracker.google.com/issues/37118905" rel="nofollow" target="_blank">https://issuetracker.google.com/issues/37118905</a>
   </li>
<li>Joshua Quick 2018-12-04

   The issue is that Google has made a breaking change in Android 8.0 and above. You can no longer assign a sound to individual notifications. Instead, you must configure a "notification channel" with a sound and assign that notification the ID to that notification channel. We've added notification channel "sound" support in 7.5.0. Please see...
   <a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Android.NotificationChannel-property-sound
   
   The test procedure and code example attached to the below pull request shows you how to set up a notification channel with sound. While it's an example for a local notification, you still need to create a channel yourself for push notification as well within your app. Arrow can't do this for you. The key thing is you need to assign the notification channel a name, channel ID, importance level, and path to the sound file.
   <a href="https://github.com/appcelerator/titanium_mobile/pull/10400" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10400</a>
   
   The channel ID string you set up is important. You need to apply this channel ID to your remote notification JSON so that the Android side knows which channel to assign it to. If you don't assign it a channel ID, then it ends being posted to a default channel, which is what is happening to you now.
   
   For example, if your notification channel ID is <code>"my_channel_1"</code>, then your Arrow JSON needs to be the below...
   <code><pre>
   {
   	"android": {
   		"title": "My Title",
   		"alert": "My alert message.",
   		"channelId": "my_channel_1"
   	}
   }
   </pre></code>
   
   Under the JSON's <code>"android"</code> table, the <code>"channelId"</code> is where you put the notification channel ID string.
   
   Also note that the above only applies to Android 8.0 and above. Older Android OS versions do not support notification channels and you still have to apply a sound to individual notifications for it to work on older systems. Unfortunately, you have to do it both ways. That's how Google has made it, not us.
   
   I hope this helps.</li>
</ol>


<p><a href="/MOD/MOD-2429.json">JSON Source</a></p>