---
title: "[MOD-2480] SocketIO: Event handler GC leads to crash (iOS)"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-02-25T23:08:58.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Jan Vennemann</td></tr>
<tr><th>Assignee</th><td>Jan Vennemann</td></tr>
<tr><th>Created</th><td>2018-12-07T00:34:55.000+0000</td></tr>
<tr><th>Updated</th><td>2019-02-25T23:09:13.000+0000</td></tr>
</table>

<h3>Description</h3>

For compatibility with the web client we have our own event listener methods <code>on</code>, <code>once</code> and <code>off</code>. Those do not properly protect the callback against GC so when the event listener is ultimately called and was already subject to GC the app will crash.

<h3>Comments</h3>

<ol>
<li>Hans Kn√∂chel 2018-12-07

   Thanks for creating the ticket Jan! If there is a workaround (e.g. by using callbacks directly), we could apply that temporarily to be unblocked from production. Thanks!</li>
<li>Jan Vennemann 2018-12-07

   Try calling the proxy's <code>addEventListener</code> in addition to <code>on</code> or <code>once</code> and <code>removeEventListener</code> with <code>off</code>.. That should take care of properly storing the callback and protecting it against GC. I have a fix incoming which does exactly the same behind the scenes.</li>
<li>Jan Vennemann 2019-02-25

   Fixed with version 2.0.0 of the socket.io module.</li>
</ol>


<p><a href="/MOD/MOD-2480.json">JSON Source</a></p>