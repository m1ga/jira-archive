---
title: "[MOD-2504] Missing linker flags in appcelerator.encrypteddatabase module"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-04-10T19:15:13.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Encrypted SQLite DB</td></tr>
<tr><th>Labels</th><td>ios</td></tr>
<tr><th>Reporter</th><td>Ryan Aston</td></tr>
<tr><th>Assignee</th><td>Jan Vennemann</td></tr>
<tr><th>Created</th><td>2019-03-24T03:46:33.000+0000</td></tr>
<tr><th>Updated</th><td>2019-04-10T19:15:13.000+0000</td></tr>
</table>

<h3>Description</h3>

When attempting to build a project with the encrypted database module for the iOS simulator in the environment above the xcodebuild linker step fails.  Running <code><pre>appc run -p ios -l trace</pre></code> shows the following error:

{noformat}
[TRACE] Undefined symbols for architecture x86_64:
[TRACE]   "_inflate", referenced from:
[TRACE]       _zipfileColumn in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_deflateInit2_", referenced from:
[TRACE]       _zipfileDeflate in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_compressBound", referenced from:
[TRACE]       _zipfileDeflate in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_deflate", referenced from:
[TRACE]       _zipfileDeflate in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_inflateInit2_", referenced from:
[TRACE]       _zipfileColumn in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_deflateEnd", referenced from:
[TRACE]       _zipfileDeflate in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_inflateEnd", referenced from:
[TRACE]       _zipfileColumn in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_crc32", referenced from:
[TRACE]       _zipfileStep in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]       _zipfileUpdate in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_uncompress", referenced from:
[TRACE]       _uncompressFunc in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]   "_compress", referenced from:
[TRACE]       _compressFunc in libappcelerator.encrypteddatabase.a(sqlite3.o)
[TRACE]      (maybe you meant: _sqlite3_compress_init
[TRACE] ) 
[TRACE] ld: symbol(s) not found for architecture x86_64
[TRACE] clang: error: 
[TRACE] linker command failed with exit code 1 (use -v to see invocation)
[ERROR] ** BUILD FAILED **
[ERROR] The following build commands failed:
[ERROR]         Ld /Users/ryanaston/Projects/EncDBiOSBuildBug/build/iphone/build/Products/Debug-iphonesimulator/EncDBiOSBuildBug.app/EncDBiOSBuildBug normal x86_64
[ERROR] (1 failure)
{noformat}

Researching this issue I found that adding <code><pre>OTHER_LDFLAGS= -lz</pre></code> to the module.xcconfig file fixes the issue.  If another module in the project has already set this flag it actually works fine, but when this module is alone it will not build without that flag.

This happens with both version 2.0.5 and the unofficial build of 2.0.6 we were provided for testing purposes.

Demo project here:  <a href="https://drive.google.com/file/d/1SMUz7HxNPQPUj6H48Q_NOMYwhhrj7Qd8/view?usp=sharing" rel="nofollow" target="_blank">https://drive.google.com/file/d/1SMUz7HxNPQPUj6H48Q_NOMYwhhrj7Qd8/view?usp=sharing</a>



<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/MOD/MOD-2504_66545/Screen Shot 2019-04-07 at 4.22.33 PM.png">Screen Shot 2019-04-07 at 4.22.33 PM.png</td></td><td>2019-04-07T10:24:53.000+0000</td><td>34184</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Jan Vennemann 2019-04-08

   This is due to changes in the Xcode project in 8.0.0.GA. Previously we would link with the <code>libz</code> library by default. This was removed in 8.0.0.GA and now modules that need to link against this library will have to explicitly specify this in their <code>module.xcconfig</code>. As already stated the easy fix is to update the modules <code>module.xcconfig</code> locally.
   
   Moving this to the MOD project to update the <code>module.xcconfig</code>.</li>
<li>Jan Vennemann 2019-04-08

   PR: <a href="https://github.com/appcelerator-modules/appcelerator.encrypteddatabase/pull/35" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/appcelerator.encrypteddatabase/pull/35</a></li>
<li>Christopher Williams 2019-04-10

   merged to master branch of the module</li>
</ol>


<p><a href="/MOD/MOD-2504.json">JSON Source</a></p>