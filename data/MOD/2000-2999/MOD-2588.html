---
title: "[MOD-2588] Android: Add fallback support to password, pin, or touch-pattern in \"ti.identity\""
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-07-27T17:52:10.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.1.0</td></tr>
<tr><th>Components</th><td>Identity</td></tr>
<tr><th>Labels</th><td>2020-Q3, android, module, passcode, password, ti.identity</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Akansha Maheshwari</td></tr>
<tr><th>Created</th><td>2020-03-18T16:42:09.000+0000</td></tr>
<tr><th>Updated</th><td>2020-07-27T17:52:10.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
The "ti.identity" module for Android should fallback to using the device's password, pin, or touch-pattern if a biometric means of identification (ie: touch id or face id) is not available.

*To-Do:*
When setting up the Java <code>BiometricPrompt.PromptInfo.Builder</code>, we should call the <code>setDeviceCredentialAllowed()</code> and to <code>true</code> to enable fallback support... but only
<a href="https://developer.android.com/training/sign-in/biometric-auth#allow-fallback" rel="nofollow" target="_blank">https://developer.android.com/training/sign-in/biometric-auth#allow-fallback</a>

We should only set it to <code>true</code> if the module's <code>AUTHENTICATION_POLICY_PASSCODE</code> is set. This is for parity with iOS.

Currently, we prompt in the following 2 places in the code...
[FingerPrintHelper.java#L127](<a href="https://github.com/appcelerator-modules/titanium-identity/blob/3e0d849bf6e157df60b48efd272857fa4c3e8b4f/android/src/ti/identity/FingerPrintHelper.java#L127)" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/titanium-identity/blob/3e0d849bf6e157df60b48efd272857fa4c3e8b4f/android/src/ti/identity/FingerPrintHelper.java#L127)</a>
[KeychainItemProxy.java#L159](<a href="https://github.com/appcelerator-modules/titanium-identity/blob/3e0d849bf6e157df60b48efd272857fa4c3e8b4f/android/src/ti/identity/KeychainItemProxy.java#L159)" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/titanium-identity/blob/3e0d849bf6e157df60b48efd272857fa4c3e8b4f/android/src/ti/identity/KeychainItemProxy.java#L159)</a>


<h3>Comments</h3>

<ol>
<li>Akansha Maheshwari 2020-04-21

   <a href="https://github.com/appcelerator-modules/titanium-identity/pull/52" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/titanium-identity/pull/52</a>
   
   In this, i add the fallback for the device's when the biometric means of identification is not available in the Module's TiIdentity.authenticate method.</li>
<li>Lokesh Choudhary 2020-07-27

   [~jquick], This will need a module ver update to 3.0.2 in the SDK repo as well as this is included with the SDK.</li>
<li>Christopher Williams 2020-07-27

   merged PR including it in SDK to master. Cherry-picked to 9_1_X and 9_3_X branches.</li>
<li>Lokesh Choudhary 2020-07-27

   Verified module have been added to SDK branches.
   Closing.</li>
</ol>


<p><a href="/MOD/MOD-2588.json">JSON Source</a></p>