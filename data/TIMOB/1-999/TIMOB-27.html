---
title: "[TIMOB-27] API - Facebook Connect Integration"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:50:10.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 0.7.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>facebook, ios, iphone</td></tr>
<tr><th>Reporter</th><td>Nolan Wright</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-04-15T02:22:41.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:50:10.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><h2>Description</h2>
<p>The purpose of this API is to enable developers to use the
Facebook Connect Objective-C API via Javascript</p>
<h2>Create Session</h2>
<p>The first step is to create a Facebook Session</p>
<pre>
<code class="javascript">
var session = Titanium.Facebook.createSession({
    apiKey:'my_api_key',
    appSecret:'my_app_secret',
    proxyURL:'my proxy url'
});

var isLoggedIn = session.resume();</code>
</pre>
<p>Returns true if user is already logged in, otherwise it returns
false</p>
<h2>Button Support</h2>
<p>We need to add support for two Facebook iPhone buttons:</p>
<pre>
<code class="javascript">Titanium.Facebook.CONNECT_BUTTON

Titanium.Facebook.LOGOUT_BUTTON</code>
</pre>
<p>These should be supported via the systemButton property of the
Titanium.UI.createButton API.</p>
<p>Note: the login button when clicked automatically shows the
Login Dialog</p>
<h2>Login Dialog</h2>
<p>This API creates and displays the Facebook Login Dialog</p>
<pre>
<code class="javascript">
var dialog = Titanium.Facebook.createLoginDialog({
    session:mySessionObject,
});

dialog.show();</code>
</pre>
<h2>Login Event</h2>
<pre>
<code class=
"javascript">session.addEventListener('login',function(session)
{
    // returns the updated session object after successful login
});</code>
</pre>
<h2>Permissions Dialog</h2>
<p>This API creates and displays the Facebook Extended Permission
Dialog</p>
<pre>
<code class=
"javascript">var dialog = Titanium.Facebook.createPermissionsDialog({
    permission:'permission_string'
    success:function()
    {
       // permission granted - do something cool
    },
    cancel: function()
    {
       // permission not granted - too bad
    }
});

dialog.show();</code>
</pre>
<h2>Generic Facebook API Requests</h2>
<p>This API enables you to call any of the support Facebook Connect
APIs</p>
<pre>
<code class="javascript">
var requestData = {name:'value',name2:'value2'};

var request = Titanium.Facebook.executeAPI({
     name:'api_name',
     data:requestData,
     function(result)
     {
           // result should be JSON object return from API call
     }

});</code>
</pre>
<h2>Feed Dialog</h2>
<p>This API allows you to publish a story to a user's feed.</p>
<pre>
<code class="javascript">
var templateDataObj = {key:'value'};

var dialog = Titanium.Facebook.createFeedDialog({
      templateBundleId: 12345,
      templateData: templateDataObj,
      function(result)
      {
         // was post successful
      }
});

dialog.show();</code>
</pre></div>

<h3>Comments</h3>

<ol>
<li>Jeff Haynie 2011-04-15

   <div><p>A few questions:</p>
   <ul>
   <li>
   <p>I don't like the session.resume() method - seems weird. Is this
   their name? Can we just use session.isLoggedIn()? Or is this the
   api that causes session to start? Maybe if it is, we could have a
   session.connect() to cause it to connect and then
   session.isLoggedIn() would return true/false depending on if you've
   already done this (or not).</p>
   </li>
   <li>
   <p>is there an API to see if we already have a permission? i.e. I
   don't want to show dialog if permission has already been granted...
   how would you do that?</p>
   </li>
   <li>
   <p>we need a logout capability -- session.logout() ?</p>
   </li>
   </ul></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>Facebook connect (and further OAuth) could be a really killer
   feature for Desktop as well..</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>I ended up implementing the API a little differently.</p>
   <h1>Create Login/Logout Button</h1>
   <p>Create a Facebook login/logout button and bind it to a specific
   ID. You can add and remove listeners from this button once
   created.</p>
   <pre>
   <code class=
   "javascript">var button = Titanium.Facebook.createLoginButton({
       'id':'b',
       'style':'normal',
       'apikey':Titanium.App.Properties.getString("facebook.apikey"),
       'secret':Titanium.App.Properties.getString("facebook.secret")
   });
   button.addEventListener('login',function()
   {
       console.info("LOGIN");
   });
   button.addEventListener('logout',function()
   {
       console.info("LOGOUT");
   });</code>
   </pre>
   <p>The style property can either be normal (default if not
   specified) or wide.</p>
   <h1>Query</h1>
   <p>You can execute FQL query.</p>
   <pre>
   <code class=
   "javascript">Titanium.Facebook.query("select uid,name from user where uid == "+Titanium.Facebook.getUserId(),function(r)
   {
       console.info("QUERY RESULT RETURNED success = "+r.success+", error = "+r.error+", data="+r.data);
   });</code>
   </pre>
   <h1>Explicit Login</h1>
   <p>You can cause explicit login</p>
   <pre>
   <code class="javascript">Titanium.Facebook.login(function(result)
   {
      console.info("login success="+result.success);
   });</code>
   </pre>
   <h1>Explicit Logout</h1>
   <p>You can cause explicit logout</p>
   <pre>
   <code class="javascript">Titanium.Facebook.logout(function(result)
   {
      console.info("logout success="+result.success);
   });</code>
   </pre>
   <h1>Login status</h1>
   <p>You can determine the login status.</p>
   <pre>
   <code class="javascript">Titanium.Facebook.isLoggedIn();</code>
   </pre>
   <h1>Login user id</h1>
   <p>You can determine the user id of the logged in user or null if
   not logged in</p>
   <pre>
   <code class="javascript">Titanium.Facebook.getUserId();</code>
   </pre>
   <h1>Request extended permission</h1>
   <p>You can request extend permissions</p>
   <pre>
   <code class=
   "javascript">Titanium.Facebook.requestPermission("publish_feed",function(result)
   {
      console.debug("permission success="+result.success);
   });</code>
   </pre>
   <h1>Publish to Feed</h1>
   <p>You can publish to users feed</p>
   <pre>
   <code class=
   "javascript">Titanium.Facebook.publishFeed(123456789,{'img':'http://foo/bar.png'},'nolan is cool',function(result)
   {
      console.debug("publish success success="+result.success);
   });</code>
   </pre></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/6ec20bf4ca21c075ece508f4def5f2c4daa7c86d"
   title=
   "Changeset [6ec20bf4ca21c075ece508f4def5f2c4daa7c86d]">[6ec20bf4ca21c075ece508f4def5f2c4daa7c86d]</a>)
   [<a href="/projects/32238/tickets/27" title="Ticket #27">#27</a>
   state:open] added initial Facebook Connect module for iphone
   <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/6ec20bf4ca21c075ece508f4def5f2c4daa7c86d" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/6ec20bf4ca21c075ece508f4def5f2c4daa7c86d</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/6ec20bf4ca21c..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/6ec20bf4ca21c...</a></a></p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><h1>Execute API call</h1>
   <p>you can execute a facebook method. the 2nd parameter is optional
   and is any data (as javascript json object) to pass to the
   method.</p>
   <pre>
   <code class=
   "javascript">Titanium.Facebook.execute("facebook.Users.getStatus",null,function(evt)
   {
      console.info("evt = "+evt+", success="+evt.success+",cancel="+evt.cancel+",error="+evt.error+",json="+Ti._JSON(evt.data));
   });</code>
   </pre></div></li>
<li>Nolan Wright 2011-04-15

   <div><p>added in 0.7.0</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-27.json">JSON Source</a></p>