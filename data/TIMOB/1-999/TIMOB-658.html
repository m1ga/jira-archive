---
title: "[TIMOB-658] Problem with XHR + openPhotoGallery"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2011-04-15T02:33:55.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.2.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, iphone, xhr</td></tr>
<tr><th>Reporter</th><td>Jeff Haynie</td></tr>
<tr><th>Assignee</th><td>Reggie Seagraves</td></tr>
<tr><th>Created</th><td>2011-04-15T02:33:54.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-02T19:19:53.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>(From Kosso)</p>
<p>I've been stuck for a few days on an app crash in my app, which
seems to always occur after choosing/taking photo or video or
recording audio AFTER posting via XHR</p>
<p>My posting form is a window with tabBarHidden which opens the
camera or media picker or opens my audio recorder.</p>
<p>It always works the first time perfectly, then uploads the media
fine.</p>
<p>Then when I try to (in this example) openPhotoGallery, the app
crashes with this stack trace output</p>
<p><a href="/projects/32238/changesets/INFO" title=
"Changeset [INFO]">[INFO]</a> opening photo gallery....</p>
<p>2010-03-29 17:28:17.928 phreadz[26505:207] *** -[NSCFDictionary
_tabBlur]: unrecognized selector sent to instance 0x5354f30</p>
<p><a href="/projects/32238/changesets/ERROR" title=
"Changeset [ERROR]">[ERROR]</a> The application has crashed with an
unhandled exception. Stack trace:</p>
<p>0 CoreFoundation 0x02bec45b <strong>raiseError + 299<br>
1 libobjc.A.dylib 0x90417509 objc_exception_throw + 56<br>
2 CoreFoundation 0x02c4983b -[NSObject doesNotRecognizeSelector:] +
187<br>
3 CoreFoundation 0x02be0676</strong> <em>forwarding</em> <strong>+
902<br>
4 CoreFoundation 0x02bbc6c2 _CF_forwarding_prep_0 + 50<br>
5 phreadz 0x0006f9cf -[TitaniumApp showModalController:animated:] +
83<br>
6 phreadz 0x00091145 -[MediaModule openPhotoGallery:] + 575<br>
7 Foundation 0x0048fb46</strong> NSThreadPerformPerform + 678<br>
8 CoreFoundation 0x02bb78e1 CFRunLoopRunSpecific + 3217<br>
9 CoreFoundation 0x02bb6c48 CFRunLoopRunInMode + 88<br>
10 GraphicsServices 0x02e8878d GSEventRunModal + 217<br>
11 GraphicsServices 0x02e88852 GSEventRun + 115<br>
12 UIKit 0x0071a003 UIApplicationMain + 1157<br>
13 phreadz 0x0000264e main + 360<br>
14 phreadz 0x000024ba start + 54</p>
<p>2010-03-29 17:28:17.930 phreadz[26505:207]
<strong><em>Terminating app due to uncaught exception
'NSInvalidArgumentException', reason: '</em></strong>
-[NSCFDictionary _tabBlur]: unrecognized selector sent to instance
0x5354f30'</p>
<p>2010-03-29 17:28:17.931 phreadz[26505:207] Stack: (<br>
46056539,<br>
2420208905,<br>
46438459,<br>
46007926,<br>
45860546,<br>
457167,<br>
594245,<br>
4782918,<br>
45840609,<br>
45837384,<br>
48793485,<br>
48793682,<br>
7446531,<br>
9806,<br>
9402<br>
)</p>
<p><a href="/projects/32238/changesets/INFO" title=
"Changeset [INFO]">[INFO]</a> Application has exited from
Simulator</p></div>

<h3>Comments</h3>

<ol>
<li>kosso 2011-04-15

   <div><p>Hi,</p>
   <p>Just to add that this happens whenever I try to do anything
   related to the MediaModule (gallery, video, photo or record
   audio)</p>
   <p>And it always happens the SECOND time AFTER an XHR post.</p>
   <p>Unfortunately, I have not been able to replicate this with the
   KitchenSink XHR upload photo demo.<br>
   I will see if I can create a simple replication of the bug and send
   it over.</p>
   <p>It's strange that the crash only occurs AFTER the XHR post.</p></div></li>
<li>kosso 2011-04-15

   <div><p>Here are some more console outputs after crashes:</p>
   <p><a href=
   "<a href="http://pastie.org/895357" rel="nofollow" target="_blank">http://pastie.org/895357</a>"><a href="http://pastie.org/895357" rel="nofollow" target="_blank">http://pastie.org/895357</a></a></p>
   <p>I have also had this happen, again after an XHR POST when trying
   to open my audio recorder - so it seems that it's not totally
   related to the gallery or camera stuff.</p>
   <p>The common factor in every crash appears to be the '_tabBlur' -
   and it's always after an XHR POST to upload a TiBlob</p>
   <p>The crashes only when I actually click a button to open the
   gallery, record audio or use the camera. ie: nothing seems to crash
   on my actual post/form window</p>
   <p>I'm currently trying to strip down my posting window to see what
   it could be related to.</p></div></li>
<li>kosso 2011-04-15

   <div><p>Hi,</p>
   <p>Sorry. But you can ignore this now. Or change to 'invalid'</p>
   <p>It seems that I had been using some windows where I could have
   been using views and this was somehow confusing the window
   hierarchy after going back/closing a complex window with the
   media/camera launching button on it. this was causing the _tabBlur
   to get muddled.</p>
   <p>I have altered my designs to use just views and the issue seems
   to have gone away.</p></div></li>
<li>Don Thorp 2011-04-15

   <div><p>marked invalid as requested.</p></div></li>
<li>Lee Morris 2017-03-02

   Closed as invalid.</li>
</ol>


<p><a href="/TIMOB/TIMOB-658.json">JSON Source</a></p>