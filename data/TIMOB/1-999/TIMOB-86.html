---
title: "[TIMOB-86] Race condition in sound: prepareAsync called in state 128"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:51:56.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 0.6.2</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android</td></tr>
<tr><th>Reporter</th><td>Don Thorp</td></tr>
<tr><th>Assignee</th><td>Don Thorp</td></tr>
<tr><th>Created</th><td>2011-04-15T02:23:31.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:51:56.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>If release was called just as sound finished it could cause the
MediaPlayer to throw an IllegalState exception 'prepareAsync called
in state 128'. Being an unchecked exception, it would cause the
application to terminate.</p></div>

<h3>Comments</h3>

<ol>
<li>Don Thorp 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/73c36134d78e207ef2075d27f7452f363d76c23e"
   title=
   "Changeset [73c36134d78e207ef2075d27f7452f363d76c23e]">[73c36134d78e207ef2075d27f7452f363d76c23e]</a>)
   [<a href="/projects/32238/tickets/86" title="Ticket #86">#86</a>
   state:resolved] Removed call to stop in release. It was causing an
   IllegalStateException to be thrown in some cases. Also put
   throwable catches around all audio calls to prevent it from taking
   the app down. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/73c36134d78e207ef2075d27f7452f363d76c23e" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/73c36134d78e207ef2075d27f7452f363d76c23e</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/73c36134d78e2..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/73c36134d78e2...</a></a></p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-86.json">JSON Source</a></p>