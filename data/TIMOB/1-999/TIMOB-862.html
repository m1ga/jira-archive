---
title: "[TIMOB-862] on android cdata from xml returns blank"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:54:28.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.4.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, xml</td></tr>
<tr><th>Reporter</th><td>Masood</td></tr>
<tr><th>Assignee</th><td>Don Thorp</td></tr>
<tr><th>Created</th><td>2011-04-15T02:38:01.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:54:28.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Example XML feed</p>
<pre>
<code>&lt;title&gt;some title&lt;/title&gt;
&lt;description&gt;&lt;![CDATA[Some text]]&gt;&lt;/description&gt;</code>
</pre>
<p>the following code works in iphone but not on android to extract
description:<br></p>
<pre>
<code>var title = item.getElementsByTagName("title").item(0).text;
var description = item.getElementsByTagName("description").item(0).text;</code>
</pre></div>

<h3>Comments</h3>

<ol>
<li>Masood 2011-04-15

   <div><p>found answer on q&amp;a, this works on android:<br></p>
   <pre>
   <code>var description = item.getElementsByTagName("description").item(0).firstChild.nodeValue.text;</code>
   </pre>
   <p>please close this ticket. thanks.</p></div></li>
<li>Brion Vibber 2011-04-15

   <div><p>This bug is legitimate, and also affects other sorts of
   situations such as embedded child elements:</p>
   <pre>
   <code>    Ti.XML.parseString('&lt;div&gt;foo &lt;span&gt;bar&lt;/span&gt; baz&lt;/div&gt;').documentElement.text</code>
   </pre>
   <p>gives 'foo bar baz' as expected on iPhone;<br>
   gives 'foo baz' on Android.</p>
   <p>The bug is in ElementProxy:</p>
   <pre>
   <code>    public String getText() {
               StringBuilder sb = new StringBuilder();
               NodeList children = element.getChildNodes();
               for (int i = 0; i &lt; children.getLength(); i++)
               {
                       Node child = children.item(i);
                       if (child.getNodeType() == Node.TEXT_NODE) {</code>
   </pre>
   <p>// ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
   <pre>
   <code>                            sb.append(((Text)child).getNodeValue());
                       }
               }
   
               return sb.toString();
       }</code>
   </pre>
   <p>That explicit check for text child nodes fails to include text
   content from character entities, CDATA sections, or child elements
   which themselves contain text.</p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/9b3c7fa6daba96d532b223be26f7746aa97e0231"
   title=
   "Changeset [9b3c7fa6daba96d532b223be26f7746aa97e0231]">[9b3c7fa6daba96d532b223be26f7746aa97e0231]</a>)
   also handle elements, entities, and CDATA sections in
   ElementProxy.getText() [<a href="/projects/32238/tickets/862"
   title="Ticket #862">#862</a> state:resolved] <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/9b3c7fa6daba96d532b223be26f7746aa97e0231" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/9b3c7fa6daba96d532b223be26f7746aa97e0231</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/9b3c7fa6daba9..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/9b3c7fa6daba9...</a></a></p></div></li>
<li>Brion Vibber 2011-04-15

   <div><p>Confirmed that fixes my problem case -- thanks!</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-862.json">JSON Source</a></p>