---
title: "[TIMOB-982] Ti.App.addEventListener('close') not working"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:54:52.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.4.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Nolan Wright</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-04-15T02:40:42.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:54:52.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>code:</p>
<p>// this sets the background color of the master UIView (when
there are no windows/tab groups on it)
Titanium.UI.setBackgroundColor('#000');</p>
<p>// create tab group var tabGroup =
Titanium.UI.createTabGroup();</p>
<p>Titanium.App.addEventListener('close',function(e)<br>
{</p>
<pre>
<code>alert("The application is being shutdown");</code>
</pre>
<p>});</p>
<p>// // create base UI tab and root window // var win1 =
Titanium.UI.createWindow({<br></p>
<pre>
<code>title:'Tab 1',
backgroundColor:'#fff',
barColor:'#005298'</code>
</pre>
<p>});</p>
<p>var tab1 = Titanium.UI.createTab({<br></p>
<pre>
<code>icon:'KS_nav_views.png',
title:'Tab 1',
window:win1</code>
</pre>
<p>});</p>
<p>var navbar = Titanium.UI.createTabbedBar({<br></p>
<pre>
<code>labels:["A", "B"],
style:Titanium.UI.iPhone.SystemButtonStyle.BAR,
backgroundColor:"#005298"</code>
</pre>
<p>});</p>
<p>win1.setTitleControl(navbar);</p>
<p>var scrollView = Titanium.UI.createScrollView({<br></p>
<pre>
<code>contentHeight: 'auto',
contentWidth:'auto',
top:0,
showVerticalScrollIndicator:true,
showHorizontalScrollIndicator:true</code>
</pre>
<p>});</p>
<p>var view = Titanium.UI.createView({<br></p>
<pre>
<code>width:300,
height:100,
top:20,
borderRadius:5,
backgroundGradient:{
    type:'linear',
    colors:[{color:'#005298',position:0.0},
                    {color:'#001d36',position:1.0}]

}</code>
</pre>
<p>});</p>
<p>scrollView.add(view);<br>
win1.add(scrollView);</p>
<p>// // add tabs // tabGroup.addTab(tab1);</p>
<p>// open tab group tabGroup.open();</p></div>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2011-04-15

   <div><p>This is a little misleading: The callback happens, but only
   after the program has suspended, which means that nothing is going
   to get logged. Seems like this will mostly end up being a
   documentation issue, provided that I can confirm that the stuff in
   the callback is actually happening (probably via a contacts or iPod
   test app).</p>
   <p>Once this is taken care of there will need to be some additional
   infrastructure for 4.0's pause/resume.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Okay, much worse than I thought. There's a race between Titanium
   and the OS to see when resources get freed up: The system wants to
   release them immediately, and Titanium wants to try and finish
   everything up. 4.0 allows for the application to demand additional
   time to finish tasks in the background, but allowing compilation
   for 3.1.x (and iPad) means that app event support wouldn't work on
   these systems.</p>
   <p>Investigating further.</p></div></li>
<li>Dasher 2011-04-15

   <div><p>Just so it doesn't slip through the cracks - this is also an
   issue on Android :)</p></div></li>
<li>Blain Hamon 2011-04-15

   <div><p>Tag team coding. Swapping with Steve.</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/f6e6787856b1faf7e7b71cd577b775544b25d0ee"
   title=
   "Changeset [f6e6787856b1faf7e7b71cd577b775544b25d0ee]">[f6e6787856b1faf7e7b71cd577b775544b25d0ee]</a>)
   When closing, the app now sends the close event before the rest of
   the shutdown, and waits for the function to be processed before
   exiting. Note that it does mean if the javascript takes too long,
   the app will be force quit like the iPhone OS would any other app.
   Closes <a href="/projects/32238/tickets/982" title=
   "Ticket #982">#982</a> <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/f6e6787856b1faf7e7b71cd577b775544b25d0ee" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/f6e6787856b1faf7e7b71cd577b775544b25d0ee</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/f6e6787856b1f..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/f6e6787856b1f...</a></a></p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-982.json">JSON Source</a></p>