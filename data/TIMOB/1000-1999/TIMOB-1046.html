---
title: "[TIMOB-1046] calling selectAnnotation on mapview outside of event listener does not work"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:55:03.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.4.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Nolan Wright</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-04-15T02:42:26.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:55:03.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>in Kitchen Sink - Base UI -&gt; Views -&gt; Map View</p></div>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2011-04-15

   <div><p>This should have been fixed by <a href=
   "/projects/32238/tickets/918" title="Ticket #918">#918</a> but
   there are a couple changes I can make to the code to make it more
   robust (I think). Using this ticket as an excuse to go back in and
   clean up the original hack if possible.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>From the MKMapView documentation:</p>
   <blockquote>
   <p>If the specified annotation is not onscreen, and therefore does
   not have an associated annotation view, this method has no
   effect.</p>
   </blockquote>
   <p>Annotations do not become onscreen at least until the map view
   has been drawn, which only happens at the end of the JS. Updated
   the documentation to reflect this.</p></div></li>
<li>Nolan Wright 2011-04-15

   <div><p>we have to figure this out. it's perfectly reasonable to want
   your annotation to be visible when the map is rendered</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>I agree that it's perfectly reasonable, but we can't do anything
   about the limitations of MKMapView. I would say that we could queue
   selections, to be selected once the map is displayed, but this does
   not get around the restriction that annotations must be visible on
   the current map display to be selected.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Okay, think I have a solution. Was a good idea to reopen
   this.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Alright, we can support the following:</p>
   <ul>
   <li>add/remove annotation work correctly before map is
   displayed</li>
   <li>annotations (which are in the visible region) will select on
   load</li>
   </ul>
   <p>HOWEVER, the following features will still need to be added:</p>
   <ul>
   <li>zooming so that all annotations they want selected are visible
   (BEFORE selecting them)</li>
   <li>recentering the view on the appropriate region BEFORE selecting
   an annotation contained within it</li>
   </ul>
   <p>These are much easier to do on the JS end than the Cocoa Touch
   end, so we may be able to stall on them for a while.</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/23d0511b83365e6b3912ebbd517ca43a7dc9474f"
   title=
   "Changeset [23d0511b83365e6b3912ebbd517ca43a7dc9474f]">[23d0511b83365e6b3912ebbd517ca43a7dc9474f]</a>)
   [<a href="/projects/32238/tickets/1046" title=
   "Ticket #1046">#1046</a> state:open] First set of fixes for map
   view add/select including small modifications to KS to test. Second
   set will involve moving the visible region to a newly selected
   annotation. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/23d0511b83365e6b3912ebbd517ca43a7dc9474f" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/23d0511b83365e6b3912ebbd517ca43a7dc9474f</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/23d0511b83365..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/23d0511b83365...</a></a></p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Hey, looks like the map view documentation is wrong. We can, in
   fact, select an annotation in the annotations list and the map
   automatically jumps to the right point.</p>
   <p>However, selecting annotations that were added with
   addAnnotation(s) may not work. Need to take a look at the current
   annotation management framework as a result.</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/3c14b2eec6b641ab53cbd43fa0aabab1161955ba"
   title=
   "Changeset [3c14b2eec6b641ab53cbd43fa0aabab1161955ba]">[3c14b2eec6b641ab53cbd43fa0aabab1161955ba]</a>)
   Closes <a href="/projects/32238/tickets/1046" title=
   "Ticket #1046">#1046</a>: Annotation addition/removal now happens
   immediately, not on a delay. No idea why there was a delay in the
   first place; users can always use careful annotation management to
   batch display. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/3c14b2eec6b641ab53cbd43fa0aabab1161955ba" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/3c14b2eec6b641ab53cbd43fa0aabab1161955ba</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/3c14b2eec6b64..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/3c14b2eec6b64...</a></a></p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-1046.json">JSON Source</a></p>