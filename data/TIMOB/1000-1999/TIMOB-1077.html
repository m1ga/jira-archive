---
title: "[TIMOB-1077] Titanium.App.getArguments() not working on OS4 beta4"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:55:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.4.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>arguments, crash, os4</td></tr>
<tr><th>Reporter</th><td>Antonio Carlos Silveira</td></tr>
<tr><th>Assignee</th><td>Reggie Seagraves</td></tr>
<tr><th>Created</th><td>2011-04-15T02:43:20.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:55:08.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Titanium.App.getArguments() seems to not work on Iphone OS4 beta
4.</p>
<p>When calling a Custom URL schema passing some query strings
arguments, ON the App it does not get the arguments.</p>
<p>Used to work on 3.x</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-1077_17928/device-log_ks_getargument.txt">device-log_ks_getargument.txt</td></td><td>2011-04-15T02:43:20.000+0000</td><td>1472</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-1077_17927/device-log-geo_ks.txt">device-log-geo_ks.txt</td></td><td>2011-04-15T02:43:20.000+0000</td><td>5311</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-1077_17926/kitchensink_2010-06-01-125109_antonio-iphone-3gs.crash">kitchensink_2010-06-01-125109_antonio-iphone-3gs.crash</td></td><td>2011-04-15T02:43:20.000+0000</td><td>21794</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-1077_17929/ks_geo.PNG">ks_geo.PNG</td></td><td>2011-04-15T02:43:21.000+0000</td><td>52787</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2011-04-15

   <div><p>Need some more information, including a test case and which
   version of Titanium you're using.</p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

   <div><p>Here are the info.<br>
   Mobile SDK 1.3<br>
   iPhone SDK OS4 beta4</p>
   <p>Attached is the console log, running on an iPhone 3Gs with OS4
   beta4. Using KitchenSink 1.3. (changed the name to be able to use
   my Profile.</p>
   <p>Start KitchenSink 1.3<br>
   Go to Phone Tab<br>
   Go to GeoLocation<br>
   The data will be filled, only the Reverse Geo data is blank</p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

   <div><p>Sorry wrong update :-)</p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

   <div><p>Here is the proper additional info for this bug.</p>
   <p>Info:<br>
   Titanium MObile SDK 1.3<br>
   xcode_3.2.3_and_iphone_sdk_4_beta_4<br>
   iPhone OS4 beta4 for iPhone 3Gs (build:8a274b)</p>
   <p>================================================== Steps to
   reproduce on the Device:</p>
   <p>Edit the Custom URL handler on info.plist</p>
   <pre>
   <code>&lt;key&gt;CFBundleURLTypes&lt;/key&gt;
       &lt;array&gt;
          &lt;dict&gt;
             &lt;key&gt;CFBundleURLName&lt;/key&gt;
                &lt;string&gt;com.appcelerator.kitchensink&lt;/string&gt;
              &lt;key&gt;CFBundleURLSchemes&lt;/key&gt;
               &lt;array&gt;
                 &lt;string&gt;kitchensink&lt;/string&gt;
               &lt;/array&gt;
           &lt;/dict&gt;
       &lt;/array&gt;</code>
   </pre>
   <p>Now open Safari Mobile on the Device<br>
   type the Custom URL passing some query strings:
   kitchensink://?foo=bar<br>
   Kitchen Sink will open and then will crash.</p>
   <p>================================================== Find the
   Files Attached, Crash Log and Console Log.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Hard to say if this is a bug on our end. I see</p>
   <pre>
   <code>Tue Jun  1 12:51:08 unknown UIKitApplication:com.acarlos.KitchenSink[0x80c9][1227]</code>
   </pre>
   <p>In your output, and</p>
   <pre>
   <code>&lt;string&gt;com.appcelerator.kitchensink&lt;/string&gt;</code>
   </pre>
   <p>in the plist. Was the plist value changed so that you could test
   on device?</p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

   <div><p>Hi Stephen, I needed to change the AppID, so I could use my
   Provisioning Profile and to test on my Device.</p>
   <p>But When I run on Simmulator I use the default KitchenSink
   AppID: com.appcelerator.kitchensink</p>
   <p>I am doing some more research on this as well.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Try changing the value for the CFBundleURLName key to match the
   application ID. I don't get crashes in simulator when they match,
   and can't test on device since I don't have a 4.0-capable one
   handy.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Mistakenly marked as invalid. Didn't know that getX() functions
   were the same as accessing the X property.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Yeah, this works for me in simulator when the CFBundleURLName
   matches the application ID.</p>
   <p>I will close this ticket if you can confirm that any application
   which does not support backgrounding (built for 3.1) running on
   device does not crash when the CFBundleURLName and the app ID
   match.</p>
   <p>(Edited to remove iPhone 4.0 information)</p></div></li>
<li>Jeff Haynie 2011-04-15

    <div><p>(from <a href=
    "/projects/32238/changesets/76a7494c760ea73db037f719e67ab3a700d8a750"
    title=
    "Changeset [76a7494c760ea73db037f719e67ab3a700d8a750]">[76a7494c760ea73db037f719e67ab3a700d8a750]</a>)
    [<a href="/projects/32238/tickets/1077" title=
    "Ticket #1077">#1077</a> state:open] plist change to allow KS to
    test getArguments(). Note that under 4.0, we do not support
    changing the arguments; this may not even be possible. Have to look
    into it. <a href=
    "<a href="http://github.com/appcelerator/titanium_mobile/commit/76a7494c760ea73db037f719e67ab3a700d8a750" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/76a7494c760ea73db037f719e67ab3a700d8a750</a>">
    <a href="http://github.com/appcelerator/titanium_mobile/commit/76a7494c760ea..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/76a7494c760ea...</a></a></p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

    <div><p>Hi Guys, you are right. It seems that on OS4 I can't get the
    arguments when coming from a 'Pause'.</p>
    <p>let me give you some more background on what I am trying to
    achieve.</p>
    <p>What I am trying to do is an oAuth 3-legged authorization
    process with Yahoo!, then my App does the call for authorization
    and opens Safari, after authorizing the app, I have created a
    callback that calls the Custom URL passing the access token and the
    verifier as arguments. Then my app checks the arguments and
    completes the oAuth process.</p>
    <p>It worked very well on 3.1, but for 4.0 first I needed to change
    my startup listener to 'resume', but then the arguments are always
    empty.</p>
    <p>Anyway, now I have no Idea how to proceed with the whole oAuth
    3-legged process as Safari will not be able to open back my
    App.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>I would like to be able to give you a workaround, but the NDA
    prevents me from discussing this issue with you further in a public
    forum. All I can recommend is looking through (4.0) documentation
    on the relevant subjects.</p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

    <div><p>Ok, thanks, so will it be possible to retrieve arguments from
    Safari on Titanium 1.4?</p>
    <p>What my Safari does e call a callback like this, passing the
    oauth verifier and a Token.</p>
    <p>Myapp://?oauthv=something&amp;token=otherstuff</p>
    <p>This starts my app, but getArguments does not work with
    "Resume".</p>
    <p>Do you have any suggestion on how to retrieve this data back
    with my app?</p>
    <p>Thanks once again.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>It is possible to retrieve arguments from Safari, but only on
    startup. We will very likely not get to this feature in time for
    1.4.0. I can't advise you further until the NDA is up because the
    workaround does not involve Titanium directly.</p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

    <div><p>Ok, thanks Stephen.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>With the advent of iOS4 I can finally give you the bad news.
    When apps resume from background, they are NOT passed any new
    information about arguments; they are only passed arguments on
    startup. This means that if it's absolutely critical that your app
    always be able to get startup argument information, it must opt-out
    of background execution.</p>
    <p>You can do this by changing the
    <code>UIApplicationExitsOnSuspend</code> key in the
    <code>Info.plist</code> file to have a <code>YES</code> value.</p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

    <div><p>All right, thanks for the update Stephen.</p></div></li>
<li>Damien Elmes 2011-04-15

    <div><p>It appears it is possible to receive the URL if the process is
    backgrounded, but a different approach is required. From the
    developer forums:</p>
    <hr>
    <ul>
    <li>(BOOL)application:(UIApplication <em>)application
    handleOpenURL:(NSURL</em> )url</li>
    </ul>
    <p>Also, check that you're using</p>
    <ul>
    <li>(void)applicationDidFinishLaunching:(UIApplication
    *)application;</li>
    </ul>
    <p>and NOT</p>
    <ul>
    <li>(BOOL)application:(UIApplication <em>)application
    didFinishLaunchingWithOptions:(NSDictionary</em>
    )launchOptions</li>
    </ul>
    <h2>If you're using the second one, handleOpenURL is ignored.</h2>
    <p>Would it be possible for Titanium to expose this information in
    the future? For dictionary and study applications, the ability to
    switch quickly between them is important.</p></div></li>
<li>Damien Elmes 2011-04-15

    <div><p>(sorry for the bold, I had only meant to mark off what was
    quoted and what wasn't)</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Thank you for pointing this out - it was not covered in any of
    the backgrounding documentation. I will see if I can get it in
    before 1.4.0 drops.</p></div></li>
<li>Jeff Haynie 2011-04-15

    <div><p>(from <a href=
    "/projects/32238/changesets/8c573ed5806e0477e143f40e272314bfe130d054"
    title=
    "Changeset [8c573ed5806e0477e143f40e272314bfe130d054]">[8c573ed5806e0477e143f40e272314bfe130d054]</a>)
    Closes <a href="/projects/32238/tickets/1077" title=
    "Ticket #1077">#1077</a>: Apps can now get URLs on return from
    backgrounding. Thanks to Damien Elmes for the solution. <a href=
    "<a href="http://github.com/appcelerator/titanium_mobile/commit/8c573ed5806e0477e143f40e272314bfe130d054" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/8c573ed5806e0477e143f40e272314bfe130d054</a>">
    <a href="http://github.com/appcelerator/titanium_mobile/commit/8c573ed5806e0..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/8c573ed5806e0...</a></a></p></div></li>
<li>Damien Elmes 2011-04-15

    <div><p>Thanks for the quick fix!</p></div></li>
<li>Antonio Carlos Silveira 2011-04-15

    <div><p>Hi There,</p>
    <p>so do you know how can I get the arguments that are passed from
    an CustomHandle, here is some sample code I am trying, but the
    arguments object is empty.</p>
    <p>on <strong>App.js</strong> I have added the following code,
    trying to trap the data from the customHandle from a Resume or
    Open</p>
    <pre>
    <code>var argu = Ti.App.getArguments();
    var argumentos = JSON.stringify(argu);
    // var theImage = null; //capture image from gallety and/or camera
    // var theThumbnail = null; //capture image thumbnail from gallety and/or camera
    
    
    // trap app Open event and retrieve the arguments from safari
    Ti.App.addEventListener('resume', function(e)
    {
    
    Ti.API.info("MemePost is being RESUMED, getting Arguments");
    
    Ti.API.info("Arguments from RESUME on app.js " + argu);
    
    a = Ti.UI.createAlertDialog({ 
        title:'URL Arguments from RESUME on app.js',
        message: argu
    });
    a.show();
    
    });
    
    // trap app Open event and retrieve the arguments from safari
    Ti.App.addEventListener('open', function(e)
    {
    
    Ti.API.info("MemePost is being OPEN, getting Arguments");
    
    Ti.API.info("Arguments from OPEN on app.js " + argumentos);
    
    a = Ti.UI.createAlertDialog({ 
        title:'URL Arguments from OPEN on app.js',
        message: argumentos
    });
    a.show();
    
    });</code>
    </pre>
    <p>What am I doing wrong?</p></div></li>
<li>lukaso 2011-04-15

    <div><p>This change unfortunately doesn't appear to work. When I resume
    my app with a url, the argument doesn't appear. It only appears
    later, on pause, and then on the next resume.</p>
    <p>Example:<br>
    1) Start MyApp<br>
    2) Open Safari (closing MyApp)<br>
    3) Safari: myapp://first<br>
    4) MyApp launched to the front. In<br></p>
    <pre>
    <code>Ti.App.addEventListener('resume', function() {
      if (Ti.App.getArguments() == 'myapp://') { // this will be true<br>
    <br>
    
    
    </code>
    </pre>
    <pre>
    <code><code>alert('This is always true the first time resume is called');</code></code>
    </pre>
    <pre>
    
    
    <br>
      }
    });
    </pre>
    However, on 'pause' the argument is then available.<br>
    5) Open Safari again with 'myapp://second'. This time
    Ti.App.getArguments() returns 'myapp://first'
    <p>Hopefully this all makes sense. Somehow the value is getting set
    too late.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>You need to use the 'resumed' event. There are two separate
    events on iOS due to the fact that some information is only
    available after resuming execution.</p></div></li>
<li>lukaso 2011-04-15

    <div><p>Thanks! That solved the problem.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-1077.json">JSON Source</a></p>