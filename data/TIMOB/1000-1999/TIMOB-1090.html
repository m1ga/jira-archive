---
title: "[TIMOB-1090] Memory Usage on ImageViews"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:55:10.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.4.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, iphone, memory, usage, views</td></tr>
<tr><th>Reporter</th><td>ctredway</td></tr>
<tr><th>Assignee</th><td>Reggie Seagraves</td></tr>
<tr><th>Created</th><td>2011-04-15T02:43:48.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:55:10.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>A customer has created a slide show type of application and on a
device is reporting that after view 4-5 images, the app will become
unresponsive and crash.</p>
<p>View this ticket for reference:<br>
<a href=
"<a href="http://helpdesk.appcelerator.net/tickets/2782" rel="nofollow" target="_blank">http://helpdesk.appcelerator.net/tickets/2782</a>"><a href="http://helpdesk.appcelerator.net/tickets/2782" rel="nofollow" target="_blank">http://helpdesk.appcelerator.net/tickets/2782</a></a></p></div>

<h3>Comments</h3>

<ol>
<li>ctredway 2011-04-15

   <div><p>from the customer:</p>
   <p>It also looks like TiUIImageView is never being deleted - they
   just persist in memory - I put a log into TiUIImageView::dealloc,
   and this is never called, despite removing the item from the window
   that it was added to and unsetting all references to it.</p>
   <p>Looks like there is a problem.</p>
   <p>-(void)dealloc { NSLog ( @"TiUIImageView::dealloc %@", [NSDate
   date] );<br>
   if (timer!=nil)<br>
   { [timer invalidate]; } (timer); (images); (container); (previous);
   (urlRequest); [super dealloc]; }</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/1177e7b3e90095d2ea40e818e26d178f14149e78"
   title=
   "Changeset [1177e7b3e90095d2ea40e818e26d178f14149e78]">[1177e7b3e90095d2ea40e818e26d178f14149e78]</a>)
   [<a href="/projects/32238/tickets/1090" title=
   "Ticket #1090">#1090</a> state:resolved] fixed major memory leak
   issue on iphone <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/1177e7b3e90095d2ea40e818e26d178f14149e78" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/1177e7b3e90095d2ea40e818e26d178f14149e78</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/1177e7b3e9009..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/1177e7b3e9009...</a></a></p></div></li>
<li>David R. 2011-04-15

   <div><p>I'm still experiencing memory leaks with 1.3.3. After 4-5
   ImageViews loading JPEG of about 800K the app crashes (no memory).
   I tried setting the ImageView.image to null, ImageView to null.</p></div></li>
<li>David R. 2011-04-15

   <div><p>While reminding myself :-) that Apple states "You should avoid
   creating UIImage objects there are greater than 1024x1024 in size."
   (<a href="<a href="http://bit.ly/ahftC2)" rel="nofollow" target="_blank">http://bit.ly/ahftC2)</a>"><a href="http://bit.ly/ahftC2)" rel="nofollow" target="_blank">http://bit.ly/ahftC2)</a></a>, I've
   run some tests and I was able to reproduce the crash.</p>
   <p>It happens when loading many ImageView instances (each with its
   own image) into the application. The memory quickly goes down until
   the app crashes. Best practice shall be then to use fewer ImageView
   (and smaller images), I believe.</p>
   <p>Thanks Jeff for the good work you're doing here.</p>
   <p>This is the test the makes the app crash (you need one/some
   images in your Resources folder)<br></p>
   <pre>
   <code class="javascript">var win = Ti.UI.currentWindow;
   var memoryLabel = Ti.UI.createLabel({
     text:Ti.Platform.availableMemory,
     top:-20,
     left:0,
     font:{fontSize:22},
     zIndex:-1
   });
   var availMemoryLabel = Ti.UI.createLabel({
     text:Ti.Platform.availableMemory,
     top:20,
     left:0,
     font:{fontSize:22},
     zIndex:-1
   });
   var testStatusLabel = Ti.UI.createLabel({
     text:'status',
     top:-100,
     left:0,
     font:{fontSize:22},
     zIndex:-1
   });<br>
   <br>
   
   
   <br>
   var imageCounter=1;
   var imageView=[];
   imageView[0] = Ti.UI.createImageView({
     width:'auto',
     height:'auto'
   });<br>
   <br>
   
   
   <br>
   var loaded = function()
   {
     if ((imageCounter++)&gt;=67) return;
     testStatusLabel.text=imageCounter+'/67';
     imageView[imageCounter-1] = Ti.UI.createImageView({<br>
   <br>
   
   
   </code>
   </pre>
   <pre>
   <code class="javascript"><code>width:'auto',
   height:'auto'</code></code>
   </pre>
   <pre>
   
   
   <br>
     });
     win.add(imageView[imageCounter-1]);
     imageView[imageCounter-1].addEventListener('load',loaded);
     imageView[imageCounter-1].image='images/'+imageCounter+'.jpg';      <br>
   };
   imageView[0].addEventListener('load',loaded);
   
   <br>
   win.add(imageView[0]);
   win.add(memoryLabel);
   win.add(availMemoryLabel);
   win.add(testStatusLabel);
   
   <br>
   win.addEventListener('open',function(){
     memoryLabel.text=Ti.Platform.availableMemory;
     setInterval(function(){availMemoryLabel.text=Ti.Platform.availableMemory;},1000)
     imageView[0].image='images/'+imageCounter+'.jpg'; 
   });
   </pre></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-1090.json">JSON Source</a></p>