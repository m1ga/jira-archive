---
title: "[TIMOB-1104] Map click events"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-05-11T17:43:07.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.7.0, Sprint 2011-13</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>click, defect, events, ios, mapview, release-1.7.0, reported-1.6.0, requires-4.0, rplist</td></tr>
<tr><th>Reporter</th><td>ctredway</td></tr>
<tr><th>Assignee</th><td>Reggie Seagraves</td></tr>
<tr><th>Created</th><td>2011-04-15T02:44:06.000+0000</td></tr>
<tr><th>Updated</th><td>2011-05-11T17:43:07.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Ok, it seems that a map view looses its click event listener
after the location changes. The attached project demonstrates
this.</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-1104_17932/mappintest.zip">mappintest.zip</td></td><td>2011-04-15T02:44:07.000+0000</td><td>52719</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Curtis Olson 2011-04-15

   <div><p>I had a similar problem where I wasn't able to get any events on
   a map view. A child view added to a map view would get a click
   event, but not the map view itself. I documented this behavior
   here.</p>
   <p><a href=
   "<a href="http://developer.appcelerator.com/question/32451/mapview-ignoring-touchstart-event" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/32451/mapview-ignoring-touchstart-event</a>">
   <a href="http://developer.appcelerator.com/question/32451/mapview-ignoring-t..." rel="nofollow" target="_blank">http://developer.appcelerator.com/question/32451/mapview-ignoring-t...</a></a></p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>This is a duplicate bug and should have been fixed, but I cannot
   get the provided test to work. A simpler test needs to be provided.
   Map views do not receive click events except when a pin is
   selected.</p>
   <p>I am unable to duplicate the behavior and I believe this was
   fixed as part of an earlier map view bug. Leaving open until I can
   confirm this.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Still waiting on a simpler example.</p></div></li>
<li>Nolan Wright 2011-04-15

   <div><p>run Map View test in KS - click on map - no logging occurs
   (click event is not fired)</p></div></li>
<li>Blain Hamon 2011-04-15

   <div><p>Pushing out again.</p></div></li>
<li>Dawson Toth 2011-04-15

   <div><p>A pro client is interested in this fix now as well.</p>
   <h1>Sample Code</h1>
   <p>The following demonstrates the problem. Click on the annotation,
   and you will see the map's click event fires and an alert is shown.
   Click anywhere else, and nothing will happen.</p>
   <pre>
   <code class=
   "javascript">var win = Ti.UI.createWindow({ backgroundColor: '#fff' });
   
   var map = Titanium.Map.createView({
       annotations: [Titanium.Map.createAnnotation({
           latitude: 37.390749, longitude: -122.081651,
           title: 'You Clicked Me!'
       })],
       region: {
           latitude: 37.390749, longitude: -122.081651,
           latitudeDelta: 0.01, longitudeDelta: 0.01
       }
   });
   map.addEventListener('click', function () {
       alert('Map Clicked!');
   });
   
   win.add(map);
   win.open();</code>
   </pre>
   <h2>Associated Helpdesk Ticket</h2>
   <p><a href=
   "<a href="http://developer.appcelerator.com/helpdesk/view/64521" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/64521</a>"><a href="http://developer.appcelerator.com/helpdesk/view/64521" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/64521</a></a></p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/5facf6d39cd9f693da29eab4548a651bf3f3f77d"
   title=
   "Changeset [5facf6d39cd9f693da29eab4548a651bf3f3f77d]">[5facf6d39cd9f693da29eab4548a651bf3f3f77d]</a>)
   [<a href="/projects/32238/tickets/1104" title=
   "Ticket #1104">#1104</a>] Fix to provide click-on/click-off for
   user-defined annotations. <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/5facf6d39cd9f693da29eab4548a651bf3f3f77d" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5facf6d39cd9f693da29eab4548a651bf3f3f77d</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/5facf6d39cd9..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5facf6d39cd9...</a></a></p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>A full fix for this actually requires a guarantee of iOS 3.2+
   running on device. Extensive research has shown that Apple does not
   provide a way to intercept events on a map view in 3.1.x without
   using undocumented classes or features.</p>
   <p>The previous commit is a slap patch to ensure that it is
   possible to detect when somebody "clicks off" an annotation. This
   can be done by checking the "source" property.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Forgot to mark "in-progress" as well. A full fix will be
   provided if possible.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Slap patch addresses customer issue. Going to bump the remainder
    of the bug (generic 'click' events) to TBS 1.7 so that we can
    discuss with the Android team about whether or not to break them
    and replace the name with something much more sensible.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Had a brief conversation with Marshall, we have parity on iOS
    and Android (only detect clicks on map overlays, i.e. pins and
    annotations). iOS has the addition of checking to see if you click
    OFF of either of these things and back on the map because that was
    a feature request.</p>
    <p>So, consider this resolved for iOS. We will not support
    general/generic 'click' events on the map.</p></div></li>
<li>mikantchap 2011-04-15

    <div><p>On Android, I don't see the click event firing if the background
    of the annotation is clicked.</p>
    <p>Using this code, you might see 'title' in the info message (if
    you actually click the title element) but you won't see
    'annotation'. The reason this is important is because a user might
    fail to click through to another page if they happen to miss one of
    the elements in the annotation.</p>
    <p>// this sets the background color of the master UIView (when
    there are no windows/tab groups on it)
    Titanium.UI.setBackgroundColor('#000');</p>
    <p>var win = Ti.UI.createWindow({ backgroundColor: '#fff' });</p>
    <p>var map = Titanium.Map.createView({<br></p>
    <pre>
    <code>    mapType: Titanium.Map.STANDARD_TYPE,
        animate: true,
        regionFit: true,
        region: {latitude: 37.390749, longitude: -122.081651,latitudeDelta: 0.01, longitudeDelta: 0.01 }</code>
    </pre>
    <p>});</p>
    <p>var myAnot = Titanium.Map.createAnnotation({<br></p>
    <pre>
    <code>    latitude: 37.390749,
        longitude: -122.081651,
        title: 'You Clicked Me!',
        pincolor: Titanium.Map.ANNOTATION_PURPLE,
        animate: true
    });</code>
    </pre>
    <p>map.addAnnotation(myAnot);</p>
    <p>map.addEventListener('click', function(e) {<br>
    Titanium.API.info(e.clicksource); });</p>
    <p>win.add(map);<br>
    win.open();</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Assigning to Don so that we can get an Android ticket requesting
    feature parity.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Actually, scratch that. Going to make a new ticket for Android
    instead. Durr.</p></div></li>
<li>Don Thorp 2011-04-15

    <div><p>added release-1.7.0 tag.</p></div></li>
<li>Eric Merriman  2011-05-11

    No longer able to reproduce with iPhone 4, iOS 4.3.3. KS 1.7.0, build 1.7.0.879871b. Tried both short test code and sample app. Both functioned as expected. Closing</li>
</ol>


<p><a href="/TIMOB/TIMOB-1104.json">JSON Source</a></p>