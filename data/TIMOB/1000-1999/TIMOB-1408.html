---
title: "[TIMOB-1408] iAd's related linking failure when building an app with a custom titanium extension module"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2011-04-15T02:51:31.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>module, obj-c, sdk</td></tr>
<tr><th>Reporter</th><td>Robby</td></tr>
<tr><th>Assignee</th><td>Reggie Seagraves</td></tr>
<tr><th>Created</th><td>2011-04-15T02:51:26.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-09T23:17:40.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>SDK 1.4.0, iOS SDK 4.0.1, XCode 3.2.3<br>
When attempting to build a stock new project with a very basic
Titanium SDK extension module (<a href=
"<a href="http://github.com/xavierlacot/titanium_mobile_clipboard_module)" rel="nofollow" target="_blank">http://github.com/xavierlacot/titanium_mobile_clipboard_module)</a>"><a href="http://github.com/xavierlacot/titanium_mobile_clipboard_module)" rel="nofollow" target="_blank">http://github.com/xavierlacot/titanium_mobile_clipboard_module)</a></a>,
I get the following linking error:</p>
<pre>
<code>Ld build/Debug-iphonesimulator/SCApp.app/SCApp normal i386
    cd "/Users/jamie/Documents/Aptana Studio Workspace/myprojmyproj/SCApp/build/iphone"
    setenv MACOSX_DEPLOYMENT_TARGET 10.6
    setenv PATH "/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/g++-4.2 -arch i386 -isysroot /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator4.0.sdk "-L/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/build/Debug-iphonesimulator" "-L/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/lib" "-L/Library/Application Support/Titanium/modules/iphone/titanium.clipboard/0.1" "-L/Library/Application Support/Titanium/modules/iphone/titanium.ekext/0.1" "-L/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/../../../../tmp/debug/build" "-L/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/../../../../tmp/staticlib/build/Debug-iphonesimulator" "-L/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/../../../tijs/TiCore/TiCore/build/Release-iphonesimulator" "-F/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/build/Debug-iphonesimulator" -filelist "/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/build/SCApp.build/Debug-iphonesimulator/SCApp.build/Objects-normal/i386/SCApp.LinkFileList" -mmacosx-version-min=10.6 -ObjC -Xlinker -objc_abi_version -Xlinker 2 -framework Foundation -weak_framework UIKit -framework CoreGraphics -framework AddressBook -framework AddressBookUI -framework CFNetwork -framework CoreLocation -framework MapKit -framework MessageUI -framework MobileCoreServices -framework OpenGLES -framework QuartzCore -framework SystemConfiguration -lsqlite3 -lz -framework AudioToolbox -weak_framework MediaPlayer -framework AVFoundation -lxml2 -framework StoreKit -lTiCore -ltitanium.clipboard -ltitanium.ekext -framework ExternalAccessory -ltiverify -o "/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/build/Debug-iphonesimulator/SCApp.app/SCApp"

ld: warning: directory '/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/../../../../tmp/debug/build' following -L not found
ld: warning: directory '/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/../../../../tmp/staticlib/build/Debug-iphonesimulator' following -L not found
ld: warning: directory '/Users/jamie/Documents/Aptana Studio Workspace/myproj/SCApp/build/iphone/../../../tijs/TiCore/TiCore/build/Release-iphonesimulator' following -L not found
Undefined symbols:
  "_ADBannerContentSizeIdentifier320x50", referenced from:
      _ADBannerContentSizeIdentifier320x50$non_lazy_ptr in TiUIiOSAdViewProxy.o
     (maybe you meant: _ADBannerContentSizeIdentifier320x50$non_lazy_ptr)
  "_OBJC_CLASS_$_ADBannerView", referenced from:
      objc-class-ref-to-ADBannerView in TiUIiOSAdView.o
  "_ADBannerContentSizeIdentifier480x32", referenced from:
      _ADBannerContentSizeIdentifier480x32$non_lazy_ptr in TiUIiOSAdViewProxy.o
     (maybe you meant: _ADBannerContentSizeIdentifier480x32$non_lazy_ptr)
ld: symbol(s) not found
collect2: ld returned 1 exit status</code>
</pre>
<p>Both I and another individual ran into this same error with two
recent versions of Titanium SDK (1.3.2 and 1.4.0). For the full
error and process, please see:<br>
<a href=
"<a href="http://developer.appcelerator.com/question/46541/extending-titanium-mobile-with-module-sdk-possible" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/46541/extending-titanium-mobile-with-module-sdk-possible</a>">
<a href="http://developer.appcelerator.com/question/46541/extending-titanium..." rel="nofollow" target="_blank">http://developer.appcelerator.com/question/46541/extending-titanium...</a></a></p>
<p>Also, when adding an extension module up against a titanium app,
and launching the app in the emulator, the build scripts seem to
want to recompile the whole Titanium libraries every
time&#8230;making it take 5+ minutes every time I try to build the
app (maybe this is just because of the linking problem above).</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-1408_17982/ek.zip">ek.zip</td></td><td>2011-04-15T02:51:27.000+0000</td><td>789291</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-1408_17981/st-johns.zip">st-johns.zip</td></td><td>2011-04-15T02:51:27.000+0000</td><td>127723</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Robby 2011-04-15

   <div><p>It looks like just adding "-framework iAd" into that linking
   statement will resolve the error. Now I just need to find where in
   the Titanium codebase that linking statement is being assembled....
   :o</p></div></li>
<li>Robby 2011-04-15

   <div><p>Note that this appears to be a side-effect to the issue
   identified in ticket <a href="/projects/32238/tickets/1339" title=
   "Ticket #1339">#1339</a>. Commenting out that line fixes this issue
   and allows the build to succeed.</p></div></li>
<li>Robby 2011-04-15

   <div><p>The issue of a full Titanium rebuild every time I make an app
   revision still persists however...perhaps it's that "force_xcode =
   True" in iphone/builder.py on line 478?? Is there a particular
   reason for having to rebuild everything? This makes test/debug
   cycles unbearably long (5-10 minutes, instead of the normal</p>
   <p>I'd really like to use Titanium but if I have to have 5-10
   minute rebuild cycles every time I'll have to just write this app
   natively. :/</p></div></li>
<li>Jake Howerton 2011-04-15

   <div><p>One part of the issue which resolves my original ticket is that
   the comment banner at the top of the automatically generated
   module.xcconfig creates a syntax error. Comments should use double
   slash (//) in xcconfig files</p>
   <p>Remove:</p>
   <pre>
   <code>#
   <h4>PLACE ANY BUILD DEFINITIONS IN THIS FILE AND THEY WILL BE </h4>
   <h4>PICKED UP DURING THE APP BUILD FOR YOUR MODULE</h4>
   #</code>
   </pre></div></li>
<li>Jake Howerton 2011-04-15

   <div><p>After fixing the comment issue above and then wiping out my
   build folder entirely, I can successfully build with the
   -weak_framework flags</p></div></li>
<li>Des 2011-04-15

   <div><p>I have been trying to create a module to use the Event Kit over
   the last few days and found exactly the same issue. Both of the
   tips above have not helped. Is there anything else to try?</p>
   <p>The error I get is:</p>
   <p>Undefined symbols:<br>
   "<em>OBJC_CLASS</em>$_EKEventStore", referenced from:</p>
   <pre>
   <code>  objc-class-ref-to-EKEventStore in libcalendar.a(CalendarModule.o)</code>
   </pre>
   <p>"<em>OBJC_CLASS</em>$_EKEvent", referenced from:</p>
   <pre>
   <code>  objc-class-ref-to-EKEvent in libcalendar.a(CalendarModule.o)</code>
   </pre>
   <p>ld: symbol(s) not found<br>
   collect2: ld returned 1 exit status</p>
   <p>This may be down to my module as I have never used Objective C
   before and have just been cutting and pasting what I have found in
   Appcelerator and Apple documentation. If it is of any use the code
   is as follows:</p>
   <p>CalendarModule.h :-</p>
   <h1>import "TiModule.h"</h1>
   <p>@interface CalendarModule : TiModule { }</p>
   <p>@end</p>
   <p>CalendarModule.m :-</p>
   <h1>import "CalendarModule.h"</h1>
   <h1>import "TiBase.h"</h1>
   <h1>import "TiHost.h"</h1>
   <h1>import "TiUtils.h"</h1>
   <h1>import &lt;EventKit/EventKit.h&gt;</h1>
   <p>@implementation CalendarModule</p>
   <h1>pragma mark Lifecycle</h1>
   <p>-(void)startup {</p>
   <pre>
   <code>[super startup];
   NSLog(@"[INFO] %@ loaded",self);</code>
   </pre>
   <p>}</p>
   <p>-(void)shutdown:(id)sender {</p>
   <pre>
   <code>[super shutdown:sender];</code>
   </pre>
   <p>}</p>
   <h1>pragma mark Cleanup</h1>
   <p>-(void)dealloc {</p>
   <pre>
   <code>[super dealloc];</code>
   </pre>
   <p>}</p>
   <h1>pragma mark Internal Memory Management</h1>
   <p>-(void)didReceiveMemoryWarning:(NSNotification*)notification
   {</p>
   <pre>
   <code>[super didReceiveMemoryWarning:notification];</code>
   </pre>
   <p>}</p>
   <h1>pragma mark Listener Notifications</h1>
   <p>-(void)_listenerAdded:(NSString *)type count:(int)count {</p>
   <pre>
   <code>if (count == 1 &amp;&amp; [type isEqualToString:@"my_event"])
   {
   }</code>
   </pre>
   <p>}</p>
   <p>-(void)_listenerRemoved:(NSString *)type count:(int)count {</p>
   <pre>
   <code>if (count == 0 &amp;&amp; [type isEqualToString:@"my_event"])
   {
   }</code>
   </pre>
   <p>}</p>
   <h1>pragma Public APIs</h1>
   <p>-(id)newevent:(id)args {</p>
   <pre>
   <code>id arg1 = [args objectAtIndex:0];  // Start Date
   id arg2 = [args objectAtIndex:1];  // End Date
   id arg3 = [args objectAtIndex:2];  // Title
   id arg4 = [args objectAtIndex:3];  // Location
   id arg5 = [args objectAtIndex:4];  // Text
   
   NSDateFormatter *df = [[NSDateFormatter alloc] init];
   [df setDateFormat:@"yyyy-MM-dd hh:mm:ss"];
   NSDate *startdate = [df dateFromString: arg1];
   NSDate *enddate = [df dateFromString: arg2];
   
   EKEventStore *eventStore = [[[EKEventStore alloc] init] autorelease];
   
   EKEvent *event  = [EKEvent eventWithEventStore:eventStore];
   
   event.title     = arg3;
   event.location  = arg4;
   event.notes     = arg5;
   event.startDate = startdate;
   event.endDate   = enddate;
   
   [event setCalendar:[eventStore defaultCalendarForNewEvents]];
   NSError *err;
   [eventStore saveEvent:event span:EKSpanThisEvent error:&amp;err];
   
   return event.eventIdentifier;</code>
   </pre>
   <p>}</p>
   <p>@end</p></div></li>
<li>Robby 2011-04-15

   <div><p>Des,</p>
   <p>hmm, check your compiler build strings. Is it trying to link to
   the Eventkit framework? If not, you should remove those # comments
   that ticket <a href="/projects/32238/tickets/1339" title=
   "Ticket #1339">#1339</a> talks about. Then, add a -framework switch
   for eventkit in your module's OTHER_LDFLAGS variable (I think
   OTHER_LDFLAGS is right...forget the exact named, and it should be
   in a file called module.xcconfig ..which is xconfig-specific
   parameters for your project)</p>
   <p>I'll be going through this here in a few days, so let me know
   how it turns out.</p></div></li>
<li>Des 2011-04-15

   <div><p>Dear Robby,</p>
   <p>Sorry for the delay replying, I have had 24 hours of hair
   pulling. My previous attempt was such a messed up bodge (using sdk
   1.4 with the 1.3.2 module builder as it had moved, modified
   build.py and builder.py, every conceivable setting in xcode messed
   about....) so I thought I would start from scratch with a clean
   module.</p>
   <p>Deleted 1.4 and re-downloaded, used it's module builder, deleted
   the # comments and recreated the module from scratch. Added the
   following line to module.xcconfig, OTHER_LDFLAGS=$(inherited)
   -framework EventKit.</p>
   <p>And it didn<code>t work. I have been trying everything and
   eventually realised that I am a complete idiot! I wanted to leave
   my original module there for reference (it was called Calendar) so
   I created a new module called EK (completely forgetting Titanium's
   naming requirements). Once all references to EK were changed to Ek
   it works perfectly. It doesn</code>t do much, but it does let me
   put events into the iPhone Calendar and shouldn<code>t be very hard
   to extend.</code></p>
   <p>Thanks very much for the help.</p></div></li>
<li>Robby 2011-04-15

   <div><p>Hey Des,</p>
   <p>Glad you got it working!</p>
   <p>Would you be able to send me the module you made by chance (that
   or put it on github, etc)? I'm going to be doing this myself for my
   app and it would save me a lot of time. I'd be happy to send you
   back any additions.</p>
   <p>Robby</p></div></li>
<li>Des 2011-04-15

    <div><p>Dear Robby,</p>
    <p>Attached are two files, the module EK.zip and a simple titanium
    project that lets you add and inspect calendar events
    StJohns.zip</p>
    <p>It is really just a proof of concept at the moment as I know
    that I will need it for an app that I plan to start working on in
    the next month or so. Please note that this is no use in the
    emulator as it appears not to support the calendar at all, you have
    to install on a phone.</p>
    <p>There is a bit of fiddling required to get it going, but I think
    this ticket could now be reduced to a faq.</p>
    <p>I am not too concerned about the full rebuild, having got the
    functionality required in the module working I will comment out the
    entry in tiapp.xml and work on the rest of the app, just
    uncommenting every now and then to do a test build.</p>
    <p>Best wishes</p>
    <p>Des</p></div></li>
<li>Robby 2011-04-15

    <div><p>Thanks Des for the files. Much appreciated.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Unable to duplicate as described. Probably an issue with the
    external module at some point. 1.6.0 RC1.</p></div></li>
<li>Lee Morris 2017-03-09

    Closing ticket as invalid.</li>
</ol>


<p><a href="/TIMOB/TIMOB-1408.json">JSON Source</a></p>