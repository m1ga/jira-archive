---
title: "[TIMOB-1412] iPhone: username/pass on URL (https only?) will break"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:56:06.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>https, ios, iphone</td></tr>
<tr><th>Reporter</th><td>Jeff Haynie</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2011-04-15T02:51:39.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:56:06.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>From blog post...</p>
<p>There is a thread on the QA on HTTPS being broken. This broke in
a fairly recent build as we were using the nightly from a week or
two ago with no issue. URL formats like this: <a href=
"<a href="https://username:password@api.lafitness.com" rel="nofollow" target="_blank">https://username:password@api.lafitness.com</a>"><a href="https://username:password@api.lafitness.com" rel="nofollow" target="_blank">https://username:password@api.lafitness.com</a></a>
will fail 100% of the<br>
time. Take out https and just go with http and it works fine. Our
cert is not self signed.</p>
<p>I think this might be related to the UTF-8 URI change (although,
that should effect both http right?).</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-1412_17985/resources.zip">resources.zip</td></td><td>2011-04-15T02:51:39.000+0000</td><td>146064</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>zeroendless 2011-04-15

   <div><p>I have twitter Xauth with similar posting issues. it've been
   working great on 1.3.2 and early 1.3.3 built version with iOS 4/iOS
   4.01, but refused to work on 1.4. I can reserve it back to early
   version and it would work again.<br></p>
   <p>I attached files for testing if that helps speed up the
   progress. With 1.4, i always get authentication error "Error
   Domain=ASIHTTPRequestErrorDomain Code=3 "Authentication needed"
   UserInfo=0x7a1cbd0 {NSLocalizedDescription=Authentication needed"
   despite all parameters checked and submit as requested, including a
   valid pair of twitter username and password. It seems like there's
   problem with parameters encoding issue on 1.4 too?</p>
   <p>Thanks</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/60364b73b1c5d17d7e8f42ecaf80b58efb5e5d4f"
   title=
   "Changeset [60364b73b1c5d17d7e8f42ecaf80b58efb5e5d4f]">[60364b73b1c5d17d7e8f42ecaf80b58efb5e5d4f]</a>)
   [<a href="/projects/32238/tickets/1412" title=
   "Ticket #1412">#1412</a> state:resolved] CFURLCreateStringBy...
   automatically doesn't substitute escapes for valid URL characters.
   <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/60364b73b1c5d17d7e8f42ecaf80b58efb5e5d4f" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/60364b73b1c5d17d7e8f42ecaf80b58efb5e5d4f</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/60364b73b1c5d..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/60364b73b1c5d...</a></a></p></div></li>
<li>zeroendless 2011-04-15

   <div><p>Hi Jeff,<br>
   Thanks for the quick attention.</p>
   <p>I tried the patch, copy the util file to 1.4 but still having
   the same issue on Twitter Xauth posting.</p>
   <p>Thanks</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>The problem appears to be this:</p>
   <blockquote>
   <p>['oauth_signature_method', 'HMAC-SHA1'],</p>
   </blockquote>
   <p>I took a look at the generated URL, and this is the only portion
   of it which was escaped:</p>
   <blockquote>
   <p>oauth_signature=imhFTmernI9uy7a2keXj%2FEWoC%2BE%3D</p>
   </blockquote>
   <p>HMAC-SHA1 may be placing unicode characters which would normally
   need to be escaped into your authorization string. I would
   recommend using a different signature method, since there is no
   workaround for this on our end.</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>i think the problem is that we're escaping twice. the path
   should be escaped on our end but not the entire query string. this
   is a platform problem i believe since this worked before this
   change.</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/3bca7969873c164f4596a1249a2f1f5e0143e172"
   title=
   "Changeset [3bca7969873c164f4596a1249a2f1f5e0143e172]">[3bca7969873c164f4596a1249a2f1f5e0143e172]</a>)
   [<a href="/projects/32238/tickets/1412" title=
   "Ticket #1412">#1412</a> state:resolved] Original list of
   characters to not escape was right... just not the right argument.
   <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/3bca7969873c164f4596a1249a2f1f5e0143e172" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/3bca7969873c164f4596a1249a2f1f5e0143e172</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/3bca7969873c1..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/3bca7969873c1...</a></a></p></div></li>
<li>Luke Melia 2011-04-15

   <div><p>I had this problem and can confirm that
   3bca7969873c164f4596a1249a2f1f5e0143e172 fixed it for me.
   Thanks.</p></div></li>
<li>zeroendless 2011-04-15

   <div><p>Brilliant, Thanks.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-1412.json">JSON Source</a></p>