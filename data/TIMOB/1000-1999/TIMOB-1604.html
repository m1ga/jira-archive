---
title: "[TIMOB-1604] Android: base64 encoding/decoding of Blob cannot be round-tripped successfully"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-05-14T14:49:57.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Neeraj Gupta</td></tr>
<tr><th>Created</th><td>2011-04-15T02:57:11.000+0000</td></tr>
<tr><th>Updated</th><td>2012-05-14T14:49:58.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>You cannot use Titanium.Utils.base64encode &amp;
Titanium.Utils.base64decode successfully to round-trip the encoding
/ decoding of a blob. In other words, you don't get back the same
set of bytes that you originally started with.</p>
<p>Failcase app.js (make sure you have KS_nav_ui.png in your
Resources folder; it's there by default with new projects):</p>
<pre>
<code class="javascript">
var win = Ti.UI.createWindow({fullscreen: true, exitOnClose:true});

var file = Ti.Filesystem.getFile('KS_nav_ui.png');

var blob1 = file.read();
var base64 = Ti.Utils.base64encode(blob1);
var blob2 = Ti.Utils.base64decode(base64);

var thumbnail1 = Titanium.UI.createView({left: 0, top: 0, width: 46, height: 43});
thumbnail1.backgroundImage = 'KS_nav_ui.png'; // the orig, which obviously works    
var thumbnail2 = Titanium.UI.createView({left: 56, top: 0, width: 46, height: 43});
var thumbnail3 = Titanium.UI.createView({left: 112, top: 0, width: 46, height: 43});
win.add(thumbnail1); win.add(thumbnail2); win.add(thumbnail3);

var tempDir = Titanium.Filesystem.createTempDirectory();
tempDir.createDirectory();

// Blob from original file
var file1 = Titanium.Filesystem.getFile(tempDir.nativePath, 'file1.png');
file1.write(blob1);
thumbnail2.backgroundImage = file1.nativePath;

// Base64 encoded-then-decoded blob
var file2 = Titanium.Filesystem.getFile(tempDir.nativePath, 'file2.png');
file2.write(blob2);
thumbnail3.backgroundImage = file2.nativePath;

win.open();</code>
</pre>
<p>You should see three identical images when that runs. Instead,
you'll see only two.</p></div>

<h3>Comments</h3>

<ol>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/fd880341bc564607ed68650fd73660f57131d23f"
   title=
   "Changeset [fd880341bc564607ed68650fd73660f57131d23f]">[fd880341bc564607ed68650fd73660f57131d23f]</a>)
   [<a href="/projects/32238/tickets/1604" title=
   "Ticket #1604">#1604</a> state:fixed-in-qa] When base64encoding a
   blob, don't force it to its string representation if you don't have
   to. That makes it unusable for binary files, images, etc. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/fd880341bc564607ed68650fd73660f57131d23f" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/fd880341bc564607ed68650fd73660f57131d23f</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/fd880341bc564..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/fd880341bc564...</a></a></p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>fixed on android using 1.4.1.ca7b78 device an simulator. Opening
   a new issue for iOS to have functional parity.</p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p><a href="/projects/32238/tickets/1611" title=
   "Ticket #1611">#1611</a> for iOS</p></div></li>
<li>Patrick Seda 2011-11-02

   Reopen via customer request.
   
   <h4>Associated Helpdesk Ticket</h4>
   <a href="http://appc.me/c/APP-486271" rel="nofollow" target="_blank">http://appc.me/c/APP-486271</a></li>
<li>Allen Yeung 2011-11-02

   Looks like the docs need to be updated.  base64encode() returns a TiBlob, and you will need to call getText() on TiBlob to get the string value</li>
<li>Junaid Younus 2012-05-14

   Tested with 2.0.1GA2 on a Samsung Galaxy S2 (2.3.6). Unable to reproduce the issue. Ticket closed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-1604.json">JSON Source</a></p>