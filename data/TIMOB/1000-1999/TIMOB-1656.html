---
title: "[TIMOB-1656] API inconsistency: TiBlob has 'length' property on Android, 'size' on iOS"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-05-03T15:47:23.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.1.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>core</td></tr>
<tr><th>Reporter</th><td>Brion Vibber</td></tr>
<tr><th>Assignee</th><td>Nolan Wright</td></tr>
<tr><th>Created</th><td>2011-04-15T02:58:35.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-07T18:19:56.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>In StatusNet Mobile, I'm trying to get the byte size of a blob
I've read from a file when passing a saved photo from one context
to another. The undocumented TiBlob type has a lot of differences
in its interface between the iOS and Android implementations, and
it's hitting here...</p>
<p>On Android there's a 'length' property:</p>
<pre>
<code>public int getLength() {
    switch (type) {
        case TYPE_FILE:
            return (int) ((TiBaseFile)data).getNativeFile().length();
        case TYPE_DATA:
        case TYPE_IMAGE:
            return ((byte[])data).length;
        default:
            // this is probably overly expensive.. is there a better way?
            return getBytes().length;
    }
}</code>
</pre>
<p>But on iOS, there's a 'size' property:</p>
<p>-(NSInteger)size {</p>
<pre>
<code>[self ensureImageLoaded];
if (image!=nil)
{
    return image.size.width * image.size.height;
}
switch (type)
{
    case TiBlobTypeData:
    {
        return [data length];
    }
    case TiBlobTypeFile:
    {
        NSFileManager *fm = [NSFileManager defaultManager];
        NSError *error = nil; 
        NSDictionary * resultDict = [fm attributesOfItemAtPath:path error:&amp;error];
        id result = [resultDict objectForKey:NSFileSize];
        if (error!=NULL)
        {
            return 0;
        }
        return [result intValue];
    }
}
return 0;</code>
</pre>
<p>}</p>
<p>They also don't have matching behavior for image blobs: Android
appears to return the byte size of whatever raw data the image is
using (is this source file? uncompressed? what bit depth?), while
on iOS it returns the number of pixels in the image. (Shouldn't
make a difference in this case though, since I'm reading straight
from a saved temporary file.)</p>
<p>Referencing my previous bug on the missing API documentation for
the Blob type on mobile:</p>
<p><a href=
"<a href="https://appcelerator.lighthouseapp.com/projects/32238/tickets/1580-titaniumblob-tiblob-missing-from-mobile-api-documentation" rel="nofollow" target="_blank">https://appcelerator.lighthouseapp.com/projects/32238/tickets/1580-titaniumblob-tiblob-missing-from-mobile-api-documentation</a>">
<a href="https://appcelerator.lighthouseapp.com/projects/32238/tickets/1580-..." rel="nofollow" target="_blank">https://appcelerator.lighthouseapp.com/projects/32238/tickets/1580-...</a></a></p>
<p>Note that the Desktop docs do have documentation for the Blob
type there:</p>
<p><a href=
"<a href="https://developer.appcelerator.com/apidoc/desktop/latest/Titanium.Blob-object" rel="nofollow" target="_blank">https://developer.appcelerator.com/apidoc/desktop/latest/Titanium.Blob-object</a>">
<a href="https://developer.appcelerator.com/apidoc/desktop/latest/Titanium.B..." rel="nofollow" target="_blank">https://developer.appcelerator.com/apidoc/desktop/latest/Titanium.B...</a></a></p>
<p>Desktop's blob type has a 'length' property, matching the
Android implementation (though I'm uncertain whether there are
image blobs on Desktop, and it doesn't say how it would return a
length for those).</p>
<p>Assigning to StatusNet's support contact.</p></div>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2012-05-03

   Fixed in master (2.1.0.848d711) at some point. Resolving.</li>
<li>Lee Morris 2017-03-07

   Closing ticket due to time passed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-1656.json">JSON Source</a></p>