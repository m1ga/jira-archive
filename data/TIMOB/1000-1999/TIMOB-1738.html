---
title: "[TIMOB-1738] Grouped Table does not honor background color of the table view"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:57:01.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0 M07</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>apple, bug, defect, ios, ipad, release-1.6.0, tableview</td></tr>
<tr><th>Reporter</th><td>ctredway</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-04-15T03:00:56.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:57:01.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>On 3.2 the grouped table view does not honor background color
property. The Rows will change color but the background around the
view always stays gray.</p>
<p>var win = Ti.UI.currentWindow;<br>
win.backgroundColor = '#FFF';</p>
<p>var data = [];</p>
<p>for (var c=0;c&lt;4;c++)<br>
{</p>
<pre>
<code>data[c] = Ti.UI.createTableViewSection({headerTitle:'Group '+(c+1)});
for (var x=0;x&lt;10;x++)
{
    data[c].add(Ti.UI.createTableViewRow({title:'Group '+(c+1)+', Row '+(x+1),backgroundColor:'#FF0000'}));
}</code>
</pre>
<p>}</p>
<p>// create table view var tableview =
Titanium.UI.createTableView({<br></p>
<pre>
<code>data:data,
style: Titanium.UI.iPhone.TableViewStyle.GROUPED,
backgroundColor:'transparent'</code>
</pre>
<p>});</p>
<p>// create table view event listener
tableview.addEventListener('click', function(e)<br>
{</p>
<pre>
<code>// event data
var index = e.index;
var section = e.section;
var row = e.row;
var rowdata = e.rowData;
if (section.headerTitle.indexOf('clicked')==-1)
{
    section.headerTitle = section.headerTitle + ' (clicked)';
}
Titanium.UI.createAlertDialog({title:'Table View',message:'row ' + row + ' index ' + index + ' section ' + section  + ' row data ' + rowdata}).show();</code>
</pre>
<p>});</p>
<p>// add table view to the window
Titanium.UI.currentWindow.add(tableview);</p></div>

<h3>Comments</h3>

<ol>
<li>Adriano Paladini 2011-04-15

   <div><p>I found a solution to make the 'backgroundColor' works in
   TableViewStyle.GROUPED.<br>
   This solution will set the tableview default backgroundColor to
   'transparent', and will correct ANY color applied to it.</p>
   <p>I Tested this with successful in 1.4.2 and 1.5.0</p>
   <p>If you want correct only for your project:</p>
   <ul>
   <li>Open in your project folder
   'build\iphone\Classes\TiUITableView.m'</li>
   </ul>
   <p>If you want correct all projects:</p>
   <ul>
   <li>Open '\Library\Application
   Support\Titanium\MobileSDK\osx\1.X.X\iphone\Classes\TiUITableView.m'
   *On 1.X.X is the version do you work.</li>
   </ul>
   <p>Find these lines:</p>
   <pre>
   <code>
       tableview.backgroundColor = style == UITableViewStylePlain ? [UIColor whiteColor] : [UIColor groupTableViewBackgroundColor];
       tableview.opaque = YES;</code>
   </pre>
   <p>and change to this code:</p>
   <pre>
   <code>
       //tableview.backgroundColor = style == UITableViewStylePlain ? [UIColor whiteColor] : [UIColor groupTableViewBackgroundColor];
       //tableview.opaque = YES;
   
       // CORRECTION FOR TRANSPARENT TABLEVIEW
       if (style != UITableViewStylePlain)
       {
           UIView *myBackgroundView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, [self bounds].size.width, [self bounds].size.height)];
           id BgColor = [self valueForKey:@"backgroundColor"];
           if (BgColor!=nil)
           {
               myBackgroundView.backgroundColor = [Webcolor webColorNamed:BgColor];
           }
           else
           {
               myBackgroundView.backgroundColor = [UIColor clearColor];
           }
           tableview.backgroundView = myBackgroundView;
       }
       // CORRECTION FOR TRANSPARENT TABLEVIEW</code>
   </pre></div></li>
<li>James K 2011-04-15

   <div><p>Adriano, does that introduce a memory leak? I see an alloc
   without a release.</p></div></li>
<li>Adriano Paladini 2011-04-15

   <div><p>Ops, sorry James K, you right!</p>
   <p>chage this:</p>
   <pre>
   <code>UIView *myBackgroundView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, [self bounds].size.width, [self bounds].size.height)];</code>
   </pre>
   <p>to this:</p>
   <pre>
   <code>UIView *myBackgroundView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, [self bounds].size.width, [self bounds].size.height) autorelease];</code>
   </pre>
   <p>Sorry for that!</p></div></li>
<li>Adriano Paladini 2011-04-15

   <div><p>SORRY again.....</p>
   <p>i forgot the brackets....</p>
   <p>Correct (and tested) code:</p>
   <pre>
   <code>
           //tableview.backgroundColor = style == UITableViewStylePlain ? [UIColor whiteColor] : [UIColor groupTableViewBackgroundColor];
           //tableview.opaque = YES;
           
           // CORRECTION FOR TRANSPARENT TABLEVIEW
           if (style != UITableViewStylePlain)
           {
               UIView *myBackgroundView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, [self bounds].size.width, [self bounds].size.height)] autorelease];
               id BgColor = [self valueForKey:@"backgroundColor"];
               if (BgColor!=nil)
               {
                   myBackgroundView.backgroundColor = [Webcolor webColorNamed:BgColor];
               }
               else
               {
                   myBackgroundView.backgroundColor = [UIColor clearColor];
               }
               tableview.backgroundView = myBackgroundView;
           }
           // CORRECTION FOR TRANSPARENT TABLEVIEW</code>
   </pre></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/1b85b06736303aede99672606c5e72319a2ff8dc"
   title=
   "Changeset [1b85b06736303aede99672606c5e72319a2ff8dc]">[1b85b06736303aede99672606c5e72319a2ff8dc]</a>)
   [<a href="/projects/32238/tickets/1738" title=
   "Ticket #1738">#1738</a> state:fixed-in-qa] Respect tableview BG
   color on creation, and only opaque out if not clear. <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/1b85b06736303aede99672606c5e72319a2ff8dc" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/1b85b06736303aede99672606c5e72319a2ff8dc</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/1b85b0673630..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/1b85b0673630...</a></a></p></div></li>
<li>Pedro Enrique 2011-04-15

   <div><p>Tested this code on iPad simulator and iPad, iOS 4.2</p>
   <pre>
   <code>var win = Ti.UI.createWindow({backgroundColor:'green'});
   var data = [];
   for(var i=0;i&lt;10;i++){
       data[i] = Ti.UI.createTableViewRow({title:'Row #'+i});
   }
   var tableview = Ti.UI.createTableView({
       data:data,
       style:Titanium.UI.iPhone.TableViewStyle.GROUPED,
       backgrounColor:'#5A9ECF'
   });
   win.add(tableview);
   win.open();</code>
   </pre>
   <p>Problem persists.</p>
   <p>Ti. SDK 1.6 (Jan 25 2011 17:39 r1ead074f)</p></div></li>
<li>Adriano Paladini 2011-04-15

   <div><p>In this new version made the correction as follows:</p>
   <p>after this line:</p>
   <pre>
   <code>tableview.opaque = ![tableview.backgroundColor isEqual:[UIColor clearColor]];</code>
   </pre>
   <p>I added:</p>
   <pre>
   <code>// CORRECTION FOR TRANSPARENT/COLOR BACKGROUND IN TABLEVIEW ON IPAD
   if(style != UITableViewStylePlain  &amp;&amp; [TiUtils isIPad])
   {
       UIView *myBackgroundView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, [self bounds].size.width, [self bounds].size.height)] autorelease];
       myBackgroundView.backgroundColor = bgColor != nil ? bgColor : [UIColor clearColor];
       tableview.backgroundView = myBackgroundView;
   }
   // CORRECTION FOR TRANSPARENT/COLOR BACKGROUND IN TABLEVIEW ON IPAD</code>
   </pre></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Example provided works as expected when
   <code>backgroundColor</code> doesn't contain a typo:</p>
   <pre>
   <code>var win = Ti.UI.createWindow({backgroundColor:'green'});
   var data = [];
   for(var i=0;i&lt;10;i++){
       data[i] = Ti.UI.createTableViewRow({title:'Row #'+i});
   }
   var tableview = Ti.UI.createTableView({
       data:data,
       style:Titanium.UI.iPhone.TableViewStyle.GROUPED,
       backgroundColor:'#5A9ECF'
   });
   win.add(tableview);
   win.open();</code>
   </pre>
   <p>If table rows adopting table background color/using UIClearColor
   is considered a bug and NOT expected behavior (i.e. this is not
   what Android does), that is a <strong>separate bug</strong> and
   this ticket should not be reopened.</p></div></li>
<li>Pedro Enrique 2011-04-15

   <div><p>Stephen,<br>
   Don't know if I'm testing this the wrong way, but I can't change
   the background of the tableview itself. This is the new code</p>
   <pre>
   <code>var win = Ti.UI.createWindow({backgroundColor:'green'});
   var data = [];
   for(var i=0;i&lt;10;i++){
       data[i] = Ti.UI.createTableViewRow({title:'Row #'+i,backgroundColor:'yellow'});
   }
   var tableview = Ti.UI.createTableView({
       data:data,
       style:Titanium.UI.iPhone.TableViewStyle.GROUPED,
       backgroundColor:'#000'
   });
   win.add(tableview);
   win.open();</code>
   </pre>
   <p>I'm setting the background of the tableView black and the rows
   yellow. The background of the tableView does not change, even if I
   remove the background color of the rows.</p>
   <p>And sorry for the typo, oops.</p>
   <p>Ti SDK 1.6 (Jan 26 2011 14:27 r6342c788)<br>
   TiDev 1.2 and 1.3<br>
   iPad Simulator 4.2</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>OK, this works on iPhone (what I fixed the bug for) but not
    iPad. Reopening.</p></div></li>
<li>Jeff Haynie 2011-04-15

    <div><p>(from <a href=
    "/projects/32238/changesets/5cc2ed4bdf5fcd57edfd6c86d0e3201bfb1d5997"
    title=
    "Changeset [5cc2ed4bdf5fcd57edfd6c86d0e3201bfb1d5997]">[5cc2ed4bdf5fcd57edfd6c86d0e3201bfb1d5997]</a>)
    [<a href="/projects/32238/tickets/1738" title=
    "Ticket #1738">#1738</a> state:fixed-in-qa] Fixed for iPad as well
    - there's an iPad-specific apple bug that screws up tableview
    background colors. Probably also affects BG images. <a href=
    "<a href="https://github.com/appcelerator/titanium_mobile/commit/5cc2ed4bdf5fcd57edfd6c86d0e3201bfb1d5997" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5cc2ed4bdf5fcd57edfd6c86d0e3201bfb1d5997</a>">
    <a href="https://github.com/appcelerator/titanium_mobile/commit/5cc2ed4bdf5f..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5cc2ed4bdf5f...</a></a></p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Confirmed that this is an apple bug. It's less than ideal, but
    I've added in the proposed solution of just outright replacing the
    background view in the case of iPad.</p>
    <p>Radar bug # is 8921858.</p></div></li>
<li>Pedro Enrique 2011-04-15

    <div><p>Yes!</p>
    <p>Now it works as expected.</p>
    <p>Ti. SDK 1.6 (Jan 26 2011 16:47 rb481fe0b)<br>
    iPad Simulator 4.2<br>
    Ti. Dev. 1.3</p></div></li>
<li>Marko Perutovic 2011-04-15

    <div><p>Border color is transparent</p></div></li>
<li>Rick Blalock 2011-04-15

    <div><p>I just tested what Marko is referring. Only on iPad a grouped
    view's border is semi-transparent. Workaround is to explicitly set
    the separatorColor to the tableView object.</p>
    <p>He's attached two images here to give an example: <a href=
    "<a href="http://developer.appcelerator.com/helpdesk/view/66191#c324451" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/66191#c324451</a>"><a href="http://developer.appcelerator.com/helpdesk/view/66191#c324451" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/66191#c324451</a></a></p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-1738.json">JSON Source</a></p>