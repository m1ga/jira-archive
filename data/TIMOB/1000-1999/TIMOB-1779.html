---
title: "[TIMOB-1779] Android: Cannot set Webview's html property after navigating somewhere"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2017-08-08T18:48:13.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>api</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2011-04-15T03:02:02.000+0000</td></tr>
<tr><th>Updated</th><td>2017-08-08T18:48:13.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><h1>Problem</h1>
<p>When a web view on Android navigates to an external URL, the
"html" property becomes unusable -- you cannot get or set its
value. If you set the "html" property, then navigate to an external
URL, setting the "html" property has no effect on the web view. And
reading the "html" property reflects what you originally set it as
before navigating to the external URL.</p>
<h1>Failcase</h1>
<p>The following code demonstrates setting the "html" property,
with a link to an external site.</p>
<pre>
<code class="javascript">var win = Titanium.UI.createWindow({
    backgroundColor:'#fff'
});

var html1 = '&lt;html&gt;&lt;body&gt;&lt;a href="<a href="http://www.google.com" rel="nofollow" target="_blank">http://www.google.com</a>"&gt;Google&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;';
var html2 = '&lt;html&gt;&lt;body&gt;&lt;a href="<a href="http://www.yahoo.com" rel="nofollow" target="_blank">http://www.yahoo.com</a>"&gt;Yahoo&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;';

var wv = Ti.UI.createWebView({html: html1, backgroundColor: 'yellow', top: 50});
win.add(wv);

var btn = Ti.UI.createButton({
    title: 'Set HTML', top: 10, height: 40, width: 100, left: 10
});
btn.addEventListener('click', function() {
    alert(wv.html);
    wv.html = html2;
});
win.add(btn);

win.open();</code>
</pre>
<h1>Steps to Reproduce with Failcase</h1>
<ol>
<li>Start off by clicking "Set HTML", and it will alert "web.html"
for you to see; the web view will update to contain a link to
Yahoo. So far so good.<br></li>
<li>Click the link to Yahoo,<br></li>
<li>Then click "Set HTML" again, and the web view will not update.
Also, the alerted html will be from what you previously set.</li>
</ol>
<p>If you run this same code on iOS, you'll see Yahoo's HTML
alerted, and then the web view will properly update to be the html
you specified.</p>
<h1>Expected Results</h1>
<p>A new page shows with just one link (to yahoo this time.)</p>
<h1>Workaround</h1>
<p>Two workarounds are required, but both are rather simple:</p>
<p>To get around the setting-doesn't-update issue, first set the
url property of the web view to an empty string. In the failcase,
this would look like this:</p>
<pre>
<code class="javascript">btn.addEventListener('click', function() {
    alert(wv.html);
    wv.url = '';
    wv.html = html2;
});</code>
</pre>
<p>Now getting around the reading-html-returns-stale-html issue is
a bit more difficult. We need to run some JavaScript to do so. This
isn't entirely foolproof, but it should give you a fairly accurate
dump of the HTML after the page loads:</p>
<pre>
<code class="javascript">btn.addEventListener('click', function() {
    var response = '&lt;html&gt;' + web.evalJS('document.getElementsByTagName("html")[0].innerHTML') + '&lt;/html&gt;';
    alert(response);
    wv.url = '';
    wv.html = html2;
});</code>
</pre>
<h1>Tested On</h1>
<p>Titanium SDK version: 1.6.0 (02/23/11 12:34 9882e81)<br>
BROKEN on Android Emulator 2.2 APIs<br>
BROKEN on Android Device Epic 4G 2.2<br>
WORKS on iPhone Simulator 4.2</p>
<h2>Associated Helpdesk Ticket</h2>
<p><a href=
"<a href="http://developer.appcelerator.com/helpdesk/view/76225" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/76225</a>"><a href="http://developer.appcelerator.com/helpdesk/view/76225" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/76225</a></a></p></div>

<h3>Comments</h3>

<ol>
<li>Dawson Toth 2011-04-15

   <div><p>I'm seeing the same behavior on the other side of things --
   getting the HTML, as opposed to setting it. I'll update the
   original ticket with additional details.</p></div></li>
<li>Junaid Younus 2012-08-16

   Tested using TiSDK 2.2.0v20120816015712 on a Samsung Galaxy S2, issue still valid.</li>
<li>Lee Morris 2017-08-08

   Closing due to inactivity. If this issue still exists, please raise a new ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-1779.json">JSON Source</a></p>