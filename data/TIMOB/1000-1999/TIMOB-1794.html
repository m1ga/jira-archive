---
title: "[TIMOB-1794] Android: Mixed type arrays assigned to proxies throw ClassCast exception"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:57:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0 M06</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, release-1.6.0, rplist</td></tr>
<tr><th>Reporter</th><td>Don Thorp</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-04-15T03:02:35.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:57:11.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>See <a href=
"<a href="http://developer.appcelerator.com/helpdesk/view/42511" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/42511</a>">Helpdesk
42511</a></p>
<pre>
<code class="javascript">var win = Titanium.UI.createWindow();
var foo = ["foo", "bar",999];
 
// uncommenting this fixes it, because its no longer mixed type
// foo = ["foo", "bar","999"];
// this also works
// foo = [111,222,3333];
 
// exception doesnt happen until the array is assigned to a proxy object
win.foo = foo;
alert(win.foo);
win.open();</code>
</pre>
<p>Wondering if this was a blocked issue until proxy assignment was
completed.</p></div>

<h3>Comments</h3>

<ol>
<li>hal 2011-04-15

   <div><p>As discussed with Don, the following code also produces an
   exception in 1.4.3 (21Nov) but not in 1.5.X (17Dec).</p>
   <pre>
   <code>var window = Titanium.UI.createWindow({  
       backgroundColor:'red'
   });
   
   var view = Titanium.UI.createView({
       backgroundColor:"blue"
   });
   
   var x = [ 1,2,3,4,5,6 ];
   view.myArray = x;
   window.add(view);
   window.open();
   
   function isArray(obj) {
      if (obj.constructor.toString().indexOf("Array") == -1)
         return false;
      else
         return true;
   }
   
   Ti.API.info("x type isArray = "+isArray(x));
   Ti.API.info("view.myArray[3] = "+view.myArray[3]);
   Ti.API.info("view.myArray type = "+typeof(view.myArray));
   Ti.API.info("view.myArray type isArray = "+isArray(view.myArray));  //this causes the exception</code>
   </pre>
   <p>The exception output can be found <a href=
   "<a href="https://gist.github.com/751731" rel="nofollow" target="_blank">https://gist.github.com/751731</a>">here</a></p></div></li>
<li>Don Thorp 2011-04-15

   <div><p>Not sure why this is still open if it's in 1.5.1 please test and
   close if not valid.</p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/9e588f2c63514f614a78c32f37c14071a2a2d1a4"
   title=
   "Changeset [9e588f2c63514f614a78c32f37c14071a2a2d1a4]">[9e588f2c63514f614a78c32f37c14071a2a2d1a4]</a>)
   the kroll invocation scope needs to pull from the current thread's
   ti context top level scope instead of the "start" which is
   essentially the<br>
   same as the "thisObject". added a kroll test, this fixes
   "constructor"<br>
   for Array and other types [<a href="/projects/32238/tickets/1794"
   title="Ticket #1794">#1794</a> state:fixed-in-qa]<br>
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/9e588f2c63514f614a78c32f37c14071a2a2d1a4" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/9e588f2c63514f614a78c32f37c14071a2a2d1a4</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/9e588f2c6351..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/9e588f2c6351...</a></a></p></div></li>
<li>Opie Cyrus 2011-04-15

   <div><p>Verified crash is no longer occurring with test case from
   Hal.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-1794.json">JSON Source</a></p>