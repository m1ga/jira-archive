---
title: "[TIMOB-1830] Android: FC when trying to open lightweight window with Mapview a second time"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:57:17.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-04-15T03:03:24.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:57:17.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Simple failcase app.js:</p>
<pre>
<code class="javascript">
Titanium.UI.setBackgroundColor('#000');
var win = Titanium.UI.createWindow({  
    title:'Map Test', backgroundColor:'#fff',
    fullscreen: true, exitOnClose: true
});

var open = Ti.UI.createButton({title: 'Open mapview window'});
open.addEventListener('click', function(){
    var w2 = Ti.UI.createWindow({title: 'Map View', backgroundColor: 'green'});
    var mapview = Titanium.Map.createView({
        mapType: Titanium.Map.STANDARD_TYPE,
        region: {latitude:33.74511, longitude:-84.38993, 
                latitudeDelta:0.01, longitudeDelta:0.01},
        top: 0, left: 0, right: 0, height: 300
    });
    w2.add(mapview);
    var close = Ti.UI.createButton({title: 'close', top: 305});
    close.addEventListener('click', function(){ w2.close(); });
    w2.add(close);
    w2.open();
});
win.add(open);

win.open();</code>
</pre>
<p>The map activity only gets destroyed when the "parent" activity
gets destroyed. Since lightweight windows don't have their own
activities, destroy doesn't occur. If you try to the same or
another window with a mapview, it will therefore fail.</p>
<p>We need a way to get that map activity destroyed even when the
host window is lightweight. In the past we've told some users about
an undocumented hack, calling mapview.OnDestroy. But we shouldn't
do that as it's not cross-platform and may be unavailable with new
Kroll.</p></div>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/4fc1e678d66860acfedd139baf486f849eb934b8"
   title=
   "Changeset [4fc1e678d66860acfedd139baf486f849eb934b8]">[4fc1e678d66860acfedd139baf486f849eb934b8]</a>)
   [<a href="/projects/32238/tickets/1830" title=
   "Ticket #1830">#1830</a> state:fixed-in-qa] Take care of destroying
   map activity by overriding and hooking into releaseViews().
   <a href="<a href="http://github.com/appcelerator/titanium_mobile/commit/4fc1e678d66860acfedd139baf486f849eb934b8" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/4fc1e678d66860acfedd139baf486f849eb934b8</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/4fc1e678d6686..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/4fc1e678d6686...</a></a></p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>confirmed on a G1 running 1.6, leaving in my pile till I get a
   2.1 and 2.2 device to close against.</p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>oops, did not set ticket state</p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>and again, lol</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-1830.json">JSON Source</a></p>