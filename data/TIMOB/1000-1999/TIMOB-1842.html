---
title: "[TIMOB-1842] Android: Implement spaceAvailable() for File"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:57:19.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, feature, file, spaceavailable</td></tr>
<tr><th>Reporter</th><td>Marshall Culpepper</td></tr>
<tr><th>Assignee</th><td>Marshall Culpepper</td></tr>
<tr><th>Created</th><td>2011-04-15T03:03:42.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:57:19.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>right now we just have a place holder of 9999999L</p></div>

<h3>Comments</h3>

<ol>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/bdee2871d8f32838edd9840e39ce4035088e3a43"
   title=
   "Changeset [bdee2871d8f32838edd9840e39ce4035088e3a43]">[bdee2871d8f32838edd9840e39ce4035088e3a43]</a>)
   implement spaceAvailable() for android TiFile [<a href=
   "/projects/32238/tickets/1842" title="Ticket #1842">#1842</a>
   state:fixed-in-qa] <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/bdee2871d8f32838edd9840e39ce4035088e3a43" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/bdee2871d8f32838edd9840e39ce4035088e3a43</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/bdee2871d8f32..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/bdee2871d8f32...</a></a></p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>using the code below I get binary return, I believe I should be
   seeing a value returning the available space?</p>
   <p>var win = Titanium.UI.currentWindow;<br>
   Titanium.UI.setBackgroundColor('white');</p>
   <p>var dir =
   Titanium.Filesystem.getFile(Titanium.Filesystem.resourcesDirectory);<br>
   var l = Titanium.UI.createLabel({text:'value should be updated',
   width:300, height:'auto', textAlign:'center'});<br>
   l.text='spaceAvailable = ' + dir.spaceAvailable();<br>
   win.add(l);</p></div></li>
<li>Brion Vibber 2011-04-15

   <div><p>Commit bdee2871d8f32838edd9840e39ce4035088e3a43 implemented this
   method using file.getFreeSpace() instead of returning a hardcoded
   number, but it doesn't appear to actually work in my testing.</p>
   <p>java.io.File.getFreeSpace() is new in JDK 1.6, and although I
   can compile the runtime just fine, since it isn't actually present
   in Android, my app fails when attempting to call it.</p>
   <p><a href=
   "<a href="http://download.oracle.com/javase/6/docs/api/java/io/File.html#getFreeSpace%28%29" rel="nofollow" target="_blank">http://download.oracle.com/javase/6/docs/api/java/io/File.html#getFreeSpace%28%29</a>">
   <a href="http://download.oracle.com/javase/6/docs/api/java/io/File.html#getF..." rel="nofollow" target="_blank">http://download.oracle.com/javase/6/docs/api/java/io/File.html#getF...</a></a></p>
   <p><a href=
   "<a href="http://developer.android.com/reference/java/io/File.html" rel="nofollow" target="_blank">http://developer.android.com/reference/java/io/File.html</a>"><a href="http://developer.android.com/reference/java/io/File.html" rel="nofollow" target="_blank">http://developer.android.com/reference/java/io/File.html</a></a></p>
   <pre>
   <code>E/AndroidRuntime(  792): FATAL EXCEPTION: kroll$1
   E/AndroidRuntime(  792): java.lang.NoSuchMethodError: java.io.File.getFreeSpace
   E/AndroidRuntime(  792):    at org.appcelerator.titanium.io.TiFile.spaceAvailable(TiFile.java:195)
   E/AndroidRuntime(  792):    at ti.modules.titanium.filesystem.FileProxy.spaceAvailable(FileProxy.java:231)
   E/AndroidRuntime(  792):    at ti.modules.titanium.filesystem.FileProxyBindingGen$15.invoke(FileProxyBindingGen.java:498)
   E/AndroidRuntime(  792):    at org.appcelerator.kroll.KrollMethod.call(KrollMethod.java:46)
   E/AndroidRuntime(  792):    at org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1711)
   E/AndroidRuntime(  792):    at org.mozilla.javascript.Interpreter.interpret(Interpreter.java:854)
   E/AndroidRuntime(  792):    at org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:164)
   E/AndroidRuntime(  792):    at org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:426)
   E/AndroidRuntime(  792):    at org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:3161)
   E/AndroidRuntime(  792):    at org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:162)
   E/AndroidRuntime(  792):    at org.appcelerator.titanium.kroll.KrollCallback$1.run(KrollCallback.java:97)
   E/AndroidRuntime(  792):    at android.os.Handler.handleCallback(Handler.java:587)
   E/AndroidRuntime(  792):    at android.os.Handler.dispatchMessage(Handler.java:92)
   E/AndroidRuntime(  792):    at android.os.Looper.loop(Looper.java:123)
   E/AndroidRuntime(  792):    at org.appcelerator.titanium.kroll.KrollHandlerThread.run(KrollHandlerThread.java:73)</code>
   </pre></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/dac0b4dec18678c1f5e9701fe2bdae7f5bb24895"
   title=
   "Changeset [dac0b4dec18678c1f5e9701fe2bdae7f5bb24895]">[dac0b4dec18678c1f5e9701fe2bdae7f5bb24895]</a>)
   clean up singleton modules and event managers in context onDestroy,
   this lets event listeners work when the app has been relaunched.
   removed impl of File.spaceAvailable() (it was Java6 only, we'll
   need to find another way) [<a href="/projects/32238/tickets/1238"
   title="Ticket #1238">#1238</a>] [<a href=
   "/projects/32238/tickets/1842" title="Ticket #1842">#1842</a>]
   <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/dac0b4dec18678c1f5e9701fe2bdae7f5bb24895" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/dac0b4dec18678c1f5e9701fe2bdae7f5bb24895</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/dac0b4dec1867..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/dac0b4dec1867...</a></a></p></div></li>
<li>Brion Vibber 2011-04-15

   <div><p>Looks like this can be done with android.os.StatFs:</p>
   <p><a href=
   "<a href="http://developer.android.com/reference/android/os/StatFs.html" rel="nofollow" target="_blank">http://developer.android.com/reference/android/os/StatFs.html</a>"><a href="http://developer.android.com/reference/android/os/StatFs.html" rel="nofollow" target="_blank">http://developer.android.com/reference/android/os/StatFs.html</a></a></p>
   <p>I'll throw a quick patch together.</p></div></li>
<li>Brion Vibber 2011-04-15

   <div><p>Branch:<br>
   <a href=
   "<a href="http://github.com/brion/titanium_mobile/tree/spaceAvailable" rel="nofollow" target="_blank">http://github.com/brion/titanium_mobile/tree/spaceAvailable</a>"><a href="http://github.com/brion/titanium_mobile/tree/spaceAvailable" rel="nofollow" target="_blank">http://github.com/brion/titanium_mobile/tree/spaceAvailable</a></a></p>
   <p>Commit:<br>
   <a href=
   "<a href="http://github.com/brion/titanium_mobile/commit/ab4deb35f057165dd5a94aa30a994c91ab2781b0" rel="nofollow" target="_blank">http://github.com/brion/titanium_mobile/commit/ab4deb35f057165dd5a94aa30a994c91ab2781b0</a>">
   <a href="http://github.com/brion/titanium_mobile/commit/ab4deb35f057165dd5a9..." rel="nofollow" target="_blank">http://github.com/brion/titanium_mobile/commit/ab4deb35f057165dd5a9...</a></a></p>
   <p>Pull request:<br>
   <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/pull/10" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/pull/10</a>"><a href="http://github.com/appcelerator/titanium_mobile/pull/10" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/pull/10</a></a></p>
   <p>Quick note on something I noticed while testing --
   Ti.File.spaceAvailable() is actually documented as returning a
   boolean rather than returning a numeric byte count. On iOS I'm
   indeed getting just true/false out of it... Zero/non-zero should
   act correctly in boolean context, but is there a reason we're
   returning a number on Android and a boolean on iOS and in the
   documentation?</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/e9b35665142d28eddc2f73f1aacd6dc37f357732"
   title=
   "Changeset [e9b35665142d28eddc2f73f1aacd6dc37f357732]">[e9b35665142d28eddc2f73f1aacd6dc37f357732]</a>)
   [<a href="/projects/32238/tickets/1842" title=
   "Ticket #1842">#1842</a> state:fixed-in-qa] Android implementation
   of TiFile.spaceAvailable using android.os.StatFs, as
   java.io.File.getFreeSpace isn't available in current Android.</p>
   <p>Signed-off-by: marshall <a>mculpepper@appcelerator.com</a><br>
   <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/e9b35665142d28eddc2f73f1aacd6dc37f357732" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/e9b35665142d28eddc2f73f1aacd6dc37f357732</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/e9b35665142d2..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/e9b35665142d2...</a></a></p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>implemented, logging a new bug about the values being reported
   and platform/doc inconsistencies.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-1842.json">JSON Source</a></p>