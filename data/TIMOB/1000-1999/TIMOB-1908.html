---
title: "[TIMOB-1908] Android: contacts picker callbacks never fired if showContacts called from other context"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-07-15T06:42:04.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, module_media, qe-port, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Neeraj Gupta</td></tr>
<tr><th>Created</th><td>2011-04-15T03:05:19.000+0000</td></tr>
<tr><th>Updated</th><td>2013-07-15T06:42:04.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>This is yet another context/activity issue.</p>
<p>failcase app.js:</p>
<pre>
<code class="javascript">/*global Ti, Titanium, alert, JSON */
Titanium.UI.setBackgroundColor('#000');
var win = Titanium.UI.createWindow({  
    title:'Test',
    backgroundColor:'#fff',
    fullscreen: true,
    exitOnClose: true
});

var btn = Ti.UI.createButton({
    title: 'contacts'
});
btn.addEventListener('click', function() {
    Ti.Contacts.showContacts({
        selectedPerson: function(){Ti.API.info('!!!!!!!!! SELECTED');}
    });
});

win.add(btn);
win.open();</code>
</pre>
<p>So in this example, the button to open the picker is in a
heavyweight window. But the button was placed there -- and the
listener added -- from the root context.</p>
<p>Debugging in Eclipse, I can see that the picker activity
<code>onResult</code> is not even hit.</p>
<p>If you move the code that creates the button/event listener into
the heavyweight window's own JS file, it works.</p>
<p>If you look in our <a href=
"<a href="http://github.com/appcelerator/titanium_mobile/blob/android_native_refactor/android/modules/contacts/src/ti/modules/titanium/contacts/ContactsModule.java#L126" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/blob/android_native_refactor/android/modules/contacts/src/ti/modules/titanium/contacts/ContactsModule.java#L126</a>">
ContactsModule.java</a> on the line where we setup calling the
picker activity (using TiActivitySupport), you can see we're using
the activity of the context, which in our example above will be the
root context and therefore not correspond to the Activity of the
heavyweight window.</p></div>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/e56ed6aff77ddba5c17137bd2951a02b911ac1f7"
   title=
   "Changeset [e56ed6aff77ddba5c17137bd2951a02b911ac1f7]">[e56ed6aff77ddba5c17137bd2951a02b911ac1f7]</a>)
   [<a href="/projects/32238/tickets/1908" title=
   "Ticket #1908">#1908</a>] Workaround for contact picker activity
   onResult not firing if wrong activity is starting the picker: pass
   in a proxy object that represents the correct context from which to
   start the picker activity. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/e56ed6aff77ddba5c17137bd2951a02b911ac1f7" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/e56ed6aff77ddba5c17137bd2951a02b911ac1f7</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/e56ed6aff77dd..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/e56ed6aff77dd...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/a83d7f5c23ce11c0897a963001a77ed786b1faa8"
   title=
   "Changeset [a83d7f5c23ce11c0897a963001a77ed786b1faa8]">[a83d7f5c23ce11c0897a963001a77ed786b1faa8]</a>)
   [<a href="/projects/32238/tickets/1908" title=
   "Ticket #1908">#1908</a>] Better type checking for that optional
   proxy arg. Put back @contextspecific which I'd taken away while
   testing and forgot to put back before the last commit. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/a83d7f5c23ce11c0897a963001a77ed786b1faa8" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/a83d7f5c23ce11c0897a963001a77ed786b1faa8</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/a83d7f5c23ce1..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/a83d7f5c23ce1...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/c1a4898b161a2bf564ddab74f0d5a3db1c523b52"
   title=
   "Changeset [c1a4898b161a2bf564ddab74f0d5a3db1c523b52]">[c1a4898b161a2bf564ddab74f0d5a3db1c523b52]</a>)
   [<a href="/projects/32238/tickets/1908" title=
   "Ticket #1908">#1908</a>] Workaround for contact picker activity
   onResult not firing if wrong activity is starting the picker: pass
   in a proxy object that represents the correct context from which to
   start the picker activity. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/c1a4898b161a2bf564ddab74f0d5a3db1c523b52" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/c1a4898b161a2bf564ddab74f0d5a3db1c523b52</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/c1a4898b161a2..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/c1a4898b161a2...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/e9f9d363491f9fbec474a616503c5cde12d5babd"
   title=
   "Changeset [e9f9d363491f9fbec474a616503c5cde12d5babd]">[e9f9d363491f9fbec474a616503c5cde12d5babd]</a>)
   [<a href="/projects/32238/tickets/1908" title=
   "Ticket #1908">#1908</a>] Better type checking for that optional
   proxy arg. Put back @contextspecific which I'd taken away while
   testing and forgot to put back before the last commit. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/e9f9d363491f9fbec474a616503c5cde12d5babd" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/e9f9d363491f9fbec474a616503c5cde12d5babd</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/e9f9d363491f9..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/e9f9d363491f9...</a></a></p></div></li>
<li>Junaid Younus 2012-08-21

   Tested on a Samsung Galaxy S2 using TiSDK 2.2.0v20120821095711, unable to reproduce the issue. Ticket marked as resolved. </li>
<li>Anshu Mittal 2012-08-29

   Verified on:
   SDK:2.2.0.v20120828153312
   Studio:2.1.2.201208281351
   Devices: LGp970(v 2.2.2)</li>
<li>Anshu Mittal 2012-08-29

   Verified on:
   SDK:2.2.0.v20120828153312
   Studio:2.1.2.201208281351
   Devices: LG-p970(v 2.2.2)
   
   Contacts picker callbacks are fired successfully.</li>
<li>Priya Agarwal 2013-07-15

   Reopening just to update the label.</li>
<li>Priya Agarwal 2013-07-15

   Updated label and verified with:
   
   Titanium Studio:3.1.2.201307091843
   Titanium SDK: 3.1.2.v20130710144553
   acs:1.0.3
   alloy:1.1.3
   npm:1.2.14
   titanium:3.1.1
   itanium-code-processor:1.0.1
   OS: OSX 10.8
   Device:iPhone4 (v 5.1), Galaxy Nexus (v 4.0.4)
   Xcode: 4.5.1
   
   Contacts picker callbacks are fired successfully.
   
   
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-1908.json">JSON Source</a></p>