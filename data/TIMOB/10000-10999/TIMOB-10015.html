---
title: "[TIMOB-10015] Android: Gradient colors offset property, when unspecified, crashes app"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-09-06T03:36:34.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.0, Release 2.1.1</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2012-15 API, Release 3.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>api, module_view, parity, qe-review, qe-testadded, titanbeta</td></tr>
<tr><th>Reporter</th><td>Shawn Lipscomb</td></tr>
<tr><th>Assignee</th><td>Josh Roesslein</td></tr>
<tr><th>Created</th><td>2012-07-12T11:55:28.000+0000</td></tr>
<tr><th>Updated</th><td>2013-11-07T05:52:59.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
If you leave off the *offset* property of elements in the *colors* array of a Gradient, the app crashes.

<h4>Expected behavior</h4>
First element of the *colors* array should default to offset:0.0, and the second element of the *colors* array should default to offset:1.0, as this is a common case (full width or height gradient).  Alternatively, a console error or "red & white error screen" should be produced when the *offset* property is not specified.

<h4>Actual bahavior</h4>
A "force close" occurs with this crash error in the console log:
{panel:title=console log}
<code><pre>
[ERROR][TiApplication(  526)] (main) [104,104] Sending event: exception on thread: main msg:java.lang.RuntimeException: Unable to start activity ComponentInfo{com.eCotton.GradientTest/org.appcelerator.titanium.TiActivity}: java.lang.NullPointerException; Titanium 2.1.0,2012/06/28 12:16,6e3cab6
[ERROR][TiApplication(  526)] java.lang.RuntimeException: Unable to start activity ComponentInfo{com.eCotton.GradientTest/org.appcelerator.titanium.TiActivity}: java.lang.NullPointerException
[ERROR][TiApplication(  526)] 	at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
[ERROR][TiApplication(  526)] 	at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
[ERROR][TiApplication(  526)] 	at android.app.ActivityThread.access$2300(ActivityThread.java:125)
[ERROR][TiApplication(  526)] 	at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
[ERROR][TiApplication(  526)] 	at android.os.Handler.dispatchMessage(Handler.java:99)
[ERROR][TiApplication(  526)] 	at android.os.Looper.loop(Looper.java:123)
[ERROR][TiApplication(  526)] 	at android.app.ActivityThread.main(ActivityThread.java:4627)
[ERROR][TiApplication(  526)] 	at java.lang.reflect.Method.invokeNative(Native Method)
[ERROR][TiApplication(  526)] 	at java.lang.reflect.Method.invoke(Method.java:521)
[ERROR][TiApplication(  526)] 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
[ERROR][TiApplication(  526)] 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
[ERROR][TiApplication(  526)] 	at dalvik.system.NativeStart.main(Native Method)
[ERROR][TiApplication(  526)] Caused by: java.lang.NullPointerException
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.util.TiConvert.toFloat(TiConvert.java:432)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.util.TiConvert.toFloat(TiConvert.java:462)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.view.TiGradientDrawable.loadColors(TiGradientDrawable.java:106)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.view.TiGradientDrawable.&lt;init&gt;(TiGradientDrawable.java:83)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.view.TiUIView.handleBackgroundImage(TiUIView.java:824)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.view.TiUIView.processProperties(TiUIView.java:594)
[ERROR][TiApplication(  526)] 	at ti.modules.titanium.ui.widget.TiView.processProperties(TiView.java:49)
[ERROR][TiApplication(  526)] 	at org.appcelerator.kroll.KrollProxy.setModelListener(KrollProxy.java:884)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.realizeViews(TiViewProxy.java:441)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.handleGetView(TiViewProxy.java:433)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.getOrCreateView(TiViewProxy.java:411)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.handleAdd(TiViewProxy.java:527)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.handleMessage(TiViewProxy.java:204)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.proxy.TiWindowProxy.handleMessage(TiWindowProxy.java:111)
[ERROR][TiApplication(  526)] 	at ti.modules.titanium.ui.ActivityWindowProxy.handleMessage(ActivityWindowProxy.java:93)
[ERROR][TiApplication(  526)] 	at android.os.Handler.dispatchMessage(Handler.java:95)
[ERROR][TiApplication(  526)] 	at org.appcelerator.kroll.common.TiMessenger.dispatchMessage(TiMessenger.java:365)
[ERROR][TiApplication(  526)] 	at org.appcelerator.kroll.common.TiMessenger.dispatchPendingMessages(TiMessenger.java:350)
[ERROR][TiApplication(  526)] 	at org.appcelerator.kroll.common.TiMessenger$2.getResult(TiMessenger.java:235)
[ERROR][TiApplication(  526)] 	at org.appcelerator.kroll.common.TiMessenger.sendBlockingMessage(TiMessenger.java:262)
[ERROR][TiApplication(  526)] 	at org.appcelerator.kroll.common.TiMessenger.sendBlockingRuntimeMessage(TiMessenger.java:187)
[ERROR][TiApplication(  526)] 	at org.appcelerator.kroll.KrollProxy.fireSyncEvent(KrollProxy.java:605)
[ERROR][TiApplication(  526)] 	at ti.modules.titanium.ui.TiUIActivityWindow.windowCreated(TiUIActivityWindow.java:142)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.TiActivityWindows.windowCreated(TiActivityWindows.java:31)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.TiBaseActivity.windowCreated(TiBaseActivity.java:352)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.TiBaseActivity.onCreate(TiBaseActivity.java:425)
[ERROR][TiApplication(  526)] 	at org.appcelerator.titanium.TiActivity.onCreate(TiActivity.java:22)
[ERROR][TiApplication(  526)] 	at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
[ERROR][TiApplication(  526)] 	at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
[ERROR][TiApplication(  526)] 	... 11 more
[ERROR][AndroidRuntime(  526)] FATAL EXCEPTION: main
[ERROR][AndroidRuntime(  526)] java.lang.RuntimeException: Unable to start activity ComponentInfo{com.eCotton.GradientTest/org.appcelerator.titanium.TiActivity}: java.lang.NullPointerException
[ERROR][AndroidRuntime(  526)] 	at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
[ERROR][AndroidRuntime(  526)] 	at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
[ERROR][AndroidRuntime(  526)] 	at android.app.ActivityThread.access$2300(ActivityThread.java:125)
[ERROR][AndroidRuntime(  526)] 	at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
[ERROR][AndroidRuntime(  526)] 	at android.os.Handler.dispatchMessage(Handler.java:99)
[ERROR][AndroidRuntime(  526)] 	at android.os.Looper.loop(Looper.java:123)
[ERROR][AndroidRuntime(  526)] 	at android.app.ActivityThread.main(ActivityThread.java:4627)
[ERROR][AndroidRuntime(  526)] 	at java.lang.reflect.Method.invokeNative(Native Method)
[ERROR][AndroidRuntime(  526)] 	at java.lang.reflect.Method.invoke(Method.java:521)
[ERROR][AndroidRuntime(  526)] 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
[ERROR][AndroidRuntime(  526)] 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
[ERROR][AndroidRuntime(  526)] 	at dalvik.system.NativeStart.main(Native Method)
[ERROR][AndroidRuntime(  526)] Caused by: java.lang.NullPointerException
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.util.TiConvert.toFloat(TiConvert.java:432)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.util.TiConvert.toFloat(TiConvert.java:462)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.view.TiGradientDrawable.loadColors(TiGradientDrawable.java:106)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.view.TiGradientDrawable.&lt;init&gt;(TiGradientDrawable.java:83)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.view.TiUIView.handleBackgroundImage(TiUIView.java:824)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.view.TiUIView.processProperties(TiUIView.java:594)
[ERROR][AndroidRuntime(  526)] 	at ti.modules.titanium.ui.widget.TiView.processProperties(TiView.java:49)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.kroll.KrollProxy.setModelListener(KrollProxy.java:884)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.realizeViews(TiViewProxy.java:441)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.handleGetView(TiViewProxy.java:433)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.getOrCreateView(TiViewProxy.java:411)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.handleAdd(TiViewProxy.java:527)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.proxy.TiViewProxy.handleMessage(TiViewProxy.java:204)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.proxy.TiWindowProxy.handleMessage(TiWindowProxy.java:111)
[ERROR][AndroidRuntime(  526)] 	at ti.modules.titanium.ui.ActivityWindowProxy.handleMessage(ActivityWindowProxy.java:93)
[ERROR][AndroidRuntime(  526)] 	at android.os.Handler.dispatchMessage(Handler.java:95)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.kroll.common.TiMessenger.dispatchMessage(TiMessenger.java:365)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.kroll.common.TiMessenger.dispatchPendingMessages(TiMessenger.java:350)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.kroll.common.TiMessenger$2.getResult(TiMessenger.java:235)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.kroll.common.TiMessenger.sendBlockingMessage(TiMessenger.java:262)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.kroll.common.TiMessenger.sendBlockingRuntimeMessage(TiMessenger.java:187)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.kroll.KrollProxy.fireSyncEvent(KrollProxy.java:605)
[ERROR][AndroidRuntime(  526)] 	at ti.modules.titanium.ui.TiUIActivityWindow.windowCreated(TiUIActivityWindow.java:142)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.TiActivityWindows.windowCreated(TiActivityWindows.java:31)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.TiBaseActivity.windowCreated(TiBaseActivity.java:352)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.TiBaseActivity.onCreate(TiBaseActivity.java:425)
[ERROR][AndroidRuntime(  526)] 	at org.appcelerator.titanium.TiActivity.onCreate(TiActivity.java:22)
[ERROR][AndroidRuntime(  526)] 	at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
[ERROR][AndroidRuntime(  526)] 	at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
[ERROR][AndroidRuntime(  526)] 	... 11 more
[WARN][ActivityManager(   60)]   Force finishing activity com.eCotton.GradientTest/org.appcelerator.titanium.TiActivity
</pre></code>
{panel}

<h4>Testcase</h4>
Run the following code.  A white-to-red vertical gradient box should appear at the top of the screen, but instead the app crashes.

Now uncomment the offset code.  The box appears with the correct gradient.

{panel:title=app.js}
<code><pre>
var win1=Ti.UI.createWindow({
                 layout:'vertical',
                 backgroundColor:'gray',
                 exitOnClose:true,
                 navBarHidden:true
               });

var view1=Ti.UI.createView({
                  height:100,
                  width:100,
                  backgroundGradient:{type:'linear',
                                      endPoint:{ x:0, y:'100%' },
                                      colors:[ {color:'white' /*, offset:0.0*/ },
                                               {color:'red' /*, offset:1.0*/ } ]}
                });
win1.add(view1);

win1.open();
</pre></code>
{panel}


<h3>Comments</h3>

<ol>
<li>Josh Roesslein 2012-07-19

   The recommend way to create gradients that evenly distribute the colors
   is to just provide them in an array:
   
   <code><pre>
   Ti.UI.createView({
     backgroundGradient: {
       colors: ['white', 'red']
     }
   });
   </pre></code>
   
   We could provide the same functionality with the gradient color objects, but this becomes a bit more
   difficult when you start mixing objects that have offsets and some that don't provide an offset.</li>
<li>Josh Roesslein 2012-07-19

   Created [PR #2615](<a href="https://github.com/appcelerator/titanium_mobile/pull/2615)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/2615)</a> to resolve issue.</li>
<li>Josh Roesslein 2012-07-19

   Ended up fixing the exception and matching iOS behavior by just discarding the offsets
   when the number of offsets does not match the number of colors.</li>
<li>Shawn Lipscomb 2012-07-20

   Josh, thanks for fixing this.
   
   I also didn't know that we could use the *colors**:* *['white', 'red']* syntax (I'm pretty sure that isn't in the online API docs), but I will start using it that way since it's cleaner.</li>
<li>Tamila Smolich 2012-08-13

   Closing as fixed.
   Tested and verified on:
   Titanium Studio, build: 2.1.1.201208091713
   Titanium SDK, build: 2.2.0.v20120810194112
   Devices: Nexus 7 tab (4.1), HTC Evo (4.0.3), Android Emulator (2.2)
   
   The box appears with white-to-red vertical gradient.</li>
<li>Anshu Mittal 2012-09-06

   Reopening to update labels</li>
<li>Shameer Jan 2013-11-07

   Anvil testcase PR <a href="https://github.com/appcelerator/titanium_mobile/pull/4887" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4887</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-10015.json">JSON Source</a></p>