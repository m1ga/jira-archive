---
title: "[TIMOB-10077] Android: app crashes when intent.SEND is called and the main app closed"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2013-03-19T16:22:29.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>exalture</td></tr>
<tr><th>Reporter</th><td>Davide Cassenti</td></tr>
<tr><th>Assignee</th><td>Sunila</td></tr>
<tr><th>Created</th><td>2012-07-23T08:02:31.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-21T21:26:03.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
When a user selects an image and he shares this with the app, the correct window opens and the app is fully functional. But when the app is closed, it seems to reboot and hangs in the startup screen.

<h4>Steps to reproduce</h4>
1. Edit tiapp.xml adding the following sections:
<code><pre>
    &lt;android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;
        &lt;tool-api-level&gt;8&lt;/tool-api-level&gt;
        &lt;manifest android:installLocation="preferExternal" android:versionCode="12" android:versionName="1.2.2"&gt;
            &lt;uses-sdk android:minSdkVersion="8"/&gt;
            &lt;supports-screens android:anyDensity="false"/&gt;
                &lt;application&gt;
                    &lt;activity android:alwaysRetainTaskState="true" android:configChanges="keyboardHidden|orientation" android:label="DBAPP" android:name=".DBAPPActivity" android:theme="@style/Theme.Titanium"&gt;
                         &lt;intent-filter&gt;
                            &lt;action android:name="android.intent.action.MAIN" /&gt;
                            &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
                         &lt;/intent-filter&gt;
                         &lt;intent-filter&gt;
                            &lt;action android:name="android.intent.action.SEND" /&gt;
                            &lt;category android:name="android.intent.category.DEFAULT" /&gt;
                            &lt;data android:mimeType="image/*" /&gt;
                        &lt;/intent-filter&gt;
                    &lt;/activity&gt;
                &lt;/application&gt;
        &lt;/manifest&gt;
    &lt;/android&gt;
    &lt;property name="ti.android.bug2373.disableDetection" type="bool"&gt;false&lt;/property&gt;
    &lt;property name="ti.android.bug2373.restartDelay" type="int"&gt;500&lt;/property&gt;
    &lt;property name="ti.android.bug2373.finishDelay" type="int"&gt;0&lt;/property&gt;
    &lt;property name="ti.android.bug2373.skipAlert" type="bool"&gt;true&lt;/property&gt;
    &lt;property name="ti.android.threadstacksize" type="int"&gt;32768&lt;/property&gt;
    &lt;property name="ti.android.bug2373.message"&gt;De applicatie dient na installatie opnieuw opgestart te worden&lt;/property&gt;
    &lt;property name="ti.android.bug2373.title"&gt;Succesvol geinstalleerd&lt;/property&gt;
    &lt;property name="ti.android.bug2373.buttonText"&gt;Ga verder&lt;/property&gt;
    &lt;property name="ti.android.runtime"&gt;v8&lt;/property&gt;
    &lt;property name="ti.android.fastdev" type="bool"&gt;false&lt;/property&gt;
    &lt;property name="ti.android.root.reappears.restart" type="bool"&gt;false&lt;/property&gt; 
</pre></code>

2. Create an app.js with the following code:
<code><pre>
// this sets the background color of the master UIView (when there are no windows/tab groups on it)
Titanium.UI.setBackgroundColor('#000');

var hasIntent  = false;
var intentData = null;
// create tab group
var tabGroup = Titanium.UI.createTabGroup();


	var intent = Ti.Android.currentActivity.getIntent();
	var iname = Ti.Android.EXTRA_STREAM;

	if (intent && intent.hasExtra(iname)) {
		hasIntent = true;
	    intentData = intent.getBlobExtra(iname);
	    Ti.API.info(intent);
	}

//
// create base UI tab and root window
//
var win1 = Titanium.UI.createWindow({  
    title:'Tab 1',
    backgroundColor:'#fff'
});
var tab1 = Titanium.UI.createTab({  
    icon:'KS_nav_views.png',
    title:'Tab 1',
    window:win1
});

var label1 = Titanium.UI.createLabel({
	color:'#999',
	text:'I am Window 1',
	font:{fontSize:20,fontFamily:'Helvetica Neue'},
	textAlign:'center',
	width:'auto'
});


if(hasIntent)
{
	label1.text = 'We have an intent.. do something!';
	
}

win1.add(label1);

//
// create controls tab and root window
//
var win2 = Titanium.UI.createWindow({  
    title:'Tab 2',
    backgroundColor:'#fff'
});
var tab2 = Titanium.UI.createTab({  
    icon:'KS_nav_ui.png',
    title:'Tab 2',
    window:win2
});

var label2 = Titanium.UI.createLabel({
	color:'#999',
	text:'I am Window 2',
	font:{fontSize:20,fontFamily:'Helvetica Neue'},
	textAlign:'center',
	width:'auto'
});

win2.add(label2);



//
//  add tabs
//
tabGroup.addTab(tab1);  
tabGroup.addTab(tab2);  


// open tab group
tabGroup.open();
</pre></code>

3. Run the app once
4. Close the app, open the gallery
5. Share one picture with the app
6. The app opens correctly: close it

<h4>Current result</h4>
The app seems to reload and crash.

<h3>Comments</h3>

<ol>
<li>Davide Cassenti 2012-07-23

   The problem seems to be present only with the TabGroups enabled. The following code works well:
   
   <code><pre>
   var win1 = Titanium.UI.createWindow({  
       title:'Tab 1',
       backgroundColor:'#fff',
       exitOnClose: true
   });
   
   var hasIntent  = false;
   var intentData = null;
   // create tab group
   
   var intent = Ti.Android.currentActivity.getIntent();
   var iname = Ti.Android.EXTRA_STREAM;
   
   if (intent && intent.hasExtra(iname)) {
   	hasIntent = true;
       intentData = intent.getBlobExtra(iname);
       Ti.API.info(intent);
   }
   
   var label1 = Titanium.UI.createLabel({
   	color:'#999',
   	text:'I am Window 1',
   	font:{fontSize:20,fontFamily:'Helvetica Neue'},
   	textAlign:'center',
   	width:'auto'
   });
   
   if(hasIntent)
   {
   	label1.text = 'We have an intent.. do something!';	
   }
   
   win1.add(label1);
   
   win1.open();
   </pre></code></li>
<li>Neeraj Gupta 2012-07-23

   @Davide - We need complete environment information to diagnose this issue.</li>
<li>Sunila 2013-03-19

   Tried with SDK 3.2.1, works without any crash.</li>
<li>Lee Morris 2017-03-21

   Closing ticket as the issue cannot be reproduced.</li>
</ol>


<p><a href="/TIMOB/TIMOB-10077.json">JSON Source</a></p>