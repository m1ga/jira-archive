---
title: "[TIMOB-10320] iOS: CommonJS: doesn't show where is it the offending line of code is in a module"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-01-14T14:09:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.0.2, Release 2.1.1, Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.1.0, 2013 Sprint 01 Core, 2013 Sprint 01</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>SupportTeam, core, module_require, notable, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Eduardo Gomez</td></tr>
<tr><th>Assignee</th><td>Max Stepanov</td></tr>
<tr><th>Created</th><td>2012-08-06T11:02:43.000+0000</td></tr>
<tr><th>Updated</th><td>2013-07-17T06:14:55.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
It looks like the source file doesn't show when the offending line of code is in a commonjs module. The customer needs to identify where is the offending code line in order to narrow down the issue quicker.

<h4>Tested on</h4>
iOS 5.1 Simulator

<h4>Console </h4>
<h4>Actual output</h4>
<code><pre>
[INFO] Launching application in Simulator
[INFO] Launched application in Simulator (23.09 seconds)
[INFO] Application started
[DEBUG] Reading stylesheet from: /Users/egomez/Library/Application Support/iPhone Simulator/5.1/Applications/A959F667-67EF-4247-A3DE-D0D4CB33EE06/Test.app/stylesheet.plist
[INFO] Test/1.0 (2.2.0.v20120801170113.b2782e9)
[DEBUG] Analytics is enabled = YES
[DEBUG] Loading: /Users/egomez/Library/Application Support/iPhone Simulator/5.1/Applications/A959F667-67EF-4247-A3DE-D0D4CB33EE06/1BestPractices.app/app.js, Resource: app_js
[DEBUG] Loading: /Users/egomez/Library/Application Support/iPhone Simulator/5.1/Applications/A959F667-67EF-4247-A3DE-D0D4CB33EE06/1BestPractices.app/module.js, Resource: module_js
[ERROR] Invalid type passed to function. expected: NSArray or nil, was: __NSCFString  in -[TiUIEmailDialogProxy open:] (TiUIEmailDialogProxy.m:64)
[ERROR] Script Error = Invalid type passed to function. expected: NSArray or nil, was: __NSCFString  in -[TiUIEmailDialogProxy open:] (TiUIEmailDialogProxy.m:64) (unknown file).
[DEBUG] Application booted in 11.829019 ms
</pre></code>

<h4>Proposed-Expected output</h4>
<code><pre>
[INFO] {
    line = 10;
    message = "'Script Error = Invalid type passed to function.";
    name = ScriptError;
    sourceId = 270794016;
    sourceURL = "file://localhost/Users/egomez/Library/Application%20Support/iPhone%20Simulator/5.1/Applications/CCA98E58-E7A1-453D-860E-4E310AA5F374/Test.app/module.js";
}
</pre></code>

<h4>Test case</h4>
- app.js
<code><pre>
var win1 = Titanium.UI.createWindow({ backgroundColor:'#fff' });

var accessor = require('module');
accessor.buildEmailView(/* to */ 'email@appc.com', /* subject */ 'Testing', /* defaultBody */ 'DefaultBody');

win1.open();
</pre></code>

- module.js
<code><pre>
exports.buildEmailView = function(to, subject, defaultBody) {
 
    var emailDialog = Ti.UI.createEmailDialog();
    emailDialog.setSubject(subject);
    emailDialog.setToRecipients(to);
    emailDialog.setMessageBody(defaultBody);
    emailDialog.setHtml(true);
    emailDialog.setBarColor('#312f2c');
	
	 emailDialog.open();
    
    emailDialog.addEventListener('complete',function(e)
    {
        if (e.result == emailDialog.SENT)
        {
            alert("message was sent");
        }
        else
        {
            alert("message was not sent. result = "+e.result);
        }
    });
 
};
</pre></code>

<h4>TiStudio version</h4>
Titanium Studio, build: 2.2.0.201208021836
(c) Copyright 2012 by Appcelerator, Inc.  All rights reserved.

Build: jenkins-titanium-rcp-development-921 (origin/development)
Date: 02 August 2012, 18:39:42

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-10320_30294/AppError_2.2.jpg">AppError_2.2.jpg</td></td><td>2012-08-06T11:02:43.000+0000</td><td>93364</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ivan Skugor 2012-08-11

   Getting exception info is painful. IMHO, exception data should be standardized (file, line number, error type and message should be available on all platforms).</li>
<li>Max Stepanov 2012-09-14

   This ticket is partially fixed by TIMOB-10501.
   More exception details is to come.</li>
<li>Max Stepanov 2012-12-20

   PR <a href="https://github.com/appcelerator/titanium_mobile/pull/3625" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3625</a></li>
<li>Blain Hamon 2013-01-09

   CR rejected. Methods would be difficult to maintain and there are more elegant solutions.</li>
<li>Blain Hamon 2013-01-11

   CR and FR passed, pull merged. For some reason, it won't let me update the status. Please change to 'Review passed' or the like.</li>
<li>Blain Hamon 2013-01-14

   Pull merged</li>
<li>Priya Agarwal 2013-07-17

   Updated label.
   Closing as fixed.
   Verified with:
   
   Studio: 3.1.2.201307121617
   Titanium SDK: 3.1.2.v20130710144553
   acs:1.0.3
   alloy:1.1.3
   npm:1.2.14
   titanium:3.1.1
   titanium-code-processor:1.0.1
   OS: OSX 10.8
   Device:iPhone Simulator(v6.0) iphone4(v5.1)
   Xcode: 4.5.1
   
   CommonJS showing proper error which is offending line of code as per expectation.</li>
</ol>


<p><a href="/TIMOB/TIMOB-10320.json">JSON Source</a></p>