---
title: "[TIMOB-10757] CLI: Module Build"
---
<table>
<tr><th>Type</th><td>Epic</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-08-24T19:20:16.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 4.0.0</td></tr>
<tr><th>Components</th><td>CLI</td></tr>
<tr><th>Labels</th><td>ft, notable, planning-3.2.0</td></tr>
<tr><th>Reporter</th><td>Chris Barber</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2012-09-04T14:48:48.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T17:05:17.000+0000</td></tr>
</table>

<h3>Description</h3>

The task involves a few things before implementing the platform specific logic.

<h4><code>cli/commands/build.js</code></h4>

In the <code>project-dir</code> callback function, determine if the project is an app or a module. If the project has a <code>tiapp.xml</code>, then it is an app. If the project has a <code>timodule.xml</code>, it is a module. When a module project is found, the <code>timodule.xml</code> should be parsed and saved into the <code>cli.timodule</code> variable. If the the project is neither a app or module, error and exit. You should set the <code>cli.argv.type</code> to the appropriate value. Remember that you need to scan up the directory tree since the <code>project-dir</code> may be a subdirectory.

In the <code>validate()</code> function, if it is an app, then do the <code>ti.validateCorrectSDK()</code> and <code>ti.validatePlatform()</code> stuff. If it is a module, then validate module stuff.

In the <code>run()</code> function, I think you only need to call <code>ti.resolvePlatform()</code> for apps. The <code>buildModule</code> should be <code>path.join(__dirname, '..', '..', platform, 'cli', 'commands', '_build.js')</code> for apps and <code>path.join(__dirname, '..', '..', platform, 'cli', 'commands', '_build_module.js')</code> for modules. If <code>_build_module.js</code> file does not exist, error and exit.

<h4><code>node_modules/titanium-sdk/lib/builder.js</code></h4>

Add <code>this.timodule = cli.timodule;</code> to the <code>run()</code> function after the <code>this.tiapp</code> line.

<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2015-06-02

   iOS and Android are done. MobileWeb is on hold for the moment.</li>
<li>Lee Morris 2017-03-22

   Closing ticket as fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-10757.json">JSON Source</a></p>