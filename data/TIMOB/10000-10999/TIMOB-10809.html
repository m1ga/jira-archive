---
title: "[TIMOB-10809] Android: lightweight window might not allow heavy weight window to focus"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-09-07T15:43:12.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.0.2, Release 2.1.2, Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.1.3, Release 3.0.0, Sprint 2012-18 API</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>SupportTeam, api, module_window, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Federico Casali</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2012-09-06T20:47:34.000+0000</td></tr>
<tr><th>Updated</th><td>2013-06-10T23:25:36.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
Creating a lightweight windows between two heavyweight windows might prevent heavyweight focus event to be fired

<h4>Steps to reproduce and sample code</h4>

Run the sample code (also on <a href="https://gist.github.com/61044bd87f85742e3b19):" rel="nofollow" target="_blank">https://gist.github.com/61044bd87f85742e3b19):</a>

<code><pre>
/**
 * Creates a simple black light weight window
 */
function LightWeightWindow(){
	var win = Ti.UI.createWindow({
		backgroundColor: 'black',
	});

	return win;
}

/**
 * Creates a heavy weight window
 * @param {Number} num	the window number
 */
function HeavyWeightWindow(num){
	num ++;
	// create the window
	var win = Ti.UI.createWindow({
		fullscreen: false, // make it heavy weight
		backgroundColor: '#ccc',
		title: 'win '+num
	});

	// let's do some processing
	for(var i = 0; i &lt; 200; i++) {
		win.add(Ti.UI.createView({width:0,height:0,left:0,top:0}));
	}

	// open next window
	var btn = Ti.UI.createButton({
		title: 'open win ' + (num + 1)
	});

	btn.addEventListener('click', function(){
		// open light weight window
		var lightWeight = LightWeightWindow();
		lightWeight.open();
		// create the next heavy weight window
		var next = 	HeavyWeightWindow(num);
		// open the heavy weight window
		next.open();
		// lastly, close the light weight window
		lightWeight.close();
	});

	// on focus, show the toast notification
	win.addEventListener('focus', function(){
		Ti.UI.createNotification({
			message:'focus on win '+ num,
			duration: Ti.UI.NOTIFICATION_DURATION_SHORT
		}).show();

		Ti.API.info('focus on win '+ num)
	});

	win.add(btn);

	return win;
}

HeavyWeightWindow(0).open();
</pre></code>


<h4>Steps to reproduce</h4>

- Click on the button to open a lightweight window, create next heavyweight window, open it and then close the lightweight window previously opened.
- On window focus, we show a toast notification
- Open a few windows, then press the back button.

Result: 'focus' event listener is no longer triggered when pressing the back button

<h3>Comments</h3>

<ol>
<li>Hieu Pham 2012-09-07

   Here's another test case, similar to the one above, but has "blur" eventListener added as well.
   <code><pre>
   /**
    * Creates a simple black light weight window
    */
   function LightWeightWindow(){
       var win = Ti.UI.createWindow({
           backgroundColor: 'black',
       });
    
       return win;
   }
    
   /**
    * Creates a heavy weight window
    * @param {Number} num  the window number
    */
   function HeavyWeightWindow(num){
       num ++;
       // create the window
       var win = Ti.UI.createWindow({
           fullscreen: false, // make it heavy weight
           backgroundColor: '#ccc',
           title: 'win '+num
       });
    
       // let's do some processing
       for(var i = 0; i &lt; 200; i++) {
           win.add(Ti.UI.createView({width:0,height:0,left:0,top:0}));
       }
    
       // open next window
       var btn = Ti.UI.createButton({
           title: 'open win ' + (num + 1)
       });
    
       btn.addEventListener('click', function(){
           // open light weight window
           var lightWeight = LightWeightWindow();
           lightWeight.open();
           // create the next heavy weight window
           var next =  HeavyWeightWindow(num);
           // open the heavy weight window
           next.open();
           // lastly, close the light weight window
           lightWeight.close();
       });
    
       // on focus, show the toast notification
       win.addEventListener('focus', function(){
           Ti.UI.createNotification({
               message:'focus on win '+ num,
               duration: Ti.UI.NOTIFICATION_DURATION_SHORT
           }).show();
    
           Ti.API.info('focus on win '+ num)
       });
       
       win.addEventListener('blur', function(){
    
           Ti.API.info('blur on win '+ num)
       });
    
       win.add(btn);
    
       return win;
   }
    
   HeavyWeightWindow(0).open();
   </pre></code></li>
<li>Vishal Duggal 2012-09-07

   PR for master <a href="https://github.com/appcelerator/titanium_mobile/pull/2888" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/2888</a></li>
<li>Vishal Duggal 2012-09-07

   PR for 2_1_X <a href="https://github.com/appcelerator/titanium_mobile/pull/2890" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/2890</a></li>
<li>Shyam Bhadauria 2012-09-10

   Environment used for verification -
   Titanium SDK: 2.2.0.v20120907162025
   Titanium Â Studio: 2.1.3.201209071738
   Device:Samsung GALAXY Note (2.3.6)
   Machine OS - MAC 10.8</li>
</ol>


<p><a href="/TIMOB/TIMOB-10809.json">JSON Source</a></p>