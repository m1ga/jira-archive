---
title: "[TIMOB-11055] Android: WebView event JSON object conversion bug causing crash."
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-10-11T23:28:39.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.3</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.0.0, Release 3.1.0, 2012 Sprint 21 API, 2012 Sprint 21</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>api, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Josh Roesslein</td></tr>
<tr><th>Assignee</th><td>Josh Roesslein</td></tr>
<tr><th>Created</th><td>2012-09-22T14:21:09.000+0000</td></tr>
<tr><th>Updated</th><td>2013-10-07T09:11:20.000+0000</td></tr>
</table>

<h3>Description</h3>

Firing an event from a WebView will cause a crash if the event object
contains a null value. This is due to how we bridge the object between Java <-> WebView
as a JSON string. We do not properly convert JSONObject.NULL values back to Java nulls
which causes our Kroll layer to crash since it can't convert this type.

<h4>Test Case</h4>
1. Create an application with the attached app.js and index.html.
2. Click the button in the web view ("click me") to trigger an event.

Pass: alert appears displaying the event object.
Fail: application crashes due to conversion error ("Unable to convert unknown Java object class 'org.json.JSONObject$1' to Js value")

<h4>Credit</h4>
Thanks to Tristan Waddington for reporting this bug and the detailed write up on his blog.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-11055_32504/app.js">app.js</td></td><td>2012-10-10T19:13:21.000+0000</td><td>221</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-11055_31643/index.html">index.html</td></td><td>2012-09-22T14:35:54.000+0000</td><td>356</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Josh Roesslein 2012-09-22

   Created [PR #3032](<a href="https://github.com/appcelerator/titanium_mobile/pull/3032)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3032)</a> to resolve issue.</li>
<li>Josh Roesslein 2012-10-10

   Updated app.js to fix crash seen when running on Rhino.</li>
<li>Ping Wang 2012-10-11

   backport PR <a href="https://github.com/appcelerator/titanium_mobile/pull/3174" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3174</a></li>
<li>Natalie Huynh 2012-12-05

   Tested with 3.0.0.20121204144658 on Droid 1 2.2.3 with Rhino and V8</li>
</ol>


<p><a href="/TIMOB/TIMOB-11055.json">JSON Source</a></p>