---
title: "[TIMOB-11169] iOS: Opening window in tab with animated false, stops closing the previous window "
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2012-10-02T00:35:03.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.2</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2012-20 API, 2012 Sprint 20</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>core</td></tr>
<tr><th>Reporter</th><td>Pedro Enrique</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2012-09-26T18:15:04.000+0000</td></tr>
<tr><th>Updated</th><td>2013-03-13T18:55:34.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description:</h4>
A window inside a tab group is present. On swiping to the right or left, this window needs to be replaced with another one. The way this is supposed to be accomplished, is by opening a new window in the same tab stack and close the current window at the same time. Because it cannot happen at the same exact time, the next window is said to open before the current window closes.

<h4>The problem:</h4>
To make this happen smoothly, the animation of the window open or close is removed by: tab.open( win, { animated: false });
But, if the current window is closed _after_ the next window opens, then nothing happens. If the current window is closed _before_ the it works, but there is a small flicker.
Note: The current window will close and the next will open with the sample test case, but if the current window is the root window, it will not close. It looks like the root window cannot be closed.

<h4>The code</h4>
<code><pre>
// Global Object
var App = {};
function log(a) {
	Ti.API.info(a);
}

/**
 * Creates a new window with a colored box
 * @param {String} color
 * @return Ti.UI.Window
 */
function Window(color) {
	log('Window created: '+color);
	var win = Ti.UI.createWindow({
		fullscreen: false,
		backButtonTitle: '' // for our workaround, remove the back button
	});
	
	var box = Ti.UI.createView({
		width: '300dp',
		height: '300dp',
		backgroundColor: color
	});
	
	win.addEventListener('swipe', function(e){
		log('swipe');
		if(e.direction == 'left') {
			log('left');

			// work around:
			// close the window in the tab with no animation before opening the next
			// side effect, root window cannot be closed 
			App.Tab.close(win, {animated: false});
			log('add to tab');

			App.Tab.open(Window('green'), {animated: false});

			// old code
			// uncomment to see the bug
			// win.close();

		} else {
			log('right');
			
			// work around:
			// close the window in the tab with no animation before opening the next
			// side effect, root window cannot be closed 
			App.Tab.close(win, {animated: false});
			log('add to tab');

			App.Tab.open(Window('red'), {animated: false});

			// old code
			// uncomment to see the bug
			// win.close();
		}
	});
	win.add(box);
	return win;
}

/**
 * Starts the app!
 */
(function(){
	App.TabGroup = Ti.UI.createTabGroup();
	App.Tab = Ti.UI.createTab({
		window: Window('blue')
	})
	App.TabGroup.addTab(App.Tab);
	App.TabGroup.open();
})();
</pre></code>

<h3>Comments</h3>

<ol>
<li>Vishal Duggal 2012-10-02

   Can not close the root window of a tab.
   Obviously the developer is trying to open windows in a tab but does not want the 
   nav controller functionality.
   
   Can be done by creating a dummy window as root window of tab and then just opening and closing regular windows ( Ideally you should just be swapping out views instead of windows. So replace win.open() with win.add() )
   
   Use this code to accomplish the same
   <code><pre>
   // Global Object
   var App = {};
   function log(a) {
       Ti.API.info(a);
   }
    
   /**
    * Creates a new window with a colored box
    * @param {String} color
    * @return Ti.UI.Window
    */
   function Window(color) {
       log('Window created: '+color);
       var win = Ti.UI.createWindow({
           fullscreen: false,
       });
        
       var box = Ti.UI.createView({
           width: '300dp',
           height: '300dp',
           backgroundColor: color
       });
       
       win.addEventListener('swipe', function(e){
           log('swipe');
           if(e.direction == 'left') {
               log('left');
    
               // work around:
               // close the window in the tab with no animation before opening the next
               // side effect, root window cannot be closed 
               //App.Tab.close(win, {animated: false});
               log('add to tab');
    
   			var newWin = Window('green');
               newWin.open();
   			App.Tab.currentWin.close();
   			App.Tab.currentWin = newWin;
    
           } else {
               log('right');
                
               // work around:
               // close the window in the tab with no animation before opening the next
               // side effect, root window cannot be closed 
               //App.Tab.close(win, {animated: false});
               log('add to tab');
    			
   			var newWin = Window('red');
               newWin.open();
   			App.Tab.currentWin.close();
   			App.Tab.currentWin = newWin;
           }
       });
   	
       win.add(box);
       return win;
   }
    
   /**
    * Starts the app!
    */
   (function(){
       App.TabGroup = Ti.UI.createTabGroup();
   	App.baseWin = Ti.UI.createWindow();
       App.Tab = Ti.UI.createTab({
           window: App.baseWin
       })
       App.TabGroup.addTab(App.Tab);
   
   	App.TabGroup.addEventListener('open',function(){
   		App.Tab.currentWin = Window('blue');
   		App.Tab.currentWin.open();
   	});
   	App.TabGroup.open();
   
   })();
   </pre></code></li>
<li>Natalie Huynh 2012-12-04

   Closing as invalid</li>
</ol>


<p><a href="/TIMOB/TIMOB-11169.json">JSON Source</a></p>