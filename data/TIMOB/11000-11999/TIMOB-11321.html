---
title: "[TIMOB-11321] Android: Transformations with 2D Matrices on Android produces flickering, ghosting, and other strange behavior."
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2013-11-12T19:13:58.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 23, 2013 Sprint 23 Core</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>allen-review, core, look1, triage</td></tr>
<tr><th>Reporter</th><td>Seth Benjamin</td></tr>
<tr><th>Assignee</th><td>Allen Yeung</td></tr>
<tr><th>Created</th><td>2012-10-09T17:03:29.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-21T20:57:13.000+0000</td></tr>
</table>

<h3>Description</h3>

Not entirely sure whats happening here but it seems as though Android's 2Dmatrix function, particularly the translate function therein, doesn't work as expected. We get massive amounts of flickering, occasional ghosting, and the frame/proxy doesn't update when transformed.

You can see the visual comparison here:

Android: [Video](<a href="http://f.cl.ly/items/1X3V0e2X1x0U0R2S3n1C/Screen%20Recording%202.mov)" rel="nofollow" target="_blank">http://f.cl.ly/items/1X3V0e2X1x0U0R2S3n1C/Screen%20Recording%202.mov)</a>
iOS: [Video](<a href="http://f.cl.ly/items/3r3r0f0D1e3m3i2C3p0h/Screen%20Recording%203.mov)" rel="nofollow" target="_blank">http://f.cl.ly/items/3r3r0f0D1e3m3i2C3p0h/Screen%20Recording%203.mov)</a>

The code used to produce both videos: [<a href="http://pastie.org/5025145" rel="nofollow" target="_blank">http://pastie.org/5025145</a>]

SDKs used: 2.1.3 & 3.0

Note: Testing on the device was no different than testing in the emulator.

<code><pre>
var debounce = function(func, threshold, execAsap) {
	var timeout;
	return function debounced() {
		var obj = this, args = arguments;
		function delayed() {
			if (!execAsap)
				func.apply(obj, args);
			timeout = null;
		};

		if (timeout)
			clearTimeout(timeout);
		else if (execAsap)
			func.apply(obj, args);

		timeout = setTimeout(delayed, threshold || 100);
	};
};

var win = Ti.UI.createWindow({
	backgroundColor : 'white'
});

var square = Ti.UI.createView({
	backgroundColor : 'black',
	width : 100,
	height : 100
});

var curX = 0;
var curY = 0;
var matrix = Ti.UI.create2DMatrix();

square.addEventListener('touchstart', function(e) {
	curX = e.x;
	curY = e.y;
});

square.addEventListener('touchmove', debounce(function(e) {
	var deltaX = e.x - curX;
	var deltaY = e.y - curY;

	matrix = matrix.translate(deltaX, deltaY);

	square.transform = matrix;
}, 10, false));

win.add(square);
win.open();
</pre></code>

<h3>Comments</h3>

<ol>
<li>Allen Yeung 2013-07-20

   Resolved as a part of <a href="https://github.com/appcelerator/titanium_mobile/pull/4398" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4398</a>
   </li>
<li>Lokesh Choudhary 2013-10-23

   I am still able to see the flickering behavior on android. Reopening.
   
   Environment:
   Appcel Studio : 3.2.0.201310230601
   Ti SDK : 3.2.0.v20131022171645
   Mac OSX : 10.8.5
   CLI - 3.2.0 with hash 72f7426b4ee6c2d2883c666d5b7e03906a16012f
   Device: Samsung Galaxy S4 running android 4.2.2
   Android Emulator : 4.2.2</li>
<li>Ping Wang 2013-11-08

   This issue is not resolved by TIMOB-11811 because in this test case, it uses a 2DMatrix to transform the view and this 2DMatrix is the result of concatenating the translation operation more than once. In this case, we can not use the Honeycomb+ Property Animators so we can only use the old-style view animations. (refer [here](<a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/titanium/src/java/org/appcelerator/titanium/util/TiAnimationBuilder.java#L81)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/titanium/src/java/org/appcelerator/titanium/util/TiAnimationBuilder.java#L81)</a> for more info) 
   
   Prior to Honeycomb, the animations changed the visual appearance of the target objects... but they didn't actually change the objects themselves. Please refer to <a href="http://android-developers.blogspot.com/2011/02/animation-in-honeycomb.html" rel="nofollow" target="_blank">http://android-developers.blogspot.com/2011/02/animation-in-honeycomb.html</a> for more details. Therefore, although the square view is rendered in another position, it is still only responded to the touch in the original position. Resolved the ticket as Not Our Bug.</li>
<li>Lee Morris 2017-03-21

   Closing this ticket as the issue is not our bug.</li>
</ol>


<p><a href="/TIMOB/TIMOB-11321.json">JSON Source</a></p>