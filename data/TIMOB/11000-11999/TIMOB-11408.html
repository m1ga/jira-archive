---
title: "[TIMOB-11408] Android: Runtime error is thrown for require method when called from window opened via URL"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-01-29T23:37:31.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.0.0, Release 3.1.0, 2012 Sprint 22 Core, 2012 Sprint 22, 2013 Sprint 03 API</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>core, qe-and100112, qe-port, regression</td></tr>
<tr><th>Reporter</th><td>Shyam Bhadauria</td></tr>
<tr><th>Assignee</th><td>Ping Wang</td></tr>
<tr><th>Created</th><td>2012-10-12T09:05:32.000+0000</td></tr>
<tr><th>Updated</th><td>2013-02-04T07:14:20.000+0000</td></tr>
</table>

<h3>Description</h3>

This is a regression. It works fine on 2.1.3GA.

When the app is run, a runtime error is thrown - "Message: Uncaught ReferenceError: require is not defined". Log attached.

Steps to reproduce:
1. Use the following code in app.js
<code><pre>
Ti.UI.createWindow({
	url: "win.js", // causes new JS context
	backgroundColor: "#000",
	exitOnClose: true
}).open();
</pre></code>

2. Create a file 'included.js' under 'Resources' folder and add the code below in it-
<code><pre>
var includedWord = "YES";
</pre></code>

3. Create another file win.js under 'Resources' folder and add the code below in it-
<code><pre>
require("module"); // Don't need return value, just important that this runs.
Ti.include("included.js");
alert("Does this app work (YES/NO)? \nAnswer: " + includedWord);
</pre></code>

4. Paste the attached file 'module.js' under the 'Resources' folder.

5. Run the app on android device.

Expected result:
App should display an alert 'Does this app work? YES!' 

Actual result:
A runtime error is thrown. Error log attached.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-11408_32950/module.js">module.js</td></td><td>2012-10-25T10:25:44.000+0000</td><td>42</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-11408_32556/TIMOB 5434.rtf">TIMOB 5434.rtf</td></td><td>2012-10-12T09:05:32.000+0000</td><td>1112</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Josh Roesslein 2012-10-16

   Created [PR #3244 ](<a href="https://github.com/appcelerator/titanium_mobile/pull/3244)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3244)</a> to resolve issue on master.</li>
<li>Bill Dawson 2012-10-16

   Master merge done. Ready for 3.0.X PR.
   
   *Note for future testers*: The person who created the ticket didn#t include module.js, so success in this case actually means getting an error that the module is not found, as opposed to the error that require is not defined.</li>
<li>Josh Roesslein 2012-10-16

   Created [PR #3252](<a href="https://github.com/appcelerator/titanium_mobile/pull/3252)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3252)</a> to back port fix into 3_0_X.</li>
<li>Bill Dawson 2012-10-16

   3_0_X PR merged.</li>
<li>Shyam Bhadauria 2012-10-25

   Please use the module.js attached (module_timob5434) to reproduce the issue along with other files.It still gives same error 'Message: Uncaught ReferenceError: require is not defined'.
   
   Tested it with :
   Titanium SDK:3.0.0.v20121024144610
   Titanium  Studio:3.0.0.201210220122</li>
<li>Allen Yeung 2012-10-30

   This should as a part of this PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/3321" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3321</a></li>
<li>Shyam Bhadauria 2012-11-20

   Its working fine now.
   Titanium SDK: 3.1.0.v20121119222601
   Titanium SDK:3.0.0.v20121113170203
   Titanium  Studio:3.0.0.201211131839
   Device : Android 2.2 LG-P970
   Xcode : 4.5 
   Machine OS : MAC 10.8</li>
<li>Ping Wang 2013-01-29

   This issue occurs again in the latest 3_0_X build: ffb007d573b779957baebb82895f7bf0b0f60d32</li>
<li>Ping Wang 2013-01-29

   This regression is caused by [PR#3321](<a href="https://github.com/appcelerator/titanium_mobile/pull/3321)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3321)</a>
   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/3818" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3818</a>
   For FR:
   1. Run the test case in the ticket. It should run without any crash.
   2. Run the test case below. It should run without any crash. The log should show:
   {quote}
   I/TiAPI   (13592):  ******************** module.text = I'm module
   I/TiAPI   (13592):  ******************** module.includedWord = YES
   I/TiAPI   (13592):  *************** inside module.x
   {quote}
   app.js
   <code><pre>
   Ti.UI.createWindow({
       url: "win.js", // causes new JS context
       backgroundColor: "#000",
       exitOnClose: true
   }).open();
   </pre></code>
   win.js
   <code><pre>
   var module = require("module");
   Ti.API.info("******************** module.text = " + module.text);
   Ti.API.info("******************** module.includedWord = " + module.includedWord);
   module.x();
   
   Ti.include("included.js");
   alert("Does this app work (YES/NO)? \nAnswer: " + includedWord);
   </pre></code>
   module.js
   <code><pre>
   exports.x = function() {
   	console.log("*************** inside module.x");
   };
   exports.text = "I'm module";
   
   Ti.include("included.js");
   exports.includedWord = includedWord;
   </pre></code>
   included.js
   <code><pre>
   var includedWord = "YES";
   </pre></code>
   3. Run the test cases in TIMOB-10783, TIMOB-10091, TIMOB-11307, TIMOB-5748.
   4. Run KS.
   5. Run Anvil -> includes/includes test suite. simpleRequire, secondContextRequire, multipleRequire and includeFromUrlWindow should pass.</li>
<li>Anshu Mittal 2013-02-04

    Tested with: 
    SDK:3.0.2.v20130201161712
    Studio: 3.0.2.201301281948
    Device: iPhone3GS(v 5.0.1), iPhone5(v 6.0)
    
    No runtime error is thrown.</li>
</ol>


<p><a href="/TIMOB/TIMOB-11408.json">JSON Source</a></p>