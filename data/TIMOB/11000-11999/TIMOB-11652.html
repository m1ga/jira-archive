---
title: "[TIMOB-11652] iOS: Add script errors/stack trace to TiExceptionHandler data"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-01-16T10:19:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.0.2, Release 3.1.0, 2012 Sprint 23 API, 2012 Sprint 23</td></tr>
<tr><th>Components</th><td>Core</td></tr>
<tr><th>Labels</th><td>exception, qe-port, triage</td></tr>
<tr><th>Reporter</th><td>Max Stepanov</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2012-11-02T17:16:43.000+0000</td></tr>
<tr><th>Updated</th><td>2014-07-06T20:11:52.000+0000</td></tr>
</table>

<h3>Description</h3>

JavaScript:
<code><pre>
// Without try catch:
var err = new Error("My Awesome Caught Error!");
API.logHandledException(err);

try {
var err = new Error("My Awesome Caught Error!");
throw err

} catch (err){
API.logHandledException(err);
}
</pre></code>

Objective-C:
<code><pre>
-(void)logHandledException:(id)args
{
    TiLogMessage([NSString stringWithFormat:@"class type?: %@", [[args objectAtIndex:0] class]]); // This returns as NSDictionary, is this expected?

//    TiScriptError *exception = [TiScriptError initWithDictionary:[args objectAtIndex:0]]; // This selector doesn't exist?
    TiScriptError *exception = (TiScriptError *)args; // Returns an array, not a single object. In other methods, they returned the objects rather than an array of parameters.

[API logHandledException:[self convertScriptErrorToNative:exception]];
}
</pre></code>

<h3>Comments</h3>

<ol>
<li>Blain Hamon 2013-01-15

   Reopening so that we can bring TiJSCore in. Also, documentation.</li>
<li>Max Stepanov 2013-01-26

   A test case:
   <code><pre>
   var win1 = Titanium.UI.createWindow({ backgroundColor:'#fff' });
    
   var accessor = {};
   accessor.buildEmailView = function(to, subject, defaultBody) {
     
       var emailDialog = Ti.UI.createEmailDialog();
       emailDialog.setSubject(subject);
       emailDialog.setToRecipients(to);
       emailDialog.setMessageBody(defaultBody);
       emailDialog.setHtml(true);
       emailDialog.setBarColor('#312f2c');
        
        emailDialog.open();
        
       emailDialog.addEventListener('complete',function(e)
       {
           if (e.result == emailDialog.SENT)
           {
               alert("message was sent");
           }
           else
           {
               alert("message was not sent. result = "+e.result);
           }
       });
     
   };
   accessor.buildEmailView(/* to */ 'email@appc.com', /* subject */ 'Testing', /* defaultBody */ 'DefaultBody');
    
   win1.open();
   </pre></code>
   
   Output will be something like:
   <code><pre>
   [ERROR] Script Error {
       backtrace = "#0 () at file://localhost/Users/max/Library/Application%20Support/iPhone%20Simulator/4.3.2/Applications/86EAB896-F4E9-4672-9426-D20F7FAED5F1/Titanium.app/app.js:29";
       line = 13;
       message = "Invalid type passed to function";
       nativeLocation = "-[TiUIEmailDialogProxy open:] (TiUIEmailDialogProxy.m:63)";
       nativeReason = "expected: NSArray or nil, was: NSCFString";
       sourceId = 208722560;
       sourceURL = "file://localhost/Users/max/Library/Application%20Support/iPhone%20Simulator/4.3.2/Applications/86EAB896-F4E9-4672-9426-D20F7FAED5F1/Titanium.app/app.js";
   }
   </pre></code>
   
   The expected result should contain valid 'backtrace' property:value pair.
   </li>
<li>Olga Romero 2013-01-26

   Closing.
   Tested and verified fix with:
   Device:
   iPhone5 iOS 6.0
   Titanium Studio, build: 3.0.1.201212181159
   Titanium SDK, build: 3.0.2.v20130125153221
   Titanium SDK, build:3.1.0.v20130125152545
   
   Similar output.
   
   
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-11652.json">JSON Source</a></p>