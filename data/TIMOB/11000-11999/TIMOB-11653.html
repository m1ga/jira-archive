---
title: "[TIMOB-11653] Android: Add script errors/stack trace to TiExceptionHandler data"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-01-29T01:23:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.1.0, 2013 Sprint 03 Core, 2013 Sprint 03</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Max Stepanov</td></tr>
<tr><th>Assignee</th><td>Hieu Pham</td></tr>
<tr><th>Created</th><td>2012-11-02T17:33:15.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-16T21:43:35.000+0000</td></tr>
</table>

<h3>Description</h3>

JavaScript:
<code><pre>
// Without try catch:
var err = new Error("My Awesome Caught Error!");
API.logHandledException(err);

try {
var err = new Error("My Awesome Caught Error!");
throw err

} catch (err){
API.logHandledException(err);
}
</pre></code>

Objective-C:
<code><pre>
-(void)logHandledException:(id)args
{
    TiLogMessage([NSString stringWithFormat:@"class type?: %@", [[args objectAtIndex:0] class]]); // This returns as NSDictionary, is this expected?

//    TiScriptError *exception = [TiScriptError initWithDictionary:[args objectAtIndex:0]]; // This selector doesn't exist?
    TiScriptError *exception = (TiScriptError *)args; // Returns an array, not a single object. In other methods, they returned the objects rather than an array of parameters.

[API logHandledException:[self convertScriptErrorToNative:exception]];
}
</pre></code>

Testing steps: 
1. Download CritterModule, and build it with a Titanium Mobile project.
2. Run this code (app.js):
<code><pre>
var CritterModule = require('com.crittermodule');

var win = Ti.UI.createWindow({fullscreen: true, backgroundColor: 'white'});

var stackLabel = Ti.UI.createLabel({
	left: "10%",
	top: "20%",
	color: 'red'
	
});
var lineNumberLabel = Ti.UI.createLabel({
	left: "10%",
	top: "50%",
	color: 'red'
	
});
var messageLabel = Ti.UI.createLabel({
	left: "10%",
	top: "70%",
	color: 'red'
	
});
var fileNameLabel = Ti.UI.createLabel({
	left: "10%",
	top: "85%",
	color: 'red'
	
});

var errorButton = Ti.UI.createButton({
	top: 0,
	title: "Throw error"
});

var err = new Error("uh oh!");
errorButton.addEventListener("click", function(e){
	try {
		throw err;
	} catch(e) {
		stackLabel.text = CritterModule.printErrorStack(e);
		lineNumberLabel.text = "Line number: " + CritterModule.printErrorLineNumber(e);
		messageLabel.text = "Error Message: " + CritterModule.printErrorMessage(e);
		fileNameLabel.text = "File name: " + CritterModule.printErrorFileName(e);
}

});




win.add(stackLabel);
win.add(lineNumberLabel);
win.add(messageLabel);
win.add(fileNameLabel);
win.add(errorButton);
win.open();
</pre></code>

3. Click on "Throw error" button. You should see the stack trace, line number, error message and file name.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-11653_34766/com.crittermodule.zip">com.crittermodule.zip</td></td><td>2013-01-15T16:52:21.000+0000</td><td>49846</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-11653_34719/CritterModule.zip">CritterModule.zip</td></td><td>2013-01-14T13:39:14.000+0000</td><td>63063</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Allen Yeung 2012-11-02

   In Android, we already have an API to do this:
   
   KrollRuntime.dispatchException()</li>
<li>Ingo Muschenetz 2012-11-28

   This evidently still needs to be done.</li>
<li>Allen Yeung 2013-01-09

   <a href="https://github.com/appcelerator/titanium_mobile/pull/3685" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3685</a></li>
<li>Lee Morris 2017-03-16

   Closing ticket as the issue has been fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-11653.json">JSON Source</a></p>