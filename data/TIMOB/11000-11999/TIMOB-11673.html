---
title: "[TIMOB-11673] Android: require breaks the network change event listener"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2012-12-04T00:54:01.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>2012 Sprint 25, 2012 Sprint 25 Core, 2012 Sprint 25 API</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Davide Cassenti</td></tr>
<tr><th>Assignee</th><td>Ping Wang</td></tr>
<tr><th>Created</th><td>2012-11-06T16:52:53.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-27T20:37:23.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
Whenever a require function is called, the network change event listener is broken.

<h4>Steps to reproduce</h4>
Create 3 files: app.js, win.js and view.js

*app.js*
<code><pre>
(function() {
    var Window = require('win');
	new Window().open();
})();
</pre></code>

*win.js*
<code><pre>
function ApplicationWindow() {
    var view = require('view'); // just requiring, we are not even invoking the function
    
    var self = Ti.UI.createWindow({
        backgroundColor:'#ffffff',
        navBarHidden:true,
        exitOnClose:true
    });
        
    return self;
}
module.exports = ApplicationWindow;
</pre></code>

*view.js*
<code><pre>
function SimpleView() {
    var view = Ti.UI.createView({
        backgroundColor:'red',
        width: 100,
        height: 100
    });
        
    return view;
}

module.exports = SimpleView;
</pre></code>


Now, there are 3 scenarios; use this simple listener code:
<code><pre>
Titanium.Network.addEventListener('change', function(e) {
    alert('Status changed:' + e.networkType);
});
</pre></code>

1. add the network listener code in app.js or win.js: it will only be fired ONCE [BUG]
2. add the listener code in view.js: everything is ok
3. add the listener code in win.js and remove the require('view') from it: everything is ok


<h3>Comments</h3>

<ol>
<li>Davide Cassenti 2012-11-12

   - I've tested back with 2.1.2, 2.1.1 and 2.1.0: same results.
   - I've tested with 2.0.2: the listener is not called even once.
   - However, testing with v3.0.0.20121026170116 seems to be working. Was this addressed in the release?
   
   Below a simpler test case:
   
   app.js
   <code><pre>
   (function() {
       Titanium.Network.addEventListener('change', function(e) {
           alert('Status changed:' + e.networkType);
       });
   
       var Window = require('win');
       new Window().open();
   })();
   </pre></code>
   
   win.js
   <code><pre>
   function ApplicationWindow() {
       var self = Ti.UI.createWindow({
           backgroundColor:'#ffffff',
           navBarHidden:true,
           exitOnClose:true
       });
            
       return self;
   }
   module.exports = ApplicationWindow;
   </pre></code></li>
<li>Ping Wang 2012-12-04

   Tested with latest master and 3_0_X. The two test cases both pass. Mark the ticket as Cannot Reproduce.</li>
<li>Lee Morris 2017-03-27

   Closing ticket as I am unable to reproduce this issue with the following environment;
   Pixel (7.1)
   MacOS 10.11.6 (15G31)
   Studio 4.8.1.201612050850
   Ti SDK 6.0.3 GA
   Appc NPM 4.2.8
   Appc CLI 6.1.0
   Ti CLI 5.0.11
   Alloy 1.9.5
   Arrow 1.10.1
   Xcode 8.2 (8C38)
   Node v4.6.0
   Java 1.7.0_80</li>
</ol>


<p><a href="/TIMOB/TIMOB-11673.json">JSON Source</a></p>