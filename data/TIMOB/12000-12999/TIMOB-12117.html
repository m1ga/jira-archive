---
title: "[TIMOB-12117] Android: When navBarHidden of a window is set, activity.startActivityForResult won't work"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2013-03-03T15:17:42.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.4, Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>community</td></tr>
<tr><th>Reporter</th><td>Federico Casali</td></tr>
<tr><th>Assignee</th><td>Sunila</td></tr>
<tr><th>Created</th><td>2012-12-18T12:35:01.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-24T17:51:22.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem descrption</h4>
When trying to use activity.startActivityForResult on Android, if the window's property "navBarHidden" is set, the function argument of the method is not called.

In that case, there is no way to reach the intent's return.

<h4>Steps to reproduce</h4>
- Run the sample code
- Click on the Crop button to crop and save a picture in the gallery
Expected result: lines 32 and 33 of the code should be triggered, but they are not.
Commenting out 'navBarHidden' property of the window it works as expected.

 
<code><pre> 
curWin = Ti.UI.createWindow({
    backgroundColor:'#ffffff',
    navBarHidden:true, // IF THIS IS ENABLED THE startActivityForResult WONT WORK
    exitOnClose:true
});
    
var myView = Ti.UI.createView();
var curBtn = Ti.UI.createButton({
    color:'#000000',
    title:'Start Crop',
    height:'auto',
    width:'auto'
});
myView.add(curBtn);

curBtn.addEventListener('click', function(e) {
    try{
    Titanium.Media.openPhotoGallery({
        success : function(event) {
            var intent =  Ti.Android.createIntent({
                action: "com.android.camera.action.CROP",                   
                data: event.media.nativePath,                    
                type: 'image/*'     
            });
            intent.putExtra("outputX", 512);
            intent.putExtra("outputY", 1024);
            intent.putExtra("aspectX", 1);
            intent.putExtra("aspectY", 2);
            intent.putExtra("scale", true);
            var activity = Ti.Android.currentActivity;              
            activity.startActivityForResult(intent, function(param){
               alert(JSON.stringify(param.intent));
               Ti.API.info('#### activity')
            });              
        },
        error:function(error)
        { },
        cancel : function()
        { }
    });
    }
    catch(e)
    { }
}); 
curWin.add(myView);
curWin.open();
</pre></code> 


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-12117_34237/app.js">app.js</td></td><td>2012-12-18T12:35:01.000+0000</td><td>1333</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>André Perazzi 2012-12-18

   Are you able to see the alert?</li>
<li>André Perazzi 2012-12-20

   </li>
<li>Sunila 2013-03-03

   setting the property 'navBarHidden' in createWindow will create a new Activity and js context. The code Ti.Android.currentActivity here, refers to the app main activity and the callback won't get called until that activity is active.
    To use the activity for the 'curWin', use 'curWin.getActivity()' instead of Ti.Android.currentActivity which will fix the problem</li>
<li>Lee Morris 2017-03-24

   Closing ticket as invalid with reference to the above comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-12117.json">JSON Source</a></p>