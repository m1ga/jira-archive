---
title: "[TIMOB-12324] iOS: improve RTE for addEventListener with one arg"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 3.0.0, Release 3.0.2</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, qe-sdk3.0.2</td></tr>
<tr><th>Reporter</th><td>Dustin Hyde</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-01-17T15:47:50.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:03:44.000+0000</td></tr>
</table>

<h3>Description</h3>

iOS: improve RTE for addEventListener with one arg.

If only one arg is passed to addEventListener, the iOS RTE does not indicate the nature of the problem:

<code><pre>
[ERROR] :  Script Error = *** -[__NSArrayM objectAtIndex:]: index 1 beyond bounds [0 .. 0] at app.js (line 100).
</pre></code>

Test Code:

<code><pre>
var win = Ti.UI.createWindow();

win.addEventListener(function(){
	Ti.API.error('SESSION ID: ' + Ti.App.sessionId);
});

win.open();
</pre></code>

The Android Error message is informative:

<code><pre>
[ERROR][TiExceptionHandler(  310)] (main) [682,2923] ----- Titanium Javascript Runtime Error -----
[ERROR][TiExceptionHandler(  310)] (main) [0,2923] - In ti:/events.js:138,10
[ERROR][TiExceptionHandler(  310)] (main) [0,2923] - Message: Uncaught Error: addListener only takes instances of Function. The listener for event "function (){}" is "undefined"
[ERROR][TiExceptionHandler(  310)] (main) [1,2924] - Source: 			throw new Error('addListener only takes instances of Function. The listener
[ERROR][V8Exception(  310)] Exception occurred at ti:/events.js:138: Uncaught Error: addListener only takes instances of Function. The listener for event "function (){}" is "undefined"
</pre></code>

The iOS Error message for an undefined callback is informative:

<code><pre>
[ERROR] :  Invalid type passed to function. expected: KrollCallback, was: (null)  in -[TiProxy addEventListener:] (TiProxy.m:798)
[ERROR] :  Script Error = Invalid type passed to function. expected: KrollCallback, was: (null)  in -[TiProxy addEventListener:] (TiProxy.m:798) at app.js (line 115).
</pre></code>

Undefined callback test code:

<code><pre>
var win = Ti.UI.createWindow();

win.addEventListener();

win.open();
</pre></code>

MobileWeb has no RTE: TIMOB-10412

Steps to Reproduce:

1. Run code:

<code><pre>
var win = Ti.UI.createWindow();

win.addEventListener(function(){
	Ti.API.error('SESSION ID: ' + Ti.App.sessionId);
});

win.open();
</pre></code>

Actual Result:

Index out of bounds runtime error.

Expected Result:

RTE indicating wrong number of args, or unexpected arg type.

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-12324.json">JSON Source</a></p>