---
title: "[TIMOB-12457] iOS: Ti.Locale.currentLocale and currentCountry issues"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-11-10T21:35:37.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.0, Release 3.1.1, Release 3.2.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.4.2, Release 3.5.0, Release 4.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>locale, module_locale</td></tr>
<tr><th>Reporter</th><td>Thierry Godfroid</td></tr>
<tr><th>Assignee</th><td>Muhammad Dadu</td></tr>
<tr><th>Created</th><td>2013-01-05T09:04:06.000+0000</td></tr>
<tr><th>Updated</th><td>2014-11-25T01:51:37.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Ti.Locale issue</h4>
Ti.Locale is NOT working as expected after reading the doc.

<h4>Expected</h4>
currentLocale and getCurrentLocale() to work like language i.e. <a href="http://docs.appcelerator.com/titanium/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/titanium/latest/#</a>!/api/Titanium.Locale-method-getCurrentLocale

<h4>Repro sequence</h4>
<code><pre>
Ti.API.error("locale: " + Ti.Locale.currentLocale);
Ti.API.error("country: " + Ti.Locale.currentCountry);
Ti.API.error("language: " + Ti.Locale.currentLanguage);
Ti.API.error("locale: " + Ti.Locale.getCurrentLocale());
Ti.API.error("country: " + Ti.Locale.getCurrentCountry());
Ti.API.error("language: " + Ti.Locale.getCurrentLanguage());
</pre></code>

<h4>returns</h4>

<code><pre>
[ERROR] locale: undefined
[ERROR] country: undefined
[ERROR] language: fr
[ERROR] locale: fr-BE
[ERROR] country: BE
[ERROR] language: fr
</pre></code>

<h4>yet another console output</h4>
<code><pre>
[ERROR] :  locale: undefined
[ERROR] :  country: undefined
[ERROR] :  language: en
[ERROR] :  locale: en-US
[ERROR] :  country: US
[ERROR] :  language: en
</pre></code>

I am not competent enough in objective-C and mobile SDK knowledge but the implementation of locale module here looks fishy to me (I would expect implementations for currentLocale and currentCountry). I tested w/ SDKs 1.8.2, 2.1.2.GA and 3.0.0.GA on Mac OSX for iOS.

<h3>Comments</h3>

<ol>
<li>jithinpv 2013-04-05

   Issue reproduces 
   
   Tested with
   
   Titanium Studio, build: 3.0.1.201212181159
   Titanium SDK version: 3.1.0 
   Titanium SDK version: 3.0.2 
   iOS iPhone Simulator: iOS SDK version: 6.0</li>
<li>Jong Eun Lee 2013-12-27

   Issue reproduces.
   
   Tested with Ti 3.2.0.GA :(</li>
<li>Ketan Majmudar 2014-04-29

   I have been working on a project for European Nordics markets and this method not working caused a lot of debugging and eventually having to concatenate my own version of this:
   
   <code><pre>
   Countries.getCurrentLocale = function(){
       var lang, country, locale;
       lang = Ti.Locale.getCurrentLanguage();
       country = Ti.Locale.getCurrentCountry();
       locale = lang +"-"+ country;
       return locale;
   };
   </pre></code>
   
   It most certainly has a bug - Ti.Locale.getCurrentLocale will return *en-US* no matter what the language/region configuration of the device. </li>
<li>Muhammad Dadu 2014-09-16

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/6106" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6106</a>
   
   Added the two missing properties to the SDK that were referenced in the docs.
   
   Testing sample code after implementation
   <code><pre>
   [ERROR] locale: en-US
   [ERROR] country: US
   [ERROR] language: en
   [ERROR] locale: en-US
   [ERROR] country: US
   [ERROR] language: en
   </pre></code></li>
<li>Olga Romero 2014-10-03

   <code><pre>
   [ERROR] :  locale: undefined
   [ERROR] :  country: undefined
   [ERROR] :  language: en
   [ERROR] :  locale: en-US
   [ERROR] :  country: US
   [ERROR] :  language: en
   </pre></code>
   
   Tested using
   Mac osx 10.9.5 Mavericks
   Appcelerator Studio, build: 3.4.0.201409261245
   Titanium SDK, build: 3.4.1.v20141003114920
   acs@1.0.18
   alloy 1.5.1
   install@0.1.7
   npm@1.4.23
   sudo@1.0.3
   titanium 3.4.0
   titanium-code-processor@1.1.1
   Xcode6.1GM
   Device:
   iPhone 6 iOS 8.1
   
   Closing as fixed.</li>
<li>Vishal Duggal 2014-11-10

   PR's merged
   master - <a href="https://github.com/appcelerator/titanium_mobile/pull/6106" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6106</a>
   3_4_X - <a href="https://github.com/appcelerator/titanium_mobile/pull/6331" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6331</a></li>
<li>Ewan Harris 2014-11-25

   Verified fix on:
   
   Mac OSX 10.10.1
   Appcelerator Studio, build: 3.4.1.201410281743
   Titanium SDK build:  3.5.0.v20141124114114, 3.6.0.v20141124111716
   Titanium CLI, build: 3.4.1
   Alloy: 1.5.1
   Xcode 6.2 beta
   iPhone 6 Plus (8.1), iPhone 6 Simulator (8.2)
   
   Using the test case provided, built to both simulator and device and launched the app multiple times while changing the location and language in the settings.
   
   Closing ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-12457.json">JSON Source</a></p>