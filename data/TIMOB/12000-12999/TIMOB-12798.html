---
title: "[TIMOB-12798] Android: include parameter is assumed relative to CommonJS file directory, causes FileNotFoundException "
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-03-19T22:57:35.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.1.0, 2013 Sprint 06 Core, 2013 Sprint 06</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, core, defect, include, qe-port, regression</td></tr>
<tr><th>Reporter</th><td>Shawn Lipscomb</td></tr>
<tr><th>Assignee</th><td>Allen Yeung</td></tr>
<tr><th>Created</th><td>2013-02-20T15:33:31.000+0000</td></tr>
<tr><th>Updated</th><td>2013-03-21T10:46:23.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
When a window with a url property is created from within a CommonJS unit, where the CommonJS unit resides in a subdirectory, includes that are within the window's unit (specified in the url property) used to be (2.1.4 and earlier) treated as relative to the Resources directory. Now (3.0.2.GA) it is treated as relative to the directory of the CommonJS file. If the CommonJS file is in a subdirectory, an error (APP PROXY: ti.modules.titanium.app.AppModule) is generated. This breaks a lot of existing code.

Note that in the error message, the "ui" subdirectory is doubled:
Error while reading asset "Resources/ui/ui/MyInclude.js"

Works in 2.1.4.GA
Broken in 3.0.2.GA

<h4>Testcase</h4>
Note in this example that the "MakeWin.js" and "MyInclude.js" files are in a "ui" subdirectory.

{panel:title=app.js}
<code><pre>
Ti.UI.setBackgroundColor('#000');
require('ui/MakeWin');
</pre></code>
{panel}

{panel:title=ui/MakeWin.js}
<code><pre>
var win1=Ti.UI.createWindow({  
    title:'Window 1',
    backgroundColor:'#fff',
    url:'win1.js'
});
win1.open();
</pre></code>
{panel}

{panel:title=win1.js}
<code><pre>
Ti.include('ui/MyInclude.js');

var winOne = Ti.UI.currentWindow;

var label1 = Ti.UI.createLabel({
  color:'#999',
  text:'I am Window '+MyValue,
  font:{fontSize:20,fontFamily:'Helvetica Neue'},
  textAlign:'center',
  width:'auto'
});

winOne.add(label1);
</pre></code>
{panel}

{panel:title=ui/MyInclude.js}
<code><pre>
var MyValue=5;
</pre></code>
{panel}

<h4>Error Log:</h4>
[ERROR][TiApplication(  386)] (KrollRuntimeThread) [1417,1417] APP PROXY: ti.modules.titanium.app.AppModule@43e51900
[ERROR][TiAssetHelper(  386)] Error while reading asset "Resources/ui/ui/MyInclude.js":
[ERROR][TiAssetHelper(  386)] java.io.FileNotFoundException: Resources/ui/ui/MyInclude.js
[ERROR][TiAssetHelper(  386)] 	at android.content.res.AssetManager.openAsset(Native Method)
[ERROR][TiAssetHelper(  386)] 	at android.content.res.AssetManager.open(AssetManager.java:313)
[ERROR][TiAssetHelper(  386)] 	at android.content.res.AssetManager.open(AssetManager.java:287)
[ERROR][TiAssetHelper(  386)] 	at org.appcelerator.kroll.util.KrollAssetHelper.readAsset(KrollAssetHelper.java:77)
[ERROR][TiAssetHelper(  386)] 	at org.appcelerator.kroll.runtime.v8.V8Runtime.nativeRunModule(Native Method)
[ERROR][TiAssetHelper(  386)] 	at org.appcelerator.kroll.runtime.v8.V8Runtime.doRunModule(V8Runtime.java:140)
[ERROR][TiAssetHelper(  386)] 	at org.appcelerator.kroll.KrollRuntime.handleMessage(KrollRuntime.java:289)
[ERROR][TiAssetHelper(  386)] 	at org.appcelerator.kroll.runtime.v8.V8Runtime.handleMessage(V8Runtime.java:166)
[ERROR][TiAssetHelper(  386)] 	at android.os.Handler.dispatchMessage(Handler.java:95)
[ERROR][TiAssetHelper(  386)] 	at android.os.Looper.loop(Looper.java:123)
[ERROR][TiAssetHelper(  386)] 	at org.appcelerator.kroll.KrollRuntime$KrollRuntimeThread.run(KrollRuntime.java:112)

<h3>Comments</h3>

<ol>
<li>Allen Yeung 2013-03-19

   <a href="https://github.com/appcelerator/titanium_mobile/pull/3986" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3986</a></li>
<li>Shyam Bhadauria 2013-03-21

   Environment used for verification -
   Titanium SDK: 3.1.0.v20130320190115
   Titanium Â Studio:3.0.2.201302151605
   Device: LG-P970	Android 2.2.2</li>
</ol>


<p><a href="/TIMOB/TIMOB-12798.json">JSON Source</a></p>