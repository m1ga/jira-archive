---
title: "[TIMOB-12888] Use of parentModule annotation in module fails (Android Modules)"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Jeff English</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-02-27T17:12:39.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:03:32.000+0000</td></tr>
</table>

<h3>Description</h3>

Using the "parentModule" kroll annotation in an Android module allows it to create a namespace hierarchy (e.g. mymodule.database.sql). However, depending on the names that are used for these 'namespaces' the build will fail for the module. This is becoming more important as we create more complex module structures.

The error is because the bootstrap.py build script does not always obtain the correct moduleClassName. It needs to get the top-level module classname, but it does this by assuming that entry '0' of the 'keys' hashmap is the module class name (line 376 of bootstrap.py). Since 'keys' is a hashmap (ie. unordered) it is indeterminate what the first entry will be. If entry "0"  does not happen to be the class name for the top level module then the build will fail. Depending on the names used for the various module names, it is *possible* that entry "0" of the map will be the class name for the module, but not likely when multiple parentModule annotations are used.

This can be reproduced with a simple module that uses one level of parentModule referencing.

To reproduce:
1. Unzip the attached <code>nsgood.zip</code> file
2. Build the module (ie. <code>ant</code>) -- should build successfully
3. Run the example application (ie. <code>ant run</code>). Label should display the value "999" that it retrieved from the nested namespace module.
4. Unzip the attached <code>nsbad.zip</code> file
5. Build the module -- should fail the build since it thinks the top-level className is 'ti.ns.z.ZModule' instead of 'ti.ns.NSModule'

Note that the only difference between these two modules is the name of the 2nd level module namespace. In the 'good' version it is "AModule" while in the 'bad' version it is "ZModule".


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-12888_35791/nsbad.zip">nsbad.zip</td></td><td>2013-02-27T18:00:41.000+0000</td><td>12190</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-12888_35790/nsgood.zip">nsgood.zip</td></td><td>2013-02-27T18:00:41.000+0000</td><td>11937</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-12888.json">JSON Source</a></p>