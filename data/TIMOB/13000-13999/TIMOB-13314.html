---
title: "[TIMOB-13314] Android: ListView IllegalStateException: Ambiguous Z-Order"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-04-02T23:22:03.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.1.0, 2013 Sprint 07 API, 2013 Sprint 07</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>ListViews, qe-testadded, supportTeam, triage</td></tr>
<tr><th>Reporter</th><td>Itay Avtalyon</td></tr>
<tr><th>Assignee</th><td>Hieu Pham</td></tr>
<tr><th>Created</th><td>2013-04-02T12:38:21.000+0000</td></tr>
<tr><th>Updated</th><td>2013-10-01T06:18:04.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Steps to Reproduce</h4>
Install the attached sample on an Android device and run.

<h4>Actual Result</h4>
App crash. (Tested on Android 2.3.3 [Samsung Galaxy I]

<h4>Expected Result</h4>
Show a list of three items with a custom template

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-13314_36929/.log">.log</td></td><td>2013-04-02T12:38:42.000+0000</td><td>4047938</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-13314_36931/app.js">app.js</td></td><td>2013-04-02T12:38:53.000+0000</td><td>8036</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-13314_36930/diagnostic5075961508409598148.log">diagnostic5075961508409598148.log</td></td><td>2013-04-02T12:38:51.000+0000</td><td>12112</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Itay Avtalyon 2013-04-02

   The error description from the Android Monitor:
   
   04-02 15:29:10.425: E/TiApplication(18485): (main) [443,443] Sending event: exception on thread: main msg:java.lang.IllegalStateException: Ambiguous Z-Order; Titanium 3.1.0,2013/03/28 21:09,1748774
   04-02 15:29:10.425: E/TiApplication(18485): java.lang.IllegalStateException: Ambiguous Z-Order
   04-02 15:29:10.425: E/TiApplication(18485): 	at org.appcelerator.titanium.view.TiCompositeLayout$1.compare(TiCompositeLayout.java:164)
   04-02 15:29:10.425: E/TiApplication(18485): 	at org.appcelerator.titanium.view.TiCompositeLayout$1.compare(TiCompositeLayout.java:127)
   04-02 15:29:10.425: E/TiApplication(18485): 	at java.util.TreeMap.find(TreeMap.java:277)
   04-02 15:29:10.425: E/TiApplication(18485): 	at java.util.TreeMap.putInternal(TreeMap.java:240)
   04-02 15:29:10.425: E/TiApplication(18485): 	at java.util.TreeMap.put(TreeMap.java:186)
   04-02 15:29:10.425: E/TiApplication(18485): 	at java.util.TreeSet.add(TreeSet.java:113)
   04-02 15:29:10.425: E/TiApplication(18485): 	at org.appcelerator.titanium.view.TiCompositeLayout.onLayout(TiCompositeLayout.java:491)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at org.appcelerator.titanium.view.TiCompositeLayout.onLayout(TiCompositeLayout.java:578)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at org.appcelerator.titanium.view.TiCompositeLayout.onLayout(TiCompositeLayout.java:578)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at org.appcelerator.titanium.view.TiCompositeLayout.onLayout(TiCompositeLayout.java:578)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.ListView.setupChild(ListView.java:1881)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.ListView.makeAndAddView(ListView.java:1796)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.ListView.fillDown(ListView.java:718)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.ListView.fillFromTop(ListView.java:775)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.ListView.layoutChildren(ListView.java:1646)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.AbsListView.onLayout(AbsListView.java:1384)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at org.appcelerator.titanium.view.TiCompositeLayout.onLayout(TiCompositeLayout.java:578)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at org.appcelerator.titanium.view.TiCompositeLayout.onLayout(TiCompositeLayout.java:578)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.View.layout(View.java:7228)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.ViewRoot.performTraversals(ViewRoot.java:1145)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.view.ViewRoot.handleMessage(ViewRoot.java:1865)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.os.Handler.dispatchMessage(Handler.java:99)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.os.Looper.loop(Looper.java:123)
   04-02 15:29:10.425: E/TiApplication(18485): 	at android.app.ActivityThread.main(ActivityThread.java:3687)
   04-02 15:29:10.425: E/TiApplication(18485): 	at java.lang.reflect.Method.invokeNative(Native Method)
   04-02 15:29:10.425: E/TiApplication(18485): 	at java.lang.reflect.Method.invoke(Method.java:507)
   04-02 15:29:10.425: E/TiApplication(18485): 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
   04-02 15:29:10.425: E/TiApplication(18485): 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
   04-02 15:29:10.425: E/TiApplication(18485): 	at dalvik.system.NativeStart.main(Native Method)
   </li>
<li>Itay Avtalyon 2013-04-02

   UPDATE: Tested with a very basic example (no template) and the app works fine.</li>
<li>Itay Avtalyon 2013-04-02

   Update: Tried to simplify the template, and it seems that if there are only two level of children it is working fine.</li>
<li>Hieu Pham 2013-04-02

   This is an issue with borders. Master PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/4067" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4067</a></li>
<li>Anshu Mittal 2013-04-08

   Tested with:
   SDK: 3.1.0.v20130405170202
   Studio:3.1.0.201304011603
   Device: Samsung Galaxy Note(2.3.6)
   OS: OSX 10.7.5
   
   No more Ambiguous Z-Order and Illegal stateException</li>
</ol>


<p><a href="/TIMOB/TIMOB-13314.json">JSON Source</a></p>