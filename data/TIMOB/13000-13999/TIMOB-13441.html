---
title: "[TIMOB-13441] iOS: mp4 not playing with AudioPlayer"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2017-05-02T22:05:12.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.0.2, Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Shashi Jain</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2012-11-27T22:13:20.000+0000</td></tr>
<tr><th>Updated</th><td>2017-05-02T22:05:12.000+0000</td></tr>
</table>

<h3>Description</h3>

Using 3.1.0 sdk:

Trying to play a remote .m4a (audio mp4) file with AudioPlayer. The .m4a file was created with AudioRecorder.

In KitchenSink Resources/ui/handheld/ios/phone/sound_session_module.js:

replace:

var audio = Ti.Media.createAudioPlayer({url:'<a href="http://appcelerator.qe.test.data.s3.amazonaws.com/KSResources/audio/audio_session.mp3" rel="nofollow" target="_blank">http://appcelerator.qe.test.data.s3.amazonaws.com/KSResources/audio/audio_session.mp3</a>'});

with:

var audio = Ti.Media.createAudioPlayer({url:'<a href="https://s3.amazonaws.com/titaniumtestfiles/135397723348131a88e5b0d1ace317567db810607f3b6.m4a" rel="nofollow" target="_blank">https://s3.amazonaws.com/titaniumtestfiles/135397723348131a88e5b0d1ace317567db810607f3b6.m4a</a>'});

This will not play in Simulator or on device (iPhone 4S). It crashes after displaying the following log:

<code><pre>[INFO] :   2013-04-06 12:03:34.141 KitchenSink[41416:9207] Queueing of audio buffer failed. err: ˇˇˇŒ -50</pre></code>

However, it will work on device if you replace:

Titanium.Media.audioSessionMode = Ti.Media.AUDIO_SESSION_MODE_AMBIENT;

with:

Titanium.Media.audioSessionMode = Ti.Media.AUDIO_SESSION_MODE_PLAY_AND_RECORD;
or Titanium.Media.audioSessionMode = Ti.Media.AUDIO_SESSION_MODE_PLAYBACK;

The simulator however, continues to crash.

<h3>Comments</h3>

<ol>
<li>Shashi Jain 2012-12-06

   Also happens in 2.1.4GA.</li>
<li>Shashi Jain 2013-02-11

   Any updates on this? I've also noticed another problem (I'm thinking of putting this into its own ticket.): changing the bufferSize (e.g. from default 2048 to 16384) causes the app to crash. I get the following error: 
   
   AudioQueue changed state in unexpected way.
   
   This is on device, iPhone 4S. Using recent Ti 3.1.0 build, iOS 6.1 SDK.
   setBufferSize() works fine with mp3 files. The app does not crash with mp4 files using default bufferSize.</li>
<li>Daniel Sefton 2013-04-06

   Tested and confirmed with Ti SDK 3.0.2 GA. Updated description to clarify a couple of things.</li>
<li>Lee Morris 2017-05-02

   Resolving ticket as Invalid as there is now a new version of Kitchen Sink available and we no longer support the version which relates to this ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-13441.json">JSON Source</a></p>