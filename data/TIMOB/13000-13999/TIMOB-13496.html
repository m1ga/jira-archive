---
title: "[TIMOB-13496] iOS: Titanium.Contacts.removeGroup fails"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-06-04T20:36:22.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.0.2, Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 12 API, 2013 Sprint 12, Release 3.2.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>module_media, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Mark Burggraf</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2013-01-23T16:19:02.000+0000</td></tr>
<tr><th>Updated</th><td>2013-10-15T10:04:48.000+0000</td></tr>
</table>

<h3>Description</h3>

The following code fails:

Titanium.Contacts.removeGroup(groupObj);
Titanium.Contacts.save();

The error given is:
<code><pre>
[ERROR] :  Invalid type passed to function. expected: TiContactsPerson, was: TiContactsGroup  in -[ContactsModule removePerson:] (ContactsModule.m:431)
</pre></code>
Looking at ContactsModule.m it appears there may be a bug in removeGroup -- it seems to be using code from removePerson.  See below:
<code><pre>
-(void)removeGroup:(id)arg
{
	ENSURE_SINGLE_ARG(arg,TiContactsGroup)
	ENSURE_UI_THREAD(removePerson,arg)

	[self removeRecord:[arg record]];
}
</pre></code>

<h3>Comments</h3>

<ol>
<li>Pedro Enrique 2013-04-03

   Please provide a runnable sample app.js</li>
<li>Mark Burggraf 2013-04-03

   <code><pre>
   var win = Titanium.UI.createWindow({  
       backgroundColor:"#fff",
       layout:"vertical"
   });
   
   function createGroup()
   {
   	var newGroup = Titanium.Contacts.createGroup();
   	newGroup.name = "Test Group 1";
   	Titanium.Contacts.save();	
   }
   function removeGroup()
   {
   	var allGroups = Titanium.Contacts.getAllGroups();
   	for (var i=0; i < allGroups.length; i++)
   	{
   		Ti.API.info("found group name: " + allGroups[i].name);
   		if (allGroups[i].name == "Test Group 1")
   		{
   			Titanium.Contacts.removeGroup(allGroups[i]);
   		}
   	}
   	Titanium.Contacts.save();
   }
   
   var createButton = Ti.UI.createButton({title:"Create Group: Test Group 1",top:20});
   var removeButton = Ti.UI.createButton({title:"Remove Group: Test Group 1",top:20});
   createButton.addEventListener("click",createGroup);
   removeButton.addEventListener("click",removeGroup);
   
   win.add(createButton);
   win.add(removeButton);
   
   win.open();
   </pre></code></li>
<li>Mark Burggraf 2013-04-03

   Running the app.js above gives the error:
   
   [ERROR] :  Invalid type passed to function. expected: TiContactsPerson, was: TiContactsGroup  in -[ContactsModule removePerson:] (ContactsModule.m:431)
   
   This error is not trappable via a try/catch block, though, since it's thrown at the lower (module) level.
   </li>
<li>Daniel Sefton 2013-04-08

   Confirmed with 3.0.2 GA, but the issue is fixed in 3.1.0.v20130403114957.</li>
<li>Mark Burggraf 2013-04-09

   As of 3.1.0.v20130405170202, this is still not working for us.</li>
<li>Mark Burggraf 2013-04-09

   Here is updated test code that shows it is not fixed:
   
   <code><pre>
   var win = Titanium.UI.createWindow({  
       backgroundColor:"#fff",
       layout:"vertical"
   });
   
   function createGroup()
   {
   	var newGroup = Titanium.Contacts.createGroup();
   	newGroup.name = "Test Group 2";
   	Titanium.Contacts.save();	
   	Ti.API.info("********************");
   	Ti.API.info("Listing groups:");
   	Ti.API.info("********************");
   	allGroups = Titanium.Contacts.getAllGroups();
   	for (var i=0; i < allGroups.length; i++)
   	{
   		Ti.API.info("found group name: " + allGroups[i].name);
   	}	
   	Ti.API.info("********************");
   	Ti.API.info("done");
   	Ti.API.info("********************");	
   }
   function removeGroup()
   {
   	var allGroups = Titanium.Contacts.getAllGroups();
   	for (var i=0; i < allGroups.length; i++)
   	{
   		Ti.API.info("found group name: " + allGroups[i].name);
   		if (allGroups[i].name == "Test Group 2")
   		{
   			Ti.API.info("deleting group: Test Group 2");
   			Titanium.Contacts.removeGroup(allGroups[i]);
   			Titanium.Contacts.save();
   		}
   	}	
   	Ti.API.info("********************");
   	Ti.API.info("Listing groups again");
   	Ti.API.info("********************");
   	allGroups = Titanium.Contacts.getAllGroups();
   	for (var i=0; i < allGroups.length; i++)
   	{
   		Ti.API.info("found group name: " + allGroups[i].name);
   	}	
   	Ti.API.info("********************");
   	Ti.API.info("done");
   	Ti.API.info("********************");
   	
   }
   
   var createButton = Ti.UI.createButton({title:"Create Group: Test Group 2",top:20});
   var removeButton = Ti.UI.createButton({title:"Remove Group: Test Group 2",top:20});
   createButton.addEventListener("click",createGroup);
   removeButton.addEventListener("click",removeGroup);
   
   win.add(createButton);
   win.add(removeButton);
   
   win.open();
   
   </pre></code></li>
<li>Mark Burggraf 2013-04-09

   Note that, beginning in SDK 3.1, the original error message reported no longer appears.  No error is given -- the method simply does not delete the group as it's supposed to.</li>
<li>Daniel Sefton 2013-04-09

   Ok, confirmed. Our engineering team will review. Thanks.</li>
<li>Sabil Rahim 2013-06-04

   Fixed in master (3.2.0) by PR <a href="https://github.com/appcelerator/titanium_mobile/pull/3884" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/3884</a></li>
<li>Paras Mishra 2013-10-15

    Group is getting removed on the invocation of Titanium.Contacts.removeGroup
    
    Verified fix on:
    Device : iPhone 5 , iOS version : 7.0
    Device : iPod Touch , iOS version : 6.1.3
    SDK: 3.2.0.v20131014204636
    CLI version : 3.2.0
    OS : MAC OSX 10.8.4
    Alloy : 1.2.2
    Appcelerator Studio, build: 3.2.0.201310112258
    XCode : 5</li>
</ol>


<p><a href="/TIMOB/TIMOB-13496.json">JSON Source</a></p>