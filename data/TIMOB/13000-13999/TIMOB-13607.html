---
title: "[TIMOB-13607] NPM: version downloaded may not the correct one, but reports accurate version"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2016-08-29T21:59:44.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>CLI</td></tr>
<tr><th>Labels</th><td>qe-3.1.1</td></tr>
<tr><th>Reporter</th><td>Federico Casali</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2013-04-17T20:52:52.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-24T21:57:44.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>

After updating to 3.1.0 (Alloy 1.1.0), I found out that my Alloy installed version was not reflecting the displayed version number and was not the 1.1.0 correct one, but a previous one.

'alloy -v' command was displaying the correct version (1.1.0) but the code in '/usr/local/lib/node_modules/alloy/Alloy/commands/compile/index.js' @lines 330 to 343 was wrong, not reflecting changes made for 1.1.0.

Cleaning npm cache (sudo npm cache clean) fixed the issue and I was able to install the correct Alloy 1.1.0 version using 'sudo npm install -g alloy' command.


<h4>Note</h4>
The code from in '/usr/local/lib/node_modules/alloy/Alloy/commands/compile/index.js' @lines 330 to 343 should be:
<code><pre>
// Load the style and update the state
		if (files.STYLE) {
			var theStyles = _.isArray(files.STYLE) ? files.STYLE : [{file:files.STYLE}];
			_.each(theStyles, function(style) {
				if (fs.existsSync(style.file)) {
					logger.info('  style:      "' + 
						path.relative(path.join(dir,CONST.DIR.STYLE),style.file) + '"');
					state.styles = CU.loadAndSortStyle(style.file, manifest, {
						existingStyle: state.styles,
						platform: style.platform
					});
				}
			});
		}
</pre></code>

<h3>Comments</h3>

<ol>
<li>Eric Merriman  2013-04-17

   We are seeing this on Olga's machine. Not currently seeing this on mine. Her steps:
   1) "sudo uninstall -g alloy"
   2) Studio launch, prompt for install of alloy
   3) Install alloy
   4) "alloy -v" gets you 1.1.0
   
   Code snippet shown above not present on her machine. It is accurate on mine.
   </li>
<li>Ingo Muschenetz 2013-10-08

   Deferring for now as there appears to be a workaround. Likely this is a Node.js/NPM bug.</li>
<li>Chris Barber 2016-08-29

   I tested this with NPM 3 and the globally installed Alloy and everything worked as expected. This sounds like a bug in NPM. Neither here nor there, this is pretty a non-issue with the Appc CLI and will certainly be a non-issue after we roll out the new build pipeline.</li>
<li>Lee Morris 2017-03-24

   Closing ticket as the issue cannot be reproduced and with reference to the previous comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-13607.json">JSON Source</a></p>