---
title: "[TIMOB-13712] Android: Experiment: The event subsystem is slow because it performs calculations even when there are no event listeners"
---
<table>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-05-06T22:45:57.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 09 API, 2013 Sprint 09</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>experiment, performance</td></tr>
<tr><th>Reporter</th><td>Matt Langston</td></tr>
<tr><th>Assignee</th><td>Sabil Rahim</td></tr>
<tr><th>Created</th><td>2013-04-29T18:48:23.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T00:08:49.000+0000</td></tr>
</table>

<h3>Description</h3>

1. Design an experiment to measure the validity of the hypothesis "The event subsystem is slow because it performs calculations even when there are no event listeners".

2. Run the experiment and collect the data.

3. Analyze the data.

4. Create a short writeup presenting results and conclusions.


<h3>Comments</h3>

<ol>
<li>Sabil Rahim 2013-04-29

   <h4>The hypothesis : The event subsystem is slow because it performs calculations even when there are no event listeners.</h4>
   
   ---------------------
   
   <h4>Experiment to test out the hypothesis.</h4>
   
   * Log the amount of time required/data creation cost to fire events through dofireEvent method in KrollObject.java. Changes can be viewed [here](<a href="https://github.com/srahim/titanium_mobile/compare/timob-13712)." rel="nofollow" target="_blank">https://github.com/srahim/titanium_mobile/compare/timob-13712).</a>
   * Initial test was conducted with a sample app containing a window and button. [CODE](<a href="https://gist.github.com/srahim/5485115)." rel="nofollow" target="_blank">https://gist.github.com/srahim/5485115).</a>
   * Results of the test [log1](<a href="http://tinyurl.com/bw73vn4)" rel="nofollow" target="_blank">http://tinyurl.com/bw73vn4)</a>, [log2](<a href="http://db.tt/HS1XyFIa)" rel="nofollow" target="_blank">http://db.tt/HS1XyFIa)</a>, [log3](<a href="http://db.tt/9wOAu59E)." rel="nofollow" target="_blank">http://db.tt/9wOAu59E).</a>
   * Initial Analysis of the logs shows that our system fires a lot of unnecessary events even though nobody is listening for it. But the cost associated with it (forming the actual event and its related data) seems negligible(less than 0ms in most cases).
   * Repeated the same test with a bit more complex app [Matt's touch test app ](<a href="http://db.tt/1wB3sDCL)." rel="nofollow" target="_blank">http://db.tt/1wB3sDCL).</a>
   * Results of the test [log1](<a href="http://db.tt/OwNh0P49)" rel="nofollow" target="_blank">http://db.tt/OwNh0P49)</a>, [log2](<a href="http://db.tt/QRJKmNfL)" rel="nofollow" target="_blank">http://db.tt/QRJKmNfL)</a>, [log3](<a href="http://db.tt/izkBe4Ro)" rel="nofollow" target="_blank">http://db.tt/izkBe4Ro)</a>, [log4](<a href="http://db.tt/USy46eav)." rel="nofollow" target="_blank">http://db.tt/USy46eav).</a>
   * Logs showed the same observation as we made before. We do fire a lot of unnecessary events when there are no listeners.
   * Repeated the test with TableViews in KS. Results [log1](<a href="http://db.tt/I30KD5QC)" rel="nofollow" target="_blank">http://db.tt/I30KD5QC)</a>, [log2](<a href="http://db.tt/SZQM84h9)" rel="nofollow" target="_blank">http://db.tt/SZQM84h9)</a>, [log3](<a href="http://db.tt/pUzkCMig)." rel="nofollow" target="_blank">http://db.tt/pUzkCMig).</a>
   * KS also shows the same results for scroll events. We generate a lot of scroll events when not required.
   
   ---------------------
   
   <h4>Conclusions</h4>
   
   * The excess processing of unwanted events does not result in any perceivable app performance hit. 
   * It might be worth noting that in bigger apps where each window might contain numerous child views, this could result in the event queue getting filled up and actual events that the user is listening for could be delayed. 
   * Even though each individual event does not cost much to process, as whole this could lead to a small delay(1 - 250ms depending on the complexity of the app) in the app.
   
   ---------------------
   
   <h4>Recommendations</h4>
   
   * We should always check if the current event being processed has any listeners and the listening proxy should be the first one to be notified instead of going through the hierarchy of child to parent.
   * Even though this would result in cleaning up the code flow and event queue significantly, this fix might not show any significant app performance improvement. 
   </li>
<li>Lee Morris 2017-03-22

   Closing ticket as fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-13712.json">JSON Source</a></p>