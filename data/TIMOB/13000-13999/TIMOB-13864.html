---
title: "[TIMOB-13864] Android: Maps v2 crashes inside a tab"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-03-20T23:09:00.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>2014 Sprint 06, 2014 Sprint 06 SDK, Release 3.2.3, Release 3.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>module_androidmapv2, qe-closed-3.2.3, qe-testadded, supportTeam, triage</td></tr>
<tr><th>Reporter</th><td>Romain Salles</td></tr>
<tr><th>Assignee</th><td>Hieu Pham</td></tr>
<tr><th>Created</th><td>2013-05-15T11:23:15.000+0000</td></tr>
<tr><th>Updated</th><td>2014-07-11T23:06:18.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
Google Maps Android API v2 are not compatible with the Holo theme.

We have experienced the same problem in our app : when Holo is not active, the maps work as expected. With Holo, the app crash.

There are the error logs :

<code><pre>
05-15 10:33:55.700: E/TiApplication(25966): (main) [9931,10138] Sending event: exception on thread: main msg:java.lang.IllegalArgumentException: No view found for id 0x3e8 for fragment SupportMapFragment{436e6020 #0 id=0x3e8}; Titanium 3.1.0006,2013/05/06 12:00,2b7add3
05-15 10:33:55.700: E/TiApplication(25966): java.lang.IllegalArgumentException: No view found for id 0x3e8 for fragment SupportMapFragment{436e6020 #0 id=0x3e8}
05-15 10:33:55.700: E/TiApplication(25966): 	at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:865)
05-15 10:33:55.700: E/TiApplication(25966): 	at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
05-15 10:33:55.700: E/TiApplication(25966): 	at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:635)
05-15 10:33:55.700: E/TiApplication(25966): 	at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1431)
05-15 10:33:55.700: E/TiApplication(25966): 	at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:420)
05-15 10:33:55.700: E/TiApplication(25966): 	at android.os.Handler.handleCallback(Handler.java:605)
05-15 10:33:55.700: E/TiApplication(25966): 	at android.os.Handler.dispatchMessage(Handler.java:92)
05-15 10:33:55.700: E/TiApplication(25966): 	at android.os.Looper.loop(Looper.java:137)
05-15 10:33:55.700: E/TiApplication(25966): 	at android.app.ActivityThread.main(ActivityThread.java:4507)
05-15 10:33:55.700: E/TiApplication(25966): 	at java.lang.reflect.Method.invokeNative(Native Method)
05-15 10:33:55.700: E/TiApplication(25966): 	at java.lang.reflect.Method.invoke(Method.java:511)
05-15 10:33:55.700: E/TiApplication(25966): 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
05-15 10:33:55.700: E/TiApplication(25966): 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
05-15 10:33:55.700: E/TiApplication(25966): 	at dalvik.system.NativeStart.main(Native Method)
05-15 10:33:55.705: E/AndroidRuntime(25966): FATAL EXCEPTION: main
</pre></code>

I have minimised his code to reproduce the error. There is the code for *app.js* :

<code><pre>
(function() {
	function ApplicationWindow(title) {
	    var self = Ti.UI.createWindow({ title:title });
	  
	    self.activity.onCreateOptionsMenu = function (e) {
	        var actionBar = self.activity.actionBar;
	        actionBar.setTitle('Action bar');
	        actionBar.displayHomeAsUp = true;
	        actionBar.onHomeIconItemSelected = function () {};
	    };
	
	    if (title === 'Map') {   
	        var MapModule = require('ti.map');
	        var mapview = MapModule.createView({
	            region: {latitude:33.74511, longitude:-84.38993,
	                    latitudeDelta:0.01, longitudeDelta:0.01}
	        });
	
	        self.add(mapview);
	    }
	
	    return self;
	};


    var tabGroup = Ti.UI.createTabGroup();
	var tabs = ['One', 'Two', 'Map'];
	for (var i=0, l=tabs.length; i&lt;l; i+=1) {
		var win = new ApplicationWindow(tabs[i]),
		    tab = Ti.UI.createTab({title: tabs[i], window: win});

		tabGroup.addTab(tab);
	}

	tabGroup.open();
})();
</pre></code>

And there is the *tiapp.xml* file :

<code><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ti:app xmlns:ti="<a href="http://ti.appcelerator.org" rel="nofollow" target="_blank">http://ti.appcelerator.org</a>"&gt;
    &lt;id&gt;com.enera.tabbedmap&lt;/id&gt;
    &lt;name&gt;Test&lt;/name&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;publisher&gt;romainsalles&lt;/publisher&gt;
    &lt;url&gt;http://&lt;/url&gt;
    &lt;description&gt;not specified&lt;/description&gt;
    &lt;copyright&gt;foo&lt;/copyright&gt;
    &lt;icon&gt;appicon.png&lt;/icon&gt;
    &lt;persistent-wifi&gt;false&lt;/persistent-wifi&gt;
    &lt;prerendered-icon&gt;false&lt;/prerendered-icon&gt;
    &lt;statusbar-style&gt;default&lt;/statusbar-style&gt;
    &lt;statusbar-hidden&gt;false&lt;/statusbar-hidden&gt;
    &lt;fullscreen&gt;false&lt;/fullscreen&gt;
    &lt;navbar-hidden&gt;false&lt;/navbar-hidden&gt;
    &lt;analytics&gt;true&lt;/analytics&gt;
    &lt;guid&gt;22bd9dd2-b7a9-482b-9b64-e21eb739d636&lt;/guid&gt;
    &lt;property name="ti.ui.defaultunit" type="string"&gt;system&lt;/property&gt;
    &lt;iphone&gt;
        &lt;orientations device="iphone"&gt;
            &lt;orientation&gt;Ti.UI.PORTRAIT&lt;/orientation&gt;
        &lt;/orientations&gt;
        &lt;orientations device="ipad"&gt;
            &lt;orientation&gt;Ti.UI.PORTRAIT&lt;/orientation&gt;
            &lt;orientation&gt;Ti.UI.UPSIDE_PORTRAIT&lt;/orientation&gt;
            &lt;orientation&gt;Ti.UI.LANDSCAPE_LEFT&lt;/orientation&gt;
            &lt;orientation&gt;Ti.UI.LANDSCAPE_RIGHT&lt;/orientation&gt;
        &lt;/orientations&gt;
    &lt;/iphone&gt;
    &lt;android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;
        &lt;manifest&gt;
            &lt;uses-sdk android:minSdkVersion="8" android:targetSdkVersion="14"/&gt;
            &lt;uses-permission android:name="android.permission.INTERNET"/&gt;
            &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt;
            &lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/&gt;
            &lt;uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/&gt;
            &lt;uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/&gt;
            &lt;uses-feature android:glEsVersion="0x00020000" android:required="true"/&gt;
            &lt;uses-permission android:name="com.enera.tabbedmap.permission.MAPS_RECEIVE"/&gt;
            &lt;permission android:name="com.enera.tabbedmap.permission.MAPS_RECEIVE" android:protectionLevel="signature"/&gt;
            &lt;application android:theme="@android:style/Theme.Holo"&gt;
                &lt;meta-data android:name="com.google.android.maps.v2.API_KEY" android:value="AIzaSyDYBIo7m2GkNpiwQ2VpwfH_FwOtm8a_V-w"/&gt;
            &lt;/application&gt;
        &lt;/manifest&gt;
    &lt;/android&gt;
    &lt;mobileweb&gt;
        &lt;precache/&gt;
        &lt;splash&gt;
            &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;inline-css-images&gt;true&lt;/inline-css-images&gt;
        &lt;/splash&gt;
        &lt;theme&gt;default&lt;/theme&gt;
    &lt;/mobileweb&gt;
    &lt;modules&gt;
    	&lt;module platform="android"&gt;ti.map&lt;/module&gt;	
    &lt;/modules&gt;
    &lt;deployment-targets&gt;
        &lt;target device="blackberry"&gt;false&lt;/target&gt;
        &lt;target device="android"&gt;true&lt;/target&gt;
        &lt;target device="ipad"&gt;true&lt;/target&gt;
        &lt;target device="iphone"&gt;true&lt;/target&gt;
        &lt;target device="mobileweb"&gt;true&lt;/target&gt;
        &lt;target device="tizen"&gt;false&lt;/target&gt;
    &lt;/deployment-targets&gt;
    &lt;sdk-version&gt;3.1.0.GA&lt;/sdk-version&gt;
&lt;/ti:app&gt;
</pre></code>

When the app opens, just click on the *Map tab* and it will crash on devices with Holo.

We have tested on :

 - Samsung Galaxy Ace (GT-S5830), android 2.3.3 -> *ok* (do not supports Holo)
 - Sony Xperia (LT15i), android 2.3.3 -> *ok* (do not supports Holo)
 - Samsung Galaxy S (GTI9000), android 2.3.3 -> *ok* (do not supports Holo)
 - Samsung S2 (GT-I9100P), android 4.0.3 -> *crash* (supports Holo)
 - Nexus S, android 4.1.2 -> *crash* (supports Holo)
 - Samsung S3 (GT-I93000), android 4.1.2 -> *crash* (supports Holo)

It's really annoying : we have worked a lot to make our app more android friendly (holo, maps v2, GCM, new UX ...) and *we can't publish* it because of this problem.

<h4>Associated Q&A thread</h4>
<a href="http://developer.appcelerator.com/question/151567/google-maps-v2-module-crashes-when-view-placed-in-tab-group#comment-172642" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/151567/google-maps-v2-module-crashes-when-view-placed-in-tab-group#comment-172642</a>

<h3>Comments</h3>

<ol>
<li>Romain Salles 2013-05-17

   Any news on this ?</li>
<li>Romain Salles 2013-05-28

   A point which could help : we have found a hack to make the maps work with Holo.
   The trick is to add the mapview on the window focus.
   
   In my code example, you have to change this line :
   
   <code><pre>
   self.add(mapview);
   </pre></code>
   
   by these ones :
   
   <code><pre>
   self.addEventListener('focus', function() {
   	self.add(mapview);
   });
   </pre></code>
   
   I hope it helps to solve the issue.</li>
<li>luca capra 2013-09-02

   the hack is not working for me. Map in tabgroup always crash the app.
   
   </li>
<li>Hans Kn√∂chel 2013-10-16

   Still having problems here. Holo-Theme + Ti.Maps-Module crashes the app:
   
   E/TiApplication(21096): java.lang.IllegalArgumentException: No view found for id 0x3e8 for fragment SupportMapFragment{414b1710 #0 id=0x3e8}
   E/TiApplication(21096): 	at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:865)
   E/TiApplication(21096): 	at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
   E/TiApplication(21096): 	at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:635)
   E/TiApplication(21096): 	at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1431)
   E/TiApplication(21096): 	at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:420)</li>
<li>Eduardo Gomez 2014-01-21

   Tested and reproduced the bug with 3.2.0.GA, Android 4.0.4 and ti.map 2.1.2.
   
   Work around suggested by [~romain.salles] worked for me. [~hansknoechel], did you try this suggestion? 
   
   <code><pre>
   			var MapModule = require('ti.map');
   			var mapview = MapModule.createView({
   				region : {
   					latitude : 33.74511,
   					longitude : -84.38993,
   					latitudeDelta : 0.01,
   					longitudeDelta : 0.01
   				}
   			});
   
   			//self.add(mapview);
   			self.addEventListener('focus', function() {
   				self.add(mapview);
   			});
   </pre></code></li>
<li>Bitfabrikken - Dan Wulff Kronholm 2014-01-25

   I have the same issue as well on 3.2.0.GA, Android 4.0.4 and ti.map 2.1.2.
   Only way I can get the map to show, is if I create a brand new window and add it to that using the focus hack above.
   
   Here's the crash output from my Nexus 5:
   <code><pre>
   
   [INFO]  I/Adreno-EGL: &lt;qeglDrvAPI_eglInitialize:320&gt;: EGL 1.4 QUALCOMM Build: I0404c4692afb8623f95c43aeb6d5e13ed4b30ddbDate: 11/06/13
   [DEBUG] OpenGLRenderer: Enabling debug mode 0
   [DEBUG] dalvikvm: GC_CONCURRENT freed 339K, 2% free 25392K/25748K, paused 2ms+3ms, total 21ms
   [TRACE] CustomViewBehind: behind INVISIBLE
   [WARN]  dalvikvm: VFY: unable to resolve static field 930 (MapAttrs) in Lcom/google/android/gms/R$styleable;
   [DEBUG] dalvikvm: VFY: replacing opcode 0x62 at 0x000e
   [DEBUG] AndroidRuntime: Shutting down VM
   [WARN]  dalvikvm: threadid=1: thread exiting with uncaught exception (group=0x415deba8)
   [ERROR] TiApplication: (main) [626,939] Sending event: exception on thread: main msg:java.lang.IllegalStateException: Can not perform this action after onSaveInstanceState; Titanium 3.2.0,2013/12/20 10:57,d9182d6
   [ERROR] TiApplication: java.lang.IllegalStateException: Can not perform this action after onSaveInstanceState
   [ERROR] TiApplication:  at android.support.v4.app.FragmentManagerImpl.checkStateLoss(FragmentManager.java:1314)
   [ERROR] TiApplication:  at android.support.v4.app.FragmentManagerImpl.enqueueAction(FragmentManager.java:1325)
   [ERROR] TiApplication:  at android.support.v4.app.BackStackRecord.commitInternal(BackStackRecord.java:548)
   [ERROR] TiApplication:  at android.support.v4.app.BackStackRecord.commit(BackStackRecord.java:532)
   [ERROR] TiApplication:  at org.appcelerator.titanium.view.TiUIFragment.&lt;init&gt;(TiUIFragment.java:41)
   [ERROR] TiApplication:  at ti.map.TiUIMapView.&lt;init&gt;(TiUIMapView.java:55)
   [ERROR] TiApplication:  at ti.map.ViewProxy.createView(ViewProxy.java:63)
   [ERROR] TiApplication:  at org.appcelerator.titanium.proxy.TiViewProxy.handleGetView(TiViewProxy.java:465)
   [ERROR] TiApplication:  at org.appcelerator.titanium.proxy.TiViewProxy.getOrCreateView(TiViewProxy.java:451)
   [ERROR] TiApplication:  at org.appcelerator.titanium.proxy.TiViewProxy.handleAdd(TiViewProxy.java:568)
   [ERROR] TiApplication:  at org.appcelerator.titanium.proxy.TiViewProxy.handleMessage(TiViewProxy.java:220)
   [ERROR] TiApplication:  at android.os.Handler.dispatchMessage(Handler.java:98)
   [ERROR] TiApplication:  at android.os.Looper.loop(Looper.java:136)
   [ERROR] TiApplication:  at android.app.ActivityThread.main(ActivityThread.java:5017)
   [ERROR] TiApplication:  at java.lang.reflect.Method.invokeNative(Native Method)
   [ERROR] TiApplication:  at java.lang.reflect.Method.invoke(Method.java:515)
   [ERROR] TiApplication:  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:779)
   [ERROR] TiApplication:  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:595)
   [ERROR] TiApplication:  at dalvik.system.NativeStart.main(Native Method)
   
   </pre></code></li>
<li>Hieu Pham 2014-03-12

   master PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/5462" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5462</a></li>
<li>Hieu Pham 2014-03-20

   3.2.x PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/5499" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5499</a></li>
<li>Neha Mittal 2014-03-24

   Verified fix using below environment:
   
   Appc Studio: 3.2.3.201403190645
   Sdk: 3.2.3.v20140323211726
   acs: 1.0.14
   npm: 1.3.2
   alloy:1.3.1
   titanium:3.2.1
   titanium-code-processor:1.1.0
   Xcode: 5.1
   Osx: Maverick(10.9.2)
   Device: Nexus 7 (V 4.4.2)
   
   Android: Maps v2 does not crashes inside Tab.</li>
<li>Mark Mokryn 2014-05-01

    </li>
</ol>


<p><a href="/TIMOB/TIMOB-13864.json">JSON Source</a></p>