---
title: "[TIMOB-14083] Math.random() needs to be fixed"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>math, modules, performance, random, titanium</td></tr>
<tr><th>Reporter</th><td>Carter Lathrop</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-05-31T07:17:40.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:03:53.000+0000</td></tr>
</table>

<h3>Description</h3>

*Problem*
It seems that the generation of random numbers by Math.random() is not performing well. I've done an experiment where I generate random 8-char strings, and then I check the performance on Titanium, node and native iOS, and the results are quite conclusive. Find a detailed description of the experiment here: <a href="http://developer.appcelerator.com/question/153040/titanium-performance-generating-random-strings" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/153040/titanium-performance-generating-random-strings</a> 

*Test Case*
The experiment I did to test this lack of performance was the following: I coded the same random string generator algorithm in javascript and objC. This is how it looks in javascript:

<code>function randomId (length) {</code>
<code>var textArray = [];</code>
<code>var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";</code>
<code>for( var i=0; i < length; i++)</code>
    <code>textArray.push(possible.charAt(Math.floor(Math.random() * possible.length)));</code>
    
<code>return textArray.join('');</code>
<code>}</code>

*Results*
And then I perform a test where I generate one million of 8-char strings using this algorithm, I store them in an array, and I check for duplicates. The results are:

   - When I run it with Titanium (iPhone simulator), I get an average of 40 repeated strings.
   - When I run it with node (same javascript code), I get NO repeated strings.
   - When I run it with XCode (the objC version of the algorithm) using the iPhone simulator, I get NO repeated strings.

*Conclusion*
It seems that there is an important lack of performance of the <code>Math.random()</code> method in the Titanium environment.


<h3>Comments</h3>

<ol>
<li>Carter Lathrop 2013-05-31

   Diego,
   
   Thanks for bringing this to our attention, sorry to hear a similar bug was overlooked in the past. I'll make sure engineering takes a look at this. I know it is a bit much to ask, but for clarity and completeness sake of the ticket would you mind filling out the pertinent information from your post into the description here? It would save a lot of time and we would appreciate the clarity and concise location of all necessary information.
   
   Regards,
   
   Carter</li>
<li>Diego Lafuente 2013-06-03

   Done!! Please let me know if you need more details about it.</li>
<li>Carter Lathrop 2013-06-03

   Thanks Diego! Great work on this, will pass along to engineering.
   
   Best Regards,
   Carter</li>
<li>Neville Dastur 2015-05-03

   Any news on this?</li>
</ol>


<p><a href="/TIMOB/TIMOB-14083.json">JSON Source</a></p>