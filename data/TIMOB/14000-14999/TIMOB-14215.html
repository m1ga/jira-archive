---
title: "[TIMOB-14215] Android: activity.actionBar incompatible with navBarHidden:true"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-07-22T18:48:05.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 15 API, 2013 Sprint 15, Release 3.2.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>actionbar, android, holo, navbarhidden</td></tr>
<tr><th>Reporter</th><td>Romain Salles</td></tr>
<tr><th>Assignee</th><td>Hieu Pham</td></tr>
<tr><th>Created</th><td>2013-05-21T15:03:16.000+0000</td></tr>
<tr><th>Updated</th><td>2013-10-21T23:14:42.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>The issue</h4>

It is not possible to create a window/tabgroup with the property *navBarHidden* set to *true*. Otherwise the app crashes with this error :

<code><pre> 
05-21 14:34:41.200: E/TiApplication(14621): (main) [98,98] Sending event: exception on thread: main msg:java.lang.NullPointerException; Titanium 3.1.0,2013/04/15 18:46,57634ef
05-21 14:34:41.200: E/TiApplication(14621): java.lang.NullPointerException
05-21 14:34:41.200: E/TiApplication(14621): 	at org.appcelerator.titanium.proxy.ActionBarProxy.handleSetTitle(ActionBarProxy.java:154)
05-21 14:34:41.200: E/TiApplication(14621): 	at org.appcelerator.titanium.proxy.ActionBarProxy.handleMessage(ActionBarProxy.java:207)
05-21 14:34:41.200: E/TiApplication(14621): 	at android.os.Handler.dispatchMessage(Handler.java:95)
05-21 14:34:41.200: E/TiApplication(14621): 	at android.os.Looper.loop(Looper.java:137)
05-21 14:34:41.200: E/TiApplication(14621): 	at android.app.ActivityThread.main(ActivityThread.java:4507)
05-21 14:34:41.200: E/TiApplication(14621): 	at java.lang.reflect.Method.invokeNative(Native Method)
05-21 14:34:41.200: E/TiApplication(14621): 	at java.lang.reflect.Method.invoke(Method.java:511)
05-21 14:34:41.200: E/TiApplication(14621): 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
05-21 14:34:41.200: E/TiApplication(14621): 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
05-21 14:34:41.200: E/TiApplication(14621): 	at dalvik.system.NativeStart.main(Native Method)
</pre></code>

<h4>Code to reproduce</h4>

app.js :

<code><pre>
(function() {
	// code with window
	var win = Ti.UI.createWindow({navBarHidden: true, backgroundColor: '#F00'});

	win.addEventListener("open", function(event) {
	    var actionBar = event.source.getActivity().actionBar;
	    if (actionBar) {
	        actionBar.setTitle("Test");
	    }
	});

	win.open();

	// Code with tabbar
	/*var tabGroup = Ti.UI.createTabGroup({navBarHidden: true});

	tabGroup.addEventListener("open", function() {
	    var actionBar = tabGroup.getActivity().actionBar;
	    if (actionBar) {
	        actionBar.setTitle("Test");
	    }
	});

	tabGroup.open();*/
})();
</pre></code>

tiapp.xml :
<code><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ti:app xmlns:ti="<a href="http://ti.appcelerator.org" rel="nofollow" target="_blank">http://ti.appcelerator.org</a>"&gt;
    &lt;id&gt;com.tab.test&lt;/id&gt;
    &lt;name&gt;TabTest&lt;/name&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;publisher&gt;johndoe&lt;/publisher&gt;
    &lt;url&gt;http://&lt;/url&gt;
    &lt;description&gt;not specified&lt;/description&gt;
    &lt;copyright&gt;not specified&lt;/copyright&gt;
    &lt;icon&gt;appicon.png&lt;/icon&gt;
    &lt;persistent-wifi&gt;false&lt;/persistent-wifi&gt;
    &lt;prerendered-icon&gt;false&lt;/prerendered-icon&gt;
    &lt;statusbar-style&gt;default&lt;/statusbar-style&gt;
    &lt;statusbar-hidden&gt;false&lt;/statusbar-hidden&gt;
    &lt;fullscreen&gt;false&lt;/fullscreen&gt;
    &lt;navbar-hidden&gt;false&lt;/navbar-hidden&gt;
    &lt;analytics&gt;false&lt;/analytics&gt;
    &lt;guid&gt;e96a483e-41b2-4212-b78a-910612e01548&lt;/guid&gt;
    &lt;property name="ti.ui.defaultunit" type="string"&gt;system&lt;/property&gt;
    &lt;iphone&gt;
        &lt;orientations device="iphone"&gt;
            &lt;orientation&gt;Ti.UI.PORTRAIT&lt;/orientation&gt;
        &lt;/orientations&gt;
        &lt;orientations device="ipad"&gt;
            &lt;orientation&gt;Ti.UI.PORTRAIT&lt;/orientation&gt;
            &lt;orientation&gt;Ti.UI.UPSIDE_PORTRAIT&lt;/orientation&gt;
            &lt;orientation&gt;Ti.UI.LANDSCAPE_LEFT&lt;/orientation&gt;
            &lt;orientation&gt;Ti.UI.LANDSCAPE_RIGHT&lt;/orientation&gt;
        &lt;/orientations&gt;
    &lt;/iphone&gt;
    &lt;android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;
        &lt;tool-api-level&gt;17&lt;/tool-api-level&gt;
        &lt;manifest&gt;
            &lt;uses-sdk android:minSdkVersion="8"/&gt;
            &lt;!-- TI_MANIFEST --&gt;
            &lt;application android:debuggable="false"
                android:icon="@drawable/appicon" android:label="TabTest"
                android:name="TabtestApplication" android:theme="@android:style/Theme.Holo.Light"&gt;
                &lt;!-- TI_APPLICATION --&gt;
                &lt;activity
                    android:configChanges="keyboardHidden|orientation"
                    android:label="TabTest" android:name=".TabtestActivity"&gt;
                    &lt;intent-filter&gt;
                        &lt;action android:name="android.intent.action.MAIN"/&gt;
                        &lt;category android:name="android.intent.category.LAUNCHER"/&gt;
                    &lt;/intent-filter&gt;
                &lt;/activity&gt;
                &lt;activity
                    android:configChanges="keyboardHidden|orientation" android:name="org.appcelerator.titanium.TiActivity"/&gt;
                &lt;activity
                    android:configChanges="keyboardHidden|orientation"
                    android:name="org.appcelerator.titanium.TiTranslucentActivity" android:theme="@android:style/Theme.Translucent"/&gt;
                &lt;activity
                    android:configChanges="keyboardHidden|orientation"
                    android:name="org.appcelerator.titanium.TiModalActivity" android:theme="@android:style/Theme.Translucent"/&gt;
                &lt;activity
                    android:configChanges="keyboardHidden|orientation" android:name="ti.modules.titanium.ui.TiTabActivity"/&gt;
            &lt;/application&gt;
        &lt;/manifest&gt;
    &lt;/android&gt;
    &lt;modules/&gt;
    &lt;deployment-targets&gt;
        &lt;target device="blackberry"&gt;false&lt;/target&gt;
        &lt;target device="android"&gt;true&lt;/target&gt;
        &lt;target device="ipad"&gt;false&lt;/target&gt;
        &lt;target device="iphone"&gt;false&lt;/target&gt;
        &lt;target device="mobileweb"&gt;false&lt;/target&gt;
    &lt;/deployment-targets&gt;
    &lt;sdk-version&gt;3.1.0.GA&lt;/sdk-version&gt;
&lt;/ti:app&gt;
</pre></code>

<h4>Devices used</h4>

This problem is only reproducible on devices using *Holo*.
I have tested on these devices :

- Samsung S2 (GT-I9100P), android 4.0.3 -> *crash* (supports Holo)
- Nexus S, android 4.1.2 -> *crash* (supports Holo)
- Samsung S3 (GT-I93000), android 4.1.2 -> *crash* (supports Holo)
- HTC Desire HD A9191, android 2.2 -> *ok* (does not supports Holo)
- Samsung GT-S5830, android 2.3.3 -> *ok* (does not support Holo)
- HTC Wildfire A3333, android 2.2.1 -> *ok* (does not support Holo)

<h3>Comments</h3>

<ol>
<li>Romain Salles 2013-05-21

   Note that if you change :
   
   <code><pre>
   var win = Ti.UI.createWindow({navBarHidden: true, backgroundColor: '#F00'});
   </pre></code>
   
   into :
   
   <code><pre>
   var win = Ti.UI.createWindow({navBarHidden: false, backgroundColor: '#F00'});
   </pre></code>
   
   the app will not crash</li>
<li>Tijs Zwinkels 2013-07-07

   I just submitted a [pull request](<a href="https://github.com/appcelerator/titanium_mobile/pull/4437)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4437)</a> that resolves this issue for me.
   [[TC-2577]] is an related issue as it causes a crash on the same source line, and is resolved by the same patch.</li>
<li>Hieu Pham 2013-07-12

   You need to set the targetSDK to 11+ in the manifest to enable ActionBar. Please see <a href="http://docs.appcelerator.com/titanium/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/titanium/latest/#</a>!/guide/Android_Action_Bar for more info. Though we should be performing null checks and warn users when ActionBar is not available. </li>
<li>Hieu Pham 2013-07-12

   master PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/4453" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4453</a></li>
<li>Hieu Pham 2013-07-15

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/4453" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4453</a></li>
<li>Federico Casali 2013-10-21

   Verified fixed.
   
   TiSDK 3.2.0.v20131018154951
   CLI 3.2.0
   Titanium Studio 3.2.0.201310181940
   
   Closing.</li>
</ol>


<p><a href="/TIMOB/TIMOB-14215.json">JSON Source</a></p>