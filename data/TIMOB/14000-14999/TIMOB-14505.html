---
title: "[TIMOB-14505] Android: NullPointerException when reusing an AlertDialog that contains an androidView"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-07-19T21:24:21.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 15 API, 2013 Sprint 15, Release 3.2.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, module_alertdialog, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Paul Mietz Egli</td></tr>
<tr><th>Assignee</th><td>Biju pm</td></tr>
<tr><th>Created</th><td>2013-06-28T16:34:34.000+0000</td></tr>
<tr><th>Updated</th><td>2014-03-14T07:00:06.000+0000</td></tr>
</table>

<h3>Description</h3>

My app reuses an AlertDialog object with a custom view.  The first time I call show() on the dialog, it successfully displays.  When I hide it using either a cancel button or the back button, then redisplay the same dialog object, I get the following NullPointerException:

<code><pre>

E/TiApplication( 2042): java.lang.NullPointerException
E/TiApplication( 2042): 	at org.appcelerator.titanium.TiBaseActivity$DialogWrapper.getActivity(TiBaseActivity.java:103)
E/TiApplication( 2042): 	at ti.modules.titanium.ui.widget.TiUIDialog.processView(TiUIDialog.java:165)
E/TiApplication( 2042): 	at ti.modules.titanium.ui.widget.TiUIDialog.processProperties(TiUIDialog.java:92)
E/TiApplication( 2042): 	at ti.modules.titanium.ui.widget.TiUIDialog.show(TiUIDialog.java:256)
E/TiApplication( 2042): 	at ti.modules.titanium.ui.AlertDialogProxy$1.run(AlertDialogProxy.java:73)
E/TiApplication( 2042): 	at android.os.Handler.handleCallback(Handler.java:615)
E/TiApplication( 2042): 	at android.os.Handler.dispatchMessage(Handler.java:92)
E/TiApplication( 2042): 	at android.os.Looper.loop(Looper.java:137)
E/TiApplication( 2042): 	at android.app.ActivityThread.main(ActivityThread.java:4745)
E/TiApplication( 2042): 	at java.lang.reflect.Method.invokeNative(Native Method)
E/TiApplication( 2042): 	at java.lang.reflect.Method.invoke(Method.java:511)
E/TiApplication( 2042): 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
E/TiApplication( 2042): 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
E/TiApplication( 2042): 	at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime( 2042): FATAL EXCEPTION: main
E/AndroidRuntime( 2042): java.lang.NullPointerException
E/AndroidRuntime( 2042): 	at org.appcelerator.titanium.TiBaseActivity$DialogWrapper.getActivity(TiBaseActivity.java:103)
E/AndroidRuntime( 2042): 	at ti.modules.titanium.ui.widget.TiUIDialog.processView(TiUIDialog.java:165)
E/AndroidRuntime( 2042): 	at ti.modules.titanium.ui.widget.TiUIDialog.processProperties(TiUIDialog.java:92)
E/AndroidRuntime( 2042): 	at ti.modules.titanium.ui.widget.TiUIDialog.show(TiUIDialog.java:256)
E/AndroidRuntime( 2042): 	at ti.modules.titanium.ui.AlertDialogProxy$1.run(AlertDialogProxy.java:73)
E/AndroidRuntime( 2042): 	at android.os.Handler.handleCallback(Handler.java:615)
E/AndroidRuntime( 2042): 	at android.os.Handler.dispatchMessage(Handler.java:92)
E/AndroidRuntime( 2042): 	at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime( 2042): 	at android.app.ActivityThread.main(ActivityThread.java:4745)
E/AndroidRuntime( 2042): 	at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 2042): 	at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime( 2042): 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
E/AndroidRuntime( 2042): 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
E/AndroidRuntime( 2042): 	at dalvik.system.NativeStart.main(Native Method)
</pre></code>

This appears to be happening because the TiUIDialogProxy.hide() method sets the custom view to null.  The workaround is to set the androidView property on the dialog immediately before calling show() instead of setting it in the creation dict as illustrated below:

<code><pre>
var win = Ti.UI.createWindow({
  backgroundColor: 'white'
});
var view = Ti.UI.createView({
});
var alertDialog = Ti.UI.createAlertDialog({
  androidView: view, // for workaround, remove this line
  buttonNames: ["Ok", "Close"],
  cancel: 1
});
var button = Ti.UI.createButton({
  title: 'Show Dialog'
});
button.addEventListener('click', function(e) {
  // alertDialog.androidView = view;  // for workaround, uncomment this line
  alertDialog.show();
});
win.add(button);
win.open();
</pre></code>

<h3>Comments</h3>

<ol>
<li>Carter Lathrop 2013-07-09

   Tested and confirmed on:
   Android GS3 4.1.2
   Ti 3.1.1GA
   </li>
<li>Biju pm 2013-07-12

   PR:-
   <a href="https://github.com/appcelerator/titanium_mobile/pull/4451" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4451</a></li>
<li>Paras Mishra 2013-10-21

   AlertDialog is working fine when contains an androidView. No error occurs.
   
   Verified Fix on:
   Device : Google Nexus 7,  Android Version: 4.3
   SDK: 3.2.0.v20131018154951
   CLI version : 3.2.0
   OS : MAC OSX 10.8.4
   Alloy : 1.2.2
   Appcelerator Studio, build: 3.2.0.201310181700
   XCode : 5</li>
</ol>


<p><a href="/TIMOB/TIMOB-14505.json">JSON Source</a></p>