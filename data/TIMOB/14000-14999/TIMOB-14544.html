---
title: "[TIMOB-14544] iOS: keyboardFrameChanged before keyboard is shown"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-02-25T18:01:39.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 4.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>event, events, ios, keyboard</td></tr>
<tr><th>Reporter</th><td>Tristan Roscoe</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2013-07-12T21:38:11.000+0000</td></tr>
<tr><th>Updated</th><td>2015-03-18T20:53:30.000+0000</td></tr>
</table>

<h3>Description</h3>

keyboardFrameChanged event doesn't do much good as it is fired after the keyboard has already been displayed. to create responsive layouts with different keyboard sizes we need to know keyboard size BEFORE the keyboard is displayed.

iphone/Classes/AppModule.m line 386-407 could be changed to something like this

<code><pre>
-(void)startup
{
	WARN_IF_BACKGROUND_THREAD_OBJ;	//NSNotificationCenter is not threadsafe!
    NSNotificationCenter * nc = [NSNotificationCenter defaultCenter];
    [nc addObserver:self selector:@selector(willShutdown:) name:kTiWillShutdownNotification object:nil];
    [nc addObserver:self selector:@selector(willShutdownContext:) name:kTiContextShutdownNotification object:nil];


#if __IPHONE_OS_VERSION_MIN_ALLOWED &gt;= __IPHONE_5_0
    if ([TiUtils isIOS5OrGreater])
    {
        [nc addObserver:self selector:@selector(keyboardFrameChanged:) name:UIKeyboardWillChangeFrameNotification object:nil];
    }
#else
    
    [nc addObserver:self selector:@selector(keyboardFrameChanged:) name:UIKeyboardWillShowNotification object:nil];
    [nc addObserver:self selector:@selector(keyboardFrameChanged:) name:UIKeyboardWillHideNotification object:nil];
    [nc addObserver:self selector:@selector(timeChanged:) name:UIApplicationSignificantTimeChangeNotification object:nil];
#endif	
    
    [super startup];
}
</pre></code>

Either that or provide access to both Will and Did.

e.x.

<code><pre>
Ti.App.addEventListener('keyboardFrameChanged', function(e){
	var val = Ti.Platform.displayCaps.platformHeight - e.keyboardFrame.y;
	$.container.animate({bottom:val, duration:300}, function() {
        Ti.API.log("handleAnimateEnd");
    });
});
</pre></code>

<h3>Comments</h3>

<ol>
<li>Tristan Roscoe 2013-07-12

   Also if you guys wanted to throw in UIKeyboardAnimationDurationUserInfoKey as an event property that would be extremely useful as well to match layout animation speed.</li>
<li>Mike Butler 2015-02-24

   Folks this one is killing us whenever we want do anything nice in response to the keyboard appearing.  It's even worse  when the keyboard is dismissed - whatever UI we've changed in response to the keyboard is left stranded mid-screen until after  the keyboard has animated offscreen.  No amount of subsequent animation can hide that ugliness.  It makes it look like we haven't put in the time to polish the app.  
   
   We really do need is the will version of the call (with animationDuration if possible)
   
   Any chance this could be bumped up in priority?  </li>
<li>ian young 2015-02-24

   Surely this is kind of fundamental isn't it?</li>
<li>Vishal Duggal 2015-02-24

   Test Case
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor: '#ddd',
       fullscreen:true,
       orientationModes:[1,2,3,4]
   });
    
   var ta = Ti.UI.createTextArea({
       width:Ti.UI.FILL,
       height:100,
       backgroundColor:'yellow',
       top:20
   })
   
   Ti.App.addEventListener('keyboardframechanged',function(e){
       Ti.API.info(JSON.stringify(e));
   })
   
   win.add(ta);
   
   win.open();
   </pre></code></li>
<li>Vishal Duggal 2015-02-24

   Pull pending
   master - <a href="https://github.com/appcelerator/titanium_mobile/pull/6659" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6659</a></li>
<li>Lokesh Choudhary 2015-03-18

   Verified the fix.
   The keyboardFrameChanged event is fired just before the keyboard is shown or hidden.
   Closing.
   
   Environment:
   Appc Studio : 4.0.0.201503161602
   Ti SDK : 4.0.0.v20150313181810
   CLI : 3.5.0-dev
   Alloy : 1.5.1
   MAC Yosemite : 10.10.2
   Iphone 6 - IOS 8.2</li>
</ol>


<p><a href="/TIMOB/TIMOB-14544.json">JSON Source</a></p>