---
title: "[TIMOB-14666] Android: push notification icon does not show the default icon if the chosen one is missing"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 3.2.0, Release 3.2.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>supportTeam</td></tr>
<tr><th>Reporter</th><td>Davide Cassenti</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-07-26T09:14:36.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:03:42.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
When sending a push notification to the device, if the payload contains the icon and the file is not available, or the icon is not specified, the documentation states the default app icon would be used. However, instead of the app icon's, an "information" image is shown instead.

<h4>Steps to reproduce</h4>
Just send a notification to the Android device, with the icon in the Payload. If the icon is not specified, or it does not exist, the wrong icon is shown.

<h4>Additional information</h4>
The documentation says the app icon is used: <a href="http://docs.appcelerator.com/cloud/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/cloud/latest/#</a>!/guide/android-section-7

"If no icon is provided or the provided one is unreachable, the app's icon will be used by default."

<h4>Code to reproduce the issue</h4>
I used the following code to get the notifications and test this. To send a notification, I use the dashboard.

<code><pre>
(function() {
	var platform = null;
	var type = null;
	var deviceToken = null;
	var username = null;
 
	var label = null;
 
	// Cloud modules
	var CloudPush = null; // required for Android
	var Cloud = require('ti.cloud');
 
	function init() {
		platform = Ti.Platform.osname;
		type = platform;
 
		switch(platform) {
			case "iphone":
			case "ipad":
				type = "ios";
				buildUI();
				break;
 
			case "android":
				CloudPush = require("ti.cloudpush");
				CloudPush.debug = true;
 
				buildUI();
				break;
 
			default:
				showError("Platform not supported!");
		}
	}
 
	function buildUI() {
		var win = Ti.UI.createWindow({
		    backgroundColor : 'black',
		    layout: 'vertical'
		});
 
		var title = Ti.UI.createLabel({
			text: "Appcelerator Cloud Services",
			font: {
				fontSize: "20dp"
			},
			color: "white",
			top: "10dp",
			height: Ti.UI.SIZE
		})
 
		win.add(title);
 
		var btn = Ti.UI.createButton({
			title: "Subscribe",
			height: Ti.UI.SIZE,
			top: '10dp'
		});
 
		btn.addEventListener('click', function(e) {
			label.text = "";
 
			// login the default user
			checkUser();
		});
 
		win.add(btn);
 
		label = Ti.UI.createLabel({
			text: "",
			width: Ti.UI.FILL,
			height: Ti.UI.FILL,
			color: "#dddddd",
			top: '10dp'
		});
 
		win.add(label);
 
		win.open();
	}
 
	function checkUser(retrying) {
		Cloud.Users.logout(function (e) {
	    	username = Ti.App.Properties.getString('username');
			if(username) {
				loginUser(retrying);
			} else {
				username = "";
				for(var i=0; i<10; i++) {
					username += ("" + Math.floor(10 * Math.random()));
				}
 
				addLog("Registering user " + username + "...");
				Cloud.Users.create({
					username: username,
			        password: 'logmein',
			        password_confirmation: 'logmein'
			    }, function (e) {
			        if (e.success) {
			            addLog("User registered.");
			            Ti.App.Properties.setString('username', username);
			            loginUser(retrying);
			        } else {
			            showError(e);
			        }
			    });
			} 
	    });
	}
 
	function loginUser(retrying) {
		addLog("Logging in as " + username + "...");
		Cloud.Users.login({
            login : username,
            password : 'logmein'
        }, function(e) {
            if (e.success) {
            	addLog("Logged in as " + username + ".");
                getDeviceToken();
            } else {
            	if(retrying) {
            		showError(e);
            	} else {
	                // try recreating the user
	                Ti.App.Properties.setString('username', null);
	                checkUser(true);
	            }
            }
        });
	}
 
	function getDeviceToken() {
		switch(type) {
		case "android":
			CloudPush.retrieveDeviceToken({
			    success : registrationSuccess,
			    error : showError
			});
			break;
 
		case "ios":
			Titanium.Network.registerForPushNotifications({
				types: [
					Titanium.Network.NOTIFICATION_TYPE_ALERT
				],
 
				success: registrationSuccess,
				error: showError,
				callback: handleNotification
			});
			break;
		}
	}
 
	function defaultUnsubscribe() {
		Cloud.PushNotifications.unsubscribe({
			device_token: deviceToken
		}, function(e) {
			defaultSubscribe();
		});
	}
 
	function defaultSubscribe() {
		Cloud.PushNotifications.subscribe({
			channel: 'alert',
			type: type,
			device_token: deviceToken
		},
			function (e) {
				if (e.success) {
					addLog("Subscribed to the alert channel");
				} else {
					addLog("Already subscribed to the alert channel");
				}
 
				addLog("Ready to receive notifications");
			});
 
		switch(type) {
		case "android":
		    CloudPush.addEventListener('callback', function(e) {
			    handleNotification(e);
			});
		}
	}
 
	function registrationSuccess(e) {
		deviceToken = e.deviceToken;
		addLog("Got device token: " + deviceToken);
 
		if(platform == "android") {
			CloudPush.enabled = true;
		}
 
		defaultUnsubscribe();
	}
 
	function showError(e) {
		alert('Error: ' + ((e.error && e.message) || JSON.stringify(e)));
	}
 
	function handleNotification(e) {
		addLog("Notification received");
		if(e && e.payload && e.payload.alert) {
			alert(e.payload.alert);
		} else {
			alert(JSON.stringify(e));
		}
	}
 
	function addLog(text) {
		label.text = label.text + "\n" + text;
	}
 
	init();
})();
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-14666_45991/device-2014-02-18-134423.png">device-2014-02-18-134423.png</td></td><td>2014-02-18T07:46:56.000+0000</td><td>35747</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Martin N 2014-03-12

   This also affects 3.2.2. Doesn't show the default icon/appicon, when "icon" is not specified.</li>
<li>Manuel Lehner 2015-07-07

   Please open source ti.cloudpush - would like to help here</li>
</ol>


<p><a href="/TIMOB/TIMOB-14666.json">JSON Source</a></p>