---
title: "[TIMOB-14740] Android: Automatically generate ProGuard configuration file"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android, CLI</td></tr>
<tr><th>Labels</th><td>exalture, notable</td></tr>
<tr><th>Reporter</th><td>Soumya Kanti Kar</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2013-07-31T10:49:01.000+0000</td></tr>
<tr><th>Updated</th><td>2019-11-07T00:40:12.000+0000</td></tr>
</table>

<h3>Description</h3>

Hi,

Create a sample Android module and build it. Then follow this step by step.

1. Extract the contents of the zip file inside the dist folder.
2. Extract the JAR file obtained from the zip file.
3. Use JAD (Decompile tool) to decompile the any *.class file.

You will observe that the entire source code is displayed. There is no obfuscation. I think Appcelerator must provide an obfuscation procedure during the build process.

If any such process is present (using ProGuard for example), then can you please let us know. If no such process exists then it will be a great idea to add this feature. This will increase the security and also reduce the module size.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-14740_52147/com.proguard.android.zip">com.proguard.android.zip</td></td><td>2014-10-23T22:45:22.000+0000</td><td>1273</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-14740_52146/proguard_app.zip">proguard_app.zip</td></td><td>2014-10-23T22:44:44.000+0000</td><td>641685</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Soumya Kanti Kar 2013-08-02

   ProGuard can be used on the JAR that is created after building the Android module. We need to extract the JAR from the modile ZIP. Use ProGuard on the JAR keeping the classes that extend KrollModule and TiViewProxy. Repack the ZIP file. Then use the modified ZIP file in Appcelerator projects.</li>
<li>Chris Barber 2014-01-16

   What's the immediate danger in allowing the .class files to be decompiled. They can just go to <a href="https://github.com/appcelerator/titanium_mobile" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile</a> and see the source with comments!</li>
<li>Ingo Muschenetz 2014-04-14

   Note that you can use obfuscation now. This is a ticket to automatically generate the ProGuard file.</li>
<li>Ingo Muschenetz 2014-04-28

   Note, here is a sample ProGuard file for Titanium. This may need to be updated to fit your usage (especially the file paths)!
   
   <code><pre>
   <h4>keep titanium class / package names</h4>
   -keepnames class org.appcelerator.** 
   -keepnames class com.appcelerator.**
   -keepnames class ti.**
   -keepnames class android.widget.*
   -keepnames class kankan.wheel.widget.*-
   -keepnames class org.mozilla.javascript.**
    
   <h4>TODO: generate app ID here -keepnames com.company.id.**</h4>
   -keepnames class com.arcaner.proguard.test1.**
   -keeppackagenames
    
   <h4>preverification does nothing for dex</h4>
   -dontpreverify
    
   <h4>allows further optimization of getter/setter -&gt; directly to field</h4>
   -allowaccessmodification
    
   <h4>dalvik specific optimization flags</h4>
   -optimizations !code/simplification/arithmetic
    
   <h4>app classes</h4>
   -injars /Users/username/Code/test/titanium/proguardTest1/build/android/bin/classes
    
   <h4>module jars</h4>
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-accelerometer.jar(!**/accelerometer.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-analytics.jar(!**/analytics.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-android.jar(!**/android.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-api.jar(!**/api.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-app.jar(!**/app.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-bump.jar(!**/bump.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-calendar.jar(!**/calendar.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-contacts.jar(!**/contacts.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-database.jar(!**/database.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-facebook.jar(!**/facebook.json,!META-INF/MANIFEST.MF,!**/LICENSE)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-filesystem.jar(!**/filesystem.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-geolocation.jar(!**/geolocation.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-gesture.jar(!**/gesture.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-json.jar(!**/json.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-locale.jar(!**/locale.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-map.jar(!**/map.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-media.jar(!**/media.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-network.jar(!**/network.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-platform.jar(!**/platform.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-ui.jar(!**/ui.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-utils.jar(!**/utils.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-xml.jar(!**/xml.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium-yahoo.jar(!**/yahoo.json,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/support/android/lib/titanium-verify.jar(!**/.gitignore,!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/dist/android/titanium.jar(!**/titanium.json,!META-INF/MANIFEST.MF,!**/*-NOTICE.txt,!**/.gitignore)
    
   <h4>bundled libs</h4>
   -injars /Users/username/Code/titanium_mobile/android/titanium/lib/ti-commons-codec-1.3.jar(!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/android/titanium/lib/commons-logging-1.1.1.jar(!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/android/titanium/lib/smalljs.jar(!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/android/modules/xml/lib/jaxen-1.1.1.jar(!META-INF/MANIFEST.MF)
   -injars /Users/username/Code/titanium_mobile/android/modules/bump/lib/bump-api.jar(!META-INF/MANIFEST.MF)
    
   <h4>library jars</h4>
   #-libraryjars /Users/username/Code/titanium_mobile/android/kroll-apt/lib/freemarker.jar
   -libraryjars /Users/username/Apps/android-sdk-mac_86/platforms/android-4/android.jar
   -libraryjars /Users/username/Apps/android-sdk-mac_86/add-ons/google_apis-4_r02/libs/maps.jar
    
   <h4>misc options</h4>
    
   <h4>commons codec/logging use a lot of reflection don't warn</h4>
   -dontwarn org.apache.commons.codec.binary.Base64
   -dontwarn org.apache.commons.codec.binary.Hex
   -dontwarn org.apache.commons.logging.impl.ServletContextCleaner
   -dontwarn org.apache.commons.logging.impl.LogKitLogger
   -dontwarn org.apache.commons.logging.impl.AvalonLogger
   -dontnote org.apache.commons.logging.Log
   -dontnote org.apache.commons.logging.LogSource
   -dontnote org.apache.commons.logging.impl.Log4JLogger
   -dontnote org.apache.james.mime4j.message.storage.TempStorage
   
    
   <h4>bytecode compiled JS uses reflection to bootstrap</h4>
   -dontnote org.appcelerator.titanium.TiScriptRunner
    
   <h4>we use reflection for contacts api support post android r4</h4>
   -dontnote ti.modules.titanium.contacts.CommonContactsApi
   -dontnote ti.modules.titanium.contacts.ContactsApiLevel5
    
   <h4>reflection used to get the internal "applicationScale" member in TiPlatformHelper</h4>
   -dontnote org.appcelerator.titanium.util.TiPlatformHelper
    
   <h4>thirdparty classes</h4>
    
   -keep class org.mozilla.javascript.jdk13.VMBridge_jdk13
    
   <h4>app classes</h4>
    
   -keep class com.arcaner.proguard.test1.*
    
   <h4>module classes / methods</h4>
    
   -keep class ti.modules.titanium.TitaniumModuleBindingGen
   -keep class ti.modules.titanium.ui.UIModule
   -keep class ti.modules.titanium.ui.UIModuleBindingGen
   -keep class ti.modules.titanium.filesystem.FilesystemModule
   -keep class ti.modules.titanium.filesystem.FilesystemModuleBindingGen
   -keep class ti.modules.titanium.json.JSONModule
   -keep class ti.modules.titanium.json.JSONModuleBindingGen
   -keep class ti.modules.titanium.locale.LocaleModuleBindingGen
   -keep class ti.modules.titanium.android.AndroidModuleBindingGen
   -keep class ti.modules.titanium.app.AppModuleBindingGen
   -keep class ti.modules.titanium.api.APIModuleBindingGen
   -keep class ti.modules.titanium.media.MediaModuleBindingGen
   -keep class ti.modules.titanium.analytics.AnalyticsModuleBindingGen
    
   <h4>proxy binding classes</h4>
   -keep class org.appcelerator.titanium.**BindingGen
   -keep class ti.modules.titanium.ui.WindowProxyBindingGen
   -keep class ti.modules.titanium.ui.ButtonProxyBindingGen
   -keep class ti.modules.titanium.ui.LabelProxyBindingGen
   -keep class ti.modules.titanium.filesystem.FileProxyBindingGen
   </pre></code></li>
<li>Ingo Muschenetz 2014-04-28

   To use the ProGuard file:
   
   1. Put a file called "proguard.cfg" in the project/platform/android directory
   2. Create a CLI hook that ties into the pre-compile hook and sets builder.proguard to true.
   </li>
<li>Ingo Muschenetz 2014-08-14

   Note, to configure for Crittercism: <a href="http://docs.crittercism.com/android/android.html#configuring-proguard-symbolication" rel="nofollow" target="_blank">http://docs.crittercism.com/android/android.html#configuring-proguard-symbolication</a></li>
<li>Ingo Muschenetz 2014-09-09

   It would b worth figuring out what a proper manually-generated ProGuard file looks like these days, and the algorithm for creating one.</li>
<li>Alan Leard 2014-10-23

   I have attached a sample app that has Proguard enabled with the 3.4 SDK.  It has a hacked together proguard.cfg file that probably needs some fixing, but the app and the plugin work.  I will attach separately the Proguard plugin that is used in the app.</li>
<li>Alan Leard 2014-10-23

   Here is the plugin required to manually enabled proguard.  To enable, follow these steps:
   
   1. Create plugins folder if one does not already exist
   2. Add the attached plugin com.proguard.android to the plugins directory
   3. Enable the plugin in tiapp.xml by adding
   <code><pre>
   &lt;plugins&gt;
        &lt;plugin&gt;com.proguard.android&lt;/plugin&gt;
   &lt;/plugins&gt;
   </pre></code>
   4. Add the ‘proguard.cfg' file in platform/android/ directory</li>
<li>Stephen Feather 2014-10-29

    Alan, thank you.  I'll try to get it put into an app tomorrow for testing.</li>
<li>Travis Crist 2014-11-25

    </li>
<li>Stephen Feather 2014-11-25

    I had to modify it all a bit. used -outjar to generated an intermediate jar that was reduced, then modify my proguard config to use it and not the regular jars and my apk was smaller.
    
    Ended up being faster at times, using google-play-services.jar for example, to use JarJar links to just clean that jar of unused methods before building and just skipping proguard.
    
    With libraries such as AWS, the proguard.cfg takes so long to setup and begin to declaring the used methods that its just a lot of wasted time. (no, the AWS recommended proguard.cfg does not work correctly out of the repo)</li>
<li>Mark Mokryn 2014-12-05

    </li>
<li>Ingo Muschenetz 2015-09-15

    [~hpham] [~cbarber] thoughts?</li>
<li>Thomas Colliers 2015-11-06

    I've been trying to get this working. As mentioned before, the plugin and sample attached here do run ProGuard but do nothing with the output. Like Stephen I used -outjars to specify an output directory but I'm not sure how to make dexer pick up the processed folder instead of the original classes folder.</li>
<li>Thomas Colliers 2015-11-06

    After many trial and error I finally got it working. I added 2 more event listeners to the plugin that move the classes folder to a temporary folder, proguard will then write to the classes directory so dexer can pick up the right files. I would attach the updated plugin and the proguard configuration I'm using but it seems I am unable to.</li>
<li>Eduardo Gomez 2015-12-21

    [~thomascolliers] can you elaborate what did you have add to the event listeners? Probably post a dropbox link of plugin? </li>
<li>Thomas Colliers 2015-12-30

    Here's the plugin code I'm using to switch out the Proguard output with the unobfuscated output so dexer can pick it up: (Linux/OSX only)
    <a href="https://paste.ee/p/8Y7tG" rel="nofollow" target="_blank">https://paste.ee/p/8Y7tG</a></li>
<li>Gary Mathews 2017-10-11

    Like [~jquick] and [~cbarber] mentioned, running ProGuard on a Titanium project will offer little to no benefit. The ProGuard config file provided seems to whitelist all of our Titanium namespaces which means they won't be optimised and obfuscated. Nor can they be, due to Titaniums use of reflection.
    
    The only benefit to running ProGuard would be in optimising the use of third-party libraries, reducing final APK size. ProGuard is marketed as a "source optimizer" and not a security measure (for that they suggest DexGuard). So if optimising is the priority, maybe [ReDex](<a href="https://github.com/facebook/redex)" rel="nofollow" target="_blank">https://github.com/facebook/redex)</a> would be worth looking into? Since it will work regardless of our reflection requirements.</li>
<li>Ben Bahrenburg 2017-10-11

    [~gmathews] I understand that the proxies cannot be obfuscated but shouldn't any internal classes be able to be obfuscated?  This allows for any more sensitive operation to be moved into a plain old Java class.
    
    Without some form of obfuscation this will be a high / medium finding on any enterprise security review.</li>
<li>Joshua Quick 2017-10-11

    [~ben.bahrenburg@gmail.com], Titanium and its modules are open source. So, obfuscating the code doesn't make a lot of sense (you can freely see the code on github). Just like how Google doesn't bother obfuscating their own open source Android libraries such as their support libraries. Plus, there is no 100% full-proof/future-proof automated way of obfuscating the code without issues since 3rd party code is out of our control and obfuscation would break their usage of reflection too... or features which use reflection indirectly such as via Java Serialization, GSON, HyperLoop, or possibly other means.
    
    If you're worried about code being tampered with (ie: your APK decompiled, code changed, re-compiled, and re-signed), then I think a better solution would be "tamper detection". This is what code signing is for. So, I think what you're really after here is the ability to check on startup that your APK is signed with the signature you originally signed it with. What do you think?</li>
<li>Ben Bahrenburg 2017-10-12

    [~jquick] I 100% agree with your statement for commercial apps. The trouble happens when you enter the enterprise space.  The approach you mention, ie don't obfuscate, doesn't match the OWASP guidelines, which govern most of the industry <a href="https://www.owasp.org/index.php/OWASP_Mobile_Security_Testing_Guide" rel="nofollow" target="_blank">https://www.owasp.org/index.php/OWASP_Mobile_Security_Testing_Guide</a> 
    
    If this was native, the developer would need to determine the best proguard settings to cover both the app and their dependencies.  I would recommend that we allow for the same opportunity for Ti.  This does a few things. First allows your enterprise customers the flexibility in a "safe space" to be able show they are meeting the OWASP requirement.  Secondly it allows the non proxy objects in the Ti framework or modules to be obfuscate.  This allows for the ecosystem to more easily create the "tamper detection" methods you mentioned.
    
    Please note I've implemented the OWASP tamper detection methods within Titanium.  I'm happy to discuss how these could be contributed back to the community.
    
    </li>
<li>Joshua Quick 2017-10-12

    [~ben.bahrenburg@gmail.com], probably the simplest solution would be to set up ProGuard to not obfuscate anything using a Java @Kroll annotation. That would likely cover most of the reflection issues between JavaScript and Java in Titanium. That and any classes referenced in the AndroidManifest.xml would have to be on the list too.
    
    But from there, I think it would have to be the app developer's responsibility to disable obfuscation for any other APIs reflected upon via 3rd party code or by the app developer via HyperLoop. That's where I think we can't provide a 100% full-proof solution. But that said, it's not any better for a native developer using Android Studio either.
    
    Hmm...</li>
<li>Ben Bahrenburg 2017-10-12

    Thanks [~jquick] . I think this would give the Ti developers the same footing, if not better (given JS encryption) than native developers.  Is there anything that I can help with implementing or testing?  Additionally happy to contribute the tamper methods if that would be helpful to core or AppC.</li>
<li>Eric Merriman  2017-10-31

    Hello all, due to the volume of items and the schedule for 7.0.0 and the technological challenge for this feature, this ticket will be moved to 7.1.0. </li>
<li>Muhammad Ahmed Fahad 2017-12-08

    Would really love to see this soon. Without this apps with multiple dex files are getting created which is totally incompatible with Android 4.X.X</li>
<li>Joshua Quick 2018-01-24

    [~fahad86], in the upcoming Titanium 7.0.2 release, multidex'ed apps will be able to run on Android 4.x (see [TIMOB-25597]). ProGuard is not required. It'll just work.</li>
<li>Muhammad Ahmed Fahad 2018-01-24

    @Joshua Quick :D happy for this. Thank you very much.</li>
</ol>


<p><a href="/TIMOB/TIMOB-14740.json">JSON Source</a></p>