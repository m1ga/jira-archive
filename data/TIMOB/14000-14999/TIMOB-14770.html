---
title: "[TIMOB-14770] Android: Return statement undefined (only Distribution build)"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2013-09-09T00:24:20.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.1</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 18, 2013 Sprint 18 API</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>ipass1, regression, supportTeam, triage</td></tr>
<tr><th>Reporter</th><td>Eduardo Gomez</td></tr>
<tr><th>Assignee</th><td>Hieu Pham</td></tr>
<tr><th>Created</th><td>2013-08-06T16:39:48.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-28T20:27:08.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
On signed APK Android distribution.

Issue: while installing directly to device from studio or while loading the unsigned APK (app.apk within build folder-> bin) App works fine. But the signed APK not working. Activity indicator keeps on spinning.

<h4>Background</h4>
Have been using 3.0.2 GA and migrated to 3.1.1 GA recently. Facing this issue after the migration.

<h4>Its working fine up to 3.0.2.GA Distribution</h4>

Analytics & JS Minification are already disabled. Still on direct installation to device/the unsigned APK is working fine. Have attached the required logs. 

<h4>Additional info</h4>
Added device stack trace and 'mApprovalsTest' sample. Unsigned APK launches correctly meanwhile error can be reproduced with a Signed APK.

<h4>Steps to reproduce</h4>
Please Walkthrough through the following steps (first with unsigned APK then proceed with signed APK). Install APK to device via adb in terminal, copy to SD card or bluetooth share.

(1) Click "Submit" in first screen
(2) Click left most title (that is "Purchase Requisition with count 5") in home screen.
(3) Indicator ll be loading and next screen with a tableview is loaded. Here is where on direct install / unsigned works but in signed Version indicator keeps loading/spinning.

<h4>Device output</h4>
<h4>Unsigned APK</h4>
<code><pre>
08-14 12:58:12.020: D/Window(7320): Checkpoint: postWindowCreated()
08-14 12:58:12.020: D/Module(7320): Loading module: /Data/generatePR -&gt; Resources/Data/generatePR.js
08-14 12:58:12.027: D/Module(7320): Loading module: /requestBuilder/prPendingRequestBuilder -&gt; Resources/requestBuilder/prPendingRequestBuilder.js
08-14 12:58:12.051: D/Module(7320): Loading module: settings -&gt; Resources/settings.js
08-14 12:58:12.066: I/TiAPI(7320):  ****notifyResponseText{"P_NOTIF_LIST_ITEM":[{"NOTIFICATION_ID":"89901602","SUBJECT":"Second Reminder: Purchase Requisition 1329470 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:55.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329470","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329470","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901603","SUBJECT":"Second Reminder: Purchase Requisition 1329471 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:55.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329471","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329471","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901627","SUBJECT":"Second Reminder: Purchase Requisition 1329500 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:58.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329500","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329500","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901628","SUBJECT":"Second Reminder: Purchase Requisition 1329502 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:59.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329502","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329502","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901629","SUBJECT":"Second Reminder: Purchase Requisition 1329503 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:59.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329503","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329503","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},null]}
08-14 12:58:12.066: I/TiAPI(7320):  **** so far so good[object Object],[object Object],[object Object],[object Object],[object Object]
08-14 12:58:12.066: D/Module(7320): Loading module: /controller/PRpending -&gt; Resources/controller/PRpending.js
08-14 12:58:12.184: D/Module(7320): Loading module: /ui/android/prPendingScreen -&gt; Resources/ui/android/prPendingScreen.js
08-14 12:58:12.246: I/dalvikvm(7320): Failed resolving Lti/modules/titanium/ui/widget/searchview/TiUISearchView; interface 613 'Landroid/widget/SearchView$OnQueryTextListener;'
08-14 12:58:12.246: W/dalvikvm(7320): Link of class 'Lti/modules/titanium/ui/widget/searchview/TiUISearchView;' failed
08-14 12:58:12.246: E/dalvikvm(7320): Could not find class 'ti.modules.titanium.ui.widget.searchview.TiUISearchView', referenced from method ti.modules.titanium.ui.widget.TiUITableView.processProperties
08-14 12:58:12.246: W/dalvikvm(7320): VFY: unable to resolve check-cast 1881 (Lti/modules/titanium/ui/widget/searchview/TiUISearchView;) in Lti/modules/titanium/ui/widget/TiUITableView;
08-14 12:58:12.246: D/dalvikvm(7320): VFY: replacing opcode 0x1f at 0x0110
08-14 12:58:12.246: D/dalvikvm(7320): VFY: dead code 0x0112-0118 in Lti/modules/titanium/ui/widget/TiUITableView;.processProperties (Lorg/appcelerator/kroll/KrollDict;)V
08-14 12:58:12.270: I/ActivityManager(498): Starting: Intent { cmp=com.agilent.mApprovalsTest/org.appcelerator.titanium.TiActivity (has extras) } from pid 7320
08-14 12:58:12.379: D/dalvikvm(7320): GC_EXTERNAL_ALLOC freed 684K, 40% free 4324K/7175K, external 7682K/8885K, paused 35ms
</pre></code>

<h4>Signed APK (Enabled Javascript Minification)</h4>
<code><pre>
08-14 13:04:34.332: D/dalvikvm(7000): GC_EXPLICIT freed 50K, 44% free 3013K/5379K, external 2357K/2773K, paused 165ms
08-14 13:04:34.902: I/TiAPI(7564):  ****notifyResponseText{"P_NOTIF_LIST_ITEM":[{"NOTIFICATION_ID":"89901602","SUBJECT":"Second Reminder: Purchase Requisition 1329470 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:55.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329470","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329470","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901603","SUBJECT":"Second Reminder: Purchase Requisition 1329471 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:55.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329471","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329471","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901627","SUBJECT":"Second Reminder: Purchase Requisition 1329500 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:58.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329500","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329500","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901628","SUBJECT":"Second Reminder: Purchase Requisition 1329502 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:59.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329502","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329502","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901629","SUBJECT":"Second Reminder: Purchase Requisition 1329503 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:59.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329503","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329503","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},null]}
08-14 13:04:34.902: I/TiAPI(7564):  **** so far so good[object Object],[object Object],[object Object],[object Object],[object Object]
08-14 13:04:35.066: E/TiExceptionHandler(7564): (main) [10723,10723] ----- Titanium Javascript Runtime Error -----
08-14 13:04:35.066: E/TiExceptionHandler(7564): (main) [0,10723] - In controller/PRpending.js:15,69
08-14 13:04:35.066: E/TiExceptionHandler(7564): (main) [0,10723] - Message: Uncaught TypeError: undefined is not a function
08-14 13:04:35.066: E/TiExceptionHandler(7564): (main) [1,10724] - Source: t("PRrfiAnswer",{rowIndex:e,comment:f}))}}});u.push(f)}k=="android"?v(u,s,i):v
08-14 13:04:35.066: E/V8Exception(7564): Exception occurred at controller/PRpending.js:15: Uncaught TypeError: undefined is not a function
08-14 13:04:39.254: D/dalvikvm(7014): GC_EXPLICIT freed 925K, 50% free 3139K/6215K, external 2357K/2773K, paused 83ms
08-14 13:04:41.645: D/LSAPP_TelMon(773): onCellTowerChanged CDMA :: {"NetTyp":"CDMA","BaseStnLat":"297036","NetOp":"33404","BaseStnId":"505","BaseStnLng":"-1488748","CntryISO":"mx","NetId":"0","SysId":"24587"}
08-14 13:04:41.668: D/LSAPP_TelMon(773): Telmon : celltower changed...new cell...clear bouncing cells upon new cell and no pending timer 
</pre></code>

<h4>Signed APK (Disabled Javascript Minification)</h4>
<code><pre>
08-14 13:30:58.154: I/TiAPI(8566):  ****notifyResponseText{"P_NOTIF_LIST_ITEM":[{"NOTIFICATION_ID":"89901602","SUBJECT":"Second Reminder: Purchase Requisition 1329470 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:55.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329470","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329470","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901603","SUBJECT":"Second Reminder: Purchase Requisition 1329471 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:55.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329471","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329471","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901627","SUBJECT":"Second Reminder: Purchase Requisition 1329500 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:58.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329500","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329500","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901628","SUBJECT":"Second Reminder: Purchase Requisition 1329502 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:59.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329502","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329502","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},{"NOTIFICATION_ID":"89901629","SUBJECT":"Second Reminder: Purchase Requisition 1329503 for LE, TIEN MINH (24.06 USD)","BEGIN_DATE":"2013-08-12T23:22:59.000-06:00","TYPE_OF_MSG":"Purchase Requisition","PO_REQ_NO":"1329503","FROM_USER":"LE, TIEN MINH","TOTAL_AMT":"24.06 USD","URGENT_REQ_FLAG":"N","PR_NUMBER":"1329503","STATUS":null,"VENDOR_NAME":"TELEPRESS INC"},null]}
08-14 13:30:58.154: I/TiAPI(8566):  **** so far so good[object Object],[object Object],[object Object],[object Object],[object Object]
08-14 13:30:58.303: E/TiExceptionHandler(8566): (main) [8879,8879] ----- Titanium Javascript Runtime Error -----
08-14 13:30:58.303: E/TiExceptionHandler(8566): (main) [0,8879] - In controller/PRpending.js:15,69
08-14 13:30:58.303: E/TiExceptionHandler(8566): (main) [0,8879] - Message: Uncaught TypeError: undefined is not a function
08-14 13:30:58.303: E/TiExceptionHandler(8566): (main) [0,8879] - Source: t("PRrfiAnswer",{rowIndex:e,comment:f}))}}});u.push(f)}k=="android"?v(u,s,i):v
08-14 13:30:58.303: E/V8Exception(8566): Exception occurred at controller/PRpending.js:15: Uncaught TypeError: undefined is not a function
08-14 13:30:59.631: D/dalvikvm(869): GC_EXPLICIT freed 2206K, 48% free 4860K/9223K, external 9213K/9392K, paused 73ms
08-14 13:30:59.998: I/AlarmManager(498): sending alarm Alarm{40667b50 type 1 android}
</pre></code>

<h4>Root cause</h4>
On "Resources/controller/PRPending.js" (near the very top) just add the following to notice the issue:
<code><pre>
exports.populatePrPendingTable = function(parsedArray, managerId, Token, callback) {
    alert(  'Ti.App.densityFactor: ' + Ti.App.densityFactor);
    alert(  'callback: ' + callback);
</pre></code>

<h4>Deployment build:</h4>
<code><pre>
08-19 16:15:59.223: D/Module(22337): Loading module: /controller/PRpending -&gt; Resources/controller/PRpending.js
08-19 16:15:59.246: I/ALERT(22337): (KrollRuntimeThread) [8276,8276] Ti.App.densityFactor: 1.5
08-19 16:15:59.246: I/ALERT(22337): (KrollRuntimeThread) [1,8277] callback: function createPR(tableData, topView, alertView) {
08-19 16:15:59.246: I/ALERT(22337):                         if (tableData != 'Error') {
08-19 16:15:59.246: I/ALERT(22337):                             //cover.hide();
08-19 16:15:59.246: I/ALERT(22337):                             //  alert('last'+topView);
08-19 16:15:59.246: I/ALERT(22337):                             require('/ui/android/prPendingScreen').prPendingWindow(prNotificationCount, tableData, topView, alertView, initService);
08-19 16:15:59.246: I/ALERT(22337):                             setTimeout(function() {
08-19 16:15:59.246: I/ALERT(22337):                                 cover.hide();
08-19 16:15:59.246: I/ALERT(22337):                                 Ti.API.info(' ### Hide cover.hide() newHome ');
08-19 16:15:59.246: I/ALERT(22337):                             }, 3000);
08-19 16:15:59.246: I/ALERT(22337):                             //  openContainerWindow = require('ui/PRpendingscreen').prPendingTable(managerId, token, from, navGroup, prNotificationCount, prData);
08-19 16:15:59.246: I/ALERT(22337):                         } else {
08-19 16:15:59.246: I/ALERT(22337):                             cover.hide();
08-19 16:15:59.246: I/ALERT(22337):                             Ti.API.info(' ### Hide cover.hide() newHome else ');
08-19 16:15:59.246: I/ALERT(22337):                         }
08-19 16:15:59.246: I/ALERT(22337):                     }
08-19 16:15:59.324: D/Module(22337): Loading module: /ui/android/prPendingScreen -&gt; Resources/ui/android/prPendingScreen.js
</pre></code>

<h4>Distribution build:</h4>
<code><pre>
08-19 16:23:40.270: I/ALERT(22796): (KrollRuntimeThread) [6513,6513] Ti.App.densityFactor: 1.5
08-19 16:23:40.270: I/ALERT(22796): (KrollRuntimeThread) [0,6513] callback: undefined
08-19 16:23:40.418: E/TiExceptionHandler(22796): (main) [150,6663] ----- Titanium Javascript Runtime Error -----
08-19 16:23:40.418: E/TiExceptionHandler(22796): (main) [0,6663] - In controller/PRpending.js:16,69
08-19 16:23:40.418: E/TiExceptionHandler(22796): (main) [0,6663] - Message: Uncaught TypeError: undefined is not a function
08-19 16:23:40.418: E/TiExceptionHandler(22796): (main) [0,6663] - Source: .info("Fire Event (PRrfiAnswer): "+c+d))}}});v.push(d)}h=="android"?u(v,s,i):u
08-19 16:23:40.418: E/V8Exception(22796): Exception occurred at controller/PRpending.js:16: Uncaught TypeError: undefined is not a function
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-14770_41327/diagnosticLog.rtf">diagnosticLog.rtf</td></td><td>2013-08-06T16:39:48.000+0000</td><td>14758</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-14770_41328/studioLog.rtf">studioLog.rtf</td></td><td>2013-08-06T16:39:48.000+0000</td><td>2441728</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-14770_41329/TiAppXMl.rtf">TiAppXMl.rtf</td></td><td>2013-08-06T16:39:48.000+0000</td><td>5329</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ping Wang 2013-08-08

   Eduardo, can you provide a reproducible test case? I packaged a very simple test case which is attached below with 3.1.1.GA and the latest master, and installed it on Galaxy Nexus (4.1.1) using the command "adb install xxx.apk". The app works fine.
   <code><pre>
   var win = Ti.UI.createWindow({
   	backgroundColor : '#000',
   	layout : 'vertical',
   	navBarHidden : false
   });
   
   var view = Ti.UI.createView({
   	width : 200,
   	height : 200,
   	backgroundColor : 'red'
   });
   
   win.add(view);
   
   win.open(); 
   </pre></code></li>
<li>Hieu Pham 2013-08-14

   How are you installing the signed apk? I use 'adb install' on the packaged build and it works fine for me.</li>
<li>Eduardo Gomez 2013-08-14

   [Install instructions moved to description]</li>
<li>Eric Merriman  2017-03-28

   Closing</li>
</ol>


<p><a href="/TIMOB/TIMOB-14770.json">JSON Source</a></p>