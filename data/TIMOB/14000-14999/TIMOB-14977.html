---
title: "[TIMOB-14977] Android Build: Compile resources"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-10-05T02:14:27.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 20, 2013 Sprint 20 Core, Release 3.2.0</td></tr>
<tr><th>Components</th><td>Android, Tooling</td></tr>
<tr><th>Labels</th><td>androidbuild, ay-verified, cb-verified</td></tr>
<tr><th>Reporter</th><td>Chris Barber</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2013-08-27T23:38:08.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T00:11:57.000+0000</td></tr>
</table>

<h3>Description</h3>

* compile resources
** copy Resources directory (exclude all platform directories)
*** load dependency.json
*** load modules.json
*** handle tiapp.xml "ti.android.include_all_modules" property
*** walk specified directory
**** ignore globally ignored files and directories (TIMOB-2733 Android: Getting Error at Rebuilding after changing tiapp.xml) (TIMOB-7816 Android: Ignore files that start with ._)
**** if file is a html file, scan for all <script> tags and mark all app:// URLs to the js minification exclusion list
**** if file is a jss file, ignore it
**** if file is a js file:
***** AST parse the .js files to find Titanium symbols
****** keep track of what Titanium APIs are being used
***** fire "build.android.compileJsFile" function hook
****** minify the .js files using UglifyJS instead of Closure Compiler (TIMOB-2662 android SDK > 1.5.0 "Compiling Javascript Resources" each time) (TIMOB-13974 Android: KS takes a long time to package - I've seen nine minutes, others report longer in some cases)
****** NOTE: make sure we can read utf-8 encoded .js files (TIMOB-3186 Android: Persistent internal compiler error)
**** if file is a drawable resources, copy it to the drawable directories
***** warn if copying duplicate drawable dirs (i.e. high/medium/low => hdpi/mdpi/ldpi)
***** allow either .jpg or .png files (TIMOB-6666 Android: Allow users to specify "Default.jpg" in place of "Default.png")
***** copy xhdpi images (TIMOB-7827 Android: Please add support for extrahigh density (320 dpi) devices)
**** else copy the file
**** NOTE: for each file copied, be sure to fire "build.android.copyResource" function hook
** copy Resources/android
*** same as copy Resources
** copy platform/android
*** same as copy Resources
*** NOTE: be sure all files are merge such as res/layout files (TIMOB-12372 Android: Layout resources in res/layout/filename.xml no longer work)
** copy module resources
*** same as copy Resources
** copy commonjs modules
*** same as copy Resources

<h3>Comments</h3>

<ol>
<li>Darren Haligas 2013-09-25

   Chris, I was able to reduce my compile time on 3.1.3 by changing these lines in compiler.py
   
   	jsc_args = [
               'uglifyjs',
               fullpath,
               '-o',
               fullpath + '-compiled',
               '-c'
   			]
   
   It has reduced by compile time by 80% (52 seconds / 4 min 30 seconds).
   
   Have you seen any js compile issues with uglifyjs I should watch out for?</li>
<li>Chris Barber 2013-10-05

   Pull request: <a href="https://github.com/appcelerator/titanium_mobile/pull/4760" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4760</a></li>
<li>Lee Morris 2017-03-22

   Closing ticket as fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-14977.json">JSON Source</a></p>