---
title: "[TIMOB-14993] iOS: Ti.UI.SIZE height of a WebView is incorrectly calculated"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2013-10-09T21:16:07.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.1</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 21, 2013 Sprint 21 API</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, ipass1, regression</td></tr>
<tr><th>Reporter</th><td>Matthew Delmarter</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2013-07-31T05:15:40.000+0000</td></tr>
<tr><th>Updated</th><td>2017-04-10T08:15:46.000+0000</td></tr>
</table>

<h3>Description</h3>

I have typed up a detailed description here:
<a href="https://developer.appcelerator.com/question/155469/tiuisize-is-not-working-for-a-webviews-height-any-more-sample-code-included" rel="nofollow" target="_blank">https://developer.appcelerator.com/question/155469/tiuisize-is-not-working-for-a-webviews-height-any-more-sample-code-included</a>

Basically when trying to use Ti.UI.SIZE to automatically size the Height of a WebView to fit the contents, it does not work when spaces are included in the HTML string. No spaces - it works fine. Spaces included - the height of the WebView is far too large.

You can see a screenshot example here:
<a href="http://www.imattsolutions.com/images/TiWebView_Height.png" rel="nofollow" target="_blank">http://www.imattsolutions.com/images/TiWebView_Height.png</a>

Here is some example code you can run in a new Project's app.js using 3.1.1 SDK:

<code><pre>
var win = Ti.UI.createWindow({
	backgroundColor:'#ffffff'
});
	
var html = 'This is not ok.';

var view = Ti.UI.createWebView({
	html: html,
	height: Ti.UI.SIZE,
	width: Ti.UI.FILL,
	top: 0,
	backgroundColor:'red'
});
win.add(view);

win.open();
</pre></code>

Note: This used to work fine in SDK 2.1.4.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-14993_41166/TiWebView_Height.png">TiWebView_Height.png</td></td><td>2013-07-31T05:15:40.000+0000</td><td>10661</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Matthew Delmarter 2013-08-13

   I have fixed the issue in 3.1.1.GA by doing the following:
   
   In the SDK locate the file "iphone/Classes/TiUIWebView.m".
   
   Replace:
   
   <code><pre>
   -(CGFloat)contentHeightForWidth:(CGFloat)value
   {
       CGRect oldBounds = [[self webview] bounds];
       BOOL oldVal = webview.scalesPageToFit;
       [webview setScalesPageToFit:NO];
       [webview setBounds:CGRectMake(0, 0, 10, 1)];
       CGFloat ret = [webview sizeThatFits:CGSizeMake(10, 1)].height;
       [webview setBounds:oldBounds];
       [webview setScalesPageToFit:oldVal];
       return ret;
   }
   </pre></code>
   
   With:
   
   <code><pre>
   -(CGFloat)contentHeightForWidth:(CGFloat)value
   {
        CGRect oldBounds = [[self webview] bounds];
        [webview setBounds:CGRectMake(0, 0, MAX(value,10), 1)];
        CGFloat result = [[webview stringByEvaluatingJavaScriptFromString:@"document.height"] floatValue];
        [webview setBounds:oldBounds];
        return result;
   }
   </pre></code></li>
<li>Ingo Muschenetz 2013-08-29

   [~srahim], thoughts?</li>
<li>Vishal Duggal 2013-10-09

   Setting plain text without a proper mime type will return incorrect results.
   
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor:'#ffffff'
   });
        
   var html = 'This is not ok.';
    
   var view = Ti.UI.createWebView({
       height: Ti.UI.SIZE,
       width: Ti.UI.FILL,
       top: 40,
       backgroundColor:'red'
   });
   view.setHtml(html,{mimeType:'text/plain'});
   win.add(view);
    
   win.open();
   </pre></code></li>
<li>Tom aan 't Goor 2013-10-29

   This bug also exsits on Android.</li>
<li>Ingo Muschenetz 2013-10-29

   [~tomboman] Test case?</li>
<li>Eric Merriman  2017-03-28

   I don't think a test case is coming. Closing. Please reopen if still an issue. 
   </li>
<li>Hans Kn√∂chel 2017-04-10

   This is related to TIMOB-20482, thx!</li>
</ol>


<p><a href="/TIMOB/TIMOB-14993.json">JSON Source</a></p>