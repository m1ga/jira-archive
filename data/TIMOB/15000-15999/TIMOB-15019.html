---
title: "[TIMOB-15019] iOS: Tableview crash when calling setData after search"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-09-03T20:56:58.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.0, Release 3.1.1, Release 3.1.2</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 18, 2013 Sprint 18 API, Release 3.1.3, Release 3.2.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>regression</td></tr>
<tr><th>Reporter</th><td>Betty Tran</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2013-08-30T21:12:10.000+0000</td></tr>
<tr><th>Updated</th><td>2013-09-10T06:52:33.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

When calling setData on a table that has been populated with sections and rows, setting the data to just rows causes a crash.

<h4>Code to reproduce</h4>

<code><pre>
var second = Ti.UI.createWindow();

var section = Ti.UI.createTableViewSection({
	headerTitle : "Fruit"
});

var allNoteTypes = [{
	title : 'Apple'
}, {
	title : 'Orange'
}, {
	title : 'Banana'
}, {
	title : 'Pear'
}];

var searchBar = Ti.UI.createSearchBar({
	hintText : "Type Here"
});
var table = Ti.UI.createTableView({
	width : Ti.UI.FILL,
	style : Titanium.UI.iPhone.TableViewStyle.GROUPED,
	hideSearchOnSelection : false,
	search : searchBar
});

for (var i = 0; i &lt; 3; i++) {
	var dataRow = Ti.UI.createTableViewRow({
		height : 44
	});
	var lbl = Ti.UI.createLabel({
		left : 10,
		text : allNoteTypes[i].title
	});
	dataRow.add(lbl);
	section.add(dataRow);
}

table.setData([section]);

function handleSearchBarFocus(_event) {
	Ti.API.info("handleSearchBarFocus");
	table.setData(null);
	table.setData(allNoteTypes);
}

function handleSearchBarCancel(_event) {
	Ti.API.info("handleSearchBarCancel");
	table.setData([section]);

}

searchBar.addEventListener("focus", handleSearchBarFocus);
searchBar.addEventListener("cancel", handleSearchBarCancel);
second.add(table);

second.open();

</pre></code>

<h4>Steps to reproduce</h4>

1. Tap on search bar and type 'a'.
2. Press search
3. Press cancel
4. Tap on search bar again
5. App should crash

Please see the attached crash log.
The issue does not occur in 2.1.4GA


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-15019_42036/crashlog">crashlog</td></td><td>2013-08-30T21:12:11.000+0000</td><td>6270</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Vishal Duggal 2013-09-03

   <a href="https://github.com/appcelerator/titanium_mobile/pull/4640" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4640</a></li>
<li>Vishal Duggal 2013-09-03

   backport to 3_1_X <a href="https://github.com/appcelerator/titanium_mobile/pull/4641" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4641</a>
   </li>
<li>Sid Ghosh 2013-09-04

   Vishal would you happen to know when can we expect a bug fix for this issue, will it make it to the nightly build ?
   
   Sid</li>
<li>Ingo Muschenetz 2013-09-04

   [~sghosh] The 3.1.X PR is merged. Builds are kicked off as soon as there is new code to build, so it should be in a build already or if not, soon.</li>
<li>Priya Agarwal 2013-09-10

   Verified the fixed with environment:
   
   Appc Studio:  3.1.3.201309072408
   Sdk:3.1.3.v20130909192251
   CLI version : 3.1.2
   Alloy : 1.2.2-beta
   MAC OSX: 10.8.4
   XCode : 5beta6
   Device: Ipad3(v7)
   
   TableView now does not crash on calling setData after search.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15019.json">JSON Source</a></p>