---
title: "[TIMOB-15078] iOS7: Modal Window is not closing correctly"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-09-12T19:53:35.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 19, 2013 Sprint 19 API, Release 3.1.3, Release 3.2.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios7, module_window, qe-testadded, triage</td></tr>
<tr><th>Reporter</th><td>Rafael Kellermann Streit</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2013-09-07T13:13:10.000+0000</td></tr>
<tr><th>Updated</th><td>2014-04-22T09:54:50.000+0000</td></tr>
</table>

<h3>Description</h3>

When I try to close a modal Window, it have no animation and put a **WARN** in console:

**The top View controller is not a container controller. This window will open behind the presented controller.**

Example code:

<code><pre>
var win1 = Ti.UI.createWindow({
	backgroundColor: "#FF00FF",
	title: "Window 1"
});

var navWindow = Ti.UI.iOS.createNavigationWindow({
	window: win1
});

navWindow.open();

win1.addEventListener("focus", function() {
	alert("win1 focused");
});

win1.addEventListener("click", function() {
	var buttonClose = Ti.UI.createButton({
		title: "Close"
	});

	var win2 = Ti.UI.createWindow({
		leftNavButton: buttonClose,
		backgroundColor: "#FFFF00",
		title: "Window 2"
	});
	
	var navWindow2 = Ti.UI.iOS.createNavigationWindow({
		modal: true,
		window: win2
	});

	navWindow2.open();
	
	buttonClose.addEventListener("click", function() {
		navWindow2.close();
	});
});
</pre></code>

<h3>Comments</h3>

<ol>
<li>Sabil Rahim 2013-09-10

   master <a href="https://github.com/appcelerator/titanium_mobile/pull/4663" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4663</a>
   3_1_X <a href="https://github.com/appcelerator/titanium_mobile/pull/4664" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4664</a></li>
<li>Matt Langston 2013-09-10

   FR passed for 3_1_X and PR merged.
   FR passed for master and PR merged.</li>
<li>Priya Agarwal 2013-09-10

   Verified the Fix with:
   
   Appc Studio:  3.1.3.201309072408
   Sdk:3.1.3.v20130909192251
   CLI version : 3.1.2
   Alloy : 1.2.2-beta
   MAC OSX: 10.8.4
   XCode : 5beta6
   Device: Ipad3(v7)
   
   Modal window now closes without warning.</li>
<li>Rafael Kellermann Streit 2013-09-10

   Thanks!
   
   Could someone explain why modal window is not closing with animation? I don't get it.</li>
<li>kosso 2013-09-11

   Rafael: You need to specify  {animated:true}  in the your close() method.
   
   <code><pre>
   navWindow2.close({animated:true});
   </pre></code>
   </li>
<li>Rafael Kellermann Streit 2013-09-11

   Kosso: It doesn't work for me. It works to you?</li>
<li>kosso 2013-09-11

   Hi Rafael: Sorry. You're absolutely right. 
   
   Now that I've tried to actually implement the new NavigationWindow for a modal window, I cannot get it to close with an animation, despite the setting. </li>
<li>Eric Merriman  2013-09-12

   Will verify and report back. </li>
<li>Vishal Duggal 2013-09-12

   master - <a href="https://github.com/appcelerator/titanium_mobile/pull/4677" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4677</a>
   3_1_X - <a href="https://github.com/appcelerator/titanium_mobile/pull/4678" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/4678</a></li>
<li>Vishal Duggal 2013-09-12

    [~rafaelks],[~kosso]
    
    The problem is that the view of the navigationController was being prematurely detached (windowWillClose) and hence the close() functionality appeared to be non animated. The <code>animated</code> parameter is true by default for closing modal windows so you need not specify it.
    Have moved the detaching of views to windowDidClose method, which is called after the modal window is dismissed. Should be fixed after the above two PR's are merged.
    
    Thanks for catching that.</li>
<li>Rafael Kellermann Streit 2013-09-12

    Thank you for your fast feedback Vishal! :-)
    
    Waiting for new Titanium SDK build to test it.</li>
<li>Federico Casali 2013-09-13

    Cannot reproduce the WARN message using the provided test sample and setting also all windows to modal.
    
    Verified as fixed.
    TiSDK 3.1.3.v20130912171547
    Xcode 5 on iPad Mini 7 and iPhone iOS 7 simulator
    
    Closing.</li>
<li>Jonatan Lundin 2013-10-11

    As far as I can tell this issue still exists in 3.1.3 with NavigationWindows as mentioned by @kosso.
    </li>
<li>Ingo Muschenetz 2013-10-11

    [~mrlundis] is this with the same sample code as shown above?</li>
<li>Jonatan Lundin 2013-10-11

    The example code above appears to work, but I'm experiencing the same issue with code generated through Alloy. At first glance the code appears to be comparable, but I have some more things going on though, like an opened keyboard, etc. 
    
    I'll try to figure out what's causing this and try to extract another sample illustrating the issue.</li>
<li>Ingo Muschenetz 2013-10-11

    If you can file the Alloy sample, that might be enough for us to go on.</li>
<li>Jonatan Lundin 2013-11-01

    I've done some more testing now, and it appears like the animation runs after all. The duration seemed to be extremely short however. Most likely because of to many other things happening on the main thread at the same time, delaying the start of the animation, causing it to appear almost instantaneous.
    
    I fixed the issue by waiting for the rendering of the view below to complete before closing the modal window.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15078.json">JSON Source</a></p>