---
title: "[TIMOB-15365] EXC_ARM_DA_ALIGN in KrollContext StringFormatCallback()"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Paul Mietz Egli</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-09-13T20:26:11.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:03:30.000+0000</td></tr>
</table>

<h3>Description</h3>

I started running into a memory alignment issue on iOS 7 that wasn't present in 6.1: the code for formatting a string has been throwing EXC_ARM_DA_ALIGN errors.  I found [this web page](<a href="http://www.splinter.com.au/what-do-do-with-excarmdaalign-on-an-iphone-ap/)" rel="nofollow" target="_blank">http://www.splinter.com.au/what-do-do-with-excarmdaalign-on-an-iphone-ap/)</a> which briefly explains the cause and gives a workaround.

I wasn't able to reproduce the bug with a simple test of different String.format() calls, but I was able to fix the problem in the app that was crashing by replacing lines 384-386 in KrollContext.m with the following:

<code><pre>
double tmp = TiValueToNumber(jsContext, valueRef, NULL);
memcpy(argList, &tmp, sizeof(tmp));
argList += sizeof(double);
</pre></code>

I made a similar change in the boolean arg value at lines 390-392.

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-15365.json">JSON Source</a></p>