---
title: "[TIMOB-15434] Android: Cookies are not preserved after closing the app"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 3.1.2</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, cookies, httpclient</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-09-05T11:12:49.000+0000</td></tr>
<tr><th>Updated</th><td>2020-08-18T20:42:48.000+0000</td></tr>
</table>

<h3>Description</h3>

On iOS any cookies set in HTTPClient sessions are kept until you or the server clears them. On Android though, they are cleared when you exit the app (not to the background, but really close it).

<h4>To reproduce</h4>

<h4>Create new app: <code>titanium create -p ios,android -n testCookies -d . --id test.cookies</code></h4>
<h4>In <code>app.js</code> use:</h4>
    <code><pre>
    Ti.API.debug('I was just opened, not resumed');

    var w = Ti.UI.createWindow({backgroundColor:'white'});
    var b = Ti.UI.createButton({top: 100, title:'Request'});
    var l = Ti.UI.createLabel({top: 200});

    b.addEventListener('click', function () {
        var client = Ti.Network.createHTTPClient({
            onload: function(e) {
                l.setText(this.responseText);
            }
        });
        client.open('GET', '<a href="http://dev.fokkezb.nl/cookie.php" rel="nofollow" target="_blank">http://dev.fokkezb.nl/cookie.php</a>');
        client.send();
    });

    w.add(b);
    w.add(l);

    w.open();
    </pre></code>
<h4>Run the app on both iOS and Android</h4>
<h4>Click the *Request* button several times</h4>
<h4>Confirm that under the button the server response is a incrementing number</h4>
<h4>Force close the app</h4>
<h4>Open the app again and click the *Request* button</h4>
<h4>You'll see that on iOS the number picks up where it was, but on Android is starts at 1 again</h4>

<h4>Server code</h4>

The PHP code on the server is really simple:

<code><pre>
&lt;?
session_start();
echo $_SESSION['count'] = (int) $_SESSION['count'] + 1;
?&gt;
</pre></code>

<h3>Comments</h3>

<ol>
<li>Mauro Parra-Miranda 2013-09-09

   How did you close / killed the app in iOS?</li>
<li>Fokke Zandbergen 2013-09-10

   I closed the app on iOS (7) by:
   
   <h4>Singletap on the home button to move it to background.</h4>
   <h4>Doubletap on the home button to bring up the new multitasking screen.</h4>
   <h4>Swipe the app screen up to close it.</h4>
   
   I've added a log call to the example code above so in the logs you can tell it's not resuming, but actually opening the app from scratch, still preserving the session and thus cookie.</li>
<li>jithinpv 2014-09-26

   Issue reproduces
   
   Titanium SDK version 3.4.0 master, 3.1.2.GA
   Titanium Studio, build: 3.3.0.201407100905
   Titanium Command-Line Interface
   CLI version 3.3.0, 
   Android device : Motorola Moto G, Android version : 4.4.4</li>
<li>Osian Evans 2016-10-13

   Any news on this issue?
   </li>
<li>Nikos Poulios 2017-06-29

   I noticed that android get/addSystemCookie is not working on Android 6.1.0.GA. After some testing I found out that those functions were not working on previous versions either (5.4.1/6.0.4) but it was noticed now in 6.1.0.GA,  because  I suppose that cookies were auto synced with the webview and in 6.1.0.GA cookies are not available after you restart the app
   
   I also added this comment on TIMOB-20075. I see 3 related tickets all going back to older versions, I am not sure if this should be a new ticket for 6.1.0.GA</li>
</ol>


<p><a href="/TIMOB/TIMOB-15434.json">JSON Source</a></p>