---
title: "[TIMOB-15505] iOS: HttpClient onload event returns responseCode of 0"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 3.1.0, Release 3.1.2, Release 3.1.3, Release 3.2.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>reprod, supportTeam</td></tr>
<tr><th>Reporter</th><td>Marco Cota</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-10-16T18:29:07.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:03:14.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>PROBLEM</h4>

When using an httpClient connection and this is succesful the event return a response code of 0, when user tries to do a validation of the response code they get a false as they expect a 200 response.

 
<h4>EVENT OUTPUT</h4>

<code><pre>
[INFO] :   {
[INFO] :       code = 0;
[INFO] :       source = "[object TiNetworkClient]";
[INFO] :       success = 1;
[INFO] :       type = load;
[INFO] :   }
</pre></code>


<h4>TEST CASE</h4>

<code><pre>

var w = Ti.UI.createWindow();

var url = "<a href="http://www.cotaman.com/return.php?id=200" rel="nofollow" target="_blank">http://www.cotaman.com/return.php?id=200</a>"; 
 var client = Ti.Network.createHTTPClient({ 
     // function called when the response data is available 
     onload : function(e) { 
     	console.log('success&gt;&gt;&gt;'); 
        console.log(e); 
     }, 
     // function called when an error occurs, including a timeout 
     onerror : function(e) { 
                console.log("error&gt;&gt;&gt;");
                console.log(e);
     }, 
     timeout : 5000  // in milliseconds 
 }); 
 // Prepare the connection. 
 client.open("GET", url); 
 // Send the request. 
 client.send(); 

w.open();
</pre></code>

<h4>CONSOLE LOG</h4>

<code><pre>
[INFO] :   APP-739978/1.0 (3.1.3.GA.222f4d1)
[INFO] :   success&gt;&gt;&gt;
[INFO] :   {
[INFO] :       code = 0;
[INFO] :       source = "[object TiNetworkClient]";
[INFO] :       success = 1;
[INFO] :       type = load;
[INFO] :   }
</pre></code>

<h4>SDK CODE</h4>

As doing a review we found that a 0 response is hard coded in the Titanium SDK on TiNetworkHTTPClientProxy.m

<code><pre>
if (hasOnerror && (responseCode &gt;= 400) && (responseCode &lt;= 599))
		{
			NSMutableDictionary * event = [TiUtils dictionaryWithCode:responseCode message:@"HTTP error"];
			[event setObject:@"error" forKey:@"type"];
			[self fireCallback:@"onerror" withArg:event withSource:thisPointer];
		}
		else if(hasOnload)
		{
			NSMutableDictionary * event = [TiUtils dictionaryWithCode:0 message:nil];
			[event setObject:@"load" forKey:@"type"];
			[self fireCallback:@"onload" withArg:event withSource:thisPointer];
		}
</pre></code>

<h3>Comments</h3>

<ol>
<li>Lee Morris 2017-06-21

   I am able to reproduce this issue with the following environment;
   iPhone 7 (10.2)
   Studio 4.9.0.201705302345
   Ti SDK 6.1.1.v20170620103414
   Appc NPM 4.2.9
   Appc CLI 6.2.1
   Ti CLI 5.0.13
   Alloy 1.9.11
   Arrow 2.0.0
   Xcode 8.2 (8C38)
   Node v4.8.2
   Java 1.8.0_131</li>
</ol>


<p><a href="/TIMOB/TIMOB-15505.json">JSON Source</a></p>