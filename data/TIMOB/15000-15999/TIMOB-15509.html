---
title: "[TIMOB-15509] Android: HTTPClient cannot send POST data as Ti.Filesystem.File"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2017-07-25T22:33:23.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Benjamin Hatfield</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2013-10-17T00:12:51.000+0000</td></tr>
<tr><th>Updated</th><td>2017-07-25T22:33:23.000+0000</td></tr>
</table>

<h3>Description</h3>

ENVIRONMENT:
Mac OS X 10.8.4
Appcelerator Studio, build: 3.2.0.201310141852
TiSDK 3.2.0.v20131015134843
Android 4.2.2 / API Level 17
iOS 7.0 / Xcode 5

REPRODUCTION:
1. Add/run the server code on your machine with Apache and PHP enabled.  I placed mine in my ~/Sites/ directory.
2. Replace <IP_ADDRESS> with your local IP (and "/~username" if needed).
3. Run the code below in the Android emulator and press the Submit button.

RESULTS:
Emulator reports the following error:
{noformat}
E/TiExceptionHandler( 3692): (main) [239,3117] ----- Titanium Javascript Runtime Error -----
E/TiExceptionHandler( 3692): (main) [2,3119] - In ti:/httpclient.js:28,9
E/TiExceptionHandler( 3692): (main) [26,3145] - Message: Uncaught Error: size < 0
E/TiExceptionHandler( 3692): (main) [2,3147] - Source: 		_send.call(this, options);
{noformat}

EXPECTED RESULTS:
Client request should not fail.  Server script should return the HTTP headers sent to it.

OTHER INFO:
Works fine on iOS.  Able to successfully send JSON object, Blob and String on Android.


SERVER CODE (server.php):
<code><pre>
<?php

if(strtoupper($_SERVER['REQUEST_METHOD']) === 'POST') {
    echo json_encode((object) array('header' => apache_request_headers()));
}
?>

</pre></code>

CLIENT CODE (app.js):

<code><pre>

    var form_url = 'http://<IP_ADDRESS>/server.php';
 
    var win = Ti.UI.createWindow({
        layout : 'vertical',
        backgroundColor : '#fff'
    });
    var txtTitle = Ti.UI.createTextField({
        top : '80dp',
        value : 'My Photo Title'
    });
    win.add(txtTitle);
      
    var anImageView = Ti.UI.createImageView({
        image : 'images/flower.jpg',
        width : 50,
        height : 50,
 
    });
    anImageView.addEventListener('load', function() {
        Ti.API.info('Image loaded!');
    });
 
    win.add(anImageView);
 
    var btnSubmit = Ti.UI.createButton({
        title : 'Submit'
    });
    btnSubmit.addEventListener('click', function(e) {
        // Send with HTTPClient
 
        var c = Ti.Network.createHTTPClient({
            onload : function() {
                Ti.API.info(this.responseText);
                Ti.API.info("TEXT:   " + this.responseText);
                json = JSON.parse(this.responseText);
                Ti.API.info('json' + json);
            },
            onerror : function(e) {
                Ti.API.info("STATUS: " + this.status);
                Ti.API.info("TEXT:   " + this.responseText);
                Ti.API.info("ERROR:  " + e.error);
            },
            timeout : 50000
        });
        c.enableKeepAlive = false;
        c.open('POST', form_url); 

        c.send(Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory, "/images/flower.jpg"));
        
    });
    win.add(btnSubmit);
 
    win.open();
</pre></code>



<h3>Comments</h3>

<ol>
<li>Sunila 2013-12-04

   Tried with the latest master build, couldn't reproduce the issue.
   
   Here is the sample I tried, make sure that the image path is updated
   
   var form_url = '<a href="http://www.w3schools.com/ajax/demo_post.asp" rel="nofollow" target="_blank">http://www.w3schools.com/ajax/demo_post.asp</a>';
    
   var win = Ti.UI.createWindow({
       layout : 'vertical',
       backgroundColor : '#fff'
   });
   
   var btnSubmit = Ti.UI.createButton({
       title : 'Submit'
   });
   btnSubmit.addEventListener('click', function(e) {
       // Send with HTTPClient
    
       var c = Ti.Network.createHTTPClient();
       c.onload = function() {
               Ti.API.info(this.responseText);
               Ti.API.info("TEXT:   " + this.responseText);
           };
        c.onerror = function(e) {
               Ti.API.info("STATUS: " + this.status);
           };
       c.enableKeepAlive = false;
       c.open('POST', form_url); 
    
       c.send(Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory, "/goofy.png"));
        
   });
   win.add(btnSubmit);
    
   win.open();</li>
<li>Lee Morris 2017-07-25

   Closing due to inactivity. If this issue still exists, please raise a new ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15509.json">JSON Source</a></p>