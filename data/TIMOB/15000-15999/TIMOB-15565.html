---
title: "[TIMOB-15565] Android: MapView displays a black box in TextField"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2013-10-25T22:11:02.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 22, 2013 Sprint 22 API, Release 3.2.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, map, module, qe-testadded, ti.map, triage</td></tr>
<tr><th>Reporter</th><td>Mauro Parra-Miranda</td></tr>
<tr><th>Assignee</th><td>Hieu Pham</td></tr>
<tr><th>Created</th><td>2013-10-16T10:28:48.000+0000</td></tr>
<tr><th>Updated</th><td>2014-02-20T10:45:44.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem Description</h4>
When adding a textfield and a map in a window with Alloy, you will get a black box in the textfield when focused. 

<h4>Test Case</h4>
index.xml
<code><pre>
&lt;Alloy&gt;
	&lt;Window class="container"&gt;
		&lt;View id ="mapContainer"&gt;
			&lt;View id = "directionView"&gt;
				&lt;ImageView id = "searchImg"&gt;&lt;/ImageView&gt;
				&lt;TextField id = "locationEditText" &gt;&lt;/TextField&gt;
				&lt;Button id = "getDirectionBtn" &gt;&lt;/Button&gt;
			&lt;/View&gt;
			&lt;View id="mapView" ns="Alloy.Globals.Map" platform = "android"&gt;&lt;/View&gt;
		&lt;/View&gt;
	&lt;/Window&gt;
&lt;/Alloy&gt;
</pre></code>

index.js
<code><pre>
$.index.open();
</pre></code>

<h4>Steps to reproduce</h4>

Launch the application which has been attached and then perform the following test cases:

1. Launch the application in landscape.
2. Click on the text area.
3. Keyboard is displayed (It should hide the map view entirely)
4. Hide the keyboard.
5. Output:
A black box will be displayed in the text field area.
This is not displayed if the keyboard is not overlapping the entire
 map view.



<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-15565_43335/device-2013-10-21-174236.png">device-2013-10-21-174236.png</td></td><td>2013-10-21T12:09:52.000+0000</td><td>56938</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-15565_43237/SampleEditText.zip">SampleEditText.zip</td></td><td>2013-10-16T10:28:48.000+0000</td><td>5325259</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-15565_44546/text_landscape.JPG">text_landscape.JPG</td></td><td>2013-12-11T10:45:43.000+0000</td><td>3056986</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-15565_44547/text_portrait.JPG">text_portrait.JPG</td></td><td>2013-12-11T10:45:43.000+0000</td><td>1968059</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hieu Pham 2013-10-24

   This is an Android bug (<a href="https://code.google.com/p/android/issues/detail?id=11676)." rel="nofollow" target="_blank">https://code.google.com/p/android/issues/detail?id=11676).</a> Since 4.1, Android changes their map base view from SurfaceView to TextureView, which resolves most of these clipping problems. Unfortunately, this issue still exists with older devices. I will submit a workaround to address this.
   
   </li>
<li>Hieu Pham 2013-10-24

   I could not reproduce this issue using the steps described above. Here are the steps that I used to repro:
   1. Run the code in description in PORTRAIT mode on ICS devices or below.
   2. Click on the textField, keyboard should pop up.
   3. Rotate device to LANDSCAPE, observe the black box above the textfield.
   </li>
<li>Hieu Pham 2013-10-24

   master PR: <a href="https://github.com/appcelerator-modules/ti.map/pull/16" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.map/pull/16</a></li>
<li>Paras Mishra 2013-12-11

   I am able to reproduce this issue on HTC Desire v 4.0.3 using the steps mentioned by Hieu Pham.
   Screen shots text_landscape.jpg and text_portrait.jpg are attached.
   It works fine on Google nexus 7 tab v4.3
   
   Environment used:
   Tested on:
   Device : Google Nexus 7,  Android Version: 4.3
   Device : HTC desire V , Android version : 4.0.3
   SDK: 3.2.0.v20131210191510
   CLI version : 3.2.0-cr
   OS : MAC OSX 10.9
   Alloy: 1.3.0-cr
   ACS: 1.0.10
   Appcelerator Studio, build: 3.2.0.201312101708
   titanium-code-processor: 1.1.0-cr
   XCode : 5.0.2</li>
<li>Pragya Rastogi 2013-12-16

   Verified the fix with:
   OSX: 10.8.5
   Xcode: 5.0
   Appcelerator Studio:3.2.0.201312151544
   SDK:3.2.0.v20131213102445
   alloy: 1.3.0-cr
   acs: 1.0.10
   npm: 1.3.2
   titanium: 3.2.0-cr3
   titanium-code-processor: 1.1.0-cr2
   Device: Nexus 7 (v4.3) & HTC (v4.0.3)</li>
</ol>


<p><a href="/TIMOB/TIMOB-15565.json">JSON Source</a></p>