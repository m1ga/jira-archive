---
title: "[TIMOB-15590] Titanium.Utils.base64decode truncates result with foreign characters"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2017-08-08T22:20:42.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.3</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>SupportTeam, reprod</td></tr>
<tr><th>Reporter</th><td>Mostafizur Rahman</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2013-10-26T20:35:52.000+0000</td></tr>
<tr><th>Updated</th><td>2017-08-15T20:17:16.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
Titanium.Utils.base64encode generates a truncated blob when operating on Chinese characters.

<h4>Code sample:</h4>

<code><pre>
var original = '一些随机的中国文字';
var reference = '5LiA5Lqb6ZqP5py655qE5Lit5Zu95paH5a2X';
var encoded = Titanium.Utils.base64encode(original).text;
console.log('encoded: ' + encoded);
console.log('reference: ' + reference);
console.log('encoded ' + (encoded === reference ? '===' : '!==') + ' reference');
</pre></code>



<h4>Steps to reproduce</h4>
1. Create a new mobile project
2. Paste this to app.js: 
3. Run and check the console.
<h4>Output:</h4>
{noformat}
encoded: 5LiA5Lqb6ZqP
reference: 5LiA5Lqb6ZqP5py655qE5Lit5Zu95paH5a2X
encoded !== reference
{noformat}

<h4>Expected output:</h4>
{noformat}
encoded: 5LiA5Lqb6ZqP5py655qE5Lit5Zu95paH5a2X
reference: 5LiA5Lqb6ZqP5py655qE5Lit5Zu95paH5a2X
encoded === reference
{noformat}

When "original" is Base64-encoded, the result should be equal to "reference". However, the blob returned by Titanium.Utils.base64encode is significantly shorter than expected. Titanium.Utils.base64encode apparently cannot properly handle special characters.

<h3>Comments</h3>

<ol>
<li>Ivo 2016-09-01

   We also have the same problem when Chinese characters are present in the string data we want to base64 encode.</li>
<li>Lee Morris 2017-06-21

   I am able to reproduce this issue with the following environment;
   iPhone 7 (10.2)
   Studio 4.9.0.201705302345
   Ti SDK 6.1.1.v20170620103414
   Appc NPM 4.2.9
   Appc CLI 6.2.1
   Ti CLI 5.0.13
   Alloy 1.9.11
   Arrow 2.0.0
   Xcode 8.2 (8C38)
   Node v4.8.2
   Java 1.8.0_131</li>
<li>Hans Knöchel 2017-08-08

   Marking as duplicate of TIMOB-20395.</li>
<li>Hans Knöchel 2017-08-08

   Fixed as part of TIMOB-20395.</li>
<li>Lee Morris 2017-08-15

   Closing as duplicate.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15590.json">JSON Source</a></p>