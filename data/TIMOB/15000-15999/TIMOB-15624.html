---
title: "[TIMOB-15624] iOS: AttributedString - Shadow attribute does not appear with the underline attribute for a label text"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2013-10-31T20:59:51.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>qe-3.2.0, qe-nfc</td></tr>
<tr><th>Reporter</th><td>Wilson Luu</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2013-10-31T18:06:19.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-13T21:34:15.000+0000</td></tr>
</table>

<h3>Description</h3>

*Details:* Shadow attribute does not appear with the underline attribute for a label text.

*Steps to reproduce:*
1. Install the following app.js code to device:
<code><pre>
var win = Ti.UI.createWindow({
    backgroundColor: '#ddd',
});
 
win.open();
 
var text =  'Bacon ipsum dolor sit amet fatback leberkas salami sausage tongue strip steak. Andouille drumstick meatball boudin shank flank sausage, ribeye ham venison doner bacon ham hock. Appcelerator Titanium sucks rocks! Filet mignon ham pancetta, tail salami pork chop short ribs leberkas kielbasa t-bone tri-tip bresaola. Kevin beef ribs tail hamburger andouille filet mignon bresaola ham ham hock flank meatball pork chop corned beef';
 
var attr = Ti.UI.iOS.createAttributedString({
    text: text,
    attributes: [
         
        // Underlines text
        // Comment this out to see shadow
        {
            type: Ti.UI.iOS.ATTRIBUTE_UNDERLINES_TYLE,
            value: Ti.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE | Ti.UI.iOS.ATTRIBUTE_UNDERLINE_PATTERN_DASH_DOT_DOT,
            range: [0, text.length]
        },
         
        // Sets a background color
        {
            type: Ti.UI.iOS.ATTRIBUTE_BACKGROUND_COLOR,
            value: "blue",
            range: [text.indexOf('Titanium'), ('Titanium').length]
        },
        // Sets a foreground color
        {
            type: Ti.UI.iOS.ATTRIBUTE_FOREGROUND_COLOR,
            value: "white",
            range: [0,  text.length]
        },
        // Sets a background color
        {
            type: Ti.UI.iOS.ATTRIBUTE_BACKGROUND_COLOR,
            value: "yellow",
            range: [text.indexOf('rocks!'), ('rocks!').length]
        },
        // Sets a foreground color
        {
            type: Ti.UI.iOS.ATTRIBUTE_FOREGROUND_COLOR,
            value: "black",
            range: [text.indexOf('rocks!'), ('rocks!').length]
        },
        // Crossed out text
        {
            type: Ti.UI.iOS.ATTRIBUTE_STRIKETHROUGH_STYLE,
            value: Ti.UI.iOS.ATTRIBUTE_UNDERLINE_STYLE_SINGLE,
            range: [text.indexOf('sucks'), ('sucks').length]
        },
 
        // Creates a shadow
        {
            type: Ti.UI.iOS.ATTRIBUTE_SHADOW,
            value: {
                offset: {
                    width: 10,
                    height: 5
                },
                blurRadius: 1,
                color: 'green'
            },
            range: [text.indexOf('Appcelerator'), ('Appcelerator').length]
        }
    ]
});
 
var label = Ti.UI.createLabel({
    left: 20,
    right: 20,
    height: Ti.UI.SIZE,
    backgroundColor: 'red',
    attributedString: attr
});
 
win.add(label);
</pre></code>

*Actual:* A green shadow does not appear behind "Appcelerator" (see no_shadow.png).

*Expected:* A green shadow should appear behind "Appcelerator" (see shadow.png).

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-15624_43580/no_shadow.png">no_shadow.png</td></td><td>2013-10-31T18:06:19.000+0000</td><td>96494</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-15624_43581/shadow.png">shadow.png</td></td><td>2013-10-31T18:06:19.000+0000</td><td>103492</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Pedro Enrique 2013-10-31

   Tested this in native Object-C app and can reproduce as well. This seems to be an Apple bug. Tested on iOS 7
   
   Note:
   If the underline style is removed, then the shadow is visible. 
   <code><pre>
   - (void)viewDidLoad
   {
       [super viewDidLoad];
       [[self view] setBackgroundColor:[UIColor lightGrayColor]];
       
       NSString *text = @"Bacon ipsum dolor sit amet fatback leberkas salami sausage tongue strip steak. Andouille drumstick meatball boudin shank flank sausage, ribeye ham venison doner bacon ham hock. Appcelerator Titanium sucks rocks! Filet mignon ham pancetta, tail salami pork chop short ribs leberkas kielbasa t-bone tri-tip bresaola. Kevin beef ribs tail hamburger andouille filet mignon bresaola ham ham hock flank meatball pork chop corned beef";
   
       UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(20, 20, 280, 500)];
   
       [label setNumberOfLines:0];
       [label setBackgroundColor:[UIColor redColor]];
   
       NSMutableAttributedString *attr = [[NSMutableAttributedString alloc] initWithString:text];
       
       [attr addAttribute: NSUnderlineStyleAttributeName
                    value: [NSNumber numberWithInteger:NSUnderlineStyleSingle | NSUnderlinePatternDashDotDot]
                    range: NSMakeRange(0, [text length])
        ];
   
       [attr addAttribute: NSBackgroundColorAttributeName
                    value: [UIColor blueColor]
                    range: [text rangeOfString:@"Titanium"]
        ];
   
       [attr addAttribute: NSForegroundColorAttributeName
                    value: [UIColor whiteColor]
                    range: NSMakeRange(0, [text length])
        ];
   
       [attr addAttribute: NSBackgroundColorAttributeName
                    value: [UIColor yellowColor]
                    range: [text rangeOfString:@"rocks!"]
        ];
       [attr addAttribute: NSForegroundColorAttributeName
                    value: [UIColor blackColor]
                    range: [text rangeOfString:@"rocks!"]
        ];
       [attr addAttribute: NSStrikethroughStyleAttributeName
                    value: [NSNumber numberWithInteger:NSUnderlineStyleSingle]
                    range: [text rangeOfString:@"sucks"]
        ];
       
       NSShadow *shadow = [[NSShadow alloc] init];
       [shadow setShadowOffset:CGSizeMake(10, 5)];
       [shadow setShadowBlurRadius:1];
       [shadow setShadowColor:[UIColor greenColor]];
       [attr addAttribute: NSShadowAttributeName
                    value: shadow
                    range: [text rangeOfString:@"Appcelerator"]
        ];
   
       [label setAttributedText:attr];
       
       [[self view] addSubview:label];
       [label sizeToFit];
   }
   </pre></code></li>
<li>Lee Morris 2017-03-13

   Closing ticket as this is not our bug.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15624.json">JSON Source</a></p>