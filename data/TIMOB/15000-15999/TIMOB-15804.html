---
title: "[TIMOB-15804] CLI: All commands fail if "node" executable is not actually called "node""
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-01-17T00:35:19.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.0</td></tr>
<tr><th>Fix Version/s</th><td>2014 Sprint 01, 2014 Sprint 01 Core, Release 3.2.1, Release 3.3.0</td></tr>
<tr><th>Components</th><td>CLI</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Chris Barber</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2013-11-23T01:21:37.000+0000</td></tr>
<tr><th>Updated</th><td>2014-01-31T04:35:26.000+0000</td></tr>
</table>

<h3>Description</h3>

On Ubuntu, we found that if node.js is installed via some sort of Debian package, that installs node.js as <code>/usr/bin/nodejs</code>. <code>/usr/bin/node</code> is a symlink to <code>/etc/alternatives/node</code> which is also a symlink to <code>/usr/bin/nodejs</code>.

The problem is <code>process.args\[0\]</code> is "node", but <code>process.execPath</code> is "/usr/bin/nodejs". The CLI compares these two to detect if the first arg is the node.js executable, then strip it off. Because "node" != "nodejs", the executable is not stripped off and the error happens.

<code><pre>
[ERROR] "/usr/bin/titanium" is an unrecognized command.
</pre></code>

or

<code><pre>
[ERROR] "/usr/local/bin/titanium" is an unrecognized command.
</pre></code>

To fix this, we need to properly resolve <code>process.args\[0\]</code>. That means that the CLI needs to call <code>appc.subprocess.findExecutable(process.argv\[0\], ...)</code> to convert "node" to "/usr/bin/node", then we need to run <code>fs.realpathSync()</code> on that result to resolve the symlinks to "/usr/bin/nodejs" and finally compare that to <code>process.execPath</code>.

<h4>Workaround</h4>

As a temporary workaround, you can copy /usr/bin/nodejs to /usr/bin/node.

<h3>Comments</h3>

<ol>
<li>Chris Barber 2013-12-23

   Here's a Q&A question right after the 3.2 release: <a href="http://developer.appcelerator.com/question/160741/titanium-cli-32-doesnt-work-on-ubuntu-because-it-doesnt-strip-the-node-executable-from-the-args." rel="nofollow" target="_blank">http://developer.appcelerator.com/question/160741/titanium-cli-32-doesnt-work-on-ubuntu-because-it-doesnt-strip-the-node-executable-from-the-args.</a></li>
<li>Chris Barber 2013-12-26

   Here's a Github issue also relating to this problem: <a href="https://github.com/appcelerator/titanium/issues/86" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium/issues/86</a></li>
<li>Chris Barber 2014-01-07

   Master pull request: <a href="https://github.com/appcelerator/titanium/pull/88" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium/pull/88</a>
   3.2.x pull request: <a href="https://github.com/appcelerator/titanium/pull/89" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium/pull/89</a></li>
<li>Chris Barber 2014-01-15

   Here's another Q&A question related to this issue: <a href="http://developer.appcelerator.com/question/161405/unable-to-create-new-project---run-node-help-for-available-commands" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/161405/unable-to-create-new-project---run-node-help-for-available-commands</a></li>
<li>Samuel Dowse 2014-01-22

   Verified fixed on:
   Ubuntu 12.04 LTS
   Titanium CLI: 3.2.1 (git://github.com/appcelerator/titanium.git#3_2_X)
   Titanium SDK, build: 3.2.1.v20140121132444
   NPM: 1.3.21
   Node: 0.10.24
   
   CLI: 3.2.0 did not recognize titanium command and threw error displayed in description
   CLI: 3.2.1 correctly recognizes the titanium command and works as expected
   Closing.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15804.json">JSON Source</a></p>