---
title: "[TIMOB-15854] iOS: HTTPClient returns null as responseText when location updated on page redirects"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2014-07-22T19:52:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.0, Release 3.2.3</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>qe-3.2.0, qe-3.2.3, qe-3.3.0</td></tr>
<tr><th>Reporter</th><td>Priya Agarwal</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2013-12-02T11:13:56.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-29T21:41:16.000+0000</td></tr>
</table>

<h3>Description</h3>

HTTPClient returns null as responseText when location updated on page redirects.
<code><pre>
var videoURL = "<a href="http://api.playonsports.com/v1/videos/65601.hls?Authorization=bearer%2051033058bb53a691ccc7df4340271f29" rel="nofollow" target="_blank">http://api.playonsports.com/v1/videos/65601.hls?Authorization=bearer%2051033058bb53a691ccc7df4340271f29</a>";
 
var client = Ti.Network.createHTTPClient({
    onload : function(e) {
        Ti.API.debug("event.js -&gt; android video check -&gt; received text: " + this.responseText);
        Ti.API.debug("event.js -&gt; location: " + this.location);
        Ti.API.debug("event.js -&gt; headers: " + this.getAllResponseHeaders());
        
        var win = Ti.UI.createWindow({
        	backgroundColor: 'green'
        });

        var activeMovie = Ti.Media.createVideoPlayer({
            url : this.location,
            backgroundColor : '#000',
            mediaControlStyle : Ti.Media.VIDEO_CONTROL_DEFAULT,
            scalingMode : Ti.Media.VIDEO_SCALING_ASPECT_FILL,
            fullscreen : true,
            autoplay : true
        });
        
        win.add(activeMovie);
        
        win.open();
    },
    onerror : function(e) {
        Ti.API.debug("event.js -&gt; " + e.error);
        alert('Unable to play video.');
    },
    timeout : 5000
});
client.open("HEAD", videoURL);
client.send(); 
</pre></code>

Result:
Video is not getting played.

console log:
event.js -> android video check -> received text:null

This is not a regression as also not working for 3.1.3.GA also.


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-15854_47196/expected.png">expected.png</td></td><td>2014-04-08T23:31:30.000+0000</td><td>2375010</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Wilson Luu 2014-04-08

   This bug is still reproducible. this.responseText is returning undefined when testing against the master SDK build (3.3.0.v20140407144327); this.responseText returns null when tested against SDK build 3.2.3.v20140403105720.
   
   Tested on:
   
   Appcelerator Studio, build: 3.2.3.201403271839
   SDK build: 3.2.3.v20140403105720, 3.3.0.v20140407144327
   CLI: 3.2.3-alpha2
   Alloy: 1.3.1
   Xcode: 5.1
   Devices: iphone 4 (7.1), iphone 5 (7.0)</li>
<li>Pedro Enrique 2014-04-08

   Marking as invalid. The url provided redirects to another url with empty content. There is no response text or response data.</li>
<li>Wilson Luu 2014-04-08

   Reopening this ticket. The url provided redirects to another url, but the content is still available (see expected.png) and responseText will still return null (in SDK 3.2.3) or undefined (in SDK 3.3.0). 
   
   I've updated the above sample code which will open the video player in a new window.</li>
<li>Wilson Luu 2014-04-09

   Also, tried the above sample code on Samsung Galaxy S3 (4.3) with SDK build 3.2.3.v20140403105720 and get this in the logcat:
   
   <code><pre>
   D/TiAPI   ( 8208):  event.js -&gt; android video check -&gt; received text: #EXTM3U
   D/TiAPI   ( 8208):  event.js -&gt; location: <a href="http://vod.nfhsnetwork.com/63871-VNSshf/63871.m3u8" rel="nofollow" target="_blank">http://vod.nfhsnetwork.com/63871-VNSshf/63871.m3u8</a>
   D/TiAPI   ( 8208):  event.js -&gt; headers: Content-Type:application/vnd.apple.mpegurl
   </pre></code>
   
   In Xcode console, you will get this:
   <code><pre>
   event.js -&gt; android video check -&gt; received text: null
   event.js -&gt; location: <a href="http://vod.nfhsnetwork.com/63871-VNSshf/63871.m3u8" rel="nofollow" target="_blank">http://vod.nfhsnetwork.com/63871-VNSshf/63871.m3u8</a>
   event.js -&gt; headers: undefined
   </pre></code></li>
<li>Vishal Duggal 2014-07-22

   Essentially what is happening is that the request to the original URL is redirecting with a 301 Code.
   
   On Android the request is redirected with method set to GET. (no idea why)
   On iOS the request is redirected with the method still HEAD.
   
   Since HEAD requests have no response body, responseText and responseData will be null.
   
   iOS behavior is pretty easy to verify by adding a **undocumented onredirect callback** as shown below. Android actually has  bug where it does not update the connectionType on the proxy for a redirected request. 
   
   <code><pre>
   onredirect : function(e) {
           Ti.API.debug("redirect location -&gt; " + this.location);
           Ti.API.debug("redirect connectionType-&gt; " + this.connectionType);
           Ti.API.debug("redirect status-&gt; " + this.status);
           //alert('Unable to play video.');
       },
   </pre></code>
   </li>
<li>Lee Morris 2017-03-29

   Closing ticket as invalid.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15854.json">JSON Source</a></p>