---
title: "[TIMOB-15930] Getting stale location if providers turned off , irrespective of LocationRule"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Reopened</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, geolocation</td></tr>
<tr><th>Reporter</th><td>Abhinav Tyagi</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2013-02-11T17:37:53.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:04:00.000+0000</td></tr>
</table>

<h3>Description</h3>

If the registered providers are turned off in settings , a stale location is returned and the Rules dont handle it even if it is very old.
For eg. If I have registered for GPS and Network only , and both are turned off on phone , last known location is returned which can be very old and 
  maxAge set in rules doesn't block it. Also this cached location has provider set as the original provider (i.e. gps or network) which actually should 
be passive.
EDIT Feb 13 2013:
<code><pre>
Titanium.Geolocation.Android.manualMode = true;
	
	
	var providerGps = Ti.Geolocation.Android.createLocationProvider(
				{
    				   name: Ti.Geolocation.PROVIDER_GPS,
				});
				
	
	var providerNetwork = Ti.Geolocation.Android.createLocationProvider(
				{
    				    name: Ti.Geolocation.PROVIDER_NETWORK,	
				});
	//add the providers
	Ti.Geolocation.Android.addLocationProvider(providerGps);
	Ti.Geolocation.Android.addLocationProvider(providerNetwork);
	
	var maxAgeMili = 1 * 60 * 1000;  // 1 minute
	var minAgeMili = 1 * 1000;		//1 second
	
	var gpsRule = Ti.Geolocation.Android.createLocationRule(
						{
    						  provider: Ti.Geolocation.PROVIDER_GPS,
    						  accuracy: 50,
    						  maxAge: maxAgeMili,
    						  minAge: minAgeMili
						});
	var networkRule = Ti.Geolocation.Android.createLocationRule(
						{
    						  provider: Ti.Geolocation.PROVIDER_NETWORK,
    						  accuracy: 50,
    						  maxAge: maxAgeMili,
    						  minAge: minAgeMili
						});
	Ti.Geolocation.Android.addLocationRule(gpsRule);
	Ti.Geolocation.Android.addLocationRule(networkRule);
Titanium.Geolocation.addEventListener('location',function(e){
           //Process location
});
</pre></code>
Now while testing the above code on android device (using Samsung Galaxy ACE) , if both the location providers are turned off (i.e. GPS and network) in settings , we receive a stale location . That location should have been filtered by rules but in this case does not happen.
Also the provider set in the received location is 'gps' or 'network' which should now be 'passive'.

<h3>Comments</h3>

<ol>
<li>Carter Lathrop 2013-02-12

   Can you please provide a test case that shows this bug, unable to reproduce without more information.
   
   Thank you</li>
<li>Abhinav Tyagi 2013-02-13

   Edited the description. Please let me know if further information is needed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15930.json">JSON Source</a></p>