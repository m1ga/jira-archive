---
title: "[TIMOB-15946] iOS7: Toolbar - Using Instruments to search for Toolbar proxy crashes the app and TiUIiOSToolbarProxy does not get released"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2013-12-10T22:40:13.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>qe-3.2.0, regression</td></tr>
<tr><th>Reporter</th><td>Wilson Luu</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2013-12-10T21:44:16.000+0000</td></tr>
<tr><th>Updated</th><td>2014-06-19T12:43:28.000+0000</td></tr>
</table>

<h3>Description</h3>

*Details:* Using Instruments to search for Toolbar proxy crashes the app. And, TiUIiOSToolbarProxy does not get released as well.

*Note:*
1. This only affects iOS 7
2. This bug only occurs while using Instruments; launching the app by itself and pressing the button will not crash
3. *This is a regression as this does not occur on GA stack*

*Steps to reproduce:*
1. Create default app with the following files:
app.js:
<code><pre>
var ToolbarSimple = require("ToolbarSimple").ToolbarSimple;
 
var win = Ti.UI.createWindow({
    backgroundColor : 'white'
});
var view;
function close() {
    win.remove(view);
    view = null;
}
 
view = (function() {
    var v = Ti.UI.createView({
        backgroundColor : 'black'
    });
    var toolbar = new ToolbarSimple("Title");
    v.add(toolbar);
    toolbar.addEventListener("done", close);
    toolbar.addEventListener("cancel", close);
    return v;
})();
 
win.add(view);
 
win.open();
</pre></code>

ToolbarSimple.js:
<code><pre>
exports.ToolbarSimple = function(title) {
    var toolbar;
    var cancel = Titanium.UI.createButton({
        systemButton : Ti.UI.iPhone.SystemButton.CANCEL
    });
    cancel.addEventListener('click', function() {
        toolbar.fireEvent("cancel");
    });
    var done = Titanium.UI.createButton({
        systemButton : Ti.UI.iPhone.SystemButton.DONE
    });
    done.addEventListener('click', function() {
        toolbar.fireEvent("done");
    });
 
    var spacer = Titanium.UI.createButton({
        systemButton : Titanium.UI.iPhone.SystemButton.FLEXIBLE_SPACE
    });
    var lbl = Ti.UI.createLabel({
        text : title,
        color : 'white',
        font : {
            fontWeight : 'bold',
            fontSize : 18
        }
    });
    toolbar = Ti.UI.iOS.createToolbar({
        height : 43,
        barColor : "purple",
        items : [cancel, spacer, lbl, spacer, done]
    });
    return toolbar;
};
</pre></code>
2. Install app to an iOS 7 device
3. Next, open instruments; choose allocation template
4. Choose the target device and target app
5. Filter by proxy
6. On the app, press done

*Actual:* App will silently crash (see attachments for console log and crash report) and TiUIiOSToolbarProxy does not get released.

*Expected:* App should not silently crash while using Instruments and TiUIiOSToolbarProxy should be released.


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-15946_44538/console.log">console.log</td></td><td>2013-12-10T21:44:16.000+0000</td><td>980</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-15946_44539/LeakAgent  12-10-13, 1-13 PM.crash">LeakAgent  12-10-13, 1-13 PM.crash</td></td><td>2013-12-10T21:44:16.000+0000</td><td>15574</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Wilson Luu 2013-12-10

   Closing ticket as invalid. Was not able to reproduce the issue with 3.2.0.v20131209192649 and 3.2.0.v20131210112451. I might've dirtied the test device with other test apps.</li>
</ol>


<p><a href="/TIMOB/TIMOB-15946.json">JSON Source</a></p>