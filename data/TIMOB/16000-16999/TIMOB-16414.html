---
title: "[TIMOB-16414] iOS: removeAllChildren is not working until window is open"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-03-03T23:21:33.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.1.3, Release 3.2.0, Release 3.2.1</td></tr>
<tr><th>Fix Version/s</th><td>2014 Sprint 05, 2014 Sprint 05 API, Release 3.3.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>module_window, qe-testadded, supportTeam</td></tr>
<tr><th>Reporter</th><td>Marco Cota</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2014-02-06T20:30:15.000+0000</td></tr>
<tr><th>Updated</th><td>2014-07-31T07:49:02.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Issue</h4>

In iOS when calling the removeAllChildren() method to a view part of a window that hasn't been open theres no action performed and the children of the view remain, in Android  calling the same method before the window is open the children are removed correctly.

Calling the view.remove(); before the window is open works correctly.

<h4>Test Case</h4>

Classic
app.js
<code><pre>
var win = Ti.UI.createWindow({backgroundColor:'green'});

var v = Ti.UI.createView({
	layout:'vertical'
});
var bt1 = Ti.UI.createButton({
title:'bt1',
top:10,
});
var bt2 = Ti.UI.createButton({
title:'bt2',
top:10});

v.add(bt1);
v.add(bt2);
win.add(v);

Ti.API.info('removing all children for content.  #children: ' +     v.children.length);
v.removeAllChildren();
Ti.API.info('... AFTER removing all children for content.  #children: ' +   v.children.length); 

win.open();
</pre></code>

Alloy

index.js
<code><pre>
function setupMainWindow() {
    Ti.API.info('removing all children for content.  #children: ' +     $.content.children.length);
    $.content.removeAllChildren();
    Ti.API.info('... AFTER removing all children for content.  #children: ' +   $.content.children.length);
    var pickOne = Math.floor(Math.random()*5);

switch(pickOne){
    case 0:
        $.content.add($.pageOne);
        break;
    case 1:
        $.content.add($.pageTwo);
        break;
    case 2:
        $.content.add($.pageThree);
        break;
    case 3:
        $.content.add($.pageFour);
        break;
    case 4:
    default:
        $.content.add($.pageFive);
        break;
}
$.getView().open();
};

setupMainWindow();
</pre></code>

index.xml
<code><pre>
&lt;Alloy&gt;
    &lt;Window backgroundColor="white" layout="vertical"&gt;
       	&lt;View id="content" height="70%" width="70%" borderRadius="10"&gt;
            &lt;View id="pageZero" height="10%" backgroundColor="black"&gt;&lt;Label color="red"&gt;I should NEVER be visible&lt;/Label&gt;&lt;/View&gt;
            &lt;View id="pageOne"&gt;&lt;Label&gt;I am page one!&lt;/Label&gt;&lt;/View&gt;
            &lt;View id="pageTwo" layout="vertical"&gt;&lt;Label&gt;I am page two!&lt;/Label&gt;&lt;/View&gt;
            &lt;View id="pageThree" layout="horizontal"&gt;&lt;Label&gt;I am page three!&lt;/Label&gt;&lt;/View&gt;
            &lt;View id="pageFour"&gt;&lt;Label bottom="5"&gt;I am page four!&lt;/Label&gt;&lt;/View&gt;
            &lt;View id="pageFive"&gt;&lt;Label top="5"&gt;I am page five!&lt;/Label&gt;&lt;/View&gt;
     	&lt;/View&gt;
    &lt;/Window&gt;
&lt;/Alloy&gt;
</pre></code>

<h4>Console log</h4>

Calling win.open() after the v.removeAllChildren() leaves the children.
<code><pre>
[INFO] :   Focusing the iOS Simulator
[INFO] :   Application started
[INFO] :   testcase/1.0 (3.2.0.GA.d9182d6)
[INFO] :   removing all children for content.  #children: 2
[INFO] :   ... AFTER removing all children for content.  #children: 2
</pre></code>

Calling win.open() before the v.removeAllChildren() correctly removes the children.
<code><pre>
[INFO] :   Application started
[INFO] :   testcase/1.0 (3.2.0.GA.d9182d6)
[INFO] :   removing all children for content.  #children: 2
[INFO] :   ... AFTER removing all children for content.  #children: 0
</pre></code>

<h4>Workaround</h4>

A simple loop can be used to read the children of a view and remove them, either if the window has been open or not.

<code><pre>
function clearView(view){
	Ti.API.info('removing all children for content.  #children: ' +     view.children.length);
	var viewLength = view.children.length-1;
	for(var i = viewLength;i &gt;= 0; i--){
		view.remove(view.children[i]);
	}
	Ti.API.info('... AFTER removing all children for content.  #children: ' +   view.children.length);	
};
</pre></code>


<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2014-02-06

   [~mcota] Can you please add the Alloy use case to this ticket?</li>
<li>Vishal Duggal 2014-03-03

   Pull pending against master
   <a href="https://github.com/appcelerator/titanium_mobile/pull/5408" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5408</a></li>
<li>Priya Agarwal 2014-04-17

   Closing the issue as working as expected.
   removeAllChildren method working fine before window open.
   
   Test Environment:
   
   Appc-Studio:3.2.3.201404151910
   sdk:3.3.0.v20140416200257
   acs:1.0.14
   alloy:1.3.1
   npm:1.3.2
   titanium:3.2.3-beta
   titanium-code-processor:1.1.1-beta1
   xCODE:5.1.1
   Device:Nexus7(v4.4.2),Iphone5(v7.1)</li>
</ol>


<p><a href="/TIMOB/TIMOB-16414.json">JSON Source</a></p>