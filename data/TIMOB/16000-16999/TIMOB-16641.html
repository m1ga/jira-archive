---
title: "[TIMOB-16641] iOS: TableViewRow flickers when its height is set either Ti.UI.SIZE or fix value"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2014-04-07T18:44:01.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.2</td></tr>
<tr><th>Fix Version/s</th><td>2014 Sprint 07, 2014 Sprint 07 SDK</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>supportTeam, triage</td></tr>
<tr><th>Reporter</th><td>Eduardo Gomez</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2014-03-18T23:36:51.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T22:59:28.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Issue description</h4>
TableViewRow has a view inside (where there are more children objects) for showing custom data. These Rows must be collapsed and expanded using an animation or just setting the row which changes its height. Once the row is expanded, all the rows must be shown. 

The problem developer is facing is that these animations are being sloppy and the whole TableView starts blinking once the animation starts. 

We have already used an animation and a View inside the tableViewRow which contains all the custom views and we have testing animating, a warning appears at the console: 

<code><pre>
[DEBUG] :  Application booted in 212.884963 ms
[WARN] :   New layout set while view [object __alloyId2] animating: Will relayout after animation.
[WARN] :   New layout set while view [object __alloyId2] animating: Will relayout after animation.
[WARN] :   New layout set while view [object __alloyId70] animating: Will relayout after animation.
[WARN] :   New layout set while view [object __alloyId2] animating: Will relayout after animation.
...
</pre></code>

Using 'app/controllers/index.js' and 'app/styles/index.tss' instead of commented out sections gets rid of the warning below although we haven't been able to achieve a decent result since from time to time the flickering persists.

<h4>Steps to reproduce</h4>
<h4>Launch sample demo project showing this blink once you click on a row.</h4>
<h4>Click either first, second or the third row to collapse or expand contents. The row flickers showing a red background (app/styles/index.tss). </h4>
<code><pre>
			&lt;TableViewRow class="row"&gt;
				&lt;View class="rowWrapper"&gt;
					&lt;Label class="label" /&gt;
					&lt;Label class="Secondlabel" /&gt;					
				&lt;/View&gt;
			&lt;/TableViewRow&gt;
</pre></code>
<h4>If you remove the nested view and try out to add a transparent background the children objects will eventually disappear and appear as the user collapse-expand a TableViewRow (app/styles/index.tss). </h4>
<code><pre>
			&lt;TableViewRow class="row"&gt;
					&lt;Label class="label" /&gt;
					&lt;Label class="Secondlabel" /&gt;					
			&lt;/TableViewRow&gt;
</pre></code>



<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-16641_46727/Dummy.zip">Dummy.zip</td></td><td>2014-03-18T23:36:51.000+0000</td><td>5976038</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Eduardo Gomez 2014-03-31

   <h4>Classic Titanium </h4>
   <code><pre>
   Titanium.UI.setBackgroundColor('#000');
   var rows = [];
   var win1 = Titanium.UI.createWindow({
   	width : Ti.UI.FILL,
   	height : Ti.UI.FILL,
   	backgroundColor : '#101010'
   });
   
   var tableView = Ti.UI.createTableView({
   	width : Ti.UI.FILL,
   	height : Ti.UI.FILL,
   	backgroundColor : 'black'
   });
   
   tableView.addEventListener('click', function(e) {
   	var row = e.row;
   	if (!row) {
   		return false;
   	}
   	var newHeight = row.collapsed ? 30 : 60;
   	row.height = newHeight;
   	if (row.collapsed == true) {
   		row.collapsed = false;
   	} else {
   		row.collapsed = true;
   	}
   	Ti.API.info(newHeight);
   });
   
   for (var i = 0; i &lt;= 7; i++) {
   	var row = Ti.UI.createTableViewRow({
   		width : Ti.UI.FILL,
   		height: 60, //Ti.UI.SIZE,
   		collapsed : true,
   		backgroundColor : 'red',
   		selectionStyle : Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,
   		layout : 'vertical',
   	});
   	var view = Ti.UI.createView({
   		width : Ti.UI.FILL,
   		height : 60, //Ti.UI.SIZE,
   		layout : 'vertical',
   		touchEnabled : false,
   		backgroundColor : 'green'
   	});
   	var firstLabel = Ti.UI.createLabel({
   		width : Ti.UI.FILL,
   		height : 30,
   		color : '#FFF',
   		text : 'Dummy Text'
   	});
   	var secondLabel = Ti.UI.createLabel({
   		width : Ti.UI.FILL,
   		height : 30,
   		color : '#FFF',
   		text : '&gt;&gt;&gt;&gt;&gt;&gt;'
   	});
   	view.add(firstLabel);
   	view.add(secondLabel);
   	row.add(view);
   	rows.push(row);
   }
   
   tableView.setData(rows);
   win1.add(tableView);
   win1.open();
   </pre></code></li>
<li>Vishal Duggal 2014-04-07

   There are two issues I can see.
   
   First that the red background is showing through. This issue has been reported multiple times and the workaround also has been posted. iOS will clear out the background of all subviews of TableViewCell when the cell is highlighted. This is native behavior. The simple workaround is to use a backgroundImage on the view instead of a background color. 
   
   Second issue here is that you are trying to animate the height of the tableView row. You **can not** animate the height of a tableView row because when the height changes, the row has to reload. When a row reloads we have to layout the subviews and the warning you are seeing is because the layout cycle is triggered while the row is animating. 
   
   What you should really be doing is updating the row. Posting sample code below which shows the expanding and collapsing table view rows. Going to mark this as Won't Fix
   
   <code><pre>
   function genExpandedRow(i) {
       var row = Ti.UI.createTableViewRow({
           width : Ti.UI.FILL,
           height: 60, //Ti.UI.SIZE,
           collapsed : false,
           backgroundColor : 'green',
           selectionStyle : Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,
       });
       var firstLabel = Ti.UI.createLabel({
           width : Ti.UI.FILL,
           top:0,
           height : 30,
           color : '#FFF',
           highlightedColor : '#FFF',
           text : 'Dummy Text '+i
       });
       var secondLabel = Ti.UI.createLabel({
           width : Ti.UI.FILL,
           top:30,
           height : 30,
           color : '#FFF',
           highlightedColor : '#FFF',
           text : '&gt;&gt;&gt;&gt;&gt;&gt; '+i
       });
       row.add(firstLabel);
       row.add(secondLabel);
   
       return row;
   }
   
   
   function genCollapsedRow(i) {
       var row = Ti.UI.createTableViewRow({
           width : Ti.UI.FILL,
           height: 30, //Ti.UI.SIZE,
           collapsed : true,
           backgroundColor : 'green',
           selectionStyle : Ti.UI.iPhone.TableViewCellSelectionStyle.NONE,
       });
       var firstLabel = Ti.UI.createLabel({
           width : Ti.UI.FILL,
           top:0,
           height : 30,
           color : '#FFF',
           highlightedColor : '#FFF',
           text : 'Dummy Text '+i
       });
       
       row.add(firstLabel);
   
       return row;
   }
   
   Titanium.UI.setBackgroundColor('#000');
   var rows = [];
   var win1 = Titanium.UI.createWindow({
       width : Ti.UI.FILL,
       height : Ti.UI.FILL,
       backgroundColor : '#101010'
   });
    
   var tableView = Ti.UI.createTableView({
       width : Ti.UI.FILL,
       height : Ti.UI.FILL,
       backgroundColor : 'black'
   });
    
   tableView.addEventListener('click', function(e) {
       
       var row = e.row;
       if (!row) {
           return false;
       }
       var newRow;
       if(row.collapsed == false) {
           newRow = genCollapsedRow(e.index);
       } else {
           newRow = genExpandedRow(e.index);
       }
   
       tableView.updateRow(e.index,newRow,{animated:false});
   
   });
    
   for (var i = 0; i &lt;= 7; i++) {
       var row = genExpandedRow(i);
       rows.push(row);
   }
    
   tableView.setData(rows);
   win1.add(tableView);
   win1.open();
   </pre></code></li>
<li>Lee Morris 2017-03-22

   Closing ticket as "Won't Fix".</li>
</ol>


<p><a href="/TIMOB/TIMOB-16641.json">JSON Source</a></p>