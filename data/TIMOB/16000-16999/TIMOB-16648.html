---
title: "[TIMOB-16648] BB: Ti is not defined when a WebView is created with a remote url"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2014-03-20T16:45:18.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>BlackBerry</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Davide Cassenti</td></tr>
<tr><th>Assignee</th><td>Pedro Enrique</td></tr>
<tr><th>Created</th><td>2014-03-20T12:41:45.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-14T21:08:03.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description of the problem</h4>
In BB10, when a WebView is created with a remote URL, Ti does not seem to be defined. Thus, you cannot perform calls like Ti.App.fireEvent.

<h4>Steps to reproduce</h4>
Use this code
<code><pre>
var win = Ti.UI.createWindow({
	backgroundColor:'white'
});

var webview = Ti.UI.createWebView({
	url : '<a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a>'
});

Ti.App.addEventListener('geturl', function(e) {
	alert('url: ' + e.url); // the url is defined
});

webview.addEventListener('load', function() {
	setTimeout(function() {
		webview.evalJS('Ti.App.fireEvent("geturl", { "url": window.location.href })');
	}, 1000);
});

win.add(webview);
win.open();
</pre></code>

<h4>Additional notes</h4>
By changing the 'url' property to a local file, Ti is defined, e.g.:

<code><pre>
var webview = Ti.UI.createWebView({
	url : 'test.html'
});
</pre></code>

Also note that, even with local files Ti does not seem to be defined *unless* I add a timeout.

<h3>Comments</h3>

<ol>
<li>Davide Cassenti 2014-03-20

   One additional comment here. I noticed that this code works if I first load a local page, and then change the URL to a remote one:
   
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor:'white'
   });
    
   var webview = Ti.UI.createWebView({
       url : 'test.html'
   });
   webview.url = '<a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a>';
    
   Ti.App.addEventListener('geturl', function(e) {
       alert('url: ' + e.url); // the url is defined
   });
    
   webview.addEventListener('load', function() {
       setTimeout(function() {
           webview.evalJS('Ti.App.fireEvent("geturl", { "url": window.location.href })');
       }, 1000);
   });
    
   win.add(webview);
   win.open();
   </pre></code></li>
<li>Pedro Enrique 2014-03-20

   The Ti namespace is not defined in a remote url WebView, this is expected behavior. I tested the same code in iOS and the event to get the url never fires. I placed an extra alert verify that the evalJS is getting called. Sample code with one more alert:
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor:'white'
   });
    
   var webview = Ti.UI.createWebView({
       url : '<a href="http://www.example.com" rel="nofollow" target="_blank">http://www.example.com</a>'
   });
    
   Ti.App.addEventListener('geturl', function(e) {
       alert('url: ' + e.url); // the url is defined
   });
    
   webview.addEventListener('load', function() {
       setTimeout(function() {
       	alert('calling evalJS');
           webview.evalJS('Ti.App.fireEvent("geturl", { "url": window.location.href })');
       }, 1000);
   });
    
   win.add(webview);
   win.open();
   </pre></code>
   
   Resolving as invalid.</li>
<li>Lee Morris 2017-03-14

   Closing ticket as invalid.</li>
</ol>


<p><a href="/TIMOB/TIMOB-16648.json">JSON Source</a></p>