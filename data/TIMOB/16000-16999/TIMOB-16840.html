---
title: "[TIMOB-16840] Android: Webview with '_.template' rendered HTML not displayed"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-04-11T22:37:05.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.3</td></tr>
<tr><th>Fix Version/s</th><td>2014 Sprint 07, Release 3.2.3, Release 3.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>module_android, qe-3.2.3, qe-testadded, regression</td></tr>
<tr><th>Reporter</th><td>Federico Casali</td></tr>
<tr><th>Assignee</th><td>Hieu Pham</td></tr>
<tr><th>Created</th><td>2014-04-10T00:23:00.000+0000</td></tr>
<tr><th>Updated</th><td>2014-04-21T18:44:56.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
In the Dynamic Styling Alloy sample <a href="https://github.com/appcelerator/alloy/tree/master/test/apps/advanced/dynamic_styling" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/tree/master/test/apps/advanced/dynamic_styling</a> , in the 'rawStyle' window, there is a webView whose html content is rendered using the Underscore.js '_.template' utility:

<code><pre>
$.styleArray.html = _.template(Alloy.Globals.htmlTemplate, {
	CODE: JSON.stringify(require('alloy/styles/features/rawStyle'), null, '  '),
	BRUSH: 'js'
});
</pre></code>

Alloy.Globals.htmlTemplate (in app/alloy.js):
<code><pre>
Alloy.Globals.htmlTemplate = '&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" rel="nofollow" target="_blank">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd</a>"&gt;&lt;html xmlns="<a href="http://www.w3.org/1999/xhtml" rel="nofollow" target="_blank">http://www.w3.org/1999/xhtml</a>" xml:lang="en" lang="en"&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;&lt;script type="text/javascript" src="web/syntaxhighlighter/scripts/shCore.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="web/syntaxhighlighter/scripts/shBrushJScript.js"&gt;&lt;/script&gt;&lt;link type="text/css" rel="stylesheet" href="web/syntaxhighlighter/styles/shCoreDefault.css"/&gt;&lt;script type="text/javascript"&gt;SyntaxHighlighter.all();&lt;/script&gt;&lt;/head&gt;&lt;body style="background: white; font-family: Helvetica; "&gt;&lt;pre class="brush: &lt;%= BRUSH %&gt;; gutter: false;"&gt;&lt;%= CODE %&gt;&lt;/pre&gt;&lt;/html&gt;';
</pre></code>

If no targetSdkVersion is specified or if a targetSdkVersion specified is greater than 13, running the sample on Android using the latest SDK (3.2.3.v20140403105720), the Webview is not visible.
Is correctly visible using 3.2.2.GA on both iOS and Android.

<h4>Steps to reproduce</h4>
1. Create a new Alloy project and import the Alloy sample code <a href="https://github.com/appcelerator/alloy/tree/master/test/apps/advanced/dynamic_styling" rel="nofollow" target="_blank">https://github.com/appcelerator/alloy/tree/master/test/apps/advanced/dynamic_styling</a> (or get the attached project)
2. Run on Android and click on 'Raw Style Modules'
Result: second webView (<WebView id="styleArray" height="800dp"/>) is not visible. 

3. Edit tiapp.xml, add the following and run on Android:
<code><pre>
&lt;android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;
        &lt;manifest&gt;
            &lt;uses-sdk android:targetSdkVersion="11"/&gt;
        &lt;/manifest&gt;
&lt;/android&gt;
</pre></code>

Result: the webView is now correctly displayed

4. Edit tiapp.xml, add the following and run on Android:
<code><pre>
&lt;android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;
        &lt;manifest&gt;
            &lt;uses-sdk android:targetSdkVersion="19"/&gt;
        &lt;/manifest&gt;
&lt;/android&gt;
</pre></code>

Result: Webview is no longer displayed.


5. Edit tiapp.xml, switch to SDK 3.2.2.GA, use any targetSdkVersion (from 11 to 19) and run on device:
Result: webview is always correctly displayed. It seems to be a regression on the SDK (also no changes made on Alloy).


Attached screenshots for comparison between a displayed and not-displayed webview.


<h4>Note</h4>
If using Jake to import the Alloy sample project, it works fine as in this case an Harness template with targetSdkVersion='11' is being used.
If using the default new app tiapp.xml file (with no targetSdkVersion being specified in the manifest), the sample webview is not visible.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-16840_47227/3.2.2_windows.png">3.2.2_windows.png</td></td><td>2014-04-10T00:23:00.000+0000</td><td>130762</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-16840_47228/3.2.X_windows.png">3.2.X_windows.png</td></td><td>2014-04-10T00:23:00.000+0000</td><td>96481</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-16840_47247/passTestAlloy.zip">passTestAlloy.zip</td></td><td>2014-04-10T22:10:33.000+0000</td><td>5044125</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2014-04-10

   I don't believe this to be an Alloy bug. It is related to the Android SDK version used to build the app. Anything newer than API version 13 exhibits the problem; older Android API levels don't have this issue.
   
   My test:
   
   1. Create a new project with the CLI
   2. Edit tiapp.xml to set Ti SDK to 3.2.3.Alpha
   3. Build via command line to Genymotion emulator (Galaxy Nexus, Android 4.2.2). App exhibits the behavior as described (second webview isn't visible)
   4. Modify tiapp.xml, adding the code below. Rinse and repeat using targetSdkVersions from 11 (which is what is set by the Harness Template) through 19. Android SDK versions 11, 12, and 13 -- the app works properly. Any SDK version higher than 13 exhibits the behavior described in the ticket.
   5. Modify tiapp.xml setting TiSDK to 3.2.2.GA and targetSdkVersion to 19. The app runs properly.
   
   <code><pre>
   &lt;android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;
      &lt;manifest&gt;
         &lt;uses-sdk android:targetSdkVersion="13"/&gt;
      &lt;/manifest&gt;
   &lt;/android&gt;
   
   </pre></code></li>
<li>Hieu Pham 2014-04-11

   master PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/5592" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5592</a>
   3.2.x PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/5593" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5593</a></li>
<li>Federico Casali 2014-04-14

   Verified as fixed.
   
   TiSDK 3.2.3.v20140411160129 
   Alloy 1.3.1
   Appcelerator Studio 3.2.3.201404111117
   
   Mac OS X and Windows 7 x64
   Google Nexus Galaxy 4.3
   
   Closing.</li>
<li>Wilson Luu 2014-04-15

   Closing ticket as per Federico's comment.</li>
</ol>


<p><a href="/TIMOB/TIMOB-16840.json">JSON Source</a></p>