---
title: "[TIMOB-16954] Ti.Geolocation.forwardGeocoder returning undefined error"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2014-05-16T21:25:10.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.2</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>look1, supportTeam</td></tr>
<tr><th>Reporter</th><td>Marco Cota</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2014-05-13T21:51:50.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-29T16:33:33.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

While customer calls Ti.Geolocation.forwardGeocoder returns and undefined error, when calling the Ti.Geolocation.reverseGeocode in order to get a valid address works ok but even using this address the Ti.Geolocation.forwardGeocoder is returning a undefined value in both Android and iOS.

<h4>Testcase</h4>

<code><pre>
// Create our Window
var window = Titanium.UI.createWindow({  
    title:'NexPlayer Modules P.O.C.',
    backgroundColor:'#fff'
});

Ti.Geolocation.preferredProvider = "gps";
Ti.Geolocation.purpose = "Locate user";
	
if (Titanium.Geolocation.locationServicesEnabled === false)
	{
		Titanium.UI.createAlertDialog({title:'Kitchen Sink', message:'Your device has geo turned off - turn it on.'}).show();
	}

var addr;

Titanium.Geolocation.reverseGeocoder("19.423025131225586","-99.1595687866211",function(evt)
{
	if (evt.success) {
		var text = "";
		for (var i = 0; i &lt; evt.places.length; i++) {
			text += "" + i + ") " + evt.places[i].address + "\n";
			addr = evt.places[i].address;
		}
		Ti.API.info('Reversed forward: '+text);
		
		Titanium.Geolocation.forwardGeocoder(addr,function(evt)
		{
			Ti.API.info('in forward ' + addr);
			Ti.API.info("lat:"+evt.latitude+", long:"+evt.longitude);
			Titanium.Geolocation.reverseGeocoder(evt.latitude,evt.longitude,function(evt)
			{
				if (evt.success) {
					var text = "";
					for (var i = 0; i &lt; evt.places.length; i++) {
						text += "" + i + ") " + evt.places[i].address + "\n";
					}
					Ti.API.info('Reversed forward: '+text);
				}
				else {
					Ti.UI.createAlertDialog({
						title:'Forward geo error',
						message:evt.error
					}).show();
					Ti.API.info("Code translation: "+evt.code);
				}
			});
		});
		
	}
	else {
		Ti.UI.createAlertDialog({
			title:'Forward geo error',
			message:evt.error
		}).show();
		Ti.API.info("Code translation: "+evt.code);
	}
	
	
	
	
});

window.open();
</pre></code>

<h4>Logs</h4>

IOS
<code><pre>
May 13 16:16:13 iPhone-de-Marco testcase[2141] &lt;Warning&gt;: [INFO] testcase/1.0 (3.2.2.GA.96e9a07)
May 13 16:16:13 iPhone-de-Marco testcase[2141] &lt;Warning&gt;: [DEBUG] Analytics is enabled = YES
May 13 16:16:13 iPhone-de-Marco testcase[2141] &lt;Warning&gt;: [DEBUG] Loading: /var/mobile/Applications/41289ADA-373E-4DBD-B31C-EC4F33436519/testcase.app/app.js, Resource: app_js
May 13 16:16:13 iPhone-de-Marco testcase[2141] &lt;Warning&gt;: [DEBUG] Application booted in 58.427036 ms
May 13 16:16:13 iPhone-de-Marco testcase[2141] &lt;Warning&gt;: [INFO] Reversed forward: 0) Banamex, Cordoba, Benito Júarez, Ciudad de México, Distrito Federal, 06700, México
May 13 16:16:14 iPhone-de-Marco wifid[40] &lt;Error&gt;: WiFi:[421708574.009947]: Enable WoW requested by "apsd"
May 13 16:16:16 iPhone-de-Marco testcase[2141] &lt;Warning&gt;: [INFO] in forward Banamex, Cordoba, Benito Júarez, Ciudad de México, Distrito Federal, 06700, México
May 13 16:16:16 iPhone-de-Marco testcase[2141] &lt;Warning&gt;: [INFO] lat:undefined, long:undefined
May 13 16:16:17 iPhone-de-Marco testcase[2141] &lt;Warning&gt;: [INFO] Code translation: -1
May 13 16:16:19 iPhone-de-Marco profiled[2140] &lt;Notice&gt;: (Note ) profiled: Service stopping.
</pre></code>

Android
<code><pre>
EBUG] :  OpenGLRenderer: Enabling debug mode 0
[INFO] :   Reversed forward: 0) Banamex, Cordoba, Benito Júarez, Ciudad de México, Distrito Federal, 06700, México
[INFO] :   in forward Banamex, Cordoba, Benito Júarez, Ciudad de México, Distrito Federal, 06700, México
[INFO] :   lat:undefined, long:undefined
[ERROR] :  GeolocationModule: Invalid value, expected type Number.
[ERROR] :  TiExceptionHandler: (main) [4179,4179] ----- Titanium Javascript Runtime Error -----
[ERROR] :  TiExceptionHandler: (main) [1,4180] - In app.js:31,25
[ERROR] :  TiExceptionHandler: (main) [0,4180] - Message: Uncaught Error: Invalid value, expected type Number.
[ERROR] :  TiExceptionHandler: (main) [0,4180] - Source: 			Titanium.Geolocation.reverseGeocoder(evt.latitude,evt.longitude,function(ev
[DEBUG] :  dalvikvm: GC_FOR_ALLOC freed 101K, 15% free 24159K/28216K, paused 22ms, total 23ms
[DEBUG] :  dalvikvm: GC_FOR_ALLOC freed 39K, 15% free 24341K/28440K, paused 28ms, total 28ms
[INFO] :   I/dalvikvm-heap: Grow heap (frag case) to 29.885MB for 2536936-byte allocation
[ERROR] :  V8Exception: Exception occurred at app.js:31: Uncaught Error: Invalid value, expected type Number.
[ERROR] :  ViewRootImpl: sendUserActionEvent() mView == null
</pre></code>

<h3>Comments</h3>

<ol>
<li>Marco Cota 2014-05-16

   I have done some testing directly with the mapquestapi.com (the service we use for geocoding) and found some issues with their service.
   
   If we do a reverse geocode search <a href="http://open.mapquestapi.com/nominatim/v1/reverse?lat=37.3892876&lon=-122.0502364" rel="nofollow" target="_blank">http://open.mapquestapi.com/nominatim/v1/reverse?lat=37.3892876&lon=-122.0502364</a> we will receive a success result:
   
   <code><pre>
   &lt;reversegeocode timestamp="Fri, 16 May 14 14:32:24 +0000" attribution="Data © OpenStreetMap contributors, ODbL 1.0. <a href="http://www.openstreetmap.org/copyright" rel="nofollow" target="_blank">http://www.openstreetmap.org/copyright</a>"querystring="lat=37.3892876&lon=-122.0502364"&gt;
   &lt;result place_id="2445350447" osm_type="way" osm_id="8943342" ref="North Bernardo Avenue" lat="37.3884004" lon="-122.0512303"&gt;
   North Bernardo Avenue, Whisman Station, Mountain View, Santa Clara County, California, 94043, United States of America
   &lt;/result&gt;
   &lt;addressparts&gt;
   &lt;road&gt;North Bernardo Avenue&lt;/road&gt;
   &lt;neighbourhood&gt;Whisman Station&lt;/neighbourhood&gt;
   &lt;city&gt;Mountain View&lt;/city&gt;
   &lt;county&gt;Santa Clara County&lt;/county&gt;
   &lt;state&gt;California&lt;/state&gt;
   &lt;postcode&gt;94043&lt;/postcode&gt;
   &lt;country&gt;United States of America&lt;/country&gt;
   &lt;country_code&gt;us&lt;/country_code&gt;
   &lt;/addressparts&gt;
   &lt;/reversegeocode&gt;
   </pre></code>
   
   While using the address we got from their service "North Bernardo Avenue, Whisman Station, Mountain View, Santa Clara County, California, 94043, United States of America" in their search api we receive  "No search results found"
   
   <a href="http://open.mapquestapi.com/nominatim/v1/search.php?q=North%20Bernardo%20Avenue%20Whisman%20Station%20Mountain%20View%20Santa%20Clara%20County%20California%2094043%20United%20States%20of%20America" rel="nofollow" target="_blank">http://open.mapquestapi.com/nominatim/v1/search.php?q=North%20Bernardo%20Avenue%20Whisman%20Station%20Mountain%20View%20Santa%20Clara%20County%20California%2094043%20United%20States%20of%20America</a> 
   
   If we use the same search call but replacing the address with "North Bernardo AV Mountain View CA 94043" we will get an actual result.
   
   <a href="http://open.mapquestapi.com/nominatim/v1/search.php?q=North+Bernardo+Ave+Mountain+View+CA+94043&viewbox=-91.41%2C48.11%2C91.41%2C-48.11" rel="nofollow" target="_blank">http://open.mapquestapi.com/nominatim/v1/search.php?q=North+Bernardo+Ave+Mountain+View+CA+94043&viewbox=-91.41%2C48.11%2C91.41%2C-48.11</a>
   </li>
<li>Lee Morris 2017-03-29

   Closing ticket as "Not Our Bug".</li>
</ol>


<p><a href="/TIMOB/TIMOB-16954.json">JSON Source</a></p>