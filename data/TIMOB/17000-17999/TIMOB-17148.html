---
title: "[TIMOB-17148] Android: Support "allowBackground" for Ti.Media.VideoPlayer"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2015-01-07T04:52:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.3</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>Android, AudioPlayer, VideoPlayer, allowBackgr</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2014-06-11T13:03:47.000+0000</td></tr>
<tr><th>Updated</th><td>2015-01-07T04:52:11.000+0000</td></tr>
</table>

<h3>Description</h3>

The <code>Ti.Media.AudioPlayer</code> has a property [<code>allowBackground</code>](<a href="http://docs.appcelerator.com/titanium/3.0/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/titanium/3.0/#</a>!/api/Titanium.Media.AudioPlayer-property-allowBackground) to allow the audio not to be paused with the activity is paused, as implemented in [<code>AudioPlayerProxy.java</code> on line #226](<a href="https://github.com/appcelerator/titanium_mobile/blob/e7334c98aaff370d5bbfa4bfe08656726d43baf9/android/modules/media/src/java/ti/modules/titanium/media/AudioPlayerProxy.java#L226)." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/e7334c98aaff370d5bbfa4bfe08656726d43baf9/android/modules/media/src/java/ti/modules/titanium/media/AudioPlayerProxy.java#L226).</a>

Unfortunately, <code>Ti.Media.VideoPlayer</code> does not have such a property. Though it might sound logical to pause the audio when the user can't see the video anymore, there are use cases where this is not the desired behaviour. Take the TED app, where the audio continues as well since the video is just to support the audio.

It seems to me this could be easily fixed in a similar way in [<code>VideoPlayerProxy.java</code> around line #668](<a href="https://github.com/appcelerator/titanium_mobile/blob/1b98dcd8c45953e5d5e93805594472ea6a9bd23e/android/modules/media/src/java/ti/modules/titanium/media/VideoPlayerProxy.java#L668)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/1b98dcd8c45953e5d5e93805594472ea6a9bd23e/android/modules/media/src/java/ti/modules/titanium/media/VideoPlayerProxy.java#L668)</a>

<h3>Comments</h3>

<ol>
<li>Ritu Agrawal 2014-06-12

   Moving this new feature request to engineering for further evaluation and prioritization.</li>
<li>Ashraf Abu 2015-01-02

   I looked into this and found out the following:-
   
   Ti.Media.VideoPlayer in Android uses VideoPlayerProxy that uses [TiVideoView8 | <a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/media/src/java/android/widget/TiVideoView8.java" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/media/src/java/android/widget/TiVideoView8.java</a>] to play the video. When the Activity is sent to background, the TiVideoView8 has a [surfaceDestroyed | <a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/media/src/java/android/widget/TiVideoView8.java#L630" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/media/src/java/android/widget/TiVideoView8.java#L630</a>] method that destroys the view. This happens when the Activity holding the TiViewView8 goes to onPause (aka Background).
   
   The  [surfaceDestroyed | <a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/media/src/java/android/widget/TiVideoView8.java#L637" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/media/src/java/android/widget/TiVideoView8.java#L637</a>] also stops and release the MediaPlayer that is used to play the music and show the video.
   
   Hence, it is not similar to the AudioPlayerProxy as the AudioPlayerProxy had no View objects being used. Implementing this for the VideoPlayerProxy would not be the same.</li>
<li>Ashraf Abu 2015-01-02

   Workaround in Javascript for Android. This uses the AudioPlayer to run in the background when the App goes to background.
   
   <code><pre>
   var vidWin = Titanium.UI.createWindow({
       title : 'Video View Demo',
       backgroundColor : '#fff'
   });
   
   var videoPlayer = Titanium.Media.createVideoPlayer({
       top : 2,
       autoplay : true,
       backgroundColor : 'blue',
       allowBackground: true,
       height : 300,
       width : 300,
       mediaControlStyle : Titanium.Media.VIDEO_CONTROL_DEFAULT,
       scalingMode : Titanium.Media.VIDEO_SCALING_ASPECT_FIT
   });
   
   var currentPlaybackTime = 0;
   
   var basicSwitch = Ti.UI.createSwitch({
     titleOn:'On BG',
     titleOff:'Off BG',
     value:true,
     width: 200, height:120
   });
   
   var urlToPlay = 'rtsp://r7---sn-a5m7zu76.c.youtube.com/CiILENy73wIaGQlD0rwH11uU1RMYDSANFEgGUgZ2aWRlb3MM/0/0/0/video.3gp';
   
   videoPlayer.url = urlToPlay;
   vidWin.add(videoPlayer);
   vidWin.add(basicSwitch);
   
   // allowBackground: true on Android allows the 
   // player to keep playing when the app is in the 
   // background.
   var audioPlayer = Ti.Media.createAudioPlayer({ 
       url: urlToPlay,
       allowBackground: true
   });  
   
   vidWin.addEventListener('blur', function() {
   	Ti.API.info('Closing VideoPlayer at Time Played: ' + Math.round(videoPlayer.getCurrentPlaybackTime()) + ' milliseconds');
   	if(basicSwitch.getValue()) {
   		currentPlaybackTime = videoPlayer.getCurrentPlaybackTime();
   		audioPlayer.setTime(currentPlaybackTime);
   		audioPlayer.start();
   	}
   });
   
   vidWin.addEventListener('focus', function() {
   	Ti.API.info('Closing AudioPlayer at Time Played: ' + Math.round(audioPlayer.getTime()) + ' milliseconds');
   	if(basicSwitch.getValue()) {
   		currentPlaybackTime = audioPlayer.getTime();
   	    audioPlayer.stop();
   	    audioPlayer.release();
   		videoPlayer.setCurrentPlaybackTime(currentPlaybackTime);
   	}
   });
   
   audioPlayer.addEventListener('complete', function() {
       Ti.API.info('Audio ended at: ' + Math.round(audioPlayer.getTime()) + ' milliseconds');
   });
   
   vidWin.open();
   
   </pre></code></li>
<li>Chee Kiat Ng 2015-01-07

   Closing this ticket and won't be including this in the SDK, considering that it is not of common use case. Please use Ashraf's JS workaround if need be. Will be considered for the SDK in the future if ticket gets more support.</li>
<li>Chee Kiat Ng 2015-01-07

   Closing this ticket and won't be including this in the SDK, considering that it is not of common use case. Please use Ashraf's JS workaround if need be. Will be considered for the SDK in the future if ticket gets more support.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17148.json">JSON Source</a></p>