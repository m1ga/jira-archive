---
title: "[TIMOB-17454] iOS: Cannot use "this" for assignments in subcontext"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 3.3.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2014-08-04T19:48:28.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:03:59.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>problem</h4>

*DISCLAIMER:* This description is gonna sound confusing until you read the (simple) error and working cases.

When a subcontext is created using the <code>url</code> property of a call to <code>Ti.UI.createWindow()</code>, you cannot assign <code>this</code> from within the subcontext to <code>Ti.UI.currentWindow</code> or it will result in a Kroll error. You can however assign a function that returns <code>this</code> in the subcontext, and then that function can be invoked in the original context to get the subcontext's <code>this</code>.

I have not tested this on any other platforms.

<h4>error case</h4>

<h4>app.js</h4>

<code><pre>
var win = Ti.UI.createWindow({ url: 'context.js' }).open();
</pre></code>

<h4>context.js</h4>

<code><pre>
Ti.UI.currentWindow.__context = this;
</pre></code>

<h4>result</h4>

<code><pre>
[DEBUG] 2014-08-04 15:34:40.449 conty[50898:4e0b] -[KrollContext target]: unrecognized selector sent to instance 0xd336f10
[ERROR] Script Error {
[ERROR]     backtrace = "#0 () at :0";
[ERROR]     line = 6;
[ERROR]     message = "-[KrollContext target]: unrecognized selector sent to instance 0xd336f10";
[ERROR]     sourceId = 349233056;
[ERROR]     sourceURL = "file:///Users/tlukasavage/Library/Application%20Support/iPhone%20Simulator/7.1/Applications/5EB2D06A-CE21-4B5C-A0B1-CF9BB995DF8C/conty.app/context.js";
[ERROR] } 
</pre></code>

<h4>working case</h4>

The working case here is a little longer so as to show not only does it not cause an error in context.js, but also that the context returned from it is able to be used and iterated over when returned to app.js.

<h4>app.js</h4>

<code><pre>
var win = Ti.UI.createWindow({ url: 'context.js' });
win.addEventListener('open', function() {
	Ti.API.info(Object.keys(win.__context()));
});
win.open();
</pre></code>

<h4>context.js</h4>

<code><pre>
var self = this;
Ti.UI.currentWindow.__context = function() {
	return self;
};
</pre></code>

<h4>result</h4>

<code><pre>
[INFO]  (
[INFO]      self,
[INFO]      Kroll,
[INFO]      setTimeout,
[INFO]      setInterval,
[INFO]      clearTimeout,
[INFO]      clearInterval,
[INFO]      require,
[INFO]      L,
[INFO]      alert,
[INFO]      Titanium,
[INFO]      Ti,
[INFO]      console
[INFO]  )
</pre></code>

<h4>Additional Notes</h4>

This is likely related to TIMOB-17449.

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-17454.json">JSON Source</a></p>