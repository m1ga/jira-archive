---
title: "[TIMOB-17457] Android: JS Global Object - JS global object is undefined after calling Ti.App.addEventListener"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2014-09-18T19:19:38.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.3, Release 3.3.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>qe-3.4.0</td></tr>
<tr><th>Reporter</th><td>Wilson Luu</td></tr>
<tr><th>Assignee</th><td>Ping Wang</td></tr>
<tr><th>Created</th><td>2014-08-05T23:55:37.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-24T17:10:25.000+0000</td></tr>
</table>

<h3>Description</h3>

*Details:* JS global object is undefined after calling Ti.App.addEventListener.

*Note:*
1. This does *not* occur on iOS
2. This is not a regression with 3.2.3.GA

*Steps to reproduce:*
1. Create a classic Titanium app
2. Download and unzip Archive.zip
3. Copy all contents in the Archive folder and paste them in the Resources directory from step 1
4. Next, install app to an Android device
5. After app is installed, press "Start Automation" button

*Actual:* After test is complete, "Cannot read property" runtime error appears (see runtime_error.png attachment).

The bug is in testExecutor.js on line 34.

*Expected:* App should run without throwing a runtime error.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-17457_50257/Archive.zip">Archive.zip</td></td><td>2014-08-05T23:55:37.000+0000</td><td>2884</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-17457_50256/runtime_error.png">runtime_error.png</td></td><td>2014-08-05T23:55:37.000+0000</td><td>124223</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>jithinpv 2014-08-20

   Cannot reproduce
   
   Titanium SDK version 3.4.0 master, 3.3.0.GA, 3.2.3.GA, 3.2.2.GA
   Titanium Studio, build: 3.3.0.201407100905
   Titanium Command-Line Interface
   CLI version 3.3.0, 
   Android device : Motorola Moto G, Android version : 4.4.4</li>
<li>Wilson Luu 2014-08-21

   Reopening ticket since I can still reproduce the issue. 
   
   I noticed that I was missing one more step in the bug description which was to press the "Start Automation" button. Will update the bug description.</li>
<li>Ping Wang 2014-09-18

   In the event listener of Ti.App, "this" means the Ti.App object, not the "global". That's why this.textArea inside the event listener is undefined.
   So "testExecutor.js" line 28-50 should be:
   <code><pre>
   var self = this;
   Ti.App.addEventListener(doneEvent, function(evt) {
       Ti.API.info("this = " + this);
       Ti.API.info("self = " + self);
       
       var tests = evt[overallTestsKey];
       var passed = evt[overallPassKey];
       
       // Use self instead of this
       self.textArea.value +=
           "Done! \n" + 
           "Total: " + tests + "\n" + 
           "Passed: " + passed + "\n\n";
       // workAround.textArea.value +=
           // "Done! \n" + 
           // "Total: " + tests + "\n" + 
           // "Passed: " + passed + "\n\n";
       
       overallTests += tests;
       overallPass += passed;
       
       executeNextTest();
   });
   </pre></code>
   Resolved the ticket as Invalid.</li>
<li>Lee Morris 2017-03-24

   Closing ticket as invalid with reference to the above comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17457.json">JSON Source</a></p>