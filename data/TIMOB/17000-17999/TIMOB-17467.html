---
title: "[TIMOB-17467] iOS/Android: Expose request-headers for WebView"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-08-29T21:34:59.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.3.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Components</th><td>Android, iOS</td></tr>
<tr><th>Labels</th><td>TCSupport</td></tr>
<tr><th>Reporter</th><td>Tomasz Krzywda</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2014-07-30T10:37:07.000+0000</td></tr>
<tr><th>Updated</th><td>2017-02-11T13:39:01.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Steps to Reproduce</h4>
The concept is simple, to let user add custom headers to web view requests. Example:
<code><pre>
var webView = Ti.UI.createWebView();
webView.setHeaders({header1: 'Hello', header2: 'World'});
</pre></code>
or directly during creation:
<code><pre>
var webView = Ti.UI.createWebView({
    headers: {header1: 'Hello', header2: 'World'}
});
</pre></code>

<h4>Actual Result</h4>
No acces to web view headers, except for user-agent.

<h4>Expected Result</h4>
Can add custom header to request.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-17467_60750/IMG_0486.JPG">IMG_0486.JPG</td></td><td>2016-11-21T18:54:00.000+0000</td><td>2409773</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Mauro Parra-Miranda 2014-08-07

   Thanks for your report. The priority will be set by the Platform team. </li>
<li>Nuno Costa 2015-10-23

   Any update? There is any possibility to pass a custom referrer URL, like:  https//:app.foo.com ?  
   Thanks</li>
<li>Tomasz Krzywda 2015-10-23

   Sorry, unfortunately I am not working on that project anymore and I can't set up test env.</li>
<li>Michael Gangolf 2016-01-24

   Started a fork:
   
   <a href="https://github.com/m1ga/titanium_mobile/commit/9555725b2fe532bd7f7c46a59fc911da9df6b6da" rel="nofollow" target="_blank">https://github.com/m1ga/titanium_mobile/commit/9555725b2fe532bd7f7c46a59fc911da9df6b6da</a>
   
   you can use it like this:
   
   <code><pre>
   $.www.setHeader({
           "User-Blub": "blablabla",
           "Referer": "<a href="http://www.test.de" rel="nofollow" target="_blank">http://www.test.de</a>"
       });
   </pre></code>
   
   still work in progress but my first tests are working</li>
<li>Manojkumar Murugesan 2016-04-03

   +1 for this feature.
   
   <a href="https://github.com/mano-mykingdom/titanium_mobile/commit/091149c94550acaac8acd1241db558fa3db2ce4b" rel="nofollow" target="_blank">https://github.com/mano-mykingdom/titanium_mobile/commit/091149c94550acaac8acd1241db558fa3db2ce4b</a></li>
<li>Michael Gangolf 2016-08-15

   Cleaned Android PR version: <a href="https://github.com/appcelerator/titanium_mobile/pull/8230" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8230</a></li>
<li>Hans Knöchel 2016-08-17

   Parity-PR for iOS: <a href="https://github.com/appcelerator/titanium_mobile/pull/8239" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8239</a></li>
<li>Hans Knöchel 2016-08-17

   Assigning the review to Ash for Android. After merged, please re-assign the reviewer to [~apetkov] to review and merge the iOS-part. I will update the docs when everything is tested and merged.
   
   Demo for QE (should work cross-platform, [~michael] to confirm):
   <code><pre>
   var webView = Ti.UI.createWebView({
   	url: "<a href="https://httpbin.org/headers" rel="nofollow" target="_blank">https://httpbin.org/headers</a>",
   	requestHeaders: {
   		"User-Blub": "blablabla",
   		"Referer": "<a href="http://www.test.de" rel="nofollow" target="_blank">http://www.test.de</a>",
   		"something": "string1",
   		"other": "string2"
   	}
   });
   
   /* Alternatively, use this setter
   webView.setRequestHeaders({
   	"User-Blub": "blablabla",
   	"Referer": "<a href="http://www.test.de" rel="nofollow" target="_blank">http://www.test.de</a>",
   	"something": "string1",
   	"other": "string2"
   });*/
   
   var win = Ti.UI.createWindow();
   var btn = Ti.UI.createButton({
   	title : "Reload"
   });
   
   btn.addEventListener("click", function() {
   	webView.reload();
   });
   
   win.add(webView);
   win.add(btn);
   win.open();
   
   Ti.API.warn(webView.requestHeaders);
   Ti.API.warn(webView.getRequestHeaders());
   Ti.API.warn(Object.keys(webView.requestHeaders).length);
   </pre></code></li>
<li>Michael Gangolf 2016-08-19

   </li>
<li>Ashraf Abu 2016-08-29

    Android PR <a href="https://github.com/appcelerator/titanium_mobile/pull/8230" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8230</a> merged.
    [~hansknoechel]</li>
<li>Hans Knöchel 2016-08-29

    [~apetkov] to review the iOS-PR.</li>
<li>Abir Mukherjee 2016-11-21

    [~hansknoechel]Attached is a screenshot on a device. Is this what is expected to be seen?
    !IMG_0486.JPG|thumbnail!</li>
<li>Hans Knöchel 2016-11-21

    Yes</li>
<li>Abir Mukherjee 2016-11-22

    Thanks, Hans. So I did verify that the feature works as expected with the following environment:
    NPM Version: 2.15.9
    Node Version: 4.5.0
    Mac OS: 10.12.1
    Appc CLI: 6.0.0
    Appc CLI NPM: 4.2.8
    Titanium SDK version: 6.1.0.v20161122053743
    Appcelerator Studio, build: 4.8.0.201611121409
    Xcode 8.1 GM
    iOS Device: iOS 10.1.1
    Android Device: 6.0.1
    
    I tried the extended demo code provided by Michael G, and tried all three test scenarios. The following tests performed as expected on both the Android and iOS devices:
    1. requestHeaders property are set during creation 
    2. custom headers survive a reload (press button reload, output stays the same)
    3. header can be changed with change header + reload to display the output
    
    </li>
<li>Christoph Eck 2017-02-09

    Hi
    
    I had several issues with the iOS implementation.
    
    <h4>*A second POST request to the same address*: Because of the second loadUrlRequest call it could not send a second POST request. I mean the call </h4>
    <code><pre>
    [self loadURLRequest:newRequest];
    </pre></code>
     in the implementation. I made a fix for that see TIMOB-24329
    But still this fix does not solve all request cycles propberly which can happen in a WebView itself.
    
    <h4>*Own Request-Headers and Basic-Authentication-Headers*: I had a strange behaviour with including Basic Authentication and my own Request-Headers. It was difficult to determine the error but in the end I removed the second [self loadURLRequest:newRequest]; by setting the headers and Basic Authentication in the loadURLRequest itself. See at <a href="https://github.com/chreck/titanium_mobile/commit/4d67118bebe74e9c9f008df1e40327ffb44feb8e" rel="nofollow" target="_blank">https://github.com/chreck/titanium_mobile/commit/4d67118bebe74e9c9f008df1e40327ffb44feb8e</a></h4>
    
    Best regards
    
    Christoph</li>
<li>Christoph Eck 2017-02-10

    Hi
    
    I made a Jira about this issue. AC-4786
    
    Best regards
    
    Christoph</li>
</ol>


<p><a href="/TIMOB/TIMOB-17467.json">JSON Source</a></p>