---
title: "[TIMOB-17473] iOS: Bluetooth LE state restoration callbacks are blocked in Titanium"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 3.3.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>TCSupport, ble, bluetooth, ibeacon, ios</td></tr>
<tr><th>Reporter</th><td>Andrey Pervushin</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2014-07-28T07:13:42.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:04:09.000+0000</td></tr>
</table>

<h3>Description</h3>

The following 2 callbacks never get called in Titanium when adding handling for the callback in a module.

- (void)centralManager:(CBCentralManager *)central willRestoreState:(NSDictionary *)dict
- (void)peripheralManager:(CBPeripheralManager *)peripheral willRestoreState:(NSDictionary *)dict

The code for handling the callbacks works as expected in a native app. 
The same code can be inserted into Titanium module and tested in a Titanium app and you will notice that the the app does restore itself to the background however the callback handlers never fire. 

The callbacks are supposed to be called only when the app was previously in the background, then was killed off by iOS, 
and then some bluetooth activity for the app comes in.

Similarly, the situation occurs for the following iBeacon related callbacks when the app has been killed off.

- (void)locationManager:(CLLocationManager *)manager didDetermineState:(CLRegionState)state forRegion:(CLRegion *)region
- (void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region
- (void)locationManager:(CLLocationManager *)manager didExitRegion:(CLRegion *)region

The above iBeacon related functions are being called under normal circumstances, just not when the app was killed off as they are in a native app.


<h3>Comments</h3>

<ol>
<li>Andrey Pervushin 2014-07-28

   Developing ios module with BLE integration faced with same problem.
   I've asked question here
   <a href="http://developer.appcelerator.com/question/176233/add-code-to-application-didfinishlaunchingwithoptions-from-my-module#answer-280819" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/176233/add-code-to-application-didfinishlaunchingwithoptions-from-my-module#answer-280819</a>
   as a result I've try to add observer in load method but it doesn't work</li>
<li>Ingo Muschenetz 2014-07-28

   Yes, move it please.</li>
<li>Mauro Parra-Miranda 2014-08-08

   Thanks for your report! The Platform team will set the priority on this. </li>
</ol>


<p><a href="/TIMOB/TIMOB-17473.json">JSON Source</a></p>