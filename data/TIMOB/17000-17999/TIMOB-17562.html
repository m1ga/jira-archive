---
title: "[TIMOB-17562] iOS: YQL crashing app on query"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-09-02T22:31:16.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.3.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>supportTeam</td></tr>
<tr><th>Reporter</th><td>Marco Cota</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2014-08-26T18:28:00.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-14T19:50:01.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Issue</h4>

When calling a query to get location using YQL the app crashes with Titanium SDK 3.3.0 while using SDK 3.2.3 is working fine, im attaching the Crash log (crash.txt) we obtain from device Exception Type:  EXC_CRASH (SIGABRT), when we run the test case in the iOS Simulator we receive this:

<code><pre>
[ERROR] :  Assertion failed: (self.method != nil), function -[APSHTTPRequest send], file /Users/vduggal/ForkedRepos/APSHTTPClient/APSHTTPClient/APSHTTPRequest.m, line 66.
</pre></code>

<h4>Steps to repro</h4>

1. Run the test case 

Expected Results:
An alert with the results from the YQL query will prompt

Actual Results:
The app crashes during the query

<h4>Test case</h4>

<code><pre>
var win = Titanium.UI.createWindow({  
    title:'Tab 1',
    backgroundColor:'#fff'
});

var label1 = Titanium.UI.createLabel({
	color:'#999',
	text:'I am Window 1',
	font:{fontSize:20,fontFamily:'Helvetica Neue'},
	textAlign:'center',
	width:'auto'
});

win.add(label1);
	
Ti.Geolocation.purpose = "test";
Titanium.Geolocation.addEventListener('location', locationCallback);	

function locationCallback(evtLocation){
		Titanium.Geolocation.removeEventListener('location', locationCallback);
		var mylongitude = evtLocation.coords.longitude;
		Ti.API.info("mylongitude "+mylongitude);
		var mylatitude = evtLocation.coords.latitude;
		Ti.API.info("mylatitude "+mylatitude);
		
		var query = 'select * from yahoo.maps.findLocation where q="' + mylatitude + ',' + mylongitude + '" and gflags="R"';

		Ti.Yahoo.yql(query, function(e) {
				alert(e);
			});
	
}

win.open();
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-17562_50788/crash.txt">crash.txt</td></td><td>2014-08-26T18:28:00.000+0000</td><td>50498</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Eric Merriman  2014-09-03

   [~ssekhri] Please see if you can reproduce with 3.3.0 SDK and 3.4.0 SDK.</li>
<li>Satyam Sekhri 2014-09-03

   Following are the observation while testing using the test case mentioned in the description above and following environment:
   SDK: 3.4.0.v20140829184521, 3.3.0.GA, 3.2.3.GA
   Studio: 3.4.0.201408291834
   CLI: 3.4.0-dev
   Xcode: Xcode 6 Beta7, Xcode5.1.1
   Devices: iPhone4 (v7.1), iPad Gen4 (v8.0 beta5)
   
   For SDK 3.2.3.GA, the app runs successfully on both the devices and an alert is given.
   
   For SDK 3.3.0.GA, the app crashed on both the devices. The crash logs are similar to the one mentioned above.
   
   For SDK 3.4.0.v20140829184521:
   On iPhone 4 (v7.1) the app runs successfully.
   On iPad Gen4 (v8.0 beta5), the app does not crash but no alert is shown. There is also no alert for allow/deny to authorise the app to use location services (which comes in all other scenarios that ran successfully). The console log shows a message like:
   "<Notice>: ERROR: com.appc.test17562 is depending on legacy on-demand authorization, which is not supported for new apps"</li>
<li>Lee Morris 2017-03-14

   Closing ticket as fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17562.json">JSON Source</a></p>