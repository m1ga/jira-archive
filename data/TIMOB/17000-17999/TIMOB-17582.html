---
title: "[TIMOB-17582] iOS: Unable to check if a JS source file exists on iPad device"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-11-27T07:15:21.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.4.2, Release 3.5.0, Release 4.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>module_filesystem, qe-manualtest</td></tr>
<tr><th>Reporter</th><td>Eduardo Gomez</td></tr>
<tr><th>Assignee</th><td>Chee Kiat Ng</td></tr>
<tr><th>Created</th><td>2014-09-01T12:54:54.000+0000</td></tr>
<tr><th>Updated</th><td>2014-12-19T16:36:16.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Issue description</h4>
Not able to check if a JS source file exists in the app. It only worked in the iOS simulator but not the ipad device. This was initially reproduced on Alloy but attached is a Classic app sample. 

<h4>Steps to replicate </h4>
1) Please grab the sample attached "CaseClassic2559.zip" and launch at iOS Simulator (for Alloy, you may want to use "Case2559.zip").
2) Notice when compiled in the iOS ipad simulator, you will see "I'm Ipad". But it will show "This is Not Ipad" in the real ipad device.

<h4>Additional details</h4>
Alloy 1.4.1 - iPad OS 7.0.4. Also on TiSDK 3.4.0 CI and Alloy 1.6.0-dev.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-17582_50910/Case2559.zip">Case2559.zip</td></td><td>2014-09-01T12:54:54.000+0000</td><td>5919590</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-17582_50911/CaseClassic2559.zip">CaseClassic2559.zip</td></td><td>2014-09-01T12:54:54.000+0000</td><td>3139694</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Joshua Rhinehart 2014-09-02

   The sample works on Simulator, but the file.exists() call fails on device. If you pull the name = controllerName; out of the if loop, it works as expected.</li>
<li>Ingo Muschenetz 2014-09-03

   Is there a way we can just past the sample directly in the ticket? I don't think we need all the supporting files.</li>
<li>Joshua Rhinehart 2014-09-03

   The Alloy index.js is as follows: 
   <code><pre>var createController = Alloy.createController;
   
   /**
    * Override the Alloy createController method.
    * 
    * Prepends 'ipad/' to the controller name if the controller exist in the ipad folder
    */
   Alloy.createController = function(name, args) {
       var osname = Ti.Platform.osname;
       alert(osname);
       var controllerPath = Ti.Filesystem.resourcesDirectory + 'alloy/controllers/';
       // search controller in the os name folder
       var controllerName = osname + '/' + name;
       var file = Ti.Filesystem.getFile(controllerPath, controllerName + '.js');
       Ti.API.log(file.name);
       // load the controller in the platform folder if found, other load the default
       if (file.exists()) {
           name = controllerName;
       }
       
       Ti.API.log(controllerPath);
       Titanium.API.log('Controller Name: ' + name);
       return createController(name, args);
   };
   
   /**
    * Loads "ipad/HelloWorld.js" for ipad, and "HelloWorld.js" for other devices
    */
   var controllerName = 'HelloWorld';
   var label = Alloy.createController(controllerName).getView();
   
   $.index.add(label);
   $.index.open();</pre></code>
   
   and the corresponding app.js from the classic project is here: 
   <code><pre>var getController = function(name) {
       var osname = Ti.Platform.osname;
       if(osname == 'ipad'){
       	name = 'HelloWorld';
       	Ti.API.info('iPad this time');
       }
       var controllerPath = Ti.Filesystem.resourcesDirectory + 'alloy/controllers/';
       // search controller in the os name folder
       var controllerName = osname + '/' + name;
       var file = Ti.Filesystem.getFile(controllerPath, controllerName + '.js');
       Ti.API.info(name +' controllerPath + controllerName: '+ controllerPath + controllerName );
       // load the controller in the platform folder if found, other load the default
       //if (file.exists()) {
           name = controllerName;
           Ti.API.info('file.nativePath: '+ file.nativePath);
           return require('alloy/controllers/' + controllerName).HelloWorld();
       // }else{
       	// Titanium.API.log('Controller Name: ' + controllerName);
       	// return require('alloy/controllers/' + controllerName).HelloWorld();    	
       // }
       
   };
   
   /**
    * Loads "ipad/HelloWorld.js" for ipad, and "HelloWorld.js" for other devices
    */
   var controllerName = 'HelloWorld';
   var label = getController(controllerName);
   
   win1.add(label);
   
   win1.open();</pre></code></li>
<li>Chee Kiat Ng 2014-10-14

   It is discovered that resourcesDirectory doesn't return a reliable result when utilized on iPad devices specifically. After some investigation, it is due to the use of [[NSBundle mainBundle] bundlePath]. Instead of absoluteString, path is recommended to be used when obtaining the path string for NSFileManager according to apple docs.
   By doing so, the resourcesDirectory returned reliable results for devices and simulators.
   
   PR here: <a href="https://github.com/appcelerator/titanium_mobile/pull/6213" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6213</a>
   </li>
<li>Vishal Duggal 2014-11-03

   PR's merged
   master - <a href="https://github.com/appcelerator/titanium_mobile/pull/6300" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6300</a>
   3_4_X - <a href="https://github.com/appcelerator/titanium_mobile/pull/6301" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6301</a></li>
<li>Satyam Sekhri 2014-11-26

   The correct js source file path is evaluated/fetched for both iPad simulator and device.
   Verified on:
   SDK: 3.5.0.v20141125154115
   Studio: 3.4.1.201410281743
   CLI: 3.4.1
   Alloy: 1.5.1
   Device: iPad simulator (8.1), iPad 2(v7.1.2), ipad 4(v8.0)
   Xcode: 6.1</li>
</ol>


<p><a href="/TIMOB/TIMOB-17582.json">JSON Source</a></p>