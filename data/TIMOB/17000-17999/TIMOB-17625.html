---
title: "[TIMOB-17625] iOS: HttpClient with async as false not responding"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2014-09-05T21:27:00.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.3.0, Release 3.4.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>supportTeam</td></tr>
<tr><th>Reporter</th><td>Marco Cota</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2014-09-05T00:07:38.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-21T20:59:04.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Issue</h4>

When setting the async parameter as false in the HttpClient the callbacks unload and on error are not being called in Ti SDK3.3.0 and 3.4.0, the same code in SDK 3.2.3.GA the callback are correctly executed.

<h4>Test code</h4>

Test case attached (network.js)

<h4>app.js</h4>
<code><pre>
var win = Ti.UI.createWindow({
	backgroundColor:'white'
});

var xhr = require('commonjs/xhr');
var url = "<a href="http://roi-stg.mcd.com/mobile/localization/au/v3.1/iPhone/image_resources.zip" rel="nofollow" target="_blank">http://roi-stg.mcd.com/mobile/localization/au/v3.1/iPhone/image_resources.zip</a>";
var sync = true;

function doCall(_url,_method,_sync){
		xhr.doCALL(_method,_url,{},callback,_sync);
}

function callback(_args) {
	alert("HTTPClient " + _args);
    Ti.API.info("HTTPClient " + _args);
}

var view = Ti.UI.createView({
	top:75,
	layout:'vertical'
});

var bt_HEAD = Ti.UI.createButton({
	title: "XHR HEAD"
});
var view2 = Ti.UI.createView({
	layout:'horizontal'
});
var label = Ti.UI.createLabel({
	text:'SYNC',
	width:Ti.UI.SIZE
});
var basicSwitch = Ti.UI.createSwitch({
  value:true // mandatory property for iOS 
});
view2.add(label);
view2.add(basicSwitch);

basicSwitch.addEventListener('change',function(e){
  Ti.API.info('Switch value: ' + basicSwitch.value);
  sync = basicSwitch.value;
});

bt_HEAD.addEventListener('click',function(e){
	doCall(url,'HEAD',sync);
});

view.add(bt_HEAD);
view.add(view2);
win.add(view);
win.open();
</pre></code>

<h4>xhr.js</h4>
<code><pre>
exports.doCALL = function (_method,_url, _params, _callback,_sync){
	// XHR POST
	var xhr = Titanium.Network.createHTTPClient();
	xhr.onload = function(e)
	{
	  _callback(this.responseText);
	};
	xhr.onerror = function(e)
	{
	  _callback('XHR &gt;&gt;&gt; '+JSON.stringify(e));
	};
	xhr.open(_method, _url, _sync);
	xhr.send();
};
</pre></code>

<h4>Steps to repro</h4>

1. Run test case
2. Use the Sync switch and set to false 
3. Press XHR HEAD

Expected Result:
An alert showing the result of the httpClient call.

Actual Result:
No alert is shown as the callbacks are not called.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-17625_50996/network.zip">network.zip</td></td><td>2014-09-05T00:07:38.000+0000</td><td>2455721</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2014-09-05

   Is this not a duplicate of TIMOB-17432?</li>
<li>Pedro Enrique 2014-09-05

   If you're making a SYNC call, there are no callbacks, the code will wait for the "send" call to be done. Try this:
   <code><pre>
   exports.doCALL = function (_method,_url, _params, _callback,_sync){
   	// XHR POST
   	var xhr = Titanium.Network.createHTTPClient();
   	xhr.onload = function(e)
   	{
   	  _callback(this.responseText);
   	};
   	xhr.onerror = function(e)
   	{
   	  _callback('XHR &gt;&gt;&gt; '+JSON.stringify(e));
   	};
   	xhr.open(_method, _url, _sync);
   	xhr.send();
   	// If it's a sync call, you can grab the response text after
   	if(_sync == false) {
   		_callback(xhr.responseText);
   	}
   };
   </pre></code></li>
<li>Pedro Enrique 2014-09-05

   Documentation: <a href="http://docs.appcelerator.com/titanium/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/titanium/latest/#</a>!/api/Titanium.Network.HTTPClient-method-send</li>
<li>Pedro Enrique 2014-09-05

   Marking this as invalid since making asynchronous calls on the HTTP Client does not fire the callback, this is by design. The sample in my previous comments should solve the issue.</li>
<li>Ingo Muschenetz 2014-09-08

   This is a behavior change. In ASIHttp, we specifically hacked around the behavior to make a callback on a synchronous call. In NSURLConnection, we decided this was no longer a good idea and stopped it. In general, we strongly recommend you not use synchronous network calls unless there is a good rationale of doing so.</li>
<li>Lee Morris 2017-03-21

   Closing ticket as invalid.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17625.json">JSON Source</a></p>