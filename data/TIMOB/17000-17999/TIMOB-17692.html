---
title: "[TIMOB-17692] iOS: Cannot load saved images anymore"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-09-26T20:15:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.4.0, Release 3.5.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>TCSupportTriage, regression</td></tr>
<tr><th>Reporter</th><td>Jérôme Danthinne</td></tr>
<tr><th>Assignee</th><td>Jon Alter</td></tr>
<tr><th>Created</th><td>2014-09-10T12:45:10.000+0000</td></tr>
<tr><th>Updated</th><td>2014-11-21T20:26:09.000+0000</td></tr>
</table>

<h3>Description</h3>

This was working fine with SDK 3.3.0, but since 3.4.0-beta, my app cannot load previously saved images anymore...

message = "invalid image type";
[ERROR] :      nativeLocation = "-[TiUIImageView setImage_:] (TiUIImageView.m:685)";
[ERROR] :      nativeReason = "expected TiBlob, String, TiFile, was: TiBlob";

Strangely, it seems to expect a TiBlob, and gets one, but doesn't load it...

<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2014-09-10

   Thank you for the report. Can you please provide a test case?</li>
<li>Jérôme Danthinne 2014-09-10

   Here's a very small part of my app, causing the bug.
   First pick an image, then click "Show Image" to load it.
   
   <code><pre>
   <Alloy>
   	<Window class="container" layout="vertical">
   		<Button title="Pick Image" onClick="PickImage" top="50" />
   		<Button title="Show Image" onClick="ShowImage" />
   		<ImageView id="imageView" width="Ti.UI.FILL" height="300"></ImageView>
   	</Window>
   </Alloy>
   </pre></code>
   <code><pre>
   var imageFilename = "test.jpg";
   function PickImage() {
   	Ti.Media.openPhotoGallery({
   		mediaTypes: [Ti.Media.MEDIA_TYPE_PHOTO],
   		success: function(event) {
   			var f = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory + imageFilename);
   			if (f.exists()) {
   				f.deleteFile();
   				f = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory + imageFilename);
   			}
   			f.write(event.media);
   		}
   	});
   }
   function ShowImage() {
   	var f = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory + imageFilename);
   	if (f.exists()) {
   		var imageBlob = f.read();
   		$.imageView.image = imageBlob;
   	}
   }
   $.index.open();
   </pre></code></li>
<li>Ingo Muschenetz 2014-09-15

   Possibly related to TIMOB-16882.</li>
<li>Jon Alter 2014-09-15

   PR master: <a href="https://github.com/appcelerator/titanium_mobile/pull/6083" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6083</a>
   PR 3_4_X: <a href="https://github.com/appcelerator/titanium_mobile/pull/6084" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6084</a>
   
   <h4>Steps to Test</h4>
   1. Click "Pick Image"
   2. Select a photo
   3. Click "Show Image"
   4. The image should now be visible at the bottom of the screen.
   
   <h4>Test Code</h4>
   <code><pre>
   var win = Ti.UI.createWindow({
   	backgroundColor: 'white'
   });
   win.open();
   
   var button1 = Ti.UI.createButton({
   	title: 'Pick Image',
   	top: 50,
   	height: 50
   });
   button1.addEventListener('click', function() {
   	PickImage();
   });
   win.add(button1);
   
   var button2 = Ti.UI.createButton({
   	title: 'Show Image',
   	top: 150,
   	height: 50
   });
   button2.addEventListener('click', function() {
   	ShowImage();
   });
   win.add(button2);
   
   var imageView = Ti.UI.createImageView({
   	width:Ti.UI.FILL,
   	height:300,
   	bottom: 0,
   	backgroundColor: 'blue'
   });
   win.add(imageView);
   
   var imageFilename = "test.jpg";
   function PickImage() {
       Ti.Media.openPhotoGallery({
           mediaTypes: [Ti.Media.MEDIA_TYPE_PHOTO],
           success: function(event) {
               var f = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory + imageFilename);
               if (f.exists()) {
                   f.deleteFile();
                   f = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory + imageFilename);
               }
               f.write(event.media);
           }
       });
   }
   function ShowImage() {
       var f = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory + imageFilename);
       if (f.exists()) {
           var imageBlob = f.read();
           imageView.image = imageBlob;
       } else {
       	console.log("image does not exist");
       }
   }
   </pre></code></li>
<li>Ewan Harris 2014-09-17

   Verified fix on:
   
   Mac OSX 10.9.4
   Appcelerator Studio, build: 3.4.0.201409131030
   Titanium SDK build:  3.4.0.v20140916151649 
   Titanium CLI, build: 3.4.0-rc4
   Alloy: 1.5.0-rc2 
   Xcode6 GM Seed
   iPhone Device 5 (8.0 GM Seed)
   
   Used the above test code and built to device. The image was shown on the screen after I selected it and clicked 'Show Image'.
   
   Closing ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17692.json">JSON Source</a></p>