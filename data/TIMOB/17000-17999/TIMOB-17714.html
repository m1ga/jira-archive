---
title: "[TIMOB-17714] iOS8: registerForPushNotifications events do not fire, no token returned"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2014-09-17T17:08:18.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.4.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios8</td></tr>
<tr><th>Reporter</th><td>Jason Kneen</td></tr>
<tr><th>Assignee</th><td>Jon Alter</td></tr>
<tr><th>Created</th><td>2014-09-17T13:01:01.000+0000</td></tr>
<tr><th>Updated</th><td>2015-05-25T22:05:29.000+0000</td></tr>
</table>

<h3>Description</h3>

Running latest RC of 3.4 + 3.4.0.v20140916181713 SDK and XCode6

Building with iOS8SDK with the following code:-

<code><pre>
Ti.Network.registerForPushNotifications({
		types : [Ti.App.iOS.NOTIFICATION_TYPE_BADGE, Ti.App.iOS.NOTIFICATION_TYPE_ALERT, Ti.App.iOS.NOTIFICATION_TYPE_SOUND],
		success : onSuccess,
		error : deviceTokenError,
		callback : receivePush
	});
</pre></code>

works and onSuccess is fired, a token is received - but the error :-

"Passing <code>types</code> to registerForPushNotifications is not supported on iOS 8 and greater. Use registerUserNotificationSettings to register notification types."

is reported in the logs

If I use the recommended approach in the docs:-

<code><pre>
Ti.App.iOS.registerUserNotificationSettings({
		types : [Ti.App.iOS.NOTIFICATION_TYPE_BADGE, Ti.App.iOS.NOTIFICATION_TYPE_ALERT, Ti.App.iOS.NOTIFICATION_TYPE_SOUND],
	});

	Ti.Network.registerForPushNotifications({
		success : onSuccess,
		error : deviceTokenError,
		callback : receivePush
	});
</pre></code>

onSuccess is not called, no token received, push is not registered.


<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2014-09-17

   [~wluu] FYI. Can you investigate as well?</li>
<li>Ingo Muschenetz 2014-09-17

   Notes:
   
   <h4>client built their own</h4>
   <h4>so I'm just doing registerForPushNotifications which I guess goes to Apple</h4>
   <h4>and get the device token</h4>
   <h4>then fire the client's API to give them the token</h4>
   <h4>been working fine in iOS7 and iOS8 if I use the old methods</h4>
   <h4>If I change to the new way, doesn't work</h4></li>
<li>Jon Alter 2014-09-17

   [~jkneen] in iOS 8 <code>registerForPushNotifications</code> will not be successful if user notifications for that app are not enabled.
   1. Go to  Settings>Notifications>Your App and make sure that notifications are enabled
   2. When registering, make sure that you only call <code>registerForPushNotifications</code> after the user has opted to allow notifications from your app. This can be done by waiting for the <code>usernotificationsettings</code> event to fire before calling <code>registerForPushNotifications</code>. There is an example of this in the [ti.cloud example app](<a href="https://github.com/appcelerator-modules/ti.cloud/commit/e6c4b8b06806b1d16692f1b53bdf9f03375e7b08#diff-21e2d89e72434de8cdfd659ae14b9ae2R61)." rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.cloud/commit/e6c4b8b06806b1d16692f1b53bdf9f03375e7b08#diff-21e2d89e72434de8cdfd659ae14b9ae2R61).</a>
   </li>
<li>Jason Kneen 2014-09-17

   Is all this + examples in the docs? Doesn't seem like the release notes cover all this.</li>
<li>Jason Kneen 2014-09-17

   Some really odd behaviour has been observed. I've got it working but here's what happened:-
   
   1. Using the code example from above, I'm doing the registernotification call and capturing the usernotificationsettings event, then calling registerForPush etc. 
   2. This didn't work. No notifications entry was created on the phone, registerForPushNotifications never responds.
   3. I changed my code back to put types BACK into the registerForPushNotifications call (which I know I shouldn't need on iOS8)
   4. Reinstalling to device, and running the code, the app appeared in the settings > notifications section *however* it was off
   5. I turned it back on, reverted the code to NOT include the types in the RFP call, and it all worked fine.
   
   The odd thing is, this app was previously authorised on the device, and in the normal notifications settings - it had been authorised prior to the iOS8 upgrade, so not sure if that did something.
   
   The only issue now is the docs don't reflect this process as I've done it. It's not clear you have to trap the event, chain the two together.</li>
<li>Jon Alter 2014-09-17

   Docs are being updated. Resolving.</li>
<li>Timan Rebel 2014-09-18

   I currently have the same issue. On iOS8 and with 3.4.0RC (and also with nightly build), somehow the types are not registered with Apple. Reinstalling does not help and the workaround from [~jkneen] neither. No way I can get the types registered with Apple.
   
   Because types is not registered, there is also no 'Notifications' page in App Settings en can not dis- and enable them.
   
   I will keep investigating and if I find a cause, I will report it here. But note that Jason and Ingo are not the only ones having this issue.</li>
<li>Timan Rebel 2014-09-18

   I found the cause of [~jkneen]'s original issue and mine as well. The types have been renamed from Ti.App.iOS.NOTIFICATION* to Ti.App.iOS.USER_NOTIFICATION*</li>
<li>Chad Stachowicz 2015-05-25

   What is the fix to this, this is happening to my on iOS8 and it worked fine on appcelerator 3.3 and iOS7?  Is it just expected push notification will never work again on iOS?  Should we be looking at other platforms if we want to use push?  Please help, this complaint is all over the google and jira...</li>
<li>Chad Stachowicz 2015-05-25

    </li>
</ol>


<p><a href="/TIMOB/TIMOB-17714.json">JSON Source</a></p>