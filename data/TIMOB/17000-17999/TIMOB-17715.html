---
title: "[TIMOB-17715] Android: Cannot open new window after last window closes"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2014-09-18T17:39:31.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, regression</td></tr>
<tr><th>Reporter</th><td>Caleb Cox</td></tr>
<tr><th>Assignee</th><td>Ping Wang</td></tr>
<tr><th>Created</th><td>2014-09-17T02:17:18.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T21:51:21.000+0000</td></tr>
</table>

<h3>Description</h3>

After closing the last window on Android, when attempting to open a new window, the app crashes with the "Unfortunately app has stopped" message. Here is the stack trace that I get:
{noformat}
E/AndroidRuntime( 2450): FATAL EXCEPTION: main
E/AndroidRuntime( 2450): Process: com.appdev.test, PID: 2450
E/AndroidRuntime( 2450): java.lang.NullPointerException
E/AndroidRuntime( 2450): 	at android.content.ComponentName.<init>(ComponentName.java:77)
E/AndroidRuntime( 2450): 	at android.content.Intent.<init>(Intent.java:3813)
E/AndroidRuntime( 2450): 	at ti.modules.titanium.ui.WindowProxy.handleOpen(WindowProxy.java:128)
E/AndroidRuntime( 2450): 	at org.appcelerator.titanium.proxy.TiWindowProxy.handleMessage(TiWindowProxy.java:88)
E/AndroidRuntime( 2450): 	at ti.modules.titanium.ui.WindowProxy.handleMessage(WindowProxy.java:399)
E/AndroidRuntime( 2450): 	at android.os.Handler.dispatchMessage(Handler.java:98)
E/AndroidRuntime( 2450): 	at android.os.Looper.loop(Looper.java:136)
E/AndroidRuntime( 2450): 	at android.app.ActivityThread.main(ActivityThread.java:5017)
E/AndroidRuntime( 2450): 	at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime( 2450): 	at java.lang.reflect.Method.invoke(Method.java:515)
E/AndroidRuntime( 2450): 	at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:779)
E/AndroidRuntime( 2450): 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:595)
E/AndroidRuntime( 2450): 	at dalvik.system.NativeStart.main(Native Method)
{noformat}

Here is the test case that I am using:
<code><pre>
var openWindow = function(index) {
    var window = Ti.UI.createWindow({
        backgroundColor: 'white',
        title: 'Window ' + index
    });
    var button = Ti.UI.createButton({
        width: 80,
        height: 40,
        title: 'Button'
    });
    button.addEventListener('click', function() {
        window.close();
        openWindow(index + 1);
    });
    window.add(button);
    window.open();
};
openWindow(1);
</pre></code>

It successfully closes the first window but crashes when attempting to open the second window. It works when opening the second window before closing the first.

<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2014-09-17

   May I ask what classifies this as a regression? Did it previously work in an earlier version of the SDK?</li>
<li>Caleb Cox 2014-09-17

   Yes, the exact same code runs without crashing using Titanium SDK 3.2.3. Sorry for not explicitly mentioning that earlier.</li>
<li>Ingo Muschenetz 2014-09-17

   [~pwang] can you please take a look?</li>
<li>Ping Wang 2014-09-17

   Starting from 3.3.0, we set exitOnClose to true by default for the first window (see [PR#5602](<a href="https://github.com/appcelerator/titanium_mobile/pull/5602))" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5602))</a>, which means once the first window is closed the whole application is closed. That's why the app crashes when you open the second window.
   
   To make the above test case run, we can modify it
   <code><pre>
   var openWindow = function(index) {
       var window = Ti.UI.createWindow({
           backgroundColor: 'white',
           title: 'Window ' + index,
           exitOnClose: false  //Override the default behavior
       });
       var button = Ti.UI.createButton({
           width: 80,
           height: 40,
           title: 'Button'
       });
       button.addEventListener('click', function() {
           window.close();
           openWindow(index + 1);
       });
       window.add(button);
       window.open();
   };
   openWindow(1);
   </pre></code></li>
<li>Caleb Cox 2014-09-17

   I verified that the change you suggested fixes my issue. Thanks for your help! Someone should update the documentation to reflect the new default value of exitOnClose.</li>
<li>Ping Wang 2014-09-18

   This change has been in the 3.3.0 Release Notes. Will update the default value of exitOnClose.
   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/6127" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6127</a>
   3_4_X PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/6128" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6128</a>
   Resolved the ticket as invalid.</li>
<li>Mark Mokryn 2014-10-02

   </li>
<li>Lee Morris 2017-03-22

   Closing ticket as invalid with reference to previous comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17715.json">JSON Source</a></p>