---
title: "[TIMOB-17731] Installation failed, longjohn.js 185 - has no method 'indexOf'"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-01-30T09:09:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.4.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>3.3.0.GA, TCSupport, android, installation, mobile</td></tr>
<tr><th>Reporter</th><td>Gianpaolo</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2014-07-22T09:30:10.000+0000</td></tr>
<tr><th>Updated</th><td>2020-01-30T16:49:21.000+0000</td></tr>
</table>

<h3>Description</h3>

Hi, 
when i try to build an application and launch it on the emulator, the console gives me this error:
<code><pre>
[INFO] :   Installing apk: /home/username/Documenti/Ti_Workspace/projectName/build/android/bin/projectName-dev-debug.apk
[ERROR] Application Installer abnormal process termination. Process exit value was 8
[TRACE] :  Checking if package manager service is started
/usr/local/lib/node_modules/titanium/node_modules/longjohn/dist/longjohn.js:185
        throw e;
              ^
has no method 'indexOf'
</pre></code>
complete log here: 
[Complete Log on PasteBin](<a href="http://pastebin.com/Q18pHFsA)" rel="nofollow" target="_blank">http://pastebin.com/Q18pHFsA)</a>

this is my complete environment: 
[Complete Environment on PasteBin](<a href="http://pastebin.com/jyiAW5ZN)" rel="nofollow" target="_blank">http://pastebin.com/jyiAW5ZN)</a>

<h3>Comments</h3>

<ol>
<li>Gianpaolo 2014-07-23

   have found a workaround...
   file: /home/user/.titanium/mobilesdk/linux/3.3.0.GA/android/cli/hooks/run.js
   from row 189 to 193
   from this
   <code><pre>
   if (output.indexOf('system_server') === -1) {
   	logger.trace(__('Package manager not started yet, trying again in %sms...', retryInterval));
   	intervalTimer = setTimeout(installApp, retryInterval);
   	return;
   }
   </pre></code>
   to this
   <code><pre>
   //if (output.indexOf('system_server') === -1) {
   //	logger.trace(__('Package manager not started yet, trying again in %sms...', retryInterval));
   //	intervalTimer = setTimeout(installApp, retryInterval);
   //	return;
   //}
   </pre></code></li>
<li>Ashley Sommer 2014-08-08

   I have this same problem, using 3.3.0.GA, and latest Android SDK.
   It appears the issue is caused because the output variable from the 'ps' command is a javascript [object Object] rather than a string.
   A better workaround is to change line  198 to:
   <code>if (output.toString().indexOf('system_server') === -1) {</code></li>
<li>Jérémy Tonneau 2014-08-21

   Hi,
   
   I have been recently faced by the same issue.
   "if (output.toString().indexOf('system_server') === -1) {" saved me !!!!
   
   
   Regards.</li>
<li>Mauro Parra-Miranda 2014-08-21

   Thanks [~daorithos] for the report! [~ingo]: can you please assign Gianpaolo ([~daorithos]) as the Reporter? TIA! </li>
<li>Chris Barber 2020-01-30

   Upon investigation, it seems the fix in the comments was put in place back in 3.4.0.
   
   <a href="https://github.com/appcelerator/titanium_mobile/pull/5915" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5915</a>
   
   Marking as fixed.</li>
<li>Sohail Saddique 2020-01-30

   Fix verified in build: 9.0.0.v20200130071742. The fix that was put in place in 3.4.0 still exists today. Ticket closed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17731.json">JSON Source</a></p>