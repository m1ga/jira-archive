---
title: "[TIMOB-17747] Android: Native module onStart() lifecycle method never called for Alloy project"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Done</td></tr>
<tr><th>Resolution Date</th><td>2015-06-17T02:59:39.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.3.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 4.1.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>TCSupport</td></tr>
<tr><th>Reporter</th><td>James Falkner</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2014-08-05T18:32:19.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-16T21:42:48.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem Description</h4>
I have created a native module that has some code in an <code>onStart()</code> method - when importing this module in my alloy controller using <code>require()</code>, the <code>onStart()</code> method is called when the root activity is started when using Titanium SDK 3.2.3.GA, but when using 3.3.0, it is never called.

I have properly declared the module in my <code>tiapp.xml</code> and my <code>onStart()</code> method is pretty simple:

{noformat}
	@Override
	public void onStart(Activity activity)
	{
		// This method is called when the module is loaded and the root context is started

		Log.d(TAG, "[MODULE LIFECYCLE EVENT] start");
		super.onStart(activity);
	}
{noformat}

In 3.2.3.GA I see the debug message in the <code>logcat</code> output - but using 3.3.0.GA I never see it (however I do see the <code>onPause</code> and <code>onStop</code> lifecycle methods are properly called.

My native module depends on some initialization code in <code>onStart</code> that cannot be moved to <code>onAppCreate</code>, so it's currently failing as <code>onStart</code> is never called (nor is <code>onPause</code> which is a bit suspect).

Also, for a non-Alloy app, this does not happen -- all of the lifecycle methods, including <code>onStart</code> are called as expected.


<h4>Steps to reproduce.</h4>
1. Download the module from this [link](<a href="https://github.com/jamesfalkner/liferay-android-beacons/blob/master/dist/com.liferay.beacons-android-0.1.zip)" rel="nofollow" target="_blank">https://github.com/jamesfalkner/liferay-android-beacons/blob/master/dist/com.liferay.beacons-android-0.1.zip)</a>
2. Create a titanium classic project
3. Paste this code:
<code><pre>
var win = Ti.UI.createWindow({
    backgroundColor:'white'
});
var label = Ti.UI.createLabel();
win.add(label);
win.open();
 
if (Ti.Platform.name == "android") {
    var mod = require('com.liferay.beacons');
    label.text = "module is => " + mod + "and checkAvailability says: " + mod.checkAvailability();
} else {
    label.text = "liferay.beacons not supported on " + Ti.Platform.name;
}
</pre></code>


<h4>Steps to reproduce the issue with alloy (which is easier to reproduce)</h4>
1. Create a new alloy project
2. Paste this to index.js:
<code><pre>
var mod = require('com.liferay.beacons');
$.label.text= "module is => " + mod + "and checkAvailability says: " + mod.checkAvailability();
function doClick(e) {
    alert($.label.text);
}
 
$.index.open();
</pre></code>
3. Run it in a device. 



<h3>Comments</h3>

<ol>
<li>Mauro Parra-Miranda 2014-08-10

   Hello,
   just to summarize (and correct me if I'm wrong):
   
   The onStart works: 
   
   3.2.3+Classic - OK
   3.2.3+Alloy - OK
   3.3.0+Classic - OK
   3.3.0+Alloy - FAIL.
   
   Do you agree?
   
   Best Regards</li>
<li>James Falkner 2014-08-10

   Yep, that's right :) </li>
<li>Joe Falcone 2014-08-30

   We've observed the same thing with "Classic" projects and 3.3.0 - it depends on the complexity of app.js, which modules are loaded, etc.
   If I take one of our apps, and strip it down to the basics, I can get the onStart event.
   If I add everything back plus modules, I don't.</li>
<li>Joe Falcone 2014-08-30

   Likewise with onCreate if you're looking for that event.  Used to get it in 3.2.x SDK, not in 3.3.0.</li>
<li>Federico Casali 2014-12-09

   </li>
<li>Ashraf Abu 2015-06-11

   </li>
<li>Ashraf Abu 2015-06-17

   To create a module that hooks to the lifecycle, take a look at here: <a href="https://github.com/appcelerator-modules/ti.facebook/blob/master/android/src/facebook/ActivityWorkerProxy.java" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.facebook/blob/master/android/src/facebook/ActivityWorkerProxy.java</a>
   
   And create the proxy as mentioned <code><pre>win1.fbProxy = fb.createActivityWorker({lifecycleContainer: win1});</pre></code>
   
   Hopefully this no longer is an issue and I'll close this as resolved. If this is still posing a problem, do comment.</li>
<li>Lee Morris 2017-03-16

   Can confirm that this was done.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17747.json">JSON Source</a></p>