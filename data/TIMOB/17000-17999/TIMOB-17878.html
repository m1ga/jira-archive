---
title: "[TIMOB-17878] Apps has last session one month in the future"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Nam Le</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2014-10-20T21:30:55.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T20:04:21.000+0000</td></tr>
</table>

<h3>Description</h3>

This is a spin-off of APPTS-6299. For the TUI Travel Org (100000172), there are Android sessions that last occurred on November 20th, 2014. 

The first step in the investigation is to see if the session summary and raw events contain a event that has that timestamp (to rule out that it is a bug in the PEM logic). If the data is there, then it's a possible issue with the SDK and it will be moved there for investigation.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-17878_52069/Screen Shot 2014-10-20 at 2.31.23 PM.png">Screen Shot 2014-10-20 at 2.31.23 PM.png</td></td><td>2014-10-20T21:34:48.000+0000</td><td>276835</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Isaac Whitfield 2014-10-20

   [~nle] can you be a bit more specific as to when the last session was? Do you have the timestamp reported by PEM? Even better would be the query that Dashboard uses to get this timestamp. </li>
<li>Isaac Whitfield 2014-10-20

   Eh, this should be moved to SDK. I just found a raw event here with a timestamp of March 2015.
   
   <code><pre>
   {
           "continent_code": "AS",
           "ts": "2015-03-24T12:40:06.405+0000",
           "area_code": 0,
           "deploytype": "production",
           "data": [
               {
                   "lvalue": 330,
                   "key": "tz"
               },
               {
                   "svalue": "iphone",
                   "key": "os"
               },
               {
                   "svalue": "WIFI",
                   "key": "nettype"
               },
               {
                   "svalue": "production",
                   "key": "deploytype"
               },
               {
                   "svalue": "6.1.255",
                   "key": "app_version"
               },
               {
                   "svalue": "7.0.3",
                   "key": "osver"
               },
               {
                   "svalue": "3.2.3.GA",
                   "key": "version"
               },
               {
                   "svalue": "iphone",
                   "key": "platform"
               },
               {
                   "svalue": "iPad4,4",
                   "key": "model"
               }
           ],
           "ver": "2",
           "type": "ti.start",
           "country_name": "India",
           "city": "",
           "id": "1E8AADB1-6FF9-4358-BB80-F089F04723BD",
           "region_name": "",
           "oid": "100000172",
           "event": "ti.start",
           "longitude": 77,
           "rdu": null,
           "sid": "27E02C3A-DBBB-44AB-B7D3-C096F2195636",
           "country_code": "IN",
           "aguid": "2261737c-bffd-46d3-9940-45a0362643c7",
           "ip_address": "59.165.251.191",
           "arrivalTime": 1413805255327,
           "region_code": "",
           "postal_code": "",
           "seq": 0,
           "latitude": 20,
           "mid": "1B0C4832-AF8A-4754-884F-2251AC795472"
       }
   </pre></code>
   
   Found via:
   
   <code><pre>
   curl -s "http://localhost:9200/oid100000172/_search?pretty=true" -d '{
       "filter" : {
         "match_all" : { }
       },
       "sort": [
         {
           "last": {
             "order": "desc"
           }
         }
       ],
       "size": 1
   }'
   
   curl -s -i -X GET -H "X-Auth-Token:8ef66f2a-c166-43cb-b5c8-0cfd375362be" "<a href="http://pem-next-rest-api.elasticbeanstalk.com:80/rest/event/id/1E8AADB1-6FF9-4358-BB80-F089F04723BD" rel="nofollow" target="_blank">http://pem-next-rest-api.elasticbeanstalk.com:80/rest/event/id/1E8AADB1-6FF9-4358-BB80-F089F04723BD</a>"
   </pre></code></li>
<li>Nam Le 2014-10-20

   [~ingo] Can we investigate whether this is a bug with the SDK? Could it be a user error, for instance of the app user changes the date on the device to be a future date, when the SDK sends the event, it would use the device's date (which is set to the future)?</li>
<li>Ingo Muschenetz 2014-10-20

   [~nle] It would be difficult for me to investigate without a set of steps to reproduce. Here is the code:
   
   <a href="https://github.com/appcelerator/aps_sdk/blob/master/ios/support/analytics/APSAnalytics/APSAnalytics.m#L460" rel="nofollow" target="_blank">https://github.com/appcelerator/aps_sdk/blob/master/ios/support/analytics/APSAnalytics/APSAnalytics.m#L460</a>
   
   Which references:
   
   <a href="https://github.com/appcelerator/aps_sdk/blob/master/ios/support/analytics/APSAnalytics/APSUtility.m#L200" rel="nofollow" target="_blank">https://github.com/appcelerator/aps_sdk/blob/master/ios/support/analytics/APSAnalytics/APSUtility.m#L200</a>
   
   It appears it uses the current date on the phone.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17878.json">JSON Source</a></p>