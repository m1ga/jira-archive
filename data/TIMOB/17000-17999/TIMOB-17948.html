---
title: "[TIMOB-17948] Android: Support SSL SNI on Apache HTTP Client"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Done</td></tr>
<tr><th>Resolution Date</th><td>2015-05-29T03:21:55.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 4.1.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, httpclient</td></tr>
<tr><th>Reporter</th><td>Philippe Wueger</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2014-10-31T10:04:38.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-16T21:42:12.000+0000</td></tr>
</table>

<h3>Description</h3>

Google recommends using HttpURLConnection instead of the Apache HTTP client, see:

<a href="http://developer.android.com/reference/org/apache/http/impl/client/DefaultHttpClient.html" rel="nofollow" target="_blank">http://developer.android.com/reference/org/apache/http/impl/client/DefaultHttpClient.html</a>
<a href="http://android-developers.blogspot.ch/2011/09/androids-http-clients.html" rel="nofollow" target="_blank">http://android-developers.blogspot.ch/2011/09/androids-http-clients.html</a>

Switching to HttpsURLConnection would further support SSL SNI, see:
<a href="https://developer.android.com/training/articles/security-ssl.html" rel="nofollow" target="_blank">https://developer.android.com/training/articles/security-ssl.html</a>
{quote}
Fortunately, HttpsURLConnection supports SNI since Android 2.3. Unfortunately, Apache HTTP Client does not, which is one of the many reasons we discourage its use. 
{quote}
<a href="http://stackoverflow.com/questions/5879894/android-ssl-sni-support" rel="nofollow" target="_blank">http://stackoverflow.com/questions/5879894/android-ssl-sni-support</a>

Please consider switching to HttpURLConnection/HttpsURLConnection.

Thank you.

<h3>Comments</h3>

<ol>
<li>Gertjan Smits 2014-11-14

   Any updates on this?</li>
<li>Ilya Kruglik 2014-12-15

   Is this issue going to be assigned to any of the nearest releases?</li>
<li>Shannon Hicks 2015-02-18

   Looks like Apache supports SNI now too. [HttpComponents HttpClient 4.3.2 Released ](<a href="http://mail-archives.apache.org/mod_mbox/www-announce/201401.mbox/%3CCACZkXPx4Rs7YQmau6h8812K_A5XVdfwo18tkvWBG=EV-9vh2XQ@mail.gmail.com%3E)" rel="nofollow" target="_blank">http://mail-archives.apache.org/mod_mbox/www-announce/201401.mbox/%3CCACZkXPx4Rs7YQmau6h8812K_A5XVdfwo18tkvWBG=EV-9vh2XQ@mail.gmail.com%3E)</a></li>
<li>Rudy Otzen 2015-03-05

   Any idea when this will be fixed?</li>
<li>Ingo Muschenetz 2015-03-05

   It will likely be addressed in upcoming sprint. However, it looks like it's not necessary to switch--just to upgrade to a newer Apache HTTP client. Anyone wish to try dropping in a newer version of the library?</li>
<li>Ashraf Abu 2015-05-15

   <a href="https://hc.apache.org/httpcomponents-client-4.3.x/android-port.html" rel="nofollow" target="_blank">https://hc.apache.org/httpcomponents-client-4.3.x/android-port.html</a>
   
   This library would be the best to drop in. There would probably need to be changes in the code as well and it needs to be tested.
   
   Any comments on doing it this way?</li>
<li>Ashraf Abu 2015-05-29

   </li>
<li>Lee Morris 2017-03-16

   Can confirm that this was done.</li>
</ol>


<p><a href="/TIMOB/TIMOB-17948.json">JSON Source</a></p>