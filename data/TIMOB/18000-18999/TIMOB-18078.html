---
title: "[TIMOB-18078] iOS: Ti.Stream.read() doesn't work with Ti.Filesystem.FileStream"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-11-26T22:43:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.4.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.5.0, Release 4.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>module_stream, parity, qe-manualtest</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2014-11-24T13:18:39.000+0000</td></tr>
<tr><th>Updated</th><td>2014-12-01T18:09:19.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>problem</h4>

Using <code>Ti.Stream.read()</code> with an open <code>Ti.Filesystem.FileStream</code> does nothing. The read call never invokes the result callback. Android works fine, but iOS always fails as described above, despite the documentation indicating that both support <code>Ti.Stream.read()</code> on FileStream. Without this support there is no asynchronous way to read files with Titanium on iOS, all reads must be blocking.

<h4>test case</h4>

<code><pre>
var file = Ti.Filesystem.getFile('app.js')
var stream = file.open(Ti.Filesystem.MODE_READ);
var buffer = Ti.createBuffer({length:8096});
Ti.Stream.read(stream, buffer, function(e) {
    Ti.API.error('I never get here');
    Ti.API.error(e);
});
</pre></code>

<h4>expected</h4>

The results callback should return an event object (<code>e</code>) containing all relevant information regarding the read operation. Both <code>Ti.API.error</code> calls should execute and print the results.

<h4>actual</h4>

The results callback is never executed. Nothing is printed.

<h3>Comments</h3>

<ol>
<li>Vishal Duggal 2014-11-24

   Pull pending
   master - <a href="https://github.com/appcelerator/titanium_mobile/pull/6381" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6381</a>
   3_5_X - <a href="https://github.com/appcelerator/titanium_mobile/pull/6382" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6382</a></li>
<li>Khushbu Agrawal 2014-11-26

   [~tlukasavage] I tried to verify this ticket with the above mentioned testcase. It's crashing while opening the file object. 
   Can you please have a look? </li>
<li>Wilson Luu 2014-11-26

   Closing ticket as fixed. Verified Ti.Stream.read() is working i.e. the event object is returned back in the callback. Used the following modified code:
   <code><pre>
       var file = Ti.Filesystem.getFile('timob18078.txt');
       var stream = file.open(Ti.Filesystem.MODE_READ);
       var buffer = Ti.createBuffer({length:8096});
       
       Ti.Stream.read(stream, buffer, function(e) {
           Ti.API.error('I never get here');
           Ti.API.error(e);
       });
   </pre></code>
   
   Instead of Ti.Filesystem.getFile('app.js'), created another text file and used Ti.Filesystem.getFile('timob18078.txt'); I think you will not be able to access app.js via Ti.Filesystem.getFile because of security reasons.
   
   Tested on:
   
   Appcelerator Studio, build: 3.4.1.201410281743
   SDK build: 3.5.0.v20141125154115
   CLI: 3.4.1
   Alloy: 1.5.1
   Xcode: 6.1.1 GM Seed
   Devices: iphone 6 plus (8.1), Samsung Galaxy S4 (4.4.2)</li>
<li>Khushbu Agrawal 2014-11-27

   [~wluu] Thanks for clarifying it.</li>
<li>Tony Lukasavage 2014-11-27

   Yeah, I believe app.js will only work on simulator tests. Thanks for the fix.</li>
</ol>


<p><a href="/TIMOB/TIMOB-18078.json">JSON Source</a></p>