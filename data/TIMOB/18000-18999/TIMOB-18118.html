---
title: "[TIMOB-18118] iOS: ti.cloud - App crashes on launch if you require in ti.cloud module with SDK 3.5.0"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2014-12-07T23:34:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.5.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 3.5.0, Release 4.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>qe-3.5.0, regression</td></tr>
<tr><th>Reporter</th><td>Wilson Luu</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2014-12-02T02:59:44.000+0000</td></tr>
<tr><th>Updated</th><td>2014-12-08T19:32:30.000+0000</td></tr>
</table>

<h3>Description</h3>

*Details:* If you require in the GA ti.cloud module (3.2.7) into your app running SDK 3.5.0, then your app will crash on launch. Specifically, this line of code from ti.cloud.js: <code>if (null != b && null != e)</code>. However, if you use strict equal, e.g. <code>if (null !== b && null !== e)</code>, then the app will launch fine.

*Notes:*
* This is a *regression* as this does not occur in SDK 3.4.1.GA
* -This issue it *not reproducible* if you require in APM-

*Steps to reproduce:*
1. Create the default Titanium classic app
2. Include this snippet of code in app.js (snippet of code is from ti.cloud.js):
<code><pre>
var e;

null == e && (e = {});

e.declareClass = function(a, d, b) {
    var e = a[d];
    a[d] = b;
    if (null != b && null != e)
        for (var f in e) "prototype" != f && (b[f] = e[f]);
    return b
};

e.declareClass(e, "SignatureMethod", function() {});
</pre></code>
3. Install app to device
4. Launch app

*Actual:* App will crash on launch; see crash.log and console.log.
*Expected:* App should not crash if you require in the GA ti.cloud module.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-18118_52939/console.log">console.log</td></td><td>2014-12-02T02:59:44.000+0000</td><td>1395538</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-18118_52938/crash.log">crash.log</td></td><td>2014-12-02T02:59:44.000+0000</td><td>44070</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-18118_52967/ti.cloud.js">ti.cloud.js</td></td><td>2014-12-02T21:22:41.000+0000</td><td>51503</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2014-12-02

   [~wluu], since the module is common.js, can you strip down the module to see if you can narrow down the cause?</li>
<li>Wilson Luu 2014-12-02

   More info:
   
   After beautifying ti.cloud.js and further investigation with Jon, line 681 - 927 seems to be the cause of the issue. It looks like that block of code is using old OAuth code from Netflix.
   
   And, if I comment out the block of code (line 681 - 927) and repeat the reproducible steps, my app does not crash. Attached my modified ti.cloud.js.</li>
<li>Wilson Luu 2014-12-03

   More info:
   
   In the block of code that I mentioned above (line 681 - 927), the exact error is occurring in the following function:
   <code><pre>
   e.declareClass = function(a, d, b) {
       var e = a[d];
       a[d] = b;
       if (null != b && null != e)
           for (var f in e) "prototype" != f && (b[f] = e[f]);
       return b
   };
   </pre></code>
   
   For what ever reason, the function is not reaching the return statement.</li>
<li>Kajenthiran Velummaylum 2014-12-04

   TIMOB-18135 is similar bug to this scenario.
   
   Following is the actual code of crash here
   <code><pre>
   if (null != b && null != e) // It crashes in this line if either 'b' or 'e' is null.
           // some code here
   </pre></code></li>
<li>Wilson Luu 2014-12-08

   Closing ticket as fixed. Verified that if you require in ti.cloud 3.2.7 into your app.js, your app will not crash. Also, verified the above sample code does not make the app crash.
   
   Tested on:
   
   Appcelerator Studio, build: 3.4.1.201410281743
   SDK build: 3.5.0.v20141208092926
   CLI: 3.4.1
   Alloy: 1.5.1
   Xcode: 6.1.1 GM 
   Devices: iphone 6 plus (8.1.1)
   
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-18118.json">JSON Source</a></p>