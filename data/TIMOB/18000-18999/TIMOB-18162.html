---
title: "[TIMOB-18162] CLI: Implement proxy autodetection from titanium-connection-test in ti setup"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-03-20T18:16:59.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 4.0.0, Release 4.1.0</td></tr>
<tr><th>Components</th><td>CLI</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Tim Poulsen</td></tr>
<tr><th>Assignee</th><td>Feon Sua Xin Miao</td></tr>
<tr><th>Created</th><td>2014-12-09T17:06:20.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-16T22:22:54.000+0000</td></tr>
</table>

<h3>Description</h3>

The <a href="https://github.com/appcelerator/titanium-connection-test" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium-connection-test</a> project automatically detects the proxy server configuration, if any is in use. This ticket is to implement those functions into the CLI. Auto-detection would augment the existing CLI network configuration functionality whereby users manually configure their proxy server settings.

General plan: developer would run <code>ti setup</code> and choose Network. After selecting "yes" that they are behind a proxy, the CLI would attempt to detect the proxy settings and present them to the user for confirmation. If values are correct, user should be able to just accept defaults. If incorrect, values entered by the user are what is saved and used by the CLI.

<h3>Comments</h3>

<ol>
<li>Tim Poulsen 2015-01-29

   <a href="https://github.com/appcelerator/titanium/pull/184" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium/pull/184</a>
   
   This needs some careful review and input on the logic. 
   
   A system could have more than one proxy configured (i.e. one for http and one for https) and could support multiple interfaces (wired & wifi for example). Our CLI supports only one proxy address and assumes all traffic will go through it. With that in mind, my code favors the first interface found, favors https over http, and in the case of OS X, favors proxies configured in the shell environment over those configured in the OS X Network settings applet. 
   
   On Windows and Linux, only proxies listed in the shell environment are used. Again, https is favored over http.
   
   FR steps on OS X:
   
   1. Open System Preferences, choose Network. Select your active network connection (e.g. Wi-Fi). Click Advanced. Click Proxies. Check Secure Web Proxy (HTTPS) and enter a URL and port into the boxes. Click OK. Click Apply.
   2. Run <code>ti setup</code> and choose <code>n</code>, enter "yes" when prompted if you're behind a proxy. The suggested address should be the one you entered in System Preferences. Press Enter twice then <code>x</code> to finish.
   3. Edit your ~/.titanium/config.json file to remove the CLI "httpProxyServer" key (can't do this through ti setup because of TIMOB-18138)
   4. Using System Preferences, remove the proxy (uncheck Secure Web Proxy).</li>
<li>Sujeet Mishra 2015-02-11

   FR passed..</li>
<li>Sujeet Mishra 2015-02-12

   CR done..</li>
<li>Tim Poulsen 2015-02-12

   If FR & CR are done, can you merge [~smishra] and mark this ticket as "passed"?</li>
<li>Sujeet Mishra 2015-02-12

   merged ...</li>
<li>Feon Sua Xin Miao 2015-03-20

   4_0_X: <a href="https://github.com/appcelerator/titanium/pull/206" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium/pull/206</a></li>
<li>Lee Morris 2017-03-16

   Closing ticket as fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-18162.json">JSON Source</a></p>