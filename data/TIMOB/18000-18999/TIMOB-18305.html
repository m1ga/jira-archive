---
title: "[TIMOB-18305] Android: Default unit not respected in all cases"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>Android, dafaultunit</td></tr>
<tr><th>Reporter</th><td>Ivan Skugor</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2014-11-06T15:37:19.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T19:54:48.000+0000</td></tr>
</table>

<h3>Description</h3>

Hi there.


When setting default value in tiapp.xml to density independent units (which you want to use because it makes calculations easier):

<code><pre>
&lt;property name="ti.ui.defaultunit" type="string"&gt;dip&lt;/property&gt;
</pre></code>

Titanium doesn't respect that value in all cases. I've noticed 2 cases, but there may be more:

<code><pre>
var win = Ti.UI.createWindow();

Ti.API.info('Platform width & height');
Ti.API.info(Ti.Platform.displayCaps.platformWidth);
Ti.API.info(Ti.Platform.displayCaps.platformWidth / Ti.Platform.displayCaps.logicalDensityFactor);
Ti.API.info(Ti.Platform.displayCaps.platformHeight);
Ti.API.info(Ti.Platform.displayCaps.platformHeight / Ti.Platform.displayCaps.logicalDensityFactor);

var view = Ti.UI.createView({
	height: Ti.UI.SIZE,
	layout: "vertical"
});

view.add(Ti.UI.createView({ height: 50, backgroundColor: "#f00" }));
view.add(Ti.UI.createView({ height: 50, backgroundColor: "#0f0" }));
view.add(Ti.UI.createView({ height: 50, backgroundColor: "#00f" }));

view.addEventListener("click", function(e) {
	Ti.API.info("on click");
	Ti.API.info(e.y);
	Ti.API.info(Math.round(e.y / Ti.Platform.displayCaps.logicalDensityFactor));
});

win.add(view);

win.open();
</pre></code>


Run this code after you've set default unit in tiapp.xml. Firstly, you'll see that to get correct platform width and height, you need to divide values with "logicalDensityFactor". Same thing happens if you want to get coordinates in "click" event. For example, if you click on bottom of red view, you'll see that you'll get x values greater than 50, which is obviously wrong (please note that value should be rounded with 1 decimal point to make this identical to iOS).


I'm not sure are there more cases, so please update test case if there are.

<h3>Comments</h3>

<ol>
<li>Fokke Zandbergen 2015-01-05

   Any progress on fixing the last few API's not respecting the default unit? Apart from this case I know the same is at least true for events passing x/y coordinates.</li>
<li>Ivan Skugor 2015-01-05

   I covered events too :)</li>
<li>Fokke Zandbergen 2015-01-05

   I should read better, sorry :)</li>
</ol>


<p><a href="/TIMOB/TIMOB-18305.json">JSON Source</a></p>