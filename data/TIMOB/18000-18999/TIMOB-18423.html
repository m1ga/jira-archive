---
title: "[TIMOB-18423] iOS: HTTPClient: setRequestHeader('X-Requested-With', null) ignored in iOS"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-02-17T19:28:42.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 4.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Eduardo Gomez</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2015-01-21T18:24:28.000+0000</td></tr>
<tr><th>Updated</th><td>2015-03-24T21:50:31.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Issue Description</h4>
When a Titanium HTTPClient request is opened and sent, the header "X-Requested-With: XMLHttpRequest" is sent with the request by default. This usually is not a problem, however, this header currently results in an error message being returned from the particular API that I'm using (shopify API). 
I've set this header to null in my controller code, which fixes the problem in Android, but not in iOS as the X-Requested-With header is still being set in iOS. 

<h4>Test Case</h4>
<code><pre>
var url = '<a href="https://shopname.myshopify.com/admin/products.json" rel="nofollow" target="_blank">https://shopname.myshopify.com/admin/products.json</a>';
var client = Ti.Network.createHTTPClient({
	timeout : 5000,
	withCredentials : true,
	validatesSecureCertificate : true
});
client.onload = function(e) {
	Ti.API.info("Received text!" + this.responseText);
};
client.onerror = function(e) {
	Ti.API.debug("error");
	Ti.API.debug(e);
};
client.onreadystatechange = function(e) {
	Ti.API.info("state changed");
	Ti.API.info(this.readyState);
	Ti.API.info(client.getAllResponseHeaders());
	Ti.API.info("************");
};

client.setUsername("user");
client.setPassword("pass");
client.open("GET", url);
client.setRequestHeader('X-Requested-With', null);
client.send();
</pre></code>

<h4>Request Raw Response</h4>
{quote}
GET /admin/products.json HTTP/1.1
Host: shopname.myshopify.com
X-Titanium-Id: f2e11973-5eac-4106-b95d-6690ddd8683e
X-Requested-With: XMLHttpRequest
Proxy-Connection: keep-alive
Accept: */*
Accept-Encoding: gzip, deflate
Accept-Language: en-us
Connection: keep-alive
User-Agent: Appcelerator Titanium/3.4.1 (iPhone Simulator/8.1; iPhone OS; en_US;)
{quote}

<h3>Comments</h3>

<ol>
<li>Vishal Duggal 2015-02-17

   Pull pending against master
   <a href="https://github.com/appcelerator/titanium_mobile/pull/6645" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6645</a></li>
<li>Ewan Harris 2015-03-24

   Verified fix using:
   
   Mac OSX 10.10.2
   Titanium SDK build:   4.0.0.v20150323131014
   Titanium CLI, build: 4.0.0-alpha
   Alloy: 1.6.0-alpha
   Xcode 6.2
   iPhone 6 (8.2)
   
   If the second argument is set to null then the headers are not sent.
   
   Closing ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-18423.json">JSON Source</a></p>