---
title: "[TIMOB-18476] iOS: After a Popover hides, Apps stop getting focus events on Tabs’ windows"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-06-10T00:12:09.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.5.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 4.1.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, ipad, popover</td></tr>
<tr><th>Reporter</th><td>Pier Paolo Ramon</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2015-01-29T10:52:39.000+0000</td></tr>
<tr><th>Updated</th><td>2015-06-10T00:12:13.000+0000</td></tr>
</table>

<h3>Description</h3>

When you open a Popover and then hide it you stop getting <code>focus</code> events on the Tabs and on the Tabs’ Windows. You still get <code>focus</code> events on the TabGroup itself.

Opening a modal Window and closing it restores the situation to the normal behaviour.

With the attached code as <code>app.js</code> follow this steps to better understand the issue. Reproduced is also the modal’s restoring effect.

<h4>Steps</h4>

<h4>Click on the second tab</h4>
<h4>Click on the "Open popover"</h4>
<h4>Click on "close" (or click outside the popover)</h4>
<h4>Click on the first tab</h4>
<h4>Click on the "Open modal" button</h4>
<h4>Click on the "close" button</h4>
<h4>Click on the second tab</h4>

<h4>Expected result</h4>

<code><pre>
[ERROR] :  Received focus for TabGroup
[ERROR] :  Received focus for Tab 1
[ERROR] :  Received focus for Window 1
[ERROR] :  Received focus for TabGroup
[ERROR] :  Received focus for Tab 2
[ERROR] :  Received focus for Window 2
[ERROR] :  Received focus for TabGroup
[ERROR] :  Received focus for Tab 1       # THIS LINE IS MISSING
[ERROR] :  Received focus for Window 1    # THIS LINE IS MISSING
[ERROR] :  Received focus for Modal
[ERROR] :  Received focus for Window 1
[ERROR] :  Received focus for Tab 1
[ERROR] :  Received close for Modal
[ERROR] :  Received focus for TabGroup
[ERROR] :  Received focus for Window 2
[ERROR] :  Received focus for Tab 2
</pre></code>

<h4>Actual result</h4>

<code><pre>
[ERROR] :  Received focus for TabGroup
[ERROR] :  Received focus for Tab 1
[ERROR] :  Received focus for Window 1
[ERROR] :  Received focus for TabGroup
[ERROR] :  Received focus for Tab 2
[ERROR] :  Received focus for Window 2
[ERROR] :  Received focus for TabGroup
[ERROR] :  Received focus for Modal
[ERROR] :  Received focus for Window 1
[ERROR] :  Received focus for Tab 1
[ERROR] :  Received close for Modal
[ERROR] :  Received focus for TabGroup
[ERROR] :  Received focus for Window 2
[ERROR] :  Received focus for Tab 2
</pre></code>

<h4>Attached code</h4>

<code><pre>
var tabGroup = Ti.UI.createTabGroup({ title: 'TabGroup' });

var window1 = Ti.UI.createWindow({ title: 'Window 1' });
var window2 = Ti.UI.createWindow({ title: 'Window 2' });

var tab1 = Ti.UI.createTab({ window: window1, title: 'Tab 1' });
var tab2 = Ti.UI.createTab({ window: window2, title: 'Tab 2' });

tabGroup.addTab(tab1);
tabGroup.addTab(tab2);

// Modals

var modalButton = Ti.UI.createButton({ title: 'Open modal' });

window1.add(modalButton);

modalButton.addEventListener('click', function () {
	var close = Ti.UI.createButton({ title: 'close' });

	var modal = Ti.UI.createWindow({ modal: true, title: 'Modal' });

	modal.add(close);

	modal.addEventListener('focus', onEvent);
	modal.addEventListener('close', onEvent);

	close.addEventListener('click', function () {
		modal.close();
	});

	modal.open();
});

// Popover

var popoverButton = Ti.UI.createButton({ title: 'Open popover' });

window2.add(popoverButton);

popoverButton.addEventListener('click', function () {
	var close = Ti.UI.createButton({ title: 'close' });

	var content = Ti.UI.createView({ title: 'Popover Content View' });

	content.backgroundColor = 'white';
	content.width = 200;
	content.height = 200;
	content.add(close);

	var popover = Ti.UI.iPad.createPopover({ contentView: content });

	close.addEventListener('click', function () {
		popover.hide();
	});

	popover.show({ view: popoverButton });
});

// Listeners

[ tabGroup, window1, window2, tab1, tab2 ].forEach(function (view) {
	view.addEventListener('focus', onEvent);
});

function onEvent(event) {
	Ti.API.error("Received " + event.type + " for " + event.source.title);
}

// Open the tab group

tabGroup.open();
</pre></code>

<h3>Comments</h3>

<ol>
<li>Banzai Mobile 2015-03-03

   This bug effectively prevents use of popovers in our apps. 
   We had to remove popovers completely to update to 3.5.0
   
   I vote for high priority on this.</li>
<li>Vishal Duggal 2015-04-16

   Pull pending
   master - <a href="https://github.com/appcelerator/titanium_mobile/pull/6786" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6786</a></li>
<li>Vishal Duggal 2015-04-22

   As a workaround, you can set the contentView property of the popover to be a Ti.UI.Window proxy. 
   Then you will have consistent behavior on both iOS7 and iOS 8.</li>
<li>Lokesh Choudhary 2015-06-05

   Verified the fix.
   We now get focus events on tabs & windows after a popover hides.
   
   Closing.
   
   Environment:
   Appc Studio :  4.1.0.201505071004
   Ti SDK :  4.1.0.v20150604094312
   CLI : 4.0.2-rc2
   Alloy : 1.6.0
   MAC Yosemite : 10.10.3
   Appc npm : 4.0.0
   Appc CLI : 4.0.1
   Node: v0.10.37
   IOS Simulator: Ipad Air IOS 8.3</li>
</ol>


<p><a href="/TIMOB/TIMOB-18476.json">JSON Source</a></p>