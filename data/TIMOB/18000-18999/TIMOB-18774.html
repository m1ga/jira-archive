---
title: "[TIMOB-18774] TitaniumWindows References/Link Library issue"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-04-15T03:59:01.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Gary Mathews</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2015-04-01T23:28:30.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-20T20:18:37.000+0000</td></tr>
</table>

<h3>Description</h3>

The _TitaniumWindows_ module contains references to 17 different modules. If another reference is added, bumping the count to 18 (e.g <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/191)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/191)</a> the build will fail.

What's strange is when a clean build is performed with 17 references. The build will succeed, if another reference is added and a normal build is performed it too will succeed. But if a clean build is performed again, the build will fail.

I don't think this is a CMake issue, since I can reproduce this using only Visual Studio.

<h3>Comments</h3>

<ol>
<li>Kota Iguchi 2015-04-03

   I was able to reproduce this issue. I believe this is not a compiler/linker issue but there's a kind of bug or limitation around applicatioin packager (appx). What I am seeing is that there's external module (winmd) built and exe is successfully built, but there's an unexpected failure on <code>GenerateAppxManifest</code> task at <code>AppxPackage\Microsoft.AppXPackage.Targets</code>. What this mean I think is that appx packager is not working well with certain conditions (I guess it happens when we referenced over 18 external winmd). I also saw that the "Create App Packages" (which you can launch from VS "Project -> Store" menu) standalone packager crashes for the project. To workaround this, we might want to add module files against certain target such as <code>TitaniumWindows</code> instead of adding new module as winmd.
   
   <code><pre>
   Error	22	error MSB4018: The "GenerateAppxManifest" task failed unexpectedly.
   System.IndexOutOfRangeException: Index was outside the bounds of the array.
      at Microsoft.Cci.MetadataReader.PEFileToObjectModel.GetCoreAssemblySymbolicIdentity()
   
   Error 21 error APPX0002: Task 'GenerateAppxManifest' failed. Index was outside the bounds of the array.  C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v12.0\AppxPackage\Microsoft.AppXPackage.Targets 1356  9  NG
   </pre></code>
   
   </li>
<li>Kota Iguchi 2015-04-14

   <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/214" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/214</a></li>
<li>Kota Iguchi 2015-04-15

   Fixed by <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/218" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/218</a></li>
<li>Lee Morris 2017-03-20

   Closing ticket as fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-18774.json">JSON Source</a></p>