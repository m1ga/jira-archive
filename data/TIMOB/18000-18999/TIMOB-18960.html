---
title: "[TIMOB-18960] Android: Enable building with android M preview "
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-08-21T21:18:25.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>qe-4.0.1</td></tr>
<tr><th>Reporter</th><td>Lokesh Choudhary</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2015-05-29T00:41:39.000+0000</td></tr>
<tr><th>Updated</th><td>2015-09-03T00:54:04.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description:</h4>
1. The android M preview SDK is now out.
2. This new SDK is also marked as API 22.
3. While building its unclear if we are building with android M or android 5.1.1 as both are API22.
4. Removing android 5.1.1 & building fails with error:
<code><pre>
To target Android SDK 22, you first must install it using the Android SDK manager.
Alternatively, you can set the &lt;uses-sdk&gt; in the &lt;android&gt; &lt;manifest&gt; section of the tiapp.xml to
one of the following installed Android target SDKs: 15, 16, 17, 18, 19, 20, 21
[ERROR] :  Target Android SDK 22 is not installed
&lt;ti:app xmlns:ti="<a href="http://ti.appcelerator.org" rel="nofollow" target="_blank">http://ti.appcelerator.org</a>"&gt;
    &lt;android&gt;
        &lt;manifest&gt;
            &lt;uses-sdk android:minSdkVersion="10" android:targetSdkVersion="15" /&gt;
        &lt;/manifest&gt;
    &lt;/android&gt;
&lt;/ti:app&gt;
titanium exited with exit code 1
[ERROR] Application Installer abnormal process termination. Process exit value was 1
</pre></code>
5. From the above error we see that our tools don't consider android M as API 22 (although it will probably be API 23 once it goes GA).

Please fix so that we can test android M till the time it is GA.

*On further looking into it found that the folder for android M in the platforms folder inside android sdk is named "android-MNC" which might be the reason for our tools not picking it up.*

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-18960_56489/Screen Shot 2015-08-21 at 1.52.24 PM.png">Screen Shot 2015-08-21 at 1.52.24 PM.png</td></td><td>2015-08-21T20:57:19.000+0000</td><td>516193</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ashraf Abu 2015-06-05

   <a href="http://developer.android.com/preview/setup-sdk.html" rel="nofollow" target="_blank">http://developer.android.com/preview/setup-sdk.html</a>
   
   Based on this, it says:
   {quote}
   compileSdkVersion is set to 'android-MNC'
   minSdkVersion is set to 'MNC'
   targetSdkVersion is set to 'MNC'
   {quote}</li>
<li>Ashraf Abu 2015-06-05

   I used <uses-sdk android:minSdkVersion="10" android:targetSdkVersion="MNC" /> and was able to compile.
   [~lchoudhary] If this works for you, I'll resolve this ticket as resolved.
   
   Also, if you are still having problems, try updating SDK Tools, Platform-tools, and Build-tools.
   Mine is SDK Tools 24.3.1, Platform-tools 22, and Build-tools 22.0.1 at the moment.
   
   Extra Note: I just tried it without the Android 5.1.1 SDK installed. It failed. Hmmm. Not sure if it is dependent on Android 5.1.1 being installed or "MNC" is also defaulting to Android 5.1.1. Will look at it further.</li>
<li>Ashraf Abu 2015-06-05

   Note for development for Android M:
   *Apache HTTP Client is removed*. This should be a big deal to note. 
   
   <a href="http://developer.android.com/preview/behavior-changes.html#behavior-apache-http-client" rel="nofollow" target="_blank">http://developer.android.com/preview/behavior-changes.html#behavior-apache-http-client</a></li>
<li>Lokesh Choudhary 2015-06-05

   Thanks [~msamah] for the info. 
   Yes we can not certainly determine if we are building with android M even if it builds fine. But as you were not able to build it without having API 22 I doubt we ever built with android M even if we specify "targetSdkVersion" as MNC.
   We had similar issue when android L preview came out.</li>
<li>Hieu Pham 2015-07-20

   If you just change the min to "MNC", it will still use 22 as min, and builds with 22. Modifications need to be made in CLI to build it with "MNC".</li>
<li>Chris Barber 2015-08-21

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/7057" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7057</a></li>
<li>Lokesh Choudhary 2015-08-21

   Reopening.
   
   Building with a build having this fix fails with error:
   <code><pre>
   [ERROR] :  Unable to find a suitable installed Android SDK that is &gt;=21 and &lt;=22
   TRACE  | titanium exited with exit code 1
   ERROR  | Error: ti run exited with error code 1
       at ChildProcess.&lt;anonymous&gt; (/Users/lokeshchoudhary/.appcelerator/install/5.0.0-12/package/node_modules/appc-cli-titanium/plugins/run.js:89:66)
       at ChildProcess.emit (events.js:98:17)
       at Process.ChildProcess._handle.onexit (child_process.js:820:12)
   [ERROR] Application Installer abnormal process termination. Process exit value was 1
   </pre></code>
   *Note* : Screenshot of my Android SDK manager is attached for reference.
   [~cbarber], Google just release (Android 6.0) API23 in android SDK manager
   
   Environment:
   Appc Studio :  4.2.0.201508062204
   Ti SDK :  5.0.0.v20150821133620
   Ti CLI : 4.1.5
   Alloy : 1.7.5
   MAC Yosemite : 10.10.4
   Appc NPM : 4.2.0-1
   Appc CLI : 5.0.0-12
   Node: v0.10.37
   </li>
<li>Chris Barber 2015-08-21

   PR 2: <a href="https://github.com/appcelerator/titanium_mobile/pull/7059" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7059</a></li>
<li>Lokesh Choudhary 2015-08-24

   </li>
<li>Lokesh Choudhary 2015-09-03

    Verified & closed TIMOB-19163. 
    Closing this ticket</li>
</ol>


<p><a href="/TIMOB/TIMOB-18960.json">JSON Source</a></p>