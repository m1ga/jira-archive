---
title: "[TIMOB-18969] Android: ActionBar.onHomeIconItemSelected() breaks evalJS() on Android 5.0"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>actionbar, android, evaljs, lollipop, timeout</td></tr>
<tr><th>Reporter</th><td>KT</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2014-11-22T00:48:48.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T19:55:37.000+0000</td></tr>
</table>

<h3>Description</h3>

Unless I'm just plain doing something wrong, something is broken on 5.0 (using Ti 3.3.0 or 3.4.1 — doesn't matter which.)

What I need to do is, after the home/back button is tapped on the ActionBar, have the app call into the WebView's JS code. But it seems that on Android 5.0, any evalJS() after onHomeIconItemSelected() is called will result in a timeout.

app.js, test.html, and test.js: <a href="http://pastebin.com/HCGXjEsY" rel="nofollow" target="_blank">http://pastebin.com/HCGXjEsY</a>

Works on Android 4.4; subsequently broken on a device just upgraded to 5.0.

On Android 4.4, the output is the expected result:

[INFO] :   'mytest'
[INFO] :   doTest()

But on Android 5.0, the output is:

[INFO] :   'mytest'
[WARN] :   TiWebViewBinding: (KrollRuntimeThread) [50477,50477] Timeout waiting to evaluate JS

Note that doing it as an event isn't necessary to cause the timeout; I'm doing that because it caused other problems previously, so the way to overcome any context-related issues seemed to be to let the app handle it not in a UI callback. Replacing win.fireEvent('mytest') with view.evalJS('doTest()') directly makes no difference — the evalJS() call still times out.

Can this be confirmed as indeed failing (newly) on 5.0? And if so is there a known workaround?

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-18969.json">JSON Source</a></p>