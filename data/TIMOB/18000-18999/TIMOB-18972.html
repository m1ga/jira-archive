---
title: "[TIMOB-18972] iOS: Map when drag and drop app crash with error:  Collection <__NSArrayM: 0x7f9d4f3db720> was mutated while being enumerated."
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Wilson Liaw</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2015-05-30T07:12:59.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T19:55:32.000+0000</td></tr>
</table>

<h3>Description</h3>

when drag and drop the pin, set callout bubble content will crash the app with error message: {color:red}Collection <__NSArrayM: 0x7f9d4f3db720> was mutated while being enumerated.{color} 


<code><pre>
var Map = require('ti.map');
var win = Titanium.UI.createWindow();

var mountainView = Map.createAnnotation({
	latitude : 37.390749,
	longitude : -122.081651,
	title : "Appcelerator Headquarters",
	subtitle : 'Mountain View, CA',
	pincolor : Map.ANNOTATION_RED,
	draggable : true,
	myid : 1 // Custom property to uniquely identify this annotation.
});

var mapview = Map.createView({
	mapType : Map.NORMAL_TYPE,
	region : {
		latitude : 37.390749,
		longitude : -122.081651,
		latitudeDelta : 0.01,
		longitudeDelta : 0.01
	},
	animate : true,
	regionFit : true,
	userLocation : true,
	annotations : [mountainView]
});

win.add(mapview);
// Handle click events on any annotations on this map.
mapview.addEventListener('click', function(evt) {
	if (evt.clicksource == 'pin') {
		mountainView.setTitle('Appcelerator Headquarters');
	}
});
win.open();
</pre></code>

Thanks


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-18972_55665/app.js">app.js</td></td><td>2015-05-30T07:10:14.000+0000</td><td>903</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Praveen Kodakkad 2016-03-07

   I am also getting the same issue 
   
   
   Operating System
   Name = Mac OS X
   Version = 10.11.3
   Architecture = 64bit
   CPUs = 4
   Memory = 8589934592
   Node.js
   Node.js Version = 0.12.7
   npm Version = 2.11.3
   Titanium CLI
   CLI Version = 5.0.6
   Titanium SDK
   SDK Version = 5.2.0.GA
   SDK Path = /Users/user1/Library/Application Support/Titanium/mobilesdk/osx/5.2.0.GA
   Target Platform = iphone
   ------------------------------------------------------------------------------------------------------------------------------------------------------------------
   [INFO] :   This application is modifying the autolayout engine from a background thread, which can lead to engine corruption and weird crashes.  This will cause an exception in a future release.
   [INFO] :    Stack:(
   [INFO] :   	0   CoreFoundation                      0x000000018162d918 <redacted> + 148
   [INFO] :   	1   libobjc.A.dylib                     0x0000000180c9bf80 objc_exception_throw + 56
   [INFO] :   	2   CoreFoundation                      0x000000018162d848 <redacted> + 0
   [INFO] :   	3   Foundation                          0x00000001820cb2d4 <redacted> + 88
   [INFO] :   	4   Foundation                          0x0000000181f5199c <redacted> + 56
   [INFO] :   	5   Foundation                          0x0000000181f4d55c <redacted> + 260
   [INFO] :   	6   UIKit                               0x00000001864275e0 <redacted> + 64
   [INFO] :   	7   UIKit                               0x00000001864280f8 <redacted> + 244
   [INFO] :   	8   MapKit                              0x000000018b515650 <redacted> + 32
   [INFO] :   	9   MapKit                              0x000000018b516788 <redacted> + 456
   [INFO] :   	10  MapKit                              0x000000018b5165a4 <redacted> + 84
   [INFO] :   	11  MapKit                              0x000000018b515474 <redacted> + 596
   [INFO] :   	12  MapKit                              0x000000018b5151f4 <redacted> + 240
   [INFO] :   	13  MapKit                              0x000000018b5278cc <redacted> + 296
   [INFO] :   	14  Foundation                          0x0000000181f3c5e4 <redacted> + 424
   [INFO] :   	15  Foundation                          0x0000000181f18804 <redacted> + 304
   [INFO] :   	16  Foundation                          0x0000000181f1832c <redacted> + 404
   [INFO] :   	17  Foundation                          0x0000000181f1780c <redacted> + 908
   [INFO] :   	18  Foundation                          0x0000000181f3b5c0 <redacted> + 268
   [INFO] :   	19  CoreFoundation                      0x0000000181633430 <redacted> + 144
   [INFO] :   	20  CoreFoundation                      0x0000000181530eb4 <redacted> + 284
   [INFO] :   	21  MyApp                             0x00000001000b5a9c MyApp + 154268
   [INFO] :   	22  MyApp                             0x00000001000b403c MyApp + 147516
   [INFO] :   	23  MyApp                             0x00000001003d569c MyApp + 3430044
   [INFO] :   	24  MyApp                             0x000000010047069c MyApp + 4064924
   [INFO] :   	25  MyApp                             0x00000001004765d8 MyApp + 4089304
   [INFO] :   )
   [ERROR] :  The application has crashed with an uncaught exception 'NSGenericException'.
   [ERROR] :  Reason:
   [ERROR] :  *** Collection <__NSSetM: 0x15d2ceec0> was mutated while being enumerated.
   [ERROR] :  Stack trace:
   [ERROR] :  
   [ERROR] :  0   CoreFoundation                      0x000000018162d900 <redacted> + 124
   [ERROR] :  1   libobjc.A.dylib                     0x0000000180c9bf80 objc_exception_throw + 56
   [ERROR] :  2   CoreFoundation                      0x000000018162d334 <redacted> + 0
   [ERROR] :  3   Foundation                          0x0000000181f51404 <redacted> + 404
   [ERROR] :  4   Foundation                          0x0000000181f541b0 <redacted> + 340
   [ERROR] :  5   Foundation                          0x0000000181f58e6c <redacted> + 708
   [ERROR] :  6   Foundation                          0x0000000181f589d8 <redacted> + 240
   [ERROR] :  7   UIKit                               0x000000018642ae90 <redacted> + 176
   [ERROR] :  8   UIKit                               0x000000018642b384 <redacted> + 196
   [ERROR] :  9   UIKit                               0x00000001864263f4 <redacted> + 268
   [ERROR] :  10  UIKit                               0x000000018637cdb0 <redacted> + 80
   [ERROR] :  11  UIKit                               0x000000018662e698 <redacted> + 664
   [ERROR] :  12  UIKit                               0x0000000186318a70 <redacted> + 96
   [ERROR] :  13  UIKit                               0x000000018658a584 <redacted> + 376
   [ERROR] :  14  UIKit                               0x0000000186aefdc4 <redacted> + 216
   [ERROR] :  15  UIKit                               0x000000018658a0a8 <redacted> + 1272
   [ERROR] :  16  UIKit                               0x0000000186589af0 <redacted> + 424
   [ERROR] :  17  MapKit                              0x000000018b521104 <redacted> + 416
   [ERROR] :  18  MapKit                              0x000000018b508230 <redacted> + 188
   [ERROR] :  19  MapKit                              0x000000018b53ec28 <redacted> + 92
   [ERROR] :  20  MapKit                              0x000000018b503db4 <redacted> + 268
   [ERROR] :  21  MyApp                             0x000000010069fcb4 MyApp + 6356148
   [ERROR] :  22  MyApp                             0x0000000100699afc MyApp + 6331132
   [ERROR] :  23  Foundation                          0x0000000181fe244c __NSFireDelayedPerform + 428
   [ERROR] :  24  CoreFoundation                      0x00000001815e55f4 <redacted> + 28
   [ERROR] :  25  CoreFoundation                      0x00000001815e5298 <redacted> + 884
   [ERROR] :  26  CoreFoundation                      0x00000001815e29ac <redacted> + 1520
   [ERROR] :  27  CoreFoundation                      0x0000000181511680 CFRunLoopRunSpecific + 384
   [ERROR] :  28  GraphicsServices                    0x0000000182a20088 GSEventRunModal + 180
   [ERROR] :  29  UIKit                               0x0000000186388d90 UIApplicationMain + 204
   [ERROR] :  30  MyApp                             0x0000000100094e2c MyApp + 20012
   [ERROR] :  31  libdyld.dylib                       0x00000001810b28b8 <redacted> + 4
   [ERROR] :  *** Terminating app due to uncaught exception 'NSGenericException', reason: '*** Collection <__NSSetM: 0x15d2ceec0> was mutated while being enumerated.'
   [ERROR] :  *** First throw call stack:
   [ERROR] :  (0x18162d900 0x180c9bf80 0x18162d334 0x181f51404 0x181f541b0 0x181f58e6c 0x181f589d8 0x18642ae90 0x18642b384 0x1864263f4 0x18637cdb0 0x18662e698 0x186318a70 0x18658a584 0x186aefdc4 0x18658a0a8 0x186589af0 0x18b521104 0x18b508230 0x18b53ec28 0x18b503db4 0x10069fcb4 0x100699afc 0x181fe244c 0x1815e55f4 0x1815e5298 0x1815e29ac 0x181511680 0x182a20088 0x186388d90 0x100094e2c 0x1810b28b8)
   [ERROR] :  This application is modifying the autolayout engine from a background thread, which can lead to engine corruption and weird crashes.  This will cause an exception in a future release.
   [ERROR] :   Stack:(
   [ERROR] :  	0   CoreFoundation                      0x000000018162d918 <redacted> + 148
   [ERROR] :  	1   libobjc.A.dylib                     0x0000000180c9bf80 objc_exception_throw + 56
   [ERROR] :  	2   CoreFoundation                      0x000000018162d848 <redacted> + 0
   [ERROR] :  	3   Foundation                          0x00000001820cb2d4 <redacted> + 88
   [ERROR] :  	4   Foundation                          0x0000000181f4d47c <redacted> + 36
   [ERROR] :  	5   UIKit                               0x00000001864275e0 <redacted> + 64
   [ERROR] :  	6   UIKit                               0x00000001864280f8 <redacted> + 244
   [ERROR] :  	7   UIKit                               0x0000000186b8eb74 <redacted> + 352
   [ERROR] :  	8   UIKit                               0x0000000186b8e95c <redacted> + 296
   [ERROR] :  	9   MapKit                              0x000000018b515684 <redacted> + 84
   [ERROR] :  	10  MapKit                              0x000000018b516788 <redacted> + 456
   [ERROR] :  	11  MapKit                              0x000000018b5165a4 <redacted> + 84
   [ERROR] :  	12  MapKit                              0x000000018b515474 <redacted> + 596
   [ERROR] :  	13  MapKit                              0x000000018b5151f4 <redacted> + 240
   [ERROR] :  	14  MapKit                              0x000000018b5278cc <redacted> + 296
   [ERROR] :  	15  Foundation                          0x0000000181f3c5e4 <redacted> + 424
   [ERROR] :  	16  Foundation                          0x0000000181f18804 <redacted> + 304
   [ERROR] :  	17  Foundation                          0x0000000181f1832c <redacted> + 404
   [ERROR] :  	18  Foundation                          0x0000000181f1780c <redacted> + 908
   [ERROR] :  	19  Foundation                          0x0000000181f3b5c0 <redacted> + 268
   [ERROR] :  	20  CoreFoundation                      0x0000000181633430 <redacted> + 144
   [ERROR] :  	21  CoreFoundation                      0x0000000181530eb4 <redacted> + 284
   [ERROR] :  	22  MyApp                             0x00000001000b5a9c MyApp + 154268
   [ERROR] :  	23  MyApp                             0x00000001000b403c MyApp + 147516
   [ERROR] :  	24  MyApp                             0x00000001003d569c MyApp + 3430044
   [ERROR] :  	25  MyApp                             0x000000010047069c MyApp + 4064924
   [ERROR] :  	26  MyApp                             0x00000001004765d8 MyApp + 4089304
   [ERROR] :  )</li>
</ol>


<p><a href="/TIMOB/TIMOB-18972.json">JSON Source</a></p>