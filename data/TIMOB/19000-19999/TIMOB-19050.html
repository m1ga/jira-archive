---
title: "[TIMOB-19050] Android: onNewIntent event not being thrown"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2015-07-01T22:39:15.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>supportTeam</td></tr>
<tr><th>Reporter</th><td>Marco Cota</td></tr>
<tr><th>Assignee</th><td>Hieu Pham</td></tr>
<tr><th>Created</th><td>2015-06-20T00:13:11.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T21:46:00.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Issue</h4>

When calling an intent the onNewIntent event is not being thrown.

<h4>Test case</h4>

<code><pre>
var win = Ti.UI.createWindow({fullscreen:false});
 
//create some simple UI
var textfield = Ti.UI.createTextField({width:300, height:'auto', top:40, left:20, hintText:'enter message'});
var button = Ti.UI.createButton({title:'Send Notification', width:'auto', top:120, left:20, height:'auto'});
var label = Ti.UI.createLabel({width:'auto', top:200, left:20, height:'auto', width:200, text:'Message from intent:'});
var msgLabel = Ti.UI.createLabel({width:'auto', top:240, left:20, height:'auto', width:200, backgroundColor:'lightgrey', text:'---'});
 
win.add(textfield);
win.add(button);
win.add(label);
win.add(msgLabel);
 
win.addEventListener("open", function(evt) {
     button.addEventListener("click", function(evt) {
        //handle the pending intent from the notification bar
     win.activity.addEventListener("newIntent", function(evt)
        {
            var pushObjStr = evt.intent.getStringExtra("pushReceived"); //  ***** GET
            if (pushObjStr) {
                Ti.API.debug("received data: " + pushObjStr);
                msgLabel.text = pushObjStr;
            } else {
                Ti.API.debug("no data received");
                msgLabel.text = "no data received";
            }
        });
         
        Ti.UI.Android.hideSoftKeyboard();
        msgLabel.text = "---"; //reset any previous text value
 
        //grab the user input
        var message = textfield.value;
        if (!message) {
            alert('you must provide a message');
            return;
        } else {
            //clear out what was typed
            textfield.value = '';
        }
         
        //put some custom data into an intent
        var intent = Ti.Android.createIntent(
        {
            action: Ti.Android.ACTION_MAIN,
            flags: Ti.Android.FLAG_ACTIVITY_CLEAR_TOP | Ti.Android.FLAG_ACTIVITY_SINGLE_TOP,
            className: "org.appcelerator.titanium.TiActivity",
            packageName: Ti.App.id
        });
        intent.addCategory(Ti.Android.CATEGORY_LAUNCH);
        intent.putExtra("pushReceived", message); //***** PUT
     
        //a pending intent to send open an activity when launched                        
        var pending = Ti.Android.createPendingIntent(
        {
            activity: win.activity,
            intent: intent,
            //updateCurrentIntent: false,
            type: Ti.Android.PENDING_INTENT_FOR_ACTIVITY
        });
     
        //put a notification in the notification bar                        
        var notification = Ti.Android.createNotification(
        {
            contentIntent: pending,
            contentTitle: "New Notification",
            contentText: "Msg: " + message,
            tickerText: "New Notification"
        });
        Ti.Android.NotificationManager.notify(1, notification);
    });
 
});
 
win.open();
</pre></code>

<h4>Steps to reproduce</h4>

1. Run the test case
2. Introduce a message in the textfield 
3. Press the send button

Expected Result
After receiving the local notification the message textfield will throw the newIntent event and show the sent message or a "No data received" message

Actual Result
The newIntent event is not thrown 


<h3>Comments</h3>

<ol>
<li>Hieu Pham 2015-07-01

   This is working as expected. You need to click on the notification for the pendingIntent to activate. Sending a notification by calling notify() alone does not trigger the pendingIntent. In this example, you would do:
   1. Introduce a message in the textfield
   2. Press the button
   3. Click on the newly received notification.
   4. New data received.</li>
<li>Lee Morris 2017-03-22

   Closing ticket as invalid with reference to previous comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-19050.json">JSON Source</a></p>