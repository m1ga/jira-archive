---
title: "[TIMOB-19157] Windows: Ti.Filesystem.File.read() fails on device only if file has .js extension"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-07-06T17:40:45.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 4.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 4.1.0</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2015-07-03T13:20:05.000+0000</td></tr>
<tr><th>Updated</th><td>2015-07-06T20:24:13.000+0000</td></tr>
</table>

<h3>Description</h3>

The following example works in the emulator but fails on the <code>.js</code> file on device:

<code><pre>
var win = Ti.UI.createWindow();
var btn = Ti.UI.createButton({
	title: 'Click'
});

btn.addEventListener('click', function (e) {

	try {
		var txt = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, 'file.txt');
		txt.write('Hello world');
		txt.read();
	} catch (e) {
		alert('TXT failed: ' + JSON.stringify(e));
	}

	try {
		var js = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, 'file.js');
		js.write('Hello world');
		js.read();
	} catch (e) {
		alert('JS failed: ' + JSON.stringify(e));
	}

	alert('all OK');
});

win.add(btn);
win.open();
</pre></code>

<h4>Error</h4>

<code><pre>
{
  "message": "Could not load module: module_path = C:\\Data\\Users\\DefApps\\APPDATA\\Local\\Packages\com.appc.test_339c21w222ff8\\LocalState\\file.js",
  "native_stack": ["JSExportClass<class Titanium::Filesystem::FIle>::CallNamedFunction"],
  "stack": "read@[native code]\n",
  "line": 1
}
</pre></code>

It looks like the <code>.js</code> extension triggers it (but only on device) to use [readRequiredModule](<a href="https://github.com/appcelerator/titanium_mobile_windows/blob/master/Source/Global/src/GlobalObject.cpp#L172-L179)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/blob/master/Source/Global/src/GlobalObject.cpp#L172-L179)</a> and then fails. It's the only place where I could find this error.

In addition the attached screenshots also show another bug, where a caught exception in an event listener still causes another exception raised?

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19157_56081/IMG_6424.JPG">IMG_6424.JPG</td></td><td>2015-07-03T13:15:10.000+0000</td><td>2356639</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19157_56080/IMG_6425.JPG">IMG_6425.JPG</td></td><td>2015-07-03T13:15:32.000+0000</td><td>4132006</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Christopher Williams 2015-07-06

   May be related to TIMOB-19152</li>
<li>Gary Mathews 2015-07-06

   Yes, this was fixed with TIMOB-19152</li>
<li>Lokesh Choudhary 2015-07-06

   Verified the fix.
   
   Ti.Filesystem.File.read() does not fail.
   
   Closing.
   
   Environment:
   Appc Studio:  4.1.0.201507031129
   Ti SDK: 4.1.0.v20150706111546
   Ti CLI: 4.0.1
   Alloy: 1.6.2
   Windows: 8.1 Enterprise 64-bit
   APPC NPM: 4.1.0-1
   APPC CLI: 4.1.0-5 
   Device: Nokia Lumia 928 - Windows Phone 8.1
   
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-19157.json">JSON Source</a></p>