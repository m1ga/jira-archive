---
title: "[TIMOB-19275] Mobileweb: When packaging for production the build errors out"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-08-14T23:58:39.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.0.0</td></tr>
<tr><th>Components</th><td>MobileWeb</td></tr>
<tr><th>Labels</th><td>qe-5.0.0, regression</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2015-07-29T00:59:06.000+0000</td></tr>
<tr><th>Updated</th><td>2015-09-02T08:54:47.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

When packaging mobileweb the build errors out with the below. The error is coming from [this line](<a href="https://github.com/appcelerator/titanium_mobile/blob/master/mobileweb/cli/commands/_build.js#L906)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/mobileweb/cli/commands/_build.js#L906)</a> and only occurs when the build is run with <code>ti build -p mobileweb -D production</code> or <code>appc run -p mobileweb -D production</code>.

*This is a regression from 4.1.0.GA*

<code><pre>
/usr/local/lib/node_modules/titanium/node_modules/longjohn/dist/longjohn.js:195
        throw e;
              ^
TypeError: undefined is not a function
    at MobileWebBuilder.assembleTitaniumCSS (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/mobileweb/cli/commands/_build.js:910:118)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:567:21
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:246:17
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:122:13
    at _each (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:46:13)
    at async.each (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:121:9)
    at _asyncMap (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:245:13)
    at Object.map (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:216:23)
    at _parallel (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:565:20)
    at async.parallel (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:595:9)
---------------------------------------------
    at exports.execFile (child_process.js:821:9)
    at exports.exec (child_process.js:649:18)
    at exports.resize (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/image.js:54:28)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/mobileweb/cli/hooks/web.js:99:14
    at /usr/local/lib/node_modules/titanium/lib/hook.js:235:13
    at /usr/local/lib/node_modules/titanium/node_modules/async/lib/async.js:551:21
    at /usr/local/lib/node_modules/titanium/node_modules/async/lib/async.js:227:13
    at iterate (/usr/local/lib/node_modules/titanium/node_modules/async/lib/async.js:134:13)
---------------------------------------------
    at exports.execFile (child_process.js:821:9)
    at exports.exec (child_process.js:649:18)
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/lib/environ.js:267:3
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:251:17
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:154:25
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:248:21
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:612:34
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/lib/environ.js:234:7
---------------------------------------------
    at exports.execFile (child_process.js:821:9)
    at exports.exec (child_process.js:649:18)
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/lib/environ.js:227:6
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:607:21
    at /usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:246:17
    at iterate (/usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:146:13)
    at async.eachSeries (/usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:162:9)
    at _asyncMap (/usr/local/lib/node_modules/titanium/node_modules/node-appc/node_modules/async/lib/async.js:245:13)
---------------------------------------------
    at run (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:59:8)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/jdk.js:186:5
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:589:17
    at done (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:132:19)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:32:16
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:586:21
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/jdk.js:100:6
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:100:8
---------------------------------------------
    at Object.run (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:59:8)
    at find (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:96:14)
    at q.process (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:806:21)
    at processImmediate (timers.js:367:17)
---------------------------------------------
    at async.setImmediate (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:107:15)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:765:21
    at _each (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:46:13)
    at _insert (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:750:11)
    at q.push (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:779:15)
    at findExecutable (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:113:8)
    at tasks.(anonymous function) (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/jdk.js:99:5)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:580:25
---------------------------------------------
    at run (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:59:8)
    at Object.detect (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/jdk.js:71:3)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/mobileweb/cli/commands/_build.js:65:12
    at /usr/local/lib/node_modules/titanium/lib/hook.js:235:13
    at /usr/local/lib/node_modules/titanium/node_modules/async/lib/async.js:551:21
    at /usr/local/lib/node_modules/titanium/node_modules/async/lib/async.js:227:13
    at iterate (/usr/local/lib/node_modules/titanium/node_modules/async/lib/async.js:134:13)
    at /usr/local/lib/node_modules/titanium/node_modules/async/lib/async.js:145:25
---------------------------------------------
    at Object.run (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:59:8)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/certs.js:122:24
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:683:13
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:234:13
    at _arrayEach (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:85:13)
    at _each (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:76:13)
    at async.forEachOf.async.eachOf (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:233:9)
    at _parallel (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:682:9)
---------------------------------------------
    at Object.run (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:59:8)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/certs.js:72:21
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/env.js:98:4
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:691:13
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:52:16
    at done (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:243:21)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:44:16
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:688:17
---------------------------------------------
    at Object.run (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:59:8)
    at find (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:96:14)
    at q.process (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:806:21)
    at processImmediate (timers.js:367:17)
---------------------------------------------
    at async.setImmediate (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:107:15)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:765:21
    at _each (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:46:13)
    at _insert (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:750:11)
    at q.push (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/node_modules/async/lib/async.js:779:15)
    at Object.findExecutable (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/node-appc/lib/subprocess.js:113:8)
    at async.parallel.security (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/env.js:64:21)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:683:13
---------------------------------------------
    at magik (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/utilities.js:40:13)
    at Object.detect (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/env.js:49:9)
    at getCerts (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/certs.js:58:8)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/certs.js:185:3
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/utilities.js:55:9
    at process._tickCallback (node.js:355:11)
---------------------------------------------
    at magik (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/utilities.js:40:13)
    at Object.detect (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/certs.js:48:9)
    at certificates (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/index.js:76:11)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:683:13
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:234:13
    at _arrayEach (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:85:13)
    at _each (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:76:13)
    at async.forEachOf.async.eachOf (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:233:9)
---------------------------------------------
    at magik (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/lib/utilities.js:40:13)
    at Object.detect (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/ioslib/index.js:44:9)
    at iOSBuilder.&lt;anonymous&gt; (/Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/iphone/cli/commands/_build.js:284:10)
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/titanium-sdk/lib/titanium.js:99:5
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:683:13
    at /Users/eharris/Library/Application Support/Titanium/mobilesdk/osx/4.2.0.v20150728143620/node_modules/async/lib/async.js:234:13
</pre></code>

<h4>Steps to reproduce</h4>

1. Build a titanium project with <code>ti build -p mobileweb -D production</code>

<h4>Actual result</h4>

The build will error out

<h4>Expected result</h4>

The build should not error out

<h3>Comments</h3>

<ol>
<li>Chris Barber 2015-08-14

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/7026" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7026</a></li>
<li>Satyam Sekhri 2015-09-02

   Verified on:
   Mac OS 10.10.4 
   Ti SDK: 5.0.0.v20150901105514 
   Appc CLI NPM: 4.2.0-1 
   Appc CLI Core: 5.0.0-33
   Ti CLI: 4.1.5
   Node.js: 0.10.37 </li>
</ol>


<p><a href="/TIMOB/TIMOB-19275.json">JSON Source</a></p>