---
title: "[TIMOB-19376] Android: Fingerprint support"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-07-27T18:55:50.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>parity, touchid</td></tr>
<tr><th>Reporter</th><td>Chee Kiat Ng</td></tr>
<tr><th>Assignee</th><td>Ashraf Abu</td></tr>
<tr><th>Created</th><td>2015-08-19T04:53:08.000+0000</td></tr>
<tr><th>Updated</th><td>2017-01-04T10:53:22.000+0000</td></tr>
</table>

<h3>Description</h3>

Android M supports fingerprint authentication. Refer to
<a href="http://developer.android.com/preview/api-overview.html" rel="nofollow" target="_blank">http://developer.android.com/preview/api-overview.html</a>
and <a href="https://github.com/googlesamples/android-FingerprintDialog" rel="nofollow" target="_blank">https://github.com/googlesamples/android-FingerprintDialog</a>
Try to achieve parity and package with ti.touchid module.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19376_59741/2016_07_08_15_38_38.mp4">2016_07_08_15_38_38.mp4</td></td><td>2016-07-08T22:47:30.000+0000</td><td>3079567</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19376_59923/Screenshot_20160727-155415.png">Screenshot_20160727-155415.png</td></td><td>2016-07-27T07:59:09.000+0000</td><td>98219</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Talal M 2016-01-18

   Did any body find a solution for Android touchid fingerprint authentication using ti.touchid or any other module built for Appcelerator Titanium ?</li>
<li>saamy 2016-02-18

   I'm looking for Android TouchID module as well. 
   
   Any Update from Appcelerator ? or anyone created module already ? 
   
   </li>
<li>sponnusamy 2016-04-08

   When we can expect this module ?</li>
<li>Chee Kiat Ng 2016-04-11

   We are working on it. See Fix Release version. Do also note that the only devices that support this is Nexus 5x and 6p.</li>
<li>Hans Knöchel 2016-05-06

   PR: <a href="https://github.com/appcelerator-modules/ti.touchid/pull/18" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/pull/18</a></li>
<li>Ashraf Abu 2016-05-17

   PR reviewed and merged.</li>
<li>Hans Knöchel 2016-05-24

   PR (titanium_mobile/master): <a href="https://github.com/appcelerator/titanium_mobile/pull/8017" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8017</a></li>
<li>Hans Knöchel 2016-05-25

   [~titanium@webmasterei-hamburg.de] tested the module in master and had some trouble we might want to address:
   
   {quote}
   1. He needed to rebuild, because a jar was missing
   2. He needed to set the permissions <code>&lt;uses-permission android:name="android.permission.USE_FINGERPRINT"/&gt;</code> manually (can we put it into timodule.xml?? At least we should leave a comment about it in the example)
   3. The module must be required after opening a window/activity  
   4. TiTouchId.isSupported() always returns <code>true</code>?
   (5. We should start to create a README.md for that project to note those infos)
   {quote}</li>
<li>Rainer Schleevoigt 2016-05-25

   For usage with old API levels we need a method like <code>getAuthorisationOrTrueIfOldVersion()</code> for usage the same async structur.
   
   These helper functions has different output, maybe it is a good idea to make in same style:
   
   [INFO] :   isSupported()=true
   
   [INFO] :   {"canAuthenticate":true}
   
   </li>
<li>Hieu Pham 2016-05-25

    Thanks [~hansknoechel], I'll look into these issues.</li>
<li>Hieu Pham 2016-05-25

    1. Which jar is missing?
    2. The permission should already be in timodule.xml: <a href="https://github.com/appcelerator-modules/ti.touchid/blob/master/android/timodule.xml#L11" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/blob/master/android/timodule.xml#L11</a>
    3. What do you mean? It doesn't work if you do require("touch.id") before you open a window? That doesn't sound right.
    4. This will return false on devices that doesn't have fingerprint support. There are currently only Nexus 5x and 6p that support this feature.</li>
<li>Rainer Schleevoigt 2016-05-26

    1. Hans sent me azip of module. After including and usage came an error "jat not found" and I have recomplied => without error at runtime
    2. you are right, I forgot to copy 
    3. I have embed the module at "construction time" of window and a weird error message came. Then I have embed the code after open event of activity and the error disappeared.
    4. if the module should run in all devices and the critical action is inside the async node, then it is a good idea to offer a dummy method. In other case the coder must implement a logic to realize this. (similar this wrapper: <a href="https://gist.github.com/AppWerft/6ba7b7ba8d14a269bb05f1b319d754f4)" rel="nofollow" target="_blank">https://gist.github.com/AppWerft/6ba7b7ba8d14a269bb05f1b319d754f4)</a></li>
<li>Hieu Pham 2016-05-26

    [~titanium@webmasterei-hamburg.de], which error did you see on 3? </li>
<li>Lokesh Choudhary 2016-07-08

    I see the following issues running the example app from the module:
    1. I click on <code>Authenticate</code> & place my correct finger on the fingerprint reader.
    2. I get alert <code>YAY! success</code>.
    3. I click on authenticate again & place the incorrect finger on the fingerprint reader.
    4. I get alert <code>Message:Unable to recognize fingerprint</code>.
    5. I click <code>Authenticate</code> again.
    6. I get alert <code>Message: Fingerprint operation cancelled</code>. I get this as long as I keep scanning my wrong finger.
    7. If I place my correct finger on the fingerprint scanner it scans & I get a success.
    
    Attached a video for this issue: [^2016_07_08_15_38_38.mp4]
    
    Reopening as of now.
    
    Environment:
    Appc Studio : 4.7.0.201607070843
    Ti SDK :  5.4.0.v20160705213725
    Ti CLI : 5.0.9
    Alloy : 1.9.1
    MAC El Capitan : 10.11.5
    Appc NPM : 4.2.8-1
    Appc CLI : 5.4.0-28
    Node: 4.4.4
    Nexus5X: Android 6.0.1
    </li>
<li>Ashraf Abu 2016-07-11

    [~lchoudhary] I assume the expected behaviour for number 6 would be the same results as number 4?</li>
<li>Lokesh Choudhary 2016-07-11

    [~msamah], 
    1. Everything works fine until <code>step 4</code>. 
    2. At <code>step 5</code> I again click <code>authenticate</code> & I after clicking <code>authenticate</code> I get alert <code>Message: Fingerprint operation cancelled</code>.
    3. I keep on getting this <code>Message: Fingerprint operation cancelled</code> until I scan my correct finger.
    
    So basically, after a failure it will keep showing you alert <code>Message: Fingerprint operation cancelled</code> every time I click <code>authenticate</code>, until you scan the correct finger (FYI, at this step even though you get an alert <code>Message: Fingerprint operation cancelled</code> the scanner can still scan the finger.)
    </li>
<li>Ashraf Abu 2016-07-27

    [~lchoudhary]
    This is actually expected behaviour.
    What's happening is that at step 4, once you get an <code>Unable to recognize fingerprint</code>, you should not press authenticate again. Instead, you should just provide another fingerprint for the sensor to read.
    
    Ideally it should instead show a blocking dialog UI for the fingerprint. Be it success or failure. This is because it is waiting till you provide a correct fingerprint and will stay there even at failure. (You might have a dirty finger after all and need to clean it. Thus it lets you read it again).
    !Screenshot_20160727-155415.png|thumbnail!
    
    I would suggest that we resolve this ticket (and perhaps document this) as it is and create a ticket for a improvement on this flow. [~lchoudhary]
    
    Reference <a href="https://github.com/googlesamples/android-FingerprintDialog" rel="nofollow" target="_blank">https://github.com/googlesamples/android-FingerprintDialog</a></li>
<li>Ashraf Abu 2016-07-27

    [~lchoudhary] If my idea is acceptable please resolve this issue.</li>
<li>Hans Knöchel 2016-07-27

    [~msamah] Can we make a tiny doc-note for that? Guess it's fine then.</li>
<li>Ashraf Abu 2016-07-27

    Ya. I'll proceed with a doc.</li>
<li>Ashraf Abu 2016-07-27

    Doc PR: <a href="https://github.com/appcelerator-modules/ti.touchid/pull/21" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/pull/21</a> [~hansknoechel] For your review.</li>
<li>Hans Knöchel 2016-07-27

    Merged. Please also consider to update the pre-packaged, although it's only a docs update.</li>
<li>Lokesh Choudhary 2016-07-27

    The behaviour seems to be as expected. Verified the addition of doc note.
    
    Closing.
    
    Environment:
    Appc Studio : 4.7.0.201607111053
    Ti SDK :  5.4.0.v20160725003348
    Ti CLI : 5.0.9
    Alloy : 1.9.1
    MAC El Capitan : 10.11.5
    Appc NPM : 4.2.8-1
    Appc CLI : 5.4.0-34
    Node: 4.4.4
    Nexus 5X - Android 6.0.1</li>
<li>Lokesh Choudhary 2016-07-27

    Reopening to correct comment
    </li>
<li>Ashraf Abu 2016-07-28

    Created ticket MOD-2278 for the improvement mentioned here.</li>
<li>Ashraf Abu 2016-07-28

    For document update:
    Updated module PR: <a href="https://github.com/appcelerator-modules/ti.touchid/pull/22" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/pull/22</a>
    Added to release: <a href="https://github.com/appcelerator-modules/ti.touchid/releases/tag/android-2.0.1" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/releases/tag/android-2.0.1</a>
    Ti SDK PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8166" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8166</a></li>
<li>Ashraf Abu 2016-07-28

    PRs merged.</li>
<li>Rainer Schleevoigt 2017-01-02

    Using of version 2.0.1 (compiled with SDK6.0.0) doesn't show any UI.
    testes devices: Galaxy6Edge with M and ZTEBlade7 with M.</li>
<li>Hans Knöchel 2017-01-02

    [~titanium@webmasterei-hamburg.de] See the mentioned ticket (MOD-2278) for this, we discussed it earlier. The current Touch ID implementation on Android does not seem to have a UI expected. Feel free to add this functionality on Android as well.</li>
<li>Hans Knöchel 2017-01-02

    Addition: And it is not natively supported. All that the [Google sample](<a href="https://github.com/googlesamples/android-FingerprintDialog)" rel="nofollow" target="_blank">https://github.com/googlesamples/android-FingerprintDialog)</a> does is to create a custom UI to mock this behavior. Developers usually create their own UI on Android, see [this](<a href="http://blog.m2sys.com/wp-content/uploads/2015/11/Android-fingerprint.jpg)" rel="nofollow" target="_blank">http://blog.m2sys.com/wp-content/uploads/2015/11/Android-fingerprint.jpg)</a> and [this](<a href="http://cdn.bgr.com/2015/05/dashlane-android-m-fingerprint-support.jpg?quality=98&strip=all)" rel="nofollow" target="_blank">http://cdn.bgr.com/2015/05/dashlane-android-m-fingerprint-support.jpg?quality=98&strip=all)</a> example as well.</li>
<li>Rainer Schleevoigt 2017-01-03

    In this case a modified example/app.js is meaningful.
    This irritates me: after start of  <code>authenticate</code> comes immediately the error message ("Cancel by user"). I could create a dialog with text/image, but how handle, if the function doesn't wait. </li>
<li>Rainer Schleevoigt 2017-01-03

    This works for me:
    <code><pre>javascript
    module.exports = function(options, callbacks) {
    	var start = new Date().getTime();
    	if (!TouchId.isSupported()) {
    		alert("This device doesn't support fingerprint sensor");
    		return;
    	}
    	var dialog = null;
    	if (Ti.Platform.osname == "android") {
    		var timer = 0;
    		var cronHandler = function() {
    			timer++;
    			if (timer == 600) {
    				clearInterval(cron);
    			} else {
    				androidView.children[0].backgroundImage = "/assets/fingerprint"
    						+ timer % 9 + '.png';
    				progress.setValue(timer);
    			}
    		};
    		var cron = setInterval(cronHandler, 100);
    		var androidView = Ti.UI.createView({
    			top : 10,
    			bottom : 10
    		});
    		androidView.add(Ti.UI.createView({
    			top : 10,
    			left : 10,
    			width : 80,
    			height : 90,
    			backgroundImage : "/assets/fingerprint.png"
    		}));
    		androidView.add(Ti.UI.createLabel({
    			left : 100,
    			right : 10,
    			top : 5,
    			text : options.message
    		}));
    		var progress = Ti.UI.createProgressBar({
    			width : Ti.UI.FILL,
    			top : 100,
    			left : 10,
    			right : 10,
    			min : 0,
    			max : 600
    		});
    		androidView.add(progress);
    		progress.show();
    		dialog = Ti.UI.createOptionDialog({
    			title : options.title,
    			androidView : androidView,
    			buttonNames : [ "Abbruch" ]
    		});
    		dialog.addEventListener("click",function(e){
    			console.log(e.index);
    		})
    		dialog.show();
    	}
    	TouchId
    			.authenticate({
    				reason : 'We need your fingerprint to continue.',
    				callback : function(e) {
    					if (!!dialog)
    						dialog.hide();
    					console.log("Code=" + e.code);
    					if (!e.success) {
    						var end = new Date().getTime();
    						console.log("TIMEOUT=" + parseInt(end - start));
    						Ti.Media.vibrate([ 0, 30 ]);
    						Ti.UI
    								.createNotification(
    										{
    											message : "Zugang zur Belegübersicht ohne Fingersensorschutz"
    										}).show();
    
    					} else {
    						callbacks.onsuccess();
    					}
    				}
    			});
    
    };
    </pre></code></li>
<li>Rainer Schleevoigt 2017-01-03

    This are possible payloads from callback:
    
    {"message":"GurgsDNfmFvbkiR6IK0atg==\n","success":true}
    {"error":"Unable to recognize fingerprint","success":false}
    {"error":"Fingerprint operation canceled.","success":false}
    
    Maybe we need an integer result code to better analyze the result.
    
    In FingerPrintHelper.java#115 we need an additional property "code" and in 124, 131,140 modifications.  next time I will send a PR.</li>
<li>Rainer Schleevoigt 2017-01-04

    I have a PR done.
    It adds resultcodes to every callback (for i18n) and exposed the helpers/hints like "Make sure that your finger covers the entire Home key" or "Keep your finger on the Home key a little longer"  with resultcode. A list of new constants is added.
    
    </li>
<li>Rainer Schleevoigt 2017-01-04

    For UI look to this [gist](<a href="https://gist.github.com/AppWerft/53469996b2a0589a037d2622fea6eb65)" rel="nofollow" target="_blank">https://gist.github.com/AppWerft/53469996b2a0589a037d2622fea6eb65)</a>
    !<a href="https://github.com/AppWerft/ti.touchid/blob/master/android/assets/fingerprintDialog_screenshot.png" rel="nofollow" target="_blank">https://github.com/AppWerft/ti.touchid/blob/master/android/assets/fingerprintDialog_screenshot.png</a>!
    
    </li>
</ol>


<p><a href="/TIMOB/TIMOB-19376.json">JSON Source</a></p>