---
title: "[TIMOB-19470] CLI: ti setup doesn't properly select last available versions from npm"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-09-09T16:13:06.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.0.0</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>setup</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2014-10-29T09:09:59.000+0000</td></tr>
<tr><th>Updated</th><td>2015-09-17T17:09:51.000+0000</td></tr>
</table>

<h3>Description</h3>

When I run <code>ti setup</code> and select *check* I get:

<code><pre>
Node.js
  ✓  node               up-to-date (v0.10.33)
  ★  npm                new version v2.1.6 available! (currently v2.1.5)
</pre></code>

However, on <a href="https://www.npmjs.org/package/npm" rel="nofollow" target="_blank">https://www.npmjs.org/package/npm</a> and via <code>npm info npm</code> it has *2.1.5* as the last version. The <code>versions</code> array does have 2.1.6 but the CLI should look at <code>version</code> not <code>versions</code>.

<h4>Related code</h4>

<a href="https://github.com/appcelerator/titanium/blob/master/lib/commands/setup.js#L516-L522" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium/blob/master/lib/commands/setup.js#L516-L522</a>

<code><pre>
if (info && info.versions) {
  for (var i = 0, vers = info.versions, l = vers.length; i &lt; l; i++) {
    if (appc.version.gt(vers[i], r.npm.latest)) {
      r.npm.latest = vers[i];
    }
  }
}
</pre></code>

<h4>Proposed chage</h4>

The above lines with:

<code><pre>
if (info && info.version) {
  r.npm.latest = info.version;
}
</pre></code>

<h3>Comments</h3>

<ol>
<li>Radamantis Torres-Lechuga 2015-04-06

   [~fokkezb] is this still an issue?</li>
<li>Fokke Zandbergen 2015-04-07

   [~rtlechuga] yes:
   
   <code>ti setup</code> > check
   
   <code><pre>
     *  npm                new version v2.7.6 available! (currently v1.4.28)
   </pre></code>
   
   <code>npm info npm</code>
   
   <code><pre>
     version: '2.7.5',
   </pre></code></li>
<li>Chris Barber 2015-09-08

   Verified this is a bug. @fokke is correct, we should be looking at <code>version</code>, not <code>versions</code>, then showing the proper label based on whether they are up-to-date, behind, or bleeding edge.
   
   This is pretty low priority as this is just a report screen. Titanium CLI doesn't really do anything meaningful with NPM post installation.</li>
<li>Fokke Zandbergen 2015-09-09

   Well, low prio except for that it now kind of suggests to upgrade to a new version we don't support:
   
   <code><pre>
   Node.js
     ★  node               new version v4.0.0 available! (currently v0.10.40)
     ★  npm                new version v3.3.2 available! (currently v1.4.28)
   </pre></code>
   
   We might want to use [vendorDependencies](<a href="https://github.com/appcelerator/titanium_mobile/blob/master/package.json#L63)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/package.json#L63)</a> to determine what we show here.</li>
<li>Chris Barber 2015-09-09

   Um, and how exactly do we "not support" NPM v3.3.2 or any other specific version? What compatibility issues are there? You see, once Titanium is installed, it doesn't care about NPM. It's never invoked. This screen is just a report. Titanium CLI doesn't have "vendorDependencies". That's a TiSDK thing and Titanium SDK doesn't reference NPM either.
   
   So, all this ticket needs to do is report the latest stable.</li>
<li>Chris Barber 2015-09-09

   PR: <a href="https://github.com/appcelerator/titanium/pull/232" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium/pull/232</a></li>
<li>Fokke Zandbergen 2015-09-11

   What I mean is node v4.0.0 that we don't (yet) support. Since I think the message suggest people to upgrade to the latest, even now we've fixed that to be the latest stable that might mean they upgrade to a version we don't support yet.</li>
<li>Chris Barber 2015-09-11

   I see your point. I'm fine with ripping Node.js and NPM out of "ti setup check". The intent is if someone has issues with their system, they can copy/paste the results of "ti setup check" and that would help us help them.</li>
<li>Ingo Muschenetz 2015-09-11

   I'd be fine leaving it in but only showing what you have and not encouraging an upgrade</li>
<li>Chris Barber 2015-09-11

    That works too.</li>
<li>Chris Barber 2015-09-11

    PR 2: <a href="https://github.com/appcelerator/titanium/pull/233" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium/pull/233</a></li>
<li>Harry Bryant 2015-09-17

    Verified fixed, running " ti setup " and selecting " check " displays versions without encouraging updates.
    
    
    Ti.SDK: 5.0.0.v20150915230722
    Appc Studio: 4.3.0.201509140942
    Appc CLI: 5.0.0</li>
</ol>


<p><a href="/TIMOB/TIMOB-19470.json">JSON Source</a></p>