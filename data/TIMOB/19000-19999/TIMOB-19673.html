---
title: "[TIMOB-19673] windowslib: visualstudio.detect failed for VS 2015"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-04-06T05:48:15.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.0.2</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.3.0, windowslib 0.4.5</td></tr>
<tr><th>Components</th><td>Tooling, Windows</td></tr>
<tr><th>Labels</th><td>qe-5.3.0</td></tr>
<tr><th>Reporter</th><td>Kota Iguchi</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2015-10-06T05:26:37.000+0000</td></tr>
<tr><th>Updated</th><td>2016-04-14T18:26:49.000+0000</td></tr>
</table>

<h3>Description</h3>

<code>windowslib.visualstudio.detect</code> failed to detect Visual Studio 2015, when it is installed to the path which contains space. 

<code><pre>
PS &gt; npm run-script test-visualstudio

&gt; windowslib@0.1.15 test-visualstudio windowslib
&gt; mocha --require test/init --reporter spec --check-leaks test/test-visualstudio



  visualstudio
    âˆš namespace should be an object
    1) detect should find Visual Studio installations


  1 passing (500ms)
  1 failing

  1) visualstudio detect should find Visual Studio installations:
     Uncaught AssertionError: expected null to be a string
      at Assertion.fail (windowslib\node_modules\should\lib\assertion.js:113:17)
      at Assertion.prop.(anonymous function) [as String] (windowslib\node_modules\should\lib\ass
ertion.js:39:14)
      at checkVisualStudio (windowslib\test\test-visualstudio.js:73:42)
      at windowslib\test\test-visualstudio.js:34:4
      at finalize (windowslib\lib\visualstudio.js:64:4)
      at windowslib\lib\visualstudio.js:218:5
      at done (windowslib\node_modules\async\lib\async.js:132:19)
      at windowslib\node_modules\async\lib\async.js:32:16
      at windowslib\lib\visualstudio.js:187:10
      at ChildProcess.&lt;anonymous&gt; (windowslib\node_modules\node-appc\lib\subprocess.js:60:3)
      at ChildProcess.EventEmitter.emit (events.js:98:17)
      at maybeClose (child_process.js:753:16)
      at Process.ChildProcess._handle.onexit (child_process.js:820:5)
</pre></code>

It is because some spaces in <code>vcvarsall</code> variable is not properly escaped. 

<code><pre>
<h4>output from console.log(vcvarsall);</h4>
C:\PROGRA~2\Microsoft Visual Studio 14.0\VC\vcvarsall.bat
</pre></code>

I was able to fix it locally, here's a PR: <a href="https://github.com/appcelerator/windowslib/pull/22" rel="nofollow" target="_blank">https://github.com/appcelerator/windowslib/pull/22</a>

<h3>Comments</h3>

<ol>
<li>Kota Iguchi 2015-10-07

   <a href="https://github.com/appcelerator/windowslib/pull/22" rel="nofollow" target="_blank">https://github.com/appcelerator/windowslib/pull/22</a></li>
<li>Ewan Harris 2015-11-03

   Verified using:
   
   Windows 10 Pro
   Appc Core: 5.1.0-42
   Appc NPM: 4.2.1
   Ti SDK: 5.1.0.v2015102819002
   
   When running <code>appc ti info</code> Visual Studio 2015 is detected and when running the Visual Studio tests in windowslib they now pass
   
   Closing ticket</li>
<li>Gary Mathews 2016-04-06

   windowslib: <a href="https://github.com/appcelerator/windowslib/pull/35" rel="nofollow" target="_blank">https://github.com/appcelerator/windowslib/pull/35</a>
   titanium_mobile: <a href="https://github.com/appcelerator/titanium_mobile/pull/7918" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7918</a>
   titanium_mobile_5_3_X: <a href="https://github.com/appcelerator/titanium_mobile/pull/7919" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7919</a></li>
<li>Harry Bryant 2016-04-14

   Verified as fixed, running <code>appc ti info</code> Visual Studio 2015 is detected. Additionally experienced in issue with MSBuild detection when Visual Studio was installed on a secondary drive, but this issue has now been addressed.
   
   Tested on: 
   Windows 10 Home & Pro 
   Appc Studio: 4.6.0.201604141457
   Ti SDK: 5.3.0.v20160414094426
   Appc NPM: 4.2.5-1 
   Appc Core: 5.3.0-12 
   Node: v4.4.2
   
   *Closing Ticket.*</li>
</ol>


<p><a href="/TIMOB/TIMOB-19673.json">JSON Source</a></p>