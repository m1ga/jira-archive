---
title: "[TIMOB-19744] Android : Geolocation callback is not being called on android 6.0"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2015-10-29T00:46:32.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.1.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>qe-5.1.0</td></tr>
<tr><th>Reporter</th><td>Lokesh Choudhary</td></tr>
<tr><th>Assignee</th><td>Chee Kiat Ng</td></tr>
<tr><th>Created</th><td>2015-10-19T21:40:10.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-20T13:59:02.000+0000</td></tr>
</table>

<h3>Description</h3>

Steps To Reproduce:
1. Use the code below in the app.js.
<code><pre>
var win1 = Titanium.UI.createWindow({
    title : 'Tab 1',
    backgroundColor : '#fff'
});

var latitude = 33.58262112511852;
var longitude = -111.71566843986511;

var locationCallback = function(e) {
    if(!e.success || e.error) {  
        alert('error:' + JSON.stringify(e.error));  
        return;  
    }
    Ti.API.info(JSON.stringify(e));

    var longitude = e.coords.longitude;
    var latitude = e.coords.latitude;

};
win1.addEventListener("open", function(e) {

    if (Ti.Geolocation.hasLocationPermissions()) {
        Ti.Geolocation.preferredProvider = "gps";
        Titanium.Geolocation.addEventListener('location', locationCallback);
    } else {
        Ti.Geolocation.requestLocationPermissions(function(e) {
                    if (e.success === true) {
                        Ti.Geolocation.preferredProvider = "gps";
                        Titanium.Geolocation.addEventListener('location', locationCallback);
                    } else {
                        alert("Access denied, error: " + e.error);
                    }
        });
    }
});

win1.open();
</pre></code>
2. Build the app on android device running android 6.0.
3. After the app launches the app would ask permission to access location.
4. Grant access by tapping ok
5. Let the app launch & check the logs in studio console.

<h4>Actual Results:</h4>
1. The location callback is not called & no info is seen relating to location in the console.
2. Works fine with android 5.1.1, android 4.4.4.
*Android 5.1.1 logs:*
<code><pre>
[INFO] :   {"type":"location","source":{"bubbleParent":true,"hasCompass":true,"__propertiesDefined__":true,"_events":{"location":{}},"preferredProvider":"gps","lastGeolocation":"{\"latitude\":37.3676949,\"longitude\":-121.9137751,\"altitude\":0,\"accuracy\":67.5,\"heading\":0,\"speed\":0,\"timestamp\":1445290117314}","locationServicesEnabled":true,"apiName":"Ti.Geolocation"},"provider":{"power":1,"name":"network","accuracy":2},"coords":{"altitude":0,"speed":0,"longitude":-121.9137751,"heading":0,"latitude":37.3676949,"timestamp":1445290117314,"altitudeAccuracy":null,"accuracy":67.5},"bubbles":false,"success":true,"code":0,"cancelBubble":false}
</pre></code>

<h4>Expected Results:</h4>
1. The location callback should be called & location info should get printed in the console


<h3>Comments</h3>

<ol>
<li>Chee Kiat Ng 2015-10-20

   [~hpham] can you take a look please?</li>
<li>Lokesh Choudhary 2015-10-29

   </li>
<li>Adam Paxton 2015-11-10

   The callback doesn't appear to be called for iOS, either. And on Android, couldn't TIMOB-19821 be worked around but just viewing LogCat?  Not seeing it there, either. 
   
   {noformat}
   Operating System
     Name                        = Mac OS X
     Version                     = 10.10.5
     Architecture                = 64bit
     # CPUs                      = 4
     Memory                      = 8589934592
   
   Node.js
     Node.js Version             = 0.10.40
     npm Version                 = 2.14.3
   
   Titanium CLI
     CLI Version                 = 5.0.5
   
   Titanium SDK
     SDK Version                 = 5.1.0.v20151104190037
     SDK Path                    = /Users/adam/Library/Application Support/Titanium/mobilesdk/osx/5.1.0.v20151104190037
     Target Platform             = android
   {noformat}</li>
<li>Debuisson Eug√®ne 2017-03-20

   Any news about that ? 
   It's seems that it still not working ...</li>
</ol>


<p><a href="/TIMOB/TIMOB-19744.json">JSON Source</a></p>