---
title: "[TIMOB-19767] iOS: toImage does not honor the scale factor for retina devices"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-11-26T08:54:54.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 4.0.0, Release 5.1.0, Release 5.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.2.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, retina, scale, toimage</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2015-10-22T18:10:55.000+0000</td></tr>
<tr><th>Updated</th><td>2016-01-15T18:04:46.000+0000</td></tr>
</table>

<h3>Description</h3>

We used to have a <code>honorScaleFactor</code> property, that was removed as part of the 4.0.0.GA release in [this PR](<a href="https://github.com/appcelerator/titanium_mobile/pull/6302)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6302)</a> around changes with non-attached images. The [docs](<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI.ImageView-method-toImage) say, the property was already removed in 3.5.0, but worked until 3.5.1.GA. I would like to get this property back to achieve a proper behavior in the following use case.

*Use case*: Use <code>toImage()</code> to make an image (blob) of a view, that covers a specified square inside another view.

*Demo:*
<code><pre>
var win1 = Titanium.UI.createWindow({
	backgroundColor : '#fff'
});

var imageView = Ti.UI.createImageView({
	image : "test.jpg"
});

imageView.addEventListener("click", imageViewClicked);

win1.add(imageView);
win1.open();

function imageViewClicked(e) {
	imageView.removeEventListener("click", imageViewClicked);

	var edgeLength = 100;
	var blob = imageView.toImage();

	var tempView = Ti.UI.createView({
		width : blob.width + edgeLength,
		height : blob.height + edgeLength
	});

	tempView.add(Ti.UI.createImageView({
		image : blob,
		width : blob.width,
		height : blob.height
	}));

    // No callback -&gt; get blob directly, honorScaleFactor false -&gt; Same size for retina and non-retina
    // Default functionality still the same: No callback and secons argument true / undefined -&gt; Different size for retina and non-retina
	blob = tempView.toImage(null, false);

	var image = blob.imageAsCropped({
		width : edgeLength,
		height : edgeLength,
		x : e.x,
		y : e.y
	});

	var croppedImageView = Ti.UI.createImageView({
		image : image,
		bottom : 0,
		borderWidth : 1,
		borderColor : "black",
		borderRadius : edgeLength / 2
	});

	croppedImageView.addEventListener("click", function() {
		win1.remove(croppedImageView);
		imageView.addEventListener("click", imageViewClicked);
	});

	win1.add(croppedImageView);
}
</pre></code>

*Expected behavior*: The method works same on retina and non-retina devices.
*Actual behavior:* The method uses the wrong scale on creating the image blob.

*Proposal*: Bring back the <code>honorScaleFactor</code> property, make the default value to <code>true</code> as the current behavior expects. That would achieve the configuration of the property, but would not break any existing applications.


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-19767_57107/Actual.png">Actual.png</td></td><td>2015-10-22T18:30:00.000+0000</td><td>61508</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-19767_57106/Expected.png">Expected.png</td></td><td>2015-10-22T18:30:00.000+0000</td><td>63258</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-19767_57105/test.jpg">test.jpg</td></td><td>2015-10-22T18:27:29.000+0000</td><td>18647</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Angel Petkov 2015-11-24

   FT passed , PR approved. Thanks Hans! </li>
<li>Josh Longton 2016-01-15

   </li>
</ol>


<p><a href="/TIMOB/TIMOB-19767.json">JSON Source</a></p>