---
title: "[TIMOB-19884] iOS: Debug crash when setting breakpoint in alloy model response"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-12-14T03:23:47.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.2.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>TCSupportTriage, alloy, debugger-ios, user_experience, validate</td></tr>
<tr><th>Reporter</th><td>Jason Kotchoff</td></tr>
<tr><th>Assignee</th><td>Chee Kiat Ng</td></tr>
<tr><th>Created</th><td>2015-02-03T21:19:44.000+0000</td></tr>
<tr><th>Updated</th><td>2016-02-16T23:22:22.000+0000</td></tr>
</table>

<h3>Description</h3>

When setting a titanium studio breakpoint in an alloy model response from a sync adapter that fetches remote content, titanium 3.5.0 crashes in iOS.

Here is an example alloy project that fetches remote content using a custom alloy model adapter:
<a href="https://github.com/jkotchoff/alloytest" rel="nofollow" target="_blank">https://github.com/jkotchoff/alloytest</a>

When run in 'debug mode' in Titanium Studio, setting a breakpoint in the alloy model response will crash the app with SDK 3.5.0 and iOS
ie.
<a href="https://github.com/jkotchoff/alloytest/blob/master/app/controllers/index.js#L7" rel="nofollow" target="_blank">https://github.com/jkotchoff/alloytest/blob/master/app/controllers/index.js#L7</a>

A debug point here works fine in SDK 3.4.1 on iOS and it works fine in Android (SDK 3.4.1 or 3.5.0).

This makes debugging titanium apps that render content from a remote server impossible in 3.5.0 on iOS. 

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19884_56260/iosdebugger_notworking_4.0GA.log">iosdebugger_notworking_4.0GA.log</td></td><td>2015-07-27T14:15:53.000+0000</td><td>15476</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19884_56259/iosdebugger_working_3.4.1GA.log">iosdebugger_working_3.4.1GA.log</td></td><td>2015-07-27T14:15:53.000+0000</td><td>15853</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19884_57639/wluu_chuck_norris.crash">wluu_chuck_norris.crash</td></td><td>2015-11-30T23:00:31.000+0000</td><td>329454</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19884_57638/wluu_circular.crash">wluu_circular.crash</td></td><td>2015-11-30T23:00:31.000+0000</td><td>328931</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Jason Kotchoff 2015-02-04

   Note, just before running this test project, you may want to make a single web browser request to:
   <a href="http://sinatra-api-demo.herokuapp.com/endpoint.json" rel="nofollow" target="_blank">http://sinatra-api-demo.herokuapp.com/endpoint.json</a>
   
   in order to spin up the server because heroku will spin it down if it hasn't been hit in awhile and then the http request from titanium may time out.</li>
<li>Praveen Innamuri 2015-07-23

   [~kkolipaka] Can you take a look into this ?</li>
<li>Kondal Kolipaka 2015-07-27

   Please find the attached logs.</li>
<li>Johnson Joseph 2015-08-20

   Any news on this?</li>
<li>Manny Parasirakis 2015-10-07

   This looks like the same thing reported in AC-297. That bug has info as to how to reproduce this issue in 2 lines of code.</li>
<li>Praveen Innamuri 2015-11-06

   The titanium debugger crashes whenever it tries to send message through debugger connection:
   
   <code><pre>
   Thread 5 Crashed:: KrollContext<kroll$1>
   0   com.geoplus.alloytest         	0x0000000104c983ba WTI::StringImpl::utf8ForRange(unsigned int, unsigned int, WTI::ConversionMode) const + 90
   1   com.geoplus.alloytest         	0x0000000104c98568 WTI::StringImpl::utf8(WTI::ConversionMode) const + 24
   2   com.geoplus.alloytest         	0x0000000104c9c579 WTI::String::utf8(WTI::ConversionMode) const + 25
   3   com.geoplus.alloytest         	0x00000001049aa81b TiDebuggerUtils::wtf_string_to_string(WTI::String const&) + 27
   4   com.geoplus.alloytest         	0x00000001049abb80 TiDebuggerUtils::generate_variables(TI::ExecState*, TI::JSObject*, std::__1::map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, TiDebuggerVariableStruct, std::__1::less<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, TiDebuggerVariableStruct> > >&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) + 272
   5   com.geoplus.alloytest         	0x00000001049ab99e TiDebuggerUtils::generate_variable(TI::ExecState*, TI::TiValue&, TiDebuggerVariableStruct&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) + 2014
   6   com.geoplus.alloytest         	0x00000001049abd67 TiDebuggerUtils::generate_variables(TI::ExecState*, TI::JSObject*, std::__1::map<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, TiDebuggerVariableStruct, std::__1::less<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > >, std::__1::allocator<std::__1::pair<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const, TiDebuggerVariableStruct> > >&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) + 759
   </pre></code></li>
<li>Praveen Innamuri 2015-11-10

   [~sdavenport] This ticket doesn't duplicates any other ticket. We still need to investigate the root cause causing the crash of debugging.</li>
<li>Manny Parasirakis 2015-11-10

   The core of the issue as we discovered is that the debugger cannot seem to handle circular references in object graphs. If you create a new Appcelerator mobile project and inside the index.js add these two lines of code before $.index.open() you can reproduce the issue easily:
   
   var a = {b:{c:1}};
   a.b.d=a;
   
   Set a breakpoint on the second line above and then when you hit it, step over and the app being debugged will crash.</li>
<li>Gerald Gurevich 2015-11-11

   I have a contractor working on a time sensitive application and he is completely stopped by this issue.  I'm not getting very good information from Appcelerator on this issue.  We have 10 minutes of work to do but are unable to use Appcelerator studio to do this work.  Hours and hours of time have been lost already.  We chose this platform for its flexibility of deployment.  We are not seeing that advantage anymore.  Can we please get some traction on this issue?  
   
   We are about 1 week from being forced to move to another platform. If we leave, we won't ever be back.
   
   Please be sure to reference back to the AC-297 which is the ticket that we had been watching.</li>
<li>Wilson Luu 2015-11-30

    I am still able to reproduce this issue with the current GA stack. I was able to reproduce with [~mannyp] test case and the original reported bug, which both generated similar crash reports seen by [~pinnamuri]; see [^wluu_circular.crash] for [~mannyp] test case and see [^wluu_chuck_norris.crash] for the original reported bug.
    
    Tested on:
    
    Appcelerator Studio, build: 4.4.0.201511241829
    Appc CLI NPM: 4.2.2
    Appc CLI Core: 5.1.0
    Arrow: 1.3.22
    SDK: 5.1.1.GA
    Node: v4.2.2
    OS: El Capitan (10.11.1)
    Xcode: 7.1.1
    Devices: iphone simulator (9.1)</li>
<li>Wilson Luu 2015-12-01

    Possible valid data point: from what I'm gathering so far, it looks like the debugger cannot handle relatively large JSON objects. In TIMOB-20017 and this original reported bug, the requested JSON do not have any circular reference, but are relatively large if you were to print them out. And in [~mannyp]'s test case, I think that a circular reference JSON is inherently large.</li>
<li>Chee Kiat Ng 2015-12-09

    </li>
<li>Wilson Luu 2016-02-16

    Closing ticket as fixed. Verified that [~mannyp]'s test case and the original reported test case does not crash if you set a breakpoint on the specified lines.
    
    Tested on:
    
    Appcelerator Studio, build: 4.5.0.201602132419
    Appc CLI NPM: 4.2.3-2
    Appc CLI Core: 5.2.0-265
    Arrow: 1.7.27
    SDK: 5.2.0.v20160216091337
    Node: v4.2.4
    OS: El Capitan (10.11.3)
    </li>
</ol>


<p><a href="/TIMOB/TIMOB-19884.json">JSON Source</a></p>