---
title: "[TIMOB-19906] iOS: SafariDialog close event crash"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-11-10T18:46:14.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.1.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>crash, ios, safaridialog</td></tr>
<tr><th>Reporter</th><td>Sebastian Klaus</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2015-11-10T15:01:11.000+0000</td></tr>
<tr><th>Updated</th><td>2015-11-10T21:10:23.000+0000</td></tr>
</table>

<h3>Description</h3>

SafariaDialog crashes the app after opening with an URL containing spaces

<code><pre>
var self = Ti.UI.createWindow({
        title: L('Test')
    });

    self.addEventListener('open', function () {
        var SafariDialog = require('ti.safaridialog');

        SafariDialog.open({
            url: '<a href="http://www.amazon.com/s/field-keywords=Transformers" rel="nofollow" target="_blank">http://www.amazon.com/s/field-keywords=Transformers</a> 4', // works not
            //url: '<a href="http://www.amazon.com/s/field-keywords=Transformers+4" rel="nofollow" target="_blank">http://www.amazon.com/s/field-keywords=Transformers+4</a>', // works
            title: 'Search'
        });

        SafariDialog.addEventListener('close', function (e) {
            console.log(e);
        });
    });

    self.open();
</pre></code>

<h3>Comments</h3>

<ol>
<li>Fokke Zandbergen 2015-11-10

   [~hansknoechel] shouldn't we fix this before it is released with 5.1?</li>
<li>Hans Knöchel 2015-11-10

   PR (Ti.SafariDialog/master): <a href="https://github.com/appcelerator-modules/Ti.SafariDialog/pull/3" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/Ti.SafariDialog/pull/3</a>
   PR (titanium_mobile/master): <a href="https://github.com/appcelerator/titanium_mobile/pull/7415" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7415</a>
   PR (titanium_mobile/5_1_X): <a href="https://github.com/appcelerator/titanium_mobile/pull/7416" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7416</a>
   
   Demo:
   <code><pre>
   
   var safariDialog = require('ti.safaridialog');
   
   Ti.API.warn('ti.safaridialog.supported ' + safariDialog.supported);
   Ti.API.warn('ti.safaridialog.getSupprted() ' + safariDialog.getSupported());
   Ti.API.warn('ti.safaridialog.isSupported() ' + safariDialog.isSupported());
   
   var win = Ti.UI.createWindow({
   	backgroundColor: "#fff"
   });
   var btn = Ti.UI.createButton({
   	title: "Open SafariDialog!"
   });
   
   btn.addEventListener("click", function(){
   	safariDialog.open({
   		url: "<a href="http://www.amazon.com/s/field-keywords=Transformers" rel="nofollow" target="_blank">http://www.amazon.com/s/field-keywords=Transformers</a> 4",
   		title: "Amazon"
   	});
   });
   
   safariDialog.addEventListener("close", function(e) {
   	Ti.API.warn(e);
   });
   
   safariDialog.addEventListener("open", function(e) {
   	Ti.API.warn(e);
   });
   
   win.add(btn);
   win.open();
   win.open();
   </pre></code></li>
<li>Eric Merriman  2015-11-10

   OK with me. Merge away.</li>
<li>Angel Petkov 2015-11-10

   PR approved and Merged</li>
<li>Wilson Luu 2015-11-10

   Closing ticket as fixed. Using the above demo code, verified the following:
   
   * On a iOS 9.1 device, <code>safariDialog.supported</code>, <code>afariDialog.getSupported()</code>, and <code>safariDialog.isSupported()</code> returns true on launch of the app.
   * On a iOS 9.1 device, if I press the <code>"Open SafariDialog!"</code> button and close the SafariDialog multiple times, then the app does not crash.
   * On a iOS 8.2 device, <code>safariDialog.supported</code>, <code>afariDialog.getSupported()</code>, and <code>safariDialog.isSupported()</code> returns false on launch of the app.
   
   Tested on:
   
   Appcelerator Studio, build: 4.4.0.201511101919
   Appc CLI NPM: 4.2.1
   Appc CLI Core: 5.1.0-44
   Arrow: 1.3.19
   SDK: 5.1.0.v20151110110428
   ti.safaridialog: 1.0.2
   Node: v4.2.1
   OS: El Capitan (10.11.1)
   Xcode: 7.1.1
   Devices: iphone 6s plus (9.1), iphone 6 (8.2)</li>
<li>Sebastian Klaus 2015-11-10

   Very fast reaction. Thank you all.</li>
</ol>


<p><a href="/TIMOB/TIMOB-19906.json">JSON Source</a></p>