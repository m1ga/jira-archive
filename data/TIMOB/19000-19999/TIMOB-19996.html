---
title: "[TIMOB-19996] iOS: deadlock occurs on sound.play"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-11-16T23:10:58.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.1.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>qe-5.1.0, regression</td></tr>
<tr><th>Reporter</th><td>Harry Bryant</td></tr>
<tr><th>Assignee</th><td>Angel Petkov</td></tr>
<tr><th>Created</th><td>2015-11-16T20:57:05.000+0000</td></tr>
<tr><th>Updated</th><td>2015-11-16T23:10:58.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description:</h4>
*This is a regression from 5.0.2.GA*
Sound fails to play when an app is built with Ti SDK <code>5.1.0</code>. The following error occurs attempting to play a sound from a device:

<code><pre>
Nov 16 12:48:33 Future-Angle AudioTester[1141] <Warning>: *** -[NSLock lock]: deadlock (<NSLock: 0x146e7b830> '(null)')
Nov 16 12:48:33 Future-Angle AudioTester[1141] <Warning>: *** Break on _NSLockError() to debug.
</pre></code>

The bug was originally found when running the sound test cases in KitchenSink, but the same issue occurs when isolated into a separate app.

<h4>Steps to reproduce:</h4>
1. Create a Classic project.
2. Include attached .wav file to project directory > Resources > etc 
3. Add following demo code to app.js: 
<code><pre>
var win = Titanium.UI.createWindow({
		title: "Window One"
	});
		
	//TODO: USE OBJECT
	var sound = Titanium.Media.createSound();
	sound.url='/etc/cricket.wav'; // For testing #1913
	
	//
	// PLAY
	//
	var play = Titanium.UI.createButton({
		title:'Play',
		height:40,
		width:145,
		left:10,
		top:10
	});
	play.addEventListener('click', function()
	{
		sound.play();		
	});
	win.add(play);
	
win.open();
</pre></code>
3. Run app to device.
4. Press play.

<h4>Result:</h4>
Receive <code>deadlock</code> error and sound fails to play.

<h4>Expected Result:</h4>
app should not deadlock and should succeed in playing the sample file.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-19996_57522/cricket.wav">cricket.wav</td></td><td>2015-11-16T20:56:45.000+0000</td><td>80923</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Angel Petkov 2015-11-16

   PR pending <a href="https://github.com/appcelerator/titanium_mobile/pull/7450" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7450</a></li>
<li>Harry Bryant 2015-11-16

   Verified as fixed, using the latest Ti SDK build: <code>5.1.0.v20151116142031</code> I was able to produce sound both on device & simulators. Tested the above sample code as well as KitchenSink, with no issue.
   
   iPhone 6s Device & Sim (9.1)
   iPhone 6 Device & Sim (8.4)
   Mac OSX El Capitan 10.11 (15A284)
   Ti SDK: 5.1.0.v20151116142031 
   Appc Studio: 4.4.0.201511130407
   Appc NPM: 4.2.1
   Appc CLI: 5.1.0-54
   Ti CLI: 5.0.4
   Alloy: 1.7.25
   Xcode 7.1(7B91b)
   Node v0.12.7
   production
   
   *Closing ticket.*</li>
</ol>


<p><a href="/TIMOB/TIMOB-19996.json">JSON Source</a></p>