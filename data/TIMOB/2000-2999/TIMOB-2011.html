---
title: "[TIMOB-2011] Opening new modal window with JS error will crash the app"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-05-25T17:50:05.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.7.0, Sprint 2011-20</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>crash, ios, javascript, modal, release-1.7.0</td></tr>
<tr><th>Reporter</th><td>Alex Le</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2011-04-15T03:08:01.000+0000</td></tr>
<tr><th>Updated</th><td>2011-05-25T17:50:05.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>If opening a new modal window via a new javascript file, and
this javascript file has errors, the iPhone emulator would crash.
The reason why is that the red alert window is animating on top of
the modal animation at the same time, thus would run into animation
exception and crash the emulator.</p>
<p>For example,</p>
<p><code>
var editWin = Ti.UI.createWindow( { url: 'edit.js', title:
"Edit", backgroundColor: 'white' } );


editWin.open({ modal: true, modalStyle:
Ti.UI.iPhone.MODAL_PRESENTATION_PAGESHEET, navBarHidden: true });
</code></p>
<p>If the "edit.js" has an error, like a null reference exception,
the app would crash. The stacktrace would be something like this
...</p>
<p>ERROR] Script Error = Can't find variable: contactByIds at
edit.js (line 68).<br>
2010-10-05 17:01:21.458 Marrily[8996:207] <strong><em>Assertion
failure in -[UIWindowController
transition:fromViewController:toViewController:target:didEndSelector:],
/SourceCache/UIKit_Sim/UIKit-1262.60.3/UIWindowController.m:182<br>
<a href="/projects/32238/changesets/ERROR" title=
"Changeset [ERROR]">[ERROR]</a> The application has crashed with an
unhandled exception. Stack trace: 0 CoreFoundation 0x03807b7c
<strong>exceptionPreprocess + 156<br>
1 libobjc.A.dylib 0x0395740e objc_exception_throw + 47<br>
2 CoreFoundation 0x037c0238 +[NSException raise:format:arguments:]
+ 136<br>
3 Foundation 0x0062ae37 -[NSAssertionHandler
handleFailureInMethod:object:file:lineNumber:description:] +
116<br>
4 UIKit 0x00ac944f -[UIWindowController
transition:fromViewController:toViewController:target:didEndSelector:]
+ 212<br>
5 UIKit 0x008de10d -[UIViewController
presentModalViewController:withTransition:] + 2937<br>
6 Marrily 0x00137079 -[TiApp attachModal:toController:animated:] +
290<br>
7 Marrily 0x001370a8 -[TiApp attachModal:toController:animated:] +
337<br>
8 Marrily 0x00135b13 -[TiApp showModalController:animated:] +
231<br>
9 Marrily 0x0005386c -[TiWindowProxy open:] + 2436<br>
10 Foundation 0x005af3ca</strong> NSThreadPerformPerform + 251<br>
11 CoreFoundation 0x037e8faf
<strong>CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION</strong>
+ 15<br>
12 CoreFoundation 0x0374739b <strong>CFRunLoopDoSources0 + 571<br>
13 CoreFoundation 0x03746896</strong> CFRunLoopRun + 470<br>
14 CoreFoundation 0x03746350 CFRunLoopRunSpecific + 208<br>
15 CoreFoundation 0x03746271 CFRunLoopRunInMode + 97<br>
16 GraphicsServices 0x053ee00c GSEventRunModal + 217<br>
17 GraphicsServices 0x053ee0d1 GSEventRun + 115<br>
18 UIKit 0x0083eaf2 UIApplicationMain + 1160<br>
19 Marrily 0x00003b49 main + 362<br>
20 Marrily 0x00002931 start + 53<br>
21 ??? 0x00000001 0x0 + 1<br>
2010-10-05 17:01:21.461 Marrily[8996:207]</em></strong> Terminating
app due to uncaught exception 'NSInternalInconsistencyException',
reason: 'Attempting to begin a modal transition from
&lt;TiErrorController: 0x7ee6590&gt; to &lt;UINavigationController:
0x7ef0df0&gt; while a transition is already in progress. Wait for
viewDidAppear/viewDidDisappear to know the current transition has
completed'<br>
*** Call stack at first throw: ( 0 CoreFoundation 0x03807b99
<strong>exceptionPreprocess + 185<br>
1 libobjc.A.dylib 0x0395740e objc_exception_throw + 47<br>
2 CoreFoundation 0x037c0238 +[NSException raise:format:arguments:]
+ 136<br>
3 Foundation 0x0062ae37 -[NSAssertionHandler
handleFailureInMethod:object:file:lineNumber:description:] +
116<br>
4 UIKit 0x00ac944f -[UIWindowController
transition:fromViewController:toViewController:target:didEndSelector:]
+ 212<br>
5 UIKit 0x008de10d -[UIViewController
presentModalViewController:withTransition:] + 2937<br>
6 Marrily 0x00137079 -[TiApp attachModal:toController:animated:] +
290<br>
7 Marrily 0x001370a8 -[TiApp attachModal:toController:animated:] +
337<br>
8 Marrily 0x00135b13 -[TiApp showModalController:animated:] +
231<br>
9 Marrily 0x0005386c -[TiWindowProxy open:] + 2436<br>
10 Foundation 0x005af3ca</strong> NSThreadPerformPerform + 251<br>
11 CoreFoundation 0x037e8faf
<strong>CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION</strong>
+ 15<br>
12 CoreFoundation 0x0374739b <strong>CFRunLoopDoSources0 + 571<br>
13 CoreFoundation 0x03746896</strong> CFRunLoopRun + 470<br>
14 CoreFoundation 0x03746350 CFRunLoopRunSpecific + 208<br>
15 CoreFoundation 0x03746271 CFRunLoopRunInMode + 97<br>
16 GraphicsServices 0x053ee00c GSEventRunModal + 217<br>
17 GraphicsServices 0x053ee0d1 GSEventRun + 115<br>
18 UIKit 0x0083eaf2 UIApplicationMain + 1160<br>
19 Marrily 0x00003b49 main + 362<br>
20 Marrily 0x00002931 start + 53<br>
21 ??? 0x00000001 0x0 + 1<br>
) terminate called after throwing an instance of 'NSException'</p></div>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2011-04-15

   <div><p>Still valid. Test checked into bugtests.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Forgot, this is a high priority as it's a BAD crasher.</p></div></li>
<li>Jacob Relkin 2011-04-21

   This is a bug that runs quite deep. What to do when JSLint throws errors is yet to be determined. Putting on hold and assigning to Reggie.</li>
<li>Eric Merriman  2011-05-11

   Per the last comment, this is on hold and not fixed yet. Setting to Unresolved.</li>
<li>Thomas Huelbert 2011-05-25

   ipad1 4.3 Titanium SDK version: 1.7.0 (05/24/11 22:37 294b6aa...)</li>
</ol>


<p><a href="/TIMOB/TIMOB-2011.json">JSON Source</a></p>