---
title: "[TIMOB-2027] Android: Weird behavior when setting custom sub properties on proxies "
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:57:51.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, custom, defect, kroll, properties, proxy</td></tr>
<tr><th>Reporter</th><td>Marshall Culpepper</td></tr>
<tr><th>Assignee</th><td>Marshall Culpepper</td></tr>
<tr><th>Created</th><td>2011-04-15T03:08:29.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:57:51.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>An example from hal:<br></p>
<pre>
<code class=
"javascript">var viewInvRow = Ti.UI.createView(viewRowOptions);
Ti.API.info('----');
viewInvRow.customObj = "hello";
Ti.API.info('viewInvRow.customObj: '+viewInvRow.customObj); // output ok
viewInvRow.customObj = {};
viewInvRow.customObj.test = "hello";
Ti.API.info('viewInvRow.customObj.test: '+viewInvRow.customObj.test); // undefined
viewInvRow.customObj = { test : "hello" };
Ti.API.info('viewInvRow.customObj.test: '+viewInvRow.customObj.test); // output ok
Ti.API.info('----');</code>
</pre></div>

<h3>Comments</h3>

<ol>
<li>Nathaniel McCallum 2011-04-15

   <div><p>Something similar happens with this case (though, probably worse
   since its a crash):</p>
   <pre>
   <code class="javascript">// The object that will cause a crash
   var X = function() {
           this.y = 1;
   };
   X.prototype.getY = function() {
           return this.y;
   };
   
   var x = new X();
   
   var row = Ti.UI.createTableViewRow();
   row.x = x;
   
   Ti.API.info(x.getY());     // 1.0
   Ti.API.info(row.x.getY()); // CRASH!</code>
   </pre>
   <p>Log:<br>
   W/KrollConverter( 2859): (kroll$1) [351,491] Unhandled type
   conversion: value: {"y":1} type: org.appcelerator.kroll.KrollDict,
   invocation: [setProperty UI.TableViewRow.x null]<br>
   I/TiAPI ( 2859): (kroll$1) [49,540] 1.0<br>
   I/ActivityManager( 60): Displayed activity
   com.foo.foo/.FooActivity: 6077 ms (total 6077 ms)<br>
   E/KrollContext( 2859): (kroll$1) [462,1002] ECMA Error evaluating
   source: TypeError: Cannot find default value for object.
   (app://app.js#14)<br>
   E/KrollContext( 2859): org.mozilla.javascript.EcmaError: TypeError:
   Cannot find default value for object. (app://app.js#14)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3761)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.constructError(ScriptRuntime.java:3739)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.typeError(ScriptRuntime.java:3767)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.typeError1(ScriptRuntime.java:3779)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptableObject.getDefaultValue(ScriptableObject.java:839)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptableObject.getDefaultValue(ScriptableObject.java:758)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.toString(ScriptRuntime.java:790)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.notFunctionError(ScriptRuntime.java:3848)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.getPropFunctionAndThisHelper(ScriptRuntime.java:2343)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.getPropFunctionAndThis(ScriptRuntime.java:2310)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.Interpreter.interpretLoop(Interpreter.java:1524)<br>
   E/KrollContext( 2859): at script(app://app.js:14)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.Interpreter.interpret(Interpreter.java:854)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.InterpretedFunction.call(InterpretedFunction.java:164)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:426)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:3161)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.InterpretedFunction.exec(InterpretedFunction.java:175)<br>
   E/KrollContext( 2859): at
   org.mozilla.javascript.Context.evaluateReader(Context.java:1142)<br>
   E/KrollContext( 2859): at
   org.appcelerator.titanium.kroll.KrollContext.evaluateScript(KrollContext.java:193)<br>
   E/KrollContext( 2859): at
   org.appcelerator.titanium.kroll.KrollContext.handleEvalFile(KrollContext.java:218)<br>
   E/KrollContext( 2859): at
   org.appcelerator.titanium.kroll.KrollContext.handleMessage(KrollContext.java:115)<br>
   E/KrollContext( 2859): at
   android.os.Handler.dispatchMessage(Handler.java:95)<br>
   E/KrollContext( 2859): at
   android.os.Looper.loop(Looper.java:123)<br>
   E/KrollContext( 2859): at
   org.appcelerator.titanium.kroll.KrollHandlerThread.run(KrollHandlerThread.java:73)</p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/ee3b8859c349729bac353e413ef4eb051a51e86e"
   title=
   "Changeset [ee3b8859c349729bac353e413ef4eb051a51e86e]">[ee3b8859c349729bac353e413ef4eb051a51e86e]</a>)
   implemented a new Scriptable wrapper extension of KrollDict so
   custom objects don't get lost in the conversion mix. added a test
   to make sure custom objects work correctly when put on proxies
   [<a href="/projects/32238/tickets/2027" title=
   "Ticket #2027">#2027</a> state:fixed-in-qa] <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/ee3b8859c349729bac353e413ef4eb051a51e86e" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/ee3b8859c349729bac353e413ef4eb051a51e86e</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/ee3b8859c349..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/ee3b8859c349...</a></a></p></div></li>
<li>Matt Schmulen 2011-04-15

   <div><p>pass Titanium SDK version: 1.5.0 (12/07/10 10:00 8f4eea3...),
   bugTest android Device 1.6/ sim 2.1</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2027.json">JSON Source</a></p>