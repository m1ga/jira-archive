---
title: "[TIMOB-2107] iOS: HTTPClient doesn't execute callbacks before returning in synchronous mode"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Do</td></tr>
<tr><th>Resolution Date</th><td>2020-01-09T18:33:03.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>core</td></tr>
<tr><th>Reporter</th><td>Harry Brundage</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2011-04-15T03:10:38.000+0000</td></tr>
<tr><th>Updated</th><td>2020-01-09T18:33:03.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>When HTTPClients are opened in synchronous mode (the third
parameter set to false), the send call returns before executing the
attached callbacks. I know it seems weird wanting to use callbacks
with a synchronous call, but this behaviour seems to be expected of
other XHR like objects by libraries like jQuery and SpazCore.</p>
<p>Try running this code to reproduce the issue:<br></p>
<pre>
<code class="javascript">  var bool, xhr;
  xhr = Titanium.Network.createHTTPClient();
  bool = false;
  xhr.open("GET", "<a href="http://api.twitter.com/1/help/test.json" rel="nofollow" target="_blank">http://api.twitter.com/1/help/test.json</a>", false);
  xhr.onreadystatechange = function() {
    Ti.API.debug("Ready State change to " + xhr.status);
    if (xhr.status === 200) {
      Ti.API.debug("Setting bool to true");
      bool = true;
    }
  };
  xhr.send();
  Ti.API.debug("Bool is: " + bool);</code>
</pre>
<p>Output I get from iPhone SDK v4.1, Titanium Mobile SDK
v1.4.0</p>
<pre>
<code>[DEBUG] Bool is: false
[DEBUG] Ready State change to 200
[DEBUG] Setting bool to true</code>
</pre>
<p>What I think I should see:</p>
<pre>
<code>[DEBUG] Ready State change to 200
[DEBUG] Setting bool to true
[DEBUG] Bool is: true</code>
</pre>
<p>If you run this code in chrome in a console on
api.twitter.com:<br></p>
<pre>
<code>  var bool, xhr;
  xhr = new XMLHttpRequest();
  bool = false;
  xhr.open("GET", "<a href="http://api.twitter.com/1/help/test.json" rel="nofollow" target="_blank">http://api.twitter.com/1/help/test.json</a>", false);
  xhr.onreadystatechange = function() {<br>
<br>


</code>
</pre>
<pre>
<code><code>console.log(&amp;quot;Ready State change to &amp;quot; + xhr.status);
if (xhr.status === 200) {
  console.log(&amp;quot;Setting bool to true&amp;quot;);
  bool = true;
}</code></code>
</pre>
<pre>


<br>
  };
  xhr.send();
  console.log("Bool is: " + bool);
</pre>
<p>You get the above expected output:</p>
<pre>
<code>Ready State change to 200
Setting bool to true
Bool is: true</code>
</pre>
<p>Can Titanium's XHR implementation be changed to conform?</p></div>

<h3>Comments</h3>

<ol>
<li>Harry Brundage 2011-04-15

   <div><p>Confirmed this issue persists in the mobile SDK v1.4.1.1</p></div></li>
<li>Harry Brundage 2011-04-15

   <div><p>Any update on this folks? I'd love to use some of the stuff this
   breaks!</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>XHR spec does say that these are supposed to be synchronous, but
   we're purposefully ASYNCHRONOUS. At least on the iOS side, we need
   a way to force events to fire synchronously, for cases like
   this.</p></div></li>
<li>Stephen Tramer 2012-07-26

   Confirmed SDK 2.2.0.014b86f</li>
<li>Alan Hutton 2020-01-09

   It has been decided that this issue should be closed as “Won’t do.” This issue is out of date with our current supported SDK release (7.5.2.GA as of the date of closure), and out of date with mobile OS versions. Updating, or creating code may not reproduce the issue reported, or be a valid test case.</li>
</ol>


<p><a href="/TIMOB/TIMOB-2107.json">JSON Source</a></p>