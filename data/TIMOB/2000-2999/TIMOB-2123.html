---
title: "[TIMOB-2123] iPhone Map user location is covered by annotations with custom images"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2012-07-26T11:50:02.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>annotation, ios, iphone, map</td></tr>
<tr><th>Reporter</th><td>Jonathan Harlap</td></tr>
<tr><th>Assignee</th><td>Neeraj Gupta</td></tr>
<tr><th>Created</th><td>2011-04-15T03:11:07.000+0000</td></tr>
<tr><th>Updated</th><td>2012-07-26T22:15:42.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>If you create a map view with userLocation:true and add
annotations with custom images, the annotation images cover the
userLocation marker. The following example code illustrates the
bug, assuming you have an annotation.jpg, a trivial example of
which I attached.</p>
<pre>
<code class="javascript">Titanium.UI.setBackgroundColor('#000');

var win = Titanium.UI.createWindow({  
    title:'Map Bug',
    backgroundColor:'#fff'
});

var mapview = Titanium.Map.createView({
    mapType: Titanium.Map.STANDARD_TYPE,
    region: {latitude:0, longitude:0, 
        latitudeDelta:90, longitudeDelta:180},
    animate:true,
    regionFit:true,
    userLocation:true
});
win.add(mapview);

function updateMapLocation(e) {
    if (!e.success) { return; }

    var longitude = e.coords.longitude;
    var latitude = e.coords.latitude;

    var annotation = Ti.Map.createAnnotation({
        latitude:latitude,
        longitude:longitude,
        title:'Overlapping annotation',
        image:'images/annotation.jpg'
    });
    mapview.addAnnotation(annotation);

    var region = {latitude:latitude, longitude:longitude, latitudeDelta:0.05, longitudeDelta:0.05, animate:true};
    mapview.setLocation(region);
}

Titanium.Geolocation.purpose = "For testing";

var b = Ti.UI.createButton({title:'Add Annotation', style:Titanium.UI.iPhone.SystemButtonStyle.BORDERED});
b.addEventListener('click', function(e) {
    if (Titanium.Platform.model == 'Simulator') {
        var l = {success:true, coords:{latitude:37.3317, longitude:-122.0307}};
        updateMapLocation(l);
    } else {
        Titanium.Geolocation.getCurrentPosition(updateMapLocation);
    }
});

var flexSpace = Titanium.UI.createButton({
    systemButton:Titanium.UI.iPhone.SystemButton.FLEXIBLE_SPACE
});
var tb = Titanium.UI.createToolbar({bottom:0, items:[flexSpace,b,flexSpace]});
win.add(tb);

win.open();</code>
</pre></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-2123_18107/annotation.jpg">annotation.jpg</td></td><td>2011-04-15T03:11:08.000+0000</td><td>817</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2012-07-26

   Expected behavior.</li>
</ol>


<p><a href="/TIMOB/TIMOB-2123.json">JSON Source</a></p>