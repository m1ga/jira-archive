---
title: "[TIMOB-2135] iOS: Audioplayer change state inconsistencies"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-01-03T15:13:10.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.5.0</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-45, Release 1.8.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>module_media, qe-testadded, regression</td></tr>
<tr><th>Reporter</th><td>tcbb</td></tr>
<tr><th>Assignee</th><td>Reggie Seagraves</td></tr>
<tr><th>Created</th><td>2011-04-15T03:11:29.000+0000</td></tr>
<tr><th>Updated</th><td>2013-12-10T06:07:49.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Hi,</p>
<p>I'm currently finding that when I create an event listener that
listens to the audioPlayer change state, the state reported varies
widely across platforms and even devices.</p>
<p>Take the following code for instance (no affiliation with the
URL, just for example purposes:)</p>
<pre>
<code class="javascript">
Ti.API.log("Audio Stream App Started");
 
var url ='<a href="http://www.parishiltonjustme.com/downloads/audio/08_Screwed.mp3" rel="nofollow" target="_blank">http://www.parishiltonjustme.com/downloads/audio/08_Screwed.mp3</a>';
 
var streamer1 = Ti.Media.createAudioPlayer();
 
streamer1.addEventListener('change',function(e)
{ 
    Ti.API.log("AudioPlayer addEventListener 'change' says : "+e.description);
});
 
streamer1.url = url;
 
streamer1.start();</code>
</pre>
<p>When this runs, i get several different results depending on
device OS and even device vs. emulator.(see below)</p>
<p>In some instances,there is no report of a stopping or stopped
state. Considering this, for instance, how might one go about
creating a music stream player that auto-advances on all devices in
Titanium Mobile?</p>
<p>I first tried the developer support forum on this one a couple
weeks back, although no responses there.</p>
<p><a href=
"<a href="http://developer.appcelerator.com/question/68291/audioplayer-change-state-inconsistencies" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/68291/audioplayer-change-state-inconsistencies</a>">
<a href="http://developer.appcelerator.com/question/68291/audioplayer-change..." rel="nofollow" target="_blank">http://developer.appcelerator.com/question/68291/audioplayer-change...</a></a></p>
<p>Thanks,<br>
Darin</p>
<p>iPhone 4.1 Emulator<br></p>
<pre>
<code>[INFO] Audio Stream App Started
[INFO] AudioPlayer addEventListener 'change' says : waiting_for_data
[INFO] AudioPlayer addEventListener 'change' says : waiting_for_data
[INFO] AudioPlayer addEventListener 'change' says : waiting_for_queue
[INFO] AudioPlayer addEventListener 'change' says : playing
[INFO] AudioPlayer addEventListener 'change' says : stopping
[INFO] AudioPlayer addEventListener 'change' says : stopped
[INFO] AudioPlayer addEventListener 'change' says : initialized</code>
</pre>
Android 1.6 Emulator<br>
<pre>
<code>[INFO] Audio Stream App Started
[INFO] AudioPlayer addEventListener 'change' says : starting
[INFO] AudioPlayer addEventListener 'change' says : initialized
[INFO] AudioPlayer addEventListener 'change' says : playing
[INFO] AudioPlayer addEventListener 'change' says : playing</code>
</pre>
^never reports stopping or stopped^
<p>Andriod 2.2 Emulator<br></p>
<pre>
<code>[INFO] Audio Stream App Started
[INFO] AudioPlayer addEventListener 'change' says : starting
[INFO] AudioPlayer addEventListener 'change' says : initialized
[INFO] AudioPlayer addEventListener 'change' says : playing
[INFO] AudioPlayer addEventListener 'change' says : playing
[INFO] AudioPlayer addEventListener 'change' says : stopping
[INFO] AudioPlayer addEventListener 'change' says : stopped</code>
</pre>
Android 2.2 T- Mobile G2 (ADB logcat)<br>
<pre>
<code>I/TiAPI   ( 4260): (kroll$3) [22,25] [Audio Stream App Started] null
I/TiAPI   ( 4260): (kroll$3) [2207,2232] [AudioPlayer addEventListener 'change' says : starting] null
I/TiAPI   ( 4260): (kroll$3) [33,2265] [AudioPlayer addEventListener 'change' says : initialized] null
I/TiAPI   ( 4260): (kroll$3) [4,2269] [AudioPlayer addEventListener 'change' says : playing] null
I/TiAPI   ( 4260): (kroll$3) [2,2271] [AudioPlayer addEventListener 'change' says : playing] null</code>
</pre>
^never reports stopping or stopped^</div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-2135_18112/testing.zip">testing.zip</td></td><td>2011-04-15T03:11:30.000+0000</td><td>143684</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>turl 2011-04-15

   <div><p>I'm having this problem too; more specifically, stopping/stopped
   doesn't fire on any Android 2.1 that I tried (both emulator and a
   real device). playing/initializing/etc all work fine.</p>
   <p>This is a blocker for my app, I can't build a good media player
   with a playlist if I don't know when a song stops playing :(</p>
   <p>For now, I'm using a function being run at intervals that checks
   the playing and waiting properties, but this isn't a real solution
   to this issue.</p></div></li>
<li>Eli Mor 2011-04-15

   <div><p>I'm having this problem as well. Seems to be related to the
   1.5.x branch, tested 1.5, 1.5.1 and the 1.5.2 build from Dec 27
   2010 12:47 r9a159e76 - The change event does not work. Tested it on
   the Audioplayer version of Kitchen sink. Attached the project.<br>
   Tested the same on project on 1.4.2 and the latest master: Dec 28
   2010 21:19 r9157d0d9 and it works.</p></div></li>
<li>Eli Mor 2011-04-15

   <div><p>Not sure why this is not getting any attention. The player state
   does not change. Can anyone at least confirm whether this is a real
   bug or not?</p>
   <p>tagged:"1.5.x" tagged:state tagged:audio</p></div></li>
<li>Pat Edison 2011-04-15

   <div><p>I'm still waiting for somebody to tell me if I am dreaming or
   not on this one. It's kind of killed my development of a radio
   station app, at least under 1.5.1 when building for the iPhone.</p>
   <p>I can build OK under Appcelerator SDK 1.4x but because of
   another bug whereby my app seems not to want to run under iOS3.1 I
   was hoping that the latest of everything would be 'the fix'.</p>
   <p>I use the 'change' event to monitor the stream so the stop/start
   button can change it's icon in response to the actual stream, also
   to supply a user with some text as to what's going on - i.e.
   "Buffering", "Stopping" etc.</p></div></li>
<li>Rick Blalock 2011-04-15

   <div><p>I've verified that the change event does not work in 1.5.1 as
   well. Re: <a href=
   "<a href="http://developer.appcelerator.com/helpdesk/view/62371" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/62371</a>"><a href="http://developer.appcelerator.com/helpdesk/view/62371" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/62371</a></a></p>
   <p>The audio change event works in 1.6.</p></div></li>
<li>talldude 2011-04-15

   <div><p>Audio Events do not appear to be working in 1.6 either - I've
   done multiple clean builds on the latest daily snapshots, and it's
   not working:</p>
   <p><a href=
   "<a href="http://developer.appcelerator.com/helpdesk/view/62371" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/62371</a>"><a href="http://developer.appcelerator.com/helpdesk/view/62371" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/62371</a></a></p>
   <p>I just got done testing the latest build here:</p>
   <p><a href=
   "<a href="http://builds.appcelerator.com.s3.amazonaws.com/index.html" rel="nofollow" target="_blank">http://builds.appcelerator.com.s3.amazonaws.com/index.html</a>"><a href="http://builds.appcelerator.com.s3.amazonaws.com/index.html" rel="nofollow" target="_blank">http://builds.appcelerator.com.s3.amazonaws.com/index.html</a></a></p>
   <p>(Jan 21 2011 19:11 rfcfcc850)</p>
   <p>and events are not working for me.</p></div></li>
<li>Jordy 2011-04-15

   <div><p>@talldude: it is working for me with this build: "Jan 21 2011
   19:11 rfcfcc850" on <a href=
   "<a href="http://builds.appcelerator.com.s3.amazonaws.com/index.html" rel="nofollow" target="_blank">http://builds.appcelerator.com.s3.amazonaws.com/index.html</a>"><a href="http://builds.appcelerator.com.s3.amazonaws.com/index.html" rel="nofollow" target="_blank">http://builds.appcelerator.com.s3.amazonaws.com/index.html</a></a></p></div></li>
<li>Reggie Seagraves 2011-11-07

   Fixed in a previous checkin.</li>
<li>Eric Merriman  2011-12-06

   Verified fixed with SDK 1.8.0.1.v20111205164258 on iPad 2 (4.3.5), iPhone 4s (5.01), iPod touch 3rd gen (4.0.2). All devices report as in Reggie's comments above.</li>
<li>Michael Pettiford 2012-01-03

    Reopening/Closing to update labels</li>
<li>Shameer Jan 2013-12-10

    Anvil testcase PR <a href="https://github.com/appcelerator/titanium_mobile/pull/5021" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5021</a>
    </li>
</ol>


<p><a href="/TIMOB/TIMOB-2135.json">JSON Source</a></p>