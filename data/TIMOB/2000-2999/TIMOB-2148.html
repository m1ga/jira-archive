---
title: "[TIMOB-2148] IOS: sound_record.js from KS crashes when inoked in another app"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:58:14.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>crash, ios, record, regression, rplist, sound</td></tr>
<tr><th>Reporter</th><td>Ralf Pfeiffer</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-04-15T03:11:53.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:58:14.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>I am using the exact sound_record.js file from KS in another
app.</p>
<p>The repro steps are:</p>
<p>hit the start recording button<br>
"say something" hit the stop recording button</p>
<p>Note: It will not flip the button label back to [start
recording], as it does in KS<br>
(maybe it is stil recording?)</p>
<p>When you leave the window, the app crashes (log attached)</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-2148_18114/flashcard_recording_crash.rtf">flashcard_recording_crash.rtf</td></td><td>2011-04-15T03:11:54.000+0000</td><td>23878</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ralf Pfeiffer 2011-04-15

   <div><p>Note that this is using XCode with IOS 4.0</p>
   <p>Also there is code that is NOT at all in our API that needs some
   clarification:</p>
   <p>IN the following listener:</p>
   <p>there is a line like:<br>
   file = recording.stop(); // our API doc says this returns a
   void!</p>
   <p>IN another listener there is:<br>
   sound = Titanium.Media.createSound({sound:file}); // our API does
   not list the sound property!</p></div></li>
<li>Ralf Pfeiffer 2011-04-15

   <div><p>ok, earler I was using SDK 4.0, and 1.4.x</p>
   <p>Now I have upgraded to Xcode/SDK4.1 and latest Ti 1.5.</p>
   <p>I have the same problem, AND I can replicate in Simulator! The
   Simluator should notice that no Audio exists as per the code but it
   does not.</p>
   <p>From running in Simulator with FlashCard:<br>
   <a href="/projects/32238/changesets/INFO" title=
   "Changeset [INFO]">[INFO]</a> tab Phone prevTab = Controls <a href=
   "/projects/32238/changesets/ERROR" title=
   "Changeset [ERROR]">[ERROR]</a> Improper audio session mode for
   recording. 1835361385 in -<a>TiMediaAudioRecorderProxy start:</a>
   <a href="/projects/32238/changesets/ERROR" title=
   "Changeset [ERROR]">[ERROR]</a> The application has crashed with an
   unhandled exception. Stack trace: 0 CoreFoundation 0x0382cb7c
   <strong>exceptionPreprocess + 156<br>
   1 libobjc.A.dylib 0x0397c40e objc_exception_throw + 47<br>
   2 KitchenSink 0x000aa3ee -[TiProxy
   throwException:subreason:location:] + 478<br>
   3 KitchenSink 0x0011b671 -[TiMediaAudioRecorderProxy start:] +
   1253<br>
   4 CoreFoundation 0x0379d5cd</strong> invoking <strong><em>+ 29<br>
   5 CoreFoundation 0x0379d4a1 -[NSInvocation invoke] + 145<br>
   6 KitchenSink 0x00048fc5 -[KrollMethod call:] + 2092<br>
   7 KitchenSink 0x00048377 KrollCallAsFunction + 327<br>
   8 KitchenSink 0x0026c736</em>
   ZN2TI16TiCallbackObjectINS_8TiObjectEE4callEPNS_10TiExcStateEPS1_NS_7TiValueERKNS_7ArgListE
   + 550<br>
   9 KitchenSink 0x0023759d cti_op_call_NotTiFunction + 637<br>
   10 ??? 0x10915590 0x0 + 277960080<br>
   11 KitchenSink 0x001e4f9f
   <em>ZN2TI11Interpreter7executeEPNS_18FunctionExecutableEPNS_10TiExcStateEPNS_10TiFunctionEPNS_8TiObjectERKNS_7ArgListEPNS_14ScopeChainNodeEPNS_7TiValueE
   + 783<br>
   12 KitchenSink 0x002508ef</em>
   ZN2TI10TiFunction4callEPNS_10TiExcStateENS_7TiValueERKNS_7ArgListE
   + 127<br>
   13 KitchenSink 0x00199479
   _ZN2TI4callEPNS_10TiExcStateENS_7TiValueENS_8CallTypeERKNS_8CallDataES2_RKNS_7ArgListE
   + 57<br>
   14 KitchenSink 0x0026a2b3 TiObjectCallAsFunction + 611<br>
   15 KitchenSink 0x000431e9 -[KrollCallback call:thisObject:] +
   726<br>
   16 KitchenSink 0x00044355 -[KrollEvent invoke:] + 92<br>
   17 KitchenSink 0x000439e6 -[KrollContext invoke:] + 43<br>
   18 KitchenSink 0x00045187 -[KrollContext main] + 3092<br>
   19 Foundation 0x005bf76c -[NSThread main] + 81<br>
   20 Foundation 0x005bf6f8</strong> NSThread<strong>main</strong> +
   1387<br>
   21 libSystem.B.dylib 0x97cb481d <em>pthread_start + 345<br>
   22 libSystem.B.dylib 0x97cb46a2 thread_start + 34<br>
   2010-10-21 17:36:26.868 KitchenSink[29232:8113]
   <strong><em>Terminating app due to uncaught exception
   'org.kitchensink.TiMediaAudioRecorderProxy', reason: 'Improper
   audio session mode for recording. 1835361385 in
   -<a>TiMediaAudioRecorderProxy start:</a>'<br></em></strong> Call
   stack at first throw: ( 0 CoreFoundation 0x0382cb99
   <strong>exceptionPreprocess + 185<br>
   1 libobjc.A.dylib 0x0397c40e objc_exception_throw + 47<br>
   2 KitchenSink 0x000aa3ee -[TiProxy
   throwException:subreason:location:] + 478<br>
   3 KitchenSink 0x0011b671 -[TiMediaAudioRecorderProxy start:] +
   1253<br>
   4 CoreFoundation 0x0379d5cd</strong> invoking</em> <strong>+ 29<br>
   5 CoreFoundation 0x0379d4a1 -[NSInvocation invoke] + 145<br>
   6 KitchenSink 0x00048fc5 -[KrollMethod call:] + 2092<br>
   7 KitchenSink 0x00048377 KrollCallAsFunction + 327<br>
   8 KitchenSink 0x0026c736
   <em>ZN2TI16TiCallbackObjectINS_8TiObjectEE4callEPNS_10TiExcStateEPS1_NS_7TiValueERKNS_7ArgListE
   + 550<br>
   9 KitchenSink 0x0023759d cti_op_call_NotTiFunction + 637<br>
   10 ??? 0x10915590 0x0 + 277960080<br>
   11 KitchenSink 0x001e4f9f</em>
   ZN2TI11Interpreter7executeEPNS_18FunctionExecutableEPNS_10TiExcStateEPNS_10TiFunctionEPNS_8TiObjectERKNS_7ArgListEPNS_14ScopeChainNodeEPNS_7TiValueE
   + 783<br>
   12 KitchenSink 0x002508ef
   <em>ZN2TI10TiFunction4callEPNS_10TiExcStateENS_7TiValueERKNS_7ArgListE
   + 127<br>
   13 KitchenSink 0x00199479</em>
   ZN2TI4callEPNS_10TiExcStateENS_7TiValueENS_8CallTypeERKNS_8CallDataES2_RKNS_7ArgListE
   + 57<br>
   14 KitchenSink 0x0026a2b3 TiObjectCallAsFunction + 611<br>
   15 KitchenSink 0x000431e9 -[KrollCallback call:thisObject:] +
   726<br>
   16 KitchenSink 0x00044355 -[KrollEvent invoke:] + 92<br>
   17 KitchenSink 0x000439e6 -[KrollContext invoke:] + 43<br>
   18 KitchenSink 0x00045187 -[KrollContext main] + 3092<br>
   19 Foundation 0x005bf76c -[NSThread main] + 81<br>
   20 Foundation 0x005bf6f8</strong> NSThread<strong>main</strong> +
   1387<br>
   21 libSystem.B.dylib 0x97cb481d _pthread_start + 345<br>
   22 libSystem.B.dylib 0x97cb46a2 thread_start + 34<br>
   ) terminate called after throwing an instance of 'NSException'<br>
   <a href="/projects/32238/changesets/INFO" title=
   "Changeset [INFO]">[INFO]</a> Application has exited from
   Simulator</p></div></li>
<li>Ralf Pfeiffer 2011-04-15

   <div><p>steps to repro in KS are simple now:</p>
   <p>Simulator:</p>
   <p>Launch KS<br>
   <a href="/projects/32238/changesets/Phone" title=
   "Changeset [Phone]">[Phone]</a> Tab <a href=
   "/projects/32238/changesets/Sound" title=
   "Changeset [Sound]">[Sound]</a> row <a href=
   "/projects/32238/changesets/Record" title=
   "Changeset [Record]">[Record]</a> (already you see the Playback
   Recording button which is and error) click [Start Recording]</p>
   <p>Crash!</p></div></li>
<li>Ralf Pfeiffer 2011-04-15

   <div><p>steps to repro on device with KS:</p>
   <p>Launch KS<br>
   Phone<br>
   Sound<br>
   Record<br>
   Start Playing<br>
   go back to Sound from Record screen</p>
   <p>Crash!</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Claiming this, could be related to module fixes.</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/76706c39f5d8184166081b74c0163ca1d5bf5472"
   title=
   "Changeset [76706c39f5d8184166081b74c0163ca1d5bf5472]">[76706c39f5d8184166081b74c0163ca1d5bf5472]</a>)
   [<a href="/projects/32238/tickets/2148" title=
   "Ticket #2148">#2148</a>] Fixes to getting audio session
   properties. <a href=
   "<a href="http://github.com/appcelerator/titanium_mobile/commit/76706c39f5d8184166081b74c0163ca1d5bf5472" rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/76706c39f5d8184166081b74c0163ca1d5bf5472</a>">
   <a href="http://github.com/appcelerator/titanium_mobile/commit/76706c39f5d81..." rel="nofollow" target="_blank">http://github.com/appcelerator/titanium_mobile/commit/76706c39f5d81...</a></a></p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>I would need much more information about whatever "other app"
   this was being used in to determine if audio recording really has a
   bug or not. Mixing audio playback and recording in iOS is very
   delicate, especially in Titanium, where the user has no direct
   control over audio sessions.</p>
   <p>I am not able to repo this in KS after the previous commit.
   Going to mark fixed-in-qa.</p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>4th gen ipod running 4.1, 3g iphone 3.1.2 .5.0.77ad8ac crash not
   repro</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2148.json">JSON Source</a></p>