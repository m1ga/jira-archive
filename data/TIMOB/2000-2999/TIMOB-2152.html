---
title: "[TIMOB-2152] Android: Loading perf issue (~3 seconds) with XHR to fileSystem test case"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:58:15.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.0 M02</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, android_refactor, filesystem, performance, xhr</td></tr>
<tr><th>Reporter</th><td>Thomas Huelbert</td></tr>
<tr><th>Assignee</th><td>Don Thorp</td></tr>
<tr><th>Created</th><td>2011-04-15T03:12:05.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:58:15.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>1.5.0.70ce98 g2 running 2.2</p>
<p>1.BaseUI&gt;Web Views&gt;XHR to FileSystem<br>
2.tap the test and time how long it takes for the page to load<br>
results:the new window take about 3 seconds to load.</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-2152_18117/methodtracing.png">methodtracing.png</td></td><td>2011-04-15T03:12:05.000+0000</td><td>369267</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Marshall Culpepper 2011-04-15

   <div><p>Where is the 3 second delay occurring? It's possible this can be
   caused by network speed issues.. do you have any more data about
   how long it takes on older versions / other devices?</p></div></li>
<li>Don Thorp 2011-04-15

   <div><p>Assigning over so this get seen by Thomas.</p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>Sorry for the delayed response. The 3 seconds is the time from
   the tap of the menu item ("XHR to FileSystem") and the resulting
   window showing. So, tap menu item, nothing happens for 3 seconds,
   then web view opens and loads. No other test cases show this lag.
   This was erroneously marked as a regression, but it repos in
   1.4.1.1, removing tag. Seems like that reduces its priority as
   well, but I will leave up to you dev guys.</p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>I'm not sure what to say or do about this item, other than to
   suggest maybe the iOS native stuff is simply faster. The reason no
   other test shows this lag is because this one is a bit special: it
   makes a full HTTP call and creates a file in the phone's file
   system <em>before</em> even opening the test window. Contrast that
   with the XHR tests (Platform -&gt; XHR), such as the XML Data test.
   The XML Data test opens the test window <em>before</em> doing the
   XHR stuff, because its test window has its own URL (the Webview -
   XHR-to-Filesystem test does <em>not</em> run the code in a separate
   JS file -- instead, it calls tab.open(w) to put a window in the
   current tab.) Therefore there is no delay in feedback to the
   tester/user in tests such as the XML Data test.</p>
   <p>If I simply change the order of a few lines in the
   XHR-to-Filesystem test, you at least get (nearly) immediate
   feedback -- the Google page still loads more slowly than in iOS,
   but you get feedback. Is that sufficient?</p>
   <p>I also did method tracing (attached image). Nothing really
   stands out that can be fixed to make this faster. A big chunk of
   the time is spent in Mozilla HTTP stuff, including a surprising
   amount of time spent parsing cookies.</p>
   <p>Anyway, check out the change I made, and if it's sufficient let
   me know (or close).</p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>BTW, to me, the behavior (speed) under 1.4.1.1 seems the
   same.</p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/bad96621cd1a44f6f206cea4d2f15f16d02d5374"
   title=
   "Changeset [bad96621cd1a44f6f206cea4d2f15f16d02d5374]">[bad96621cd1a44f6f206cea4d2f15f16d02d5374]</a>)
   [<a href="/projects/32238/tickets/2152" title=
   "Ticket #2152">#2152</a> state:fixed-in-qa] change order of a few
   lines of WebView - XHR-to-Filesystem test in order to give quicker
   feedback to Android users (the Android is slower than the iOS).
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/bad96621cd1a44f6f206cea4d2f15f16d02d5374" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/bad96621cd1a44f6f206cea4d2f15f16d02d5374</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/bad96621cd1a..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/bad96621cd1a...</a></a></p></div></li>
<li>Matt Schmulen 2011-04-15

   <div><p>Not sure what to say about this... ~11 seconds on a google ION
   (from button press to page load), running 1.6 (Build number
   DRC83).</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2152.json">JSON Source</a></p>