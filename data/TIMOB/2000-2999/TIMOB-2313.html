---
title: "[TIMOB-2313] Android: bitmaps fetched by resource id more susceptible to out-of-memory errors"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:58:44.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-04-15T03:16:27.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:58:44.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Our internal code that loads bitmaps using resource ids does not
have the protection afforded by using certain BitmapFactory.Options
which we use when loading the bitmaps by url (instead of resource
id). This was an oversight.</p>
<p>Failcase:</p>
<p>Put the attached PNG into Resources/android/images/medium, then
run this app.js:</p>
<pre>
<code class="javascript">/*global Ti, Titanium, alert, JSON */
Titanium.UI.setBackgroundColor('#000');
var win = Titanium.UI.createWindow({  
    title:'Test',
    backgroundColor:'#fff',
    fullscreen: true,
    exitOnClose: true
});
win.open();

var tv = Ti.UI.createTableView();
var i = 0;
win.add(tv);

var images = [];
for (i = 0; i &lt; 25; i++) {
    images.push('images/test.png');
}

for (i = 0 ; i &lt; 50; i++) {
    var tr = Ti.UI.createTableViewRow();
    tr.add(
        Ti.UI.createImageView({images: images})
    );
    tv.appendRow(tr);
}</code>
</pre>
<p>The app should crash and if you look at the logcat you should
see similar to:</p>
<pre>
<code>E/AndroidRuntime(  450): java.lang.OutOfMemoryError: bitmap size exceeds VM budget
E/AndroidRuntime(  450):    at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
E/AndroidRuntime(  450):    at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:447)
E/AndroidRuntime(  450):    at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:323)
E/AndroidRuntime(  450):    at android.graphics.BitmapFactory.decodeResource(BitmapFactory.java:346)
E/AndroidRuntime(  450):    at android.graphics.BitmapFactory.decodeResource(BitmapFactory.java:372)
E/AndroidRuntime(  450):    at org.appcelerator.titanium.util.TiUIHelper.getResourceBitmap(TiUIHelper.java:543)
E/AndroidRuntime(  450):    at ti.modules.titanium.ui.widget.TiUIImageView.createBitmap(TiUIImageView.java:137)
E/AndroidRuntime(  450):    at ti.modules.titanium.ui.widget.TiUIImageView$Loader.run(TiUIImageView.java:268)
E/AndroidRuntime(  450):    at java.lang.Thread.run(Thread.java:1096)</code>
</pre></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-2313_18134/test.png">test.png</td></td><td>2011-04-15T03:16:27.000+0000</td><td>5043</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/dad7bc94565a627a14323e5b08ad5a562724fcbf"
   title=
   "Changeset [dad7bc94565a627a14323e5b08ad5a562724fcbf]">[dad7bc94565a627a14323e5b08ad5a562724fcbf]</a>)
   [<a href="/projects/32238/tickets/2313" title=
   "Ticket #2313">#2313</a> state:fixed-in-qa] Use
   BitmapFactory.Options options to help avoid OOM errors loading
   bitmaps by resource id <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/dad7bc94565a627a14323e5b08ad5a562724fcbf" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/dad7bc94565a627a14323e5b08ad5a562724fcbf</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/dad7bc94565a..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/dad7bc94565a...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/5e35a4041f17c7cb0a71190ba4a79547315fc910"
   title=
   "Changeset [5e35a4041f17c7cb0a71190ba4a79547315fc910]">[5e35a4041f17c7cb0a71190ba4a79547315fc910]</a>)
   [<a href="/projects/32238/tickets/2313" title=
   "Ticket #2313">#2313</a> state:fixed-in-qa] Use
   BitmapFactory.Options options to help avoid OOM errors loading
   bitmaps by resource id <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/5e35a4041f17c7cb0a71190ba4a79547315fc910" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5e35a4041f17c7cb0a71190ba4a79547315fc910</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/5e35a4041f17..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5e35a4041f17...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/7ff8c90985b6d922ffe46e0d2e12b22c434f06dd"
   title=
   "Changeset [7ff8c90985b6d922ffe46e0d2e12b22c434f06dd]">[7ff8c90985b6d922ffe46e0d2e12b22c434f06dd]</a>)
   [<a href="/projects/32238/tickets/2313" title=
   "Ticket #2313">#2313</a> state:fixed-in-qa] add drillbit <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/7ff8c90985b6d922ffe46e0d2e12b22c434f06dd" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/7ff8c90985b6d922ffe46e0d2e12b22c434f06dd</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/7ff8c90985b6..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/7ff8c90985b6...</a></a></p></div></li>
<li>Matt Schmulen 2011-04-15

   <div><p>Pass Titanium SDK version: 1.5.0 (12/01/10 09:30 ac7cfd8)
   drillbit test Android Sim 1.6/2.1</p>
   <p>android sim 1.6<br>
   <a href=
   "<a href="https://5111068499667359260-a-appcelerator-com-s-sites.googlegroups.com/a/appcelerator.com/android/screenshots/Screenshot2010-12-02at2.30.47AM.png?attachauth=ANoY7crKsfvMfdez3l27wnG_vOB0igXOd2AW8GVzP33R4KO4JNDSdg0wYeWx8OR34RLcQs0pfHxUiuoIsoVb5OClouqEI_CmWLRvbhD64WJg7KiGw4U6-679XjvXSqApaVCVyGqDjjfcHnceQepDqw0Wky44GDYZpomldZ1mAY0K0qqkI_BWhN2ETrFqCIPUjsjX6ZtLnuIJ5H1eYOg2P-M9OoYJKY6_TozjeA9AGUlbA3qoW-OTVh0%3D&amp" rel="nofollow" target="_blank">https://5111068499667359260-a-appcelerator-com-s-sites.googlegroups.com/a/appcelerator.com/android/screenshots/Screenshot2010-12-02at2.30.47AM.png?attachauth=ANoY7crKsfvMfdez3l27wnG_vOB0igXOd2AW8GVzP33R4KO4JNDSdg0wYeWx8OR34RLcQs0pfHxUiuoIsoVb5OClouqEI_CmWLRvbhD64WJg7KiGw4U6-679XjvXSqApaVCVyGqDjjfcHnceQepDqw0Wky44GDYZpomldZ1mAY0K0qqkI_BWhN2ETrFqCIPUjsjX6ZtLnuIJ5H1eYOg2P-M9OoYJKY6_TozjeA9AGUlbA3qoW-OTVh0%3D&amp</a>;attredirects=0">
   https://5111068499667359260-a-appcelerator-com-s-sites.googlegroups...</a></p>
   <p>android sim 2.1<br>
   <a href=
   "<a href="https://5111068499667359260-a-appcelerator-com-s-sites.googlegroups.com/a/appcelerator.com/android/screenshots/Screenshot2010-12-02at2.48.13AM.png?attachauth=ANoY7cqZMHs0_-0NFdd52s4sE13MK769EMBj1VEL9mkQdyPJ_1Lylg56ioZ3EKIhrSl7RMoVTCAI9cY4-jfDs6mOqdJOyP9mQrY28Zjh5vBQGQ6_377a21CU3cn9Al6-wi8damB2gpx5waY3FoILV9l9iIqifi6D5Jue3Rbig8yVLAwmls-q_qLFApWfmRmL9V7zuCx18cVF9-Om9uMmhzz7EKdEBj6cJ1MuzGF5vuOn6vTnexNmgr0%3D&amp" rel="nofollow" target="_blank">https://5111068499667359260-a-appcelerator-com-s-sites.googlegroups.com/a/appcelerator.com/android/screenshots/Screenshot2010-12-02at2.48.13AM.png?attachauth=ANoY7cqZMHs0_-0NFdd52s4sE13MK769EMBj1VEL9mkQdyPJ_1Lylg56ioZ3EKIhrSl7RMoVTCAI9cY4-jfDs6mOqdJOyP9mQrY28Zjh5vBQGQ6_377a21CU3cn9Al6-wi8damB2gpx5waY3FoILV9l9iIqifi6D5Jue3Rbig8yVLAwmls-q_qLFApWfmRmL9V7zuCx18cVF9-Om9uMmhzz7EKdEBj6cJ1MuzGF5vuOn6vTnexNmgr0%3D&amp</a>;attredirects=0">
   https://5111068499667359260-a-appcelerator-com-s-sites.googlegroups...</a></p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2313.json">JSON Source</a></p>