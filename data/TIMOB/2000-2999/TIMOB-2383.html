---
title: "[TIMOB-2383] HTTPClient doesn't trigger \"onerror\" with 4xx and 5xx HTTP response codes"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-10-27T15:53:51.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.0</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-32, Release 1.8.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Vance Lucas</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-04-15T03:18:19.000+0000</td></tr>
<tr><th>Updated</th><td>2011-10-27T15:53:51.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>When working with the HTTPClient, I was expecting a 404 response
to trigger my "onerror" function, but it never did. Even a 500
"Internal Server Error" response did not trigger the "onerror"
function. Everything I tried just executed "onload", regardless of
the actual server's response.</p>
<p>More useful behavior would be similar to jQuery's ajax
method:<br>
<a href=
"<a href="http://api.jquery.com/jQuery.ajax/" rel="nofollow" target="_blank">http://api.jquery.com/jQuery.ajax/</a>"><a href="http://api.jquery.com/jQuery.ajax/" rel="nofollow" target="_blank">http://api.jquery.com/jQuery.ajax/</a></a></p>
<ul>
<li>1xx and 2xx responses trigger the "success" callback</li>
<li>4xx and 5xx responses trigger the "error" callback</li>
</ul></div>

<h3>Comments</h3>

<ol>
<li>Anirudh Nagesh 2011-07-05

   This is reproducible on android too! 
   Associated helpdesk ticket: <a href="http://support-admin.appcelerator.com/display/9600" rel="nofollow" target="_blank">http://support-admin.appcelerator.com/display/9600</a>
   Increasing the customer priority to 'within release'.
   Ex: The 'xhr_error.js' in kitchensink demonstrates the same.</li>
<li>Kincy Clark 2011-07-11

   Assigning back to Ani for sample code creation. </li>
<li>Anirudh Nagesh 2011-07-11

   Sample code is same as xhr_error.js in kitchensink. Have attached the same.
   <code><pre>
   var win=Titanium.UI.currentWindow;
   
   var l1 = Titanium.UI.createLabel({
   	text:'UTF-8 GET',
   	font:{fontSize:16,fontWeight:'bold'},
   	top:10,
   	width:300,
   	left:10,
   	height:'auto'
   });
   win.add(l1);
   
   var l2 = Titanium.UI.createLabel({
   	text:'Waiting for response...',
   	font:{fontSize:13},
   	top:40,
   	left:10,
   	width:300,
   	height:'auto',
   	color:'#888'
   });
   win.add(l2);
   
   var xhr = Titanium.Network.createHTTPClient();
   
   xhr.onload = function(e)
   {
   	l2.text = e.responseText;
   	Ti.API.info('im inside onlaod');
   };
   
   xhr.onerror = function(e)
   {
   	l2.text = e.error;
   	Ti.API.info('im inside onerror');
   };
   
   // open the client
   xhr.open('GET','<a href="http://www.fre100.com" rel="nofollow" target="_blank">http://www.fre100.com</a>');
   
   // send the data
   xhr.send();
   
   </pre></code>
   </li>
<li>Anirudh Nagesh 2011-07-25

   I shall update this ticket with the server side code by EOD!</li>
<li>Dawson Toth 2011-07-27

   I added an action to appc.me for testing this out. Change the "code=" to some other code (like 403, 500, etc) and the server will respond appropriately. If you look at the response sent from the server, you should also see a custom status description is getting returned as well.
   <code><pre>
   var win = Ti.UI.createWindow({ backgroundColor: '#fff' });
   var lbl = Ti.UI.createLabel({
       text: 'Waiting for response...', color: '#000',
       top: 40, left: 10,
       width: 300
   });
   win.add(lbl);
   win.open();
   
   var xhr = Ti.Network.createHTTPClient({
       onload: function(e) {
           alert('FAIL! "onload" ran when we got the error code ' + this.status + ' from the server!');
       },
       onerror: function(e) {
           alert('Error: ' + e.error);
       }
   });
   xhr.open('GET', '<a href="http://appc.me/test/simulateresponse?code=404" rel="nofollow" target="_blank">http://appc.me/test/simulateresponse?code=404</a>');
   xhr.send();
   </pre></code></li>
<li>Dawson Toth 2011-07-27

   WORKS properly on Android! Does not work on iPhone Simulator 4.3.</li>
<li>Anirudh Nagesh 2011-07-27

   Oh Dawson has done it already:) Thanks Dawson. Yes, it works fine on Android.</li>
<li>Eric Merriman  2011-09-15

   Onerror is now triggered when an error is returned, but the e.error is returning undefined. Closing this bug as fixed and opened another TIMOB-5294 describing the new problem. Verified fixed with Titanium Studio, build: 1.0.5.201109091616, SDK 1.8.0.v20110914184549 on an iPad 2, 4.3.5 and iPod touch 3rd Gen 4.0.2.</li>
</ol>


<p><a href="/TIMOB/TIMOB-2383.json">JSON Source</a></p>