---
title: "[TIMOB-2393] Drillbit regression: xml.js (Wrong node attribute)"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:58:59.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0 M10</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>drillbit, ios, regression, release-1.6.0, xml</td></tr>
<tr><th>Reporter</th><td>Stephen Tramer</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2011-04-15T03:18:32.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:58:59.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Test fails xmlNodes:98:</p>
<pre>
<code>var doc = Ti.XML.parseString(this.testSource["nodes.xml"]);
var nodesList = doc.getElementsByTagName("nodes");
var nodes = nodesList.item(0);
var node = nodes.getElementsByTagName("node").item(0);
var subnodes = node.getElementsByTagName("node");
valueOf(subnodes.item(1).getAttribute("id")).shouldBe("node 2");</code>
</pre>
<p>Could also be invalid on Android. Going to test and see.</p></div>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2011-04-15

   <div><p>According to the DOM Level 2 spec, this is actually an Android
   bug:</p>
   <p><a href=
   "<a href="http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1938918D" rel="nofollow" target="_blank">http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1938918D</a>"><a href="http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1938918D" rel="nofollow" target="_blank">http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1938918D</a></a></p>
   <p>In this particular case, it looks like Android returns the
   'self' node in the search result set if it matches, which is wrong.
   iOS does the right thing and returns only elements from its
   subtree.</p>
   <p>Reassigning to Marshall so he can look at it.</p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/4389dbeacebdf3108256500daeca170cc6c6d6ac"
   title=
   "Changeset [4389dbeacebdf3108256500daeca170cc6c6d6ac]">[4389dbeacebdf3108256500daeca170cc6c6d6ac]</a>)
   updated drillbit test to have write DOM API tests,
   getElementsByTagName now correctly filters the current node if it
   also matches the query (fixing a bug in the Android Harmony Impl)
   [<a href="/projects/32238/tickets/2393" title=
   "Ticket #2393">#2393</a> state:fixed-in-qa] <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/4389dbeacebdf3108256500daeca170cc6c6d6ac" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/4389dbeacebdf3108256500daeca170cc6c6d6ac</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/4389dbeacebd..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/4389dbeacebd...</a></a></p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/aa683287fe54044577aad83411faaf170eec1960"
   title=
   "Changeset [aa683287fe54044577aad83411faaf170eec1960]">[aa683287fe54044577aad83411faaf170eec1960]</a>)
   updated drillbit test to have write DOM API tests,
   getElementsByTagName now correctly filters the current node if it
   also matches the query (fixing a bug in the Android Harmony Impl)
   [<a href="/projects/32238/tickets/2393" title=
   "Ticket #2393">#2393</a> state:fixed-in-qa] <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/aa683287fe54044577aad83411faaf170eec1960" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/aa683287fe54044577aad83411faaf170eec1960</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/aa683287fe54..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/aa683287fe54...</a></a></p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2393.json">JSON Source</a></p>