---
title: "[TIMOB-2573] HttpClient drops properties while doing a callback"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:59:29.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.5.1 M01</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, regression</td></tr>
<tr><th>Reporter</th><td>Blain Hamon</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2011-04-15T03:23:08.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:59:29.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>This is actually due to a compromise in order to reduce memory
issues due to recursive XHR call chains, as we intentionally
jettison the request holding the internal data. This will be fixed
in the great XHR refactor.</p>
<p>To recreate:</p>
<pre>
<code>var xhr = Titanium.Network.createHTTPClient();
xhr.onload = function(e){
    Ti.API.info('onload');
    Ti.API.info(xhr.location);
    // Ti.API.info(xhr.responseText);
};
xhr.onerror = function(e){
    Ti.API.info('onerror');
    // Ti.API.info(xhr.responseText);
};
xhr.open('GET','<a href="http://www.motorsport-total.com/f1/live/htdocs/ticker.php" rel="nofollow" target="_blank">http://www.motorsport-total.com/f1/live/htdocs/ticker.php</a>');
xhr.send();</code>
</pre>
<p>Expected result:</p>
<pre>
<code>[INFO] test/1.0 (1.5.1_9819ce0_13122010.9819ce0)
[INFO] onload
[INFO] <a href="http://www.motorsport-total.com/f1/live/htdocs/ticker.php?strecken_id=19&amp" rel="nofollow" target="_blank">http://www.motorsport-total.com/f1/live/htdocs/ticker.php?strecken_id=19&amp</a>;event_id=7&amp;kunde=default</code>
</pre>
<p>Actual result:</p>
<pre>
<code>[INFO] test/1.0 (1.5.1_9819ce0_13122010.9819ce0)
[INFO] onload
[INFO] &lt;null&gt;</code>
</pre>
<p>Workaround:</p>
<p>Use this.location and this.responseText.</p>
<p>Credit to Tamas Daniel for the sample code.</p></div>

<h3>Comments</h3>

<ol>
<li>Ralf Pfeiffer 2011-04-15

   <div><p>I would like us to also review two related tickets and
   discuss:<br>
   <a href="/projects/32238/tickets/519" title="Ticket #519">#519</a>
   <a href="/projects/32238/tickets/1502" title=
   "Ticket #1502">#1502</a></p>
   <p>~ralf</p></div></li>
<li>Tamas Daniel 2011-04-15

   <div><p>Nope, <strong>location</strong> still gets jettisoned.</p>
   <p>this.responseText works.</p>
   <pre>
   <code>var xhr = Titanium.Network.createHTTPClient();
   
   xhr.onload = function(e){
       Ti.API.info('onload');
       Ti.API.info(this.location);
       // Ti.API.info(this.responseText);
   };
   
   xhr.onerror = function(e){
       Ti.API.info('onerror');
       // Ti.API.info(this.responseText);
   };
   
   xhr.open('GET','<a href="http://www.motorsport-total.com/f1/live/htdocs/ticker.php" rel="nofollow" target="_blank">http://www.motorsport-total.com/f1/live/htdocs/ticker.php</a>');
   xhr.send();</code>
   </pre></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p>is <a href="/projects/32238/tickets/2450" title=
   "Ticket #2450">#2450</a> related?</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Has to be part of the XHR refactor. Our canned HTTP client
   responses do not include location.</p></div></li>
<li>Tamas Daniel 2011-04-15

   <div><p>What do you mean it does not have "location?" Sure it does, I'm
   using it.</p></div></li>
<li>Tamas Daniel 2011-04-15

   <div><p>Stephen , I can confirm that the build with githash=188468e puts
   the location in place. Thanks.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Thank you for testing this, I had initially misidentified it as
   a different bug. Tested myself and confirmed the fix.</p></div></li>
<li>Don Thorp 2011-04-15

   <div><p>Made the 1.5.1 release. Moving to the milestone it was fixed in
   and marking it resolved by <a href="/projects/32238/tickets/2450"
   title="Ticket #2450">#2450</a></p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2573.json">JSON Source</a></p>