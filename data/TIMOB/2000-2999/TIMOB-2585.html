---
title: "[TIMOB-2585] Include paths for iphone and android are not based on the same starting point"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:59:31.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.7.0, Sprint 2011-10</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, enterprise, klist, release-1.7.0, reported-1.5.0, rplist</td></tr>
<tr><th>Reporter</th><td>PaulT</td></tr>
<tr><th>Assignee</th><td>Don Thorp</td></tr>
<tr><th>Created</th><td>2011-04-15T03:23:30.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:59:31.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>This issue is making me nuts! :-)</p>
<p>I have broken my app into small, manageable pieces and link
things together using Titanium.include and the 'url' property when
creating a new window.</p>
<p>Both of these require a 'path' to a .js file. The trouble is,
one platform seems to want it relative to the root and the other
relative to where the file is being included from. The url property
used to be the same (iphone vs android) until 1.5, but after I
upgraded today I found that it had changed on android requiring me
to fiddle the paths to get the app working again.</p>
<p>Can we please have it one way or the other on all platforms? I
am trying to build a core of code that will work across all
platforms and having to deal with varying path models is just
making my code that much more complex.</p>
<p>Thanks.</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-2585_18168/resources.zip">resources.zip</td></td><td>2011-04-15T03:23:31.000+0000</td><td>118873</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Dawson Toth 2011-04-15

   <div><h2>Associated Helpdesk Ticket</h2>
   <p><a href=
   "<a href="http://developer.appcelerator.com/helpdesk/view/62271" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/62271</a>"><a href="http://developer.appcelerator.com/helpdesk/view/62271" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/62271</a></a></p>
   <p>We have an enterprise client and a premium client pushing for
   consistency as well.</p></div></li>
<li>John Welch 2011-04-15

   <div><p>Thank you for the escalation.</p></div></li>
<li>Don Thorp 2011-04-15

   <div><p>To be discussed next week to identify the underlying issue.</p></div></li>
<li>John Welch 2011-04-15

   <div><p>Attached is an example project showing the issue. I don't know
   if the example is overkill but this is how I am seeing the problem
   with another project.</p>
   <p>The file contained in /include/folder2/other_file.js has the
   following:</p>
   <pre>
   <code class="javascript">// This works for iPhone: 
   // Titanium.include("../../include/folder/file.js");
   
   // This works for Android &amp; errors for iPhone:
   Titanium.include("/include/folder/file.js");
   
   alert("A variable != " + theMessage);</code>
   </pre>
   <p>I've built and tested this using
   mobilesdk-1.6.0-20110106161536-osx.zip.</p>
   <p>I'm guessing the issue it somewhere in loadAppResource method,
   but who knows... Going to try to figure something out tomorrow.</p></div></li>
<li>Andreas sandberg 2011-04-15

   <div><p>This ticket is also probably related to LH <a href=
   "/projects/32238/tickets/1986" title="Ticket #1986">#1986</a>. Same
   failure/results for images specified with absolute urls.</p></div></li>
<li>John Welch 2011-04-15

   <div><p>I have two projects at a stand still due to this bug. Is there a
   current ETA for this issue to be resolved?</p></div></li>
<li>Indy 2011-04-15

   <div><p>So, the work-around would be be use case statement around each
   include()?</p>
   <p>ie: if( Utils.isIOS() ) {
   Ti.include('include/utils/dashboard.js') } else {
   Ti.include('utils/dashboard.js') }</p>
   <p>from ticket <a href="/projects/32238/tickets/62271" title=
   "Ticket #62271">#62271</a></p></div></li>
<li>hal 2011-04-15

   <div><p>Just to summarize paths <strong>for images</strong>, this has
   just been tested on iOS 4.2 / Ti 1.6.0 (3 Feb 2011) with the
   following results for both the <code>image</code> and
   <code>backgroundImage</code> properties of imageView (using the
   simple project attached):</p>
   <pre>
   <code>image: 'card/'+i+'.png', // no leading slash (relative) works
   image: './card/'+i+'.png', // leading dot and slash works
   image: '/card/'+i+'.png', // leading slash does *not* work
   image: 'app://card/'+i+'.png', // leading "app://" does *not* work</code>
   </pre>
   <p>The same code and tests on Android APIs 2.2 / Ti 1.6.0 (2 Feb
   2011) work for all of the above 4 paths.</p>
   <p>Note, I have not tested a relative parent path (double-dot and
   slash), ie <code>../</code></p></div></li>
<li>Dawson Toth 2011-04-15

   <div><p>I've updated the ticket so that it is properly tagged, given
   that their is HD interest and enterprise interest in its
   resolution.</p>
   <h1>Unofficial Workaround</h1>
   <p>Unofficially (aka unsupported, at least through here), you might
   want to take a look at the work I did on the redux library's
   "include" function. It lets you do absolute includes on both
   Android and iOS from any folder, to any folder. It may be a
   suitable workaround until the core code is fixed.</p>
   <p>Here is a link straight to the relevant function. It isn't
   reliant on any other functions in redux, so it should be easy to
   rip out. It operates off of what the platform osname is and the
   depth of the currentWindow's url.</p>
   <p><a href=
   "<a href="https://github.com/dawsontoth/Appcelerator-Titanium-Redux/blob/master/redux.js#L164" rel="nofollow" target="_blank">https://github.com/dawsontoth/Appcelerator-Titanium-Redux/blob/master/redux.js#L164</a>">
   <a href="https://github.com/dawsontoth/Appcelerator-Titanium-Redux/blob/mast..." rel="nofollow" target="_blank">https://github.com/dawsontoth/Appcelerator-Titanium-Redux/blob/mast...</a></a></p></div></li>
<li>Jon Alter 2011-04-15

    <div><p>Another customer interested in this<br></p>
    <h2>Associated Helpdesk Ticket</h2>
    <p><a href=
    "<a href="http://developer.appcelerator.com/helpdesk/view/74251" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/74251</a>"><a href="http://developer.appcelerator.com/helpdesk/view/74251" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/74251</a></a></p></div></li>
<li>John Welch 2011-04-15

    <div><p>Can more information related to this bug be released to the
    community/paid devs? ETA maybe?</p></div></li>
<li>Don Thorp 2011-04-15

    <div><p>Bill, We'll probably need to generate or find the iOS ticket
    that goes with this. Drillbit tests of correct behavior will speed
    the iOS fixes.</p></div></li>
<li>Bill Dawson 2011-04-15

    <div><p>(from <a href=
    "/projects/32238/changesets/b1ea8d3e0c31c5078f52380552b078d9eb3b0d25"
    title=
    "Changeset [b1ea8d3e0c31c5078f52380552b078d9eb3b0d25]">[b1ea8d3e0c31c5078f52380552b078d9eb3b0d25]</a>)
    New "includes" drillbit test suite to test Ti.include() [<a href=
    "/projects/32238/tickets/2585" title="Ticket #2585">#2585</a>]
    <a href=
    "<a href="https://github.com/appcelerator/titanium_mobile/commit/b1ea8d3e0c31c5078f52380552b078d9eb3b0d25" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/b1ea8d3e0c31c5078f52380552b078d9eb3b0d25</a>">
    <a href="https://github.com/appcelerator/titanium_mobile/commit/b1ea8d3e0c31..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/b1ea8d3e0c31...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

    <div><p>Related commit: <a href=
    "<a href="https://github.com/appcelerator/titanium_mobile/commit/dbac80a64d0dec1ce02d327f21226ad9aac6483d" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/dbac80a64d0dec1ce02d327f21226ad9aac6483d</a>">
    <a href="https://github.com/appcelerator/titanium_mobile/commit/dbac80a64d0d..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/dbac80a64d0d...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

    <div><p>QE: This is the Android ticket re pathing in Ti.include(). A set
    of drillbit tests to be sure that Ti.include() can handle relative
    and absolute pathing has been added to drillbit (see the "includes"
    test suite in drillbit.) Android passes those tests but at that
    moment iOS doesn't. iOS will be handled in ticket <a href=
    "/projects/32238/tickets/3349" title="Ticket #3349">#3349</a>, so
    for purposes of setting this to resolved you need only test the
    Android part in drillbit.</p></div></li>
<li>Bill Dawson 2011-04-15

    <div><p>Interested parties follow <a href="/projects/32238/tickets/3349"
    title="Ticket #3349">#3349</a> for the iOS part.</p></div></li>
<li>Natalie Huynh 2011-04-15

    <div><p>Tested with Titanium SDK version: 1.7.0 (03/15/11 11:42
    1f6dbfe)<br>
    Ran Drillbit on Emulator 2.1, ran includes test suite all pass<br>
    relativeDown true 9 Success<br>
    slashToRoot true 16 Success<br>
    dotdotSlash true 23 Success<br>
    dotSlash true 23 Success<br>
    lotsOfDots true 37 Success</p></div></li>
<li>Bill Dawson 2011-04-15

    <div><p>(from <a href=
    "/projects/32238/changesets/dbac80a64d0dec1ce02d327f21226ad9aac6483d"
    title=
    "Changeset [dbac80a64d0dec1ce02d327f21226ad9aac6483d]">[dbac80a64d0dec1ce02d327f21226ad9aac6483d]</a>)
    Re-work absoluteUrl() to better handle relative pathing for
    includes and such. [<a href="/projects/32238/tickets/2585" title=
    "Ticket #2585">#2585</a>] <a href=
    "<a href="https://github.com/appcelerator/titanium_mobile/commit/dbac80a64d0dec1ce02d327f21226ad9aac6483d" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/dbac80a64d0dec1ce02d327f21226ad9aac6483d</a>">
    <a href="https://github.com/appcelerator/titanium_mobile/commit/dbac80a64d0d..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/dbac80a64d0d...</a></a></p></div></li>
<li>Don Thorp 2011-04-15

    <div><p>Since a new iOS ticket has been created, converting this to
    Android only.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2585.json">JSON Source</a></p>