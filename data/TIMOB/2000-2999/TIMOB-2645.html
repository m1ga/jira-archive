---
title: "[TIMOB-2645] iPhone: Facebook offline_access state"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:59:42.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>facebook, ios, release-1.6.0</td></tr>
<tr><th>Reporter</th><td>Alan Leard</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-04-15T03:25:44.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:59:42.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Titanium.Facebook.hasPermission("offline_access")) seems to
always return false.</p>
<p>
Titanium.Facebook.requestPermission("offline_access",function(evt)
does not close window after success.</p>
<pre>
<code>b1.addEventListener('click', function()
{
    if (Titanium.Facebook.isLoggedIn()==false)
    {
        Ti.UI.createAlertDialog({title:'Facebook', message:'Login before requesting acces'}).show();
        return;
    }
    Ti.API.info('Facebook offline_access permission ' + Titanium.Facebook.hasPermission("offline_access"));
    if (!Titanium.Facebook.hasPermission("offline_access"))
    {
        Titanium.Facebook.requestPermission("offline_access",function(evt)
        {
            if (evt.success)
            {
                Ti.API.info('Facebook offline_access permission request result' + Titanium.Facebook.hasPermission("offline_access"));
            }
        });
    }
    else
    {
        Ti.API.info('Facebook offline_access permission request result' + Titanium.Facebook.hasPermission("offline_access"));
    }
    
});</code>
</pre></div>

<h3>Comments</h3>

<ol>
<li>cfox 2011-04-15

   <div><p>hasPermission doesn't work because they forgot offline_access in
   their fql select statement. You can<br>
   make your own FQL call by doing the following:</p>
   <p>Titanium.Facebook.query('SELECT ' + permission + ' FROM
   permissions WHERE uid = ' + Titanium.Facebook.userId,
   callback);</p>
   <p>Call it with "var permission = 'offline_access';<br>
   Callback is a call back function that accepts 1 parameter (result
   object).</p>
   <p>However I didn't find a work around for closing the window.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Possibly invalidated by the new FB implementation?</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Querying <code>offline_access</code> via YQL in 1.6.0GM works.
   Ticket was probably invalid to begin with.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2645.json">JSON Source</a></p>