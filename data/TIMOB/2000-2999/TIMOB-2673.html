---
title: "[TIMOB-2673] iPhone Map: Adding regionChanged listener causes map region to change"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2012-07-26T14:26:22.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Jonathan Harlap</td></tr>
<tr><th>Assignee</th><td>Neeraj Gupta</td></tr>
<tr><th>Created</th><td>2011-04-15T03:26:35.000+0000</td></tr>
<tr><th>Updated</th><td>2012-07-26T21:13:50.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>When creating a map view, if you add a regionChanged listener
then it changes the displayed region, as illustrated by <a href=
"<a href="http://developer.appcelerator.com/question/77481/map-region-doesnt-fit-in-mapview-of-titanium-when-catch-event-regionchanged" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/77481/map-region-doesnt-fit-in-mapview-of-titanium-when-catch-event-regionchanged</a>">
<a href="http://developer.appcelerator.com/question/77481/map-region-doesnt-..." rel="nofollow" target="_blank">http://developer.appcelerator.com/question/77481/map-region-doesnt-...</a></a></p>
<p>This is because when firing the event the code alters the region
object when it should simply read it.<br>
TiMapView.m in the github master as of today reads (around line
516):</p>
<pre>
<code class="objc">if ([self.proxy _hasListeners:@"regionChanged"])
    {
        region = [mapView region];</code>
</pre>
<p>It should not be modifying the region instance variable, so
simply changing this line to read <code>MKCoordinateRegion region =
[mapView region];</code> solves the problem.</p></div>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2012-07-26

   Can't reproduce in SDK 2.2.0.014b86f on iPhone Sim 5.1.
   
   Test code:
   <code><pre>
   var win = Titanium.UI.createWindow();
    
   var annotation = Titanium.Map.createAnnotation({
       latitude:42.334537,
       longitude:-71.170101,
       title:"Boston College",
       subtitle:'Newton Campus, Chestnut Hill, MA',
       animate:true,
       leftButton:'images/atlanta.jpg'
   });
    
   var boston = {latitude:42.334537,longitude:-71.170101,latitudeDelta:0.010, longitudeDelta:0.018};
    
   //
   // CREATE MAP VIEW
   //
   var mapview = Titanium.Map.createView({
       mapType: Titanium.Map.STANDARD_TYPE,
       region: boston,
       animate:true,
       regionFit:true,
       userLocation:true,
       annotations:[annotation]
   });
    
   win.add(mapview);
    
   // map view click event listener
   mapview.addEventListener('regionChanged',function(evt)
   {
    
   });
   win.open();
   </pre></code></li>
</ol>


<p><a href="/TIMOB/TIMOB-2673.json">JSON Source</a></p>