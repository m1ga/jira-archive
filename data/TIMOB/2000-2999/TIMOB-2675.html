---
title: "[TIMOB-2675] Can't set Content-Type request header"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T01:59:47.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0 M06</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>content-type, headers, ios, release-1.6.0, rplist, xhr</td></tr>
<tr><th>Reporter</th><td>Stephen Tramer</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2011-04-15T03:26:37.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T01:59:47.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Self-explanitory. Sample code from <a href=
"/projects/32238/tickets/1983" title="Ticket #1983">#1983</a>:</p>
<pre>
<code>var xhr = Titanium.Network.createHTTPClient();
xhr.onload = function()
{
       Ti.API.info('I am in utf-8 onload for POST');
};
xhr.onerror = function()
{
       Ti.API.info('I am in utf-8 error for POST');
};
xhr.setRequestHeader("setoutside", "one");
xhr.open("POST","<a href="http://api.localmedia.fm/files/endpoint_webform.cfm" rel="nofollow" target="_blank">http://api.localmedia.fm/files/endpoint_webform.cfm</a>");
xhr.setRequestHeader("content-type", "multipart/form-data");
xhr.setRequestHeader("setinside", "two");
xhr.send({"a":"hi", "b":"there"});</code>
</pre>
<p>The response is always:</p>
<pre>
<code>Content-Type     application/x-www-form-urlencoded; charset=utf-8</code>
</pre>
<p>Should be considered part of the XHR refactor.</p></div>

<h3>Comments</h3>

<ol>
<li>Anthony Webb 2011-04-15

   <div><p>@stephen, Any sort of an ETA on this bug being fixed? I'd rather
   go through this app store approval process once, so if it is coming
   soon then I will hang tight for a fix, if not then I should
   probably remove camera support from my app and go ahead and get the
   app submitted without it. Just give me an idea of how
   complicated/important this bug fix is to you guys right now.
   Thanks.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>It will be fixed for 1.6.0. There is no other timeline on this
   bug.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Ticket is targeted to be fixed by Jan 17, but there are no
   guarantees.</p></div></li>
<li>Taazza 2011-04-15

   <div><p>Jan 17th is the target date for 1.6?</p></div></li>
<li>Anthony Webb 2011-04-15

   <div><p>Thanks Stephen. I'll hang tight, really appreciate the help,
   this is a bit of a blocker for me.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>No. Only this ticket is targeted for that date.</p></div></li>
<li>Dawson Toth 2011-04-15

   <div><h2>Associated Helpdesk Ticket</h2>
   <p><a href=
   "<a href="http://developer.appcelerator.com/helpdesk/view/65171" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/65171</a>"><a href="http://developer.appcelerator.com/helpdesk/view/65171" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/65171</a></a></p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Assigned to somebody else so moved to M06.</p></div></li>
<li>Jeff Haynie 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/623a1f982c3f4107d250179d52bd9ccbe3374994"
   title=
   "Changeset [623a1f982c3f4107d250179d52bd9ccbe3374994]">[623a1f982c3f4107d250179d52bd9ccbe3374994]</a>)
   [<a href="/projects/32238/tickets/2675" title=
   "Ticket #2675">#2675</a> state:fixed-in-qa] Allow setting of
   'Content-Type'. <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/623a1f982c3f4107d250179d52bd9ccbe3374994" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/623a1f982c3f4107d250179d52bd9ccbe3374994</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/623a1f982c3f..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/623a1f982c3f...</a></a></p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Two things to note:</p>
    <ul>
    <li>The "Content-Type" header is case-sensitive. It is not
    "content-type".</li>
    <li>We do not support multipart MIME messages. This is a feature
    which will be added at an unscheduled time; please keep in mind
    that HTTPClient right now is not a TRUE HTTP client, but rather an
    XHR (XML HTTP Request), meaning that it is only suitable for a
    single-request architecture.</li>
    </ul></div></li>
<li>Anthony Webb 2011-04-15

    <div><p>I see the code has been committed, at what point are these fixes
    picked up by nightly builds for testing? I assume "fixed-in-qa" is
    an internal thing? Thanks a bunch this should allow me to move
    forward.</p></div></li>
<li>Anthony Webb 2011-04-15

    <div><p>I saw in the continuous build that this change was in there so I
    gave it a shot:<br></p>
    <pre>
    <code>var xhr = Titanium.Network.createHTTPClient();
    xhr.onload = function()
    {Ti.API.info('onLoad for POST, firing event with data: ' + this.responseText);};
    xhr.onerror = function()
    {Ti.API.info('I am in utf-8 error for POST');};
    xhr.open("POST","<a href="http://api.localmedia.fm/files/test.cfm" rel="nofollow" target="_blank">http://api.localmedia.fm/files/test.cfm</a>");
    xhr.setRequestHeader("Content-Type", "multipart/form-data");
    xhr.send({"a":"hi", "b":"there"});</code>
    </pre>
    It appears as though it is still broke though. If I run the code
    above I get:<br>
    <pre>
    <code>[INFO] onLoad for POST, firing event with data: undefined</code>
    </pre>
    If I comment out the setRequestHeader() then it goes through fine
    :(</div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>As indicated in this ticket we do not support multipart
    messages. There is no timeline for this feature.</p></div></li>
<li>Anthony Webb 2011-04-15

    <div><p>Any fresh ideas on letting the user POST photos that the user
    takes to my server? Seems like something pretty basic I want to do
    here? Additionally, it would have been nice to know this a month
    ago when this ticket was opened so I could have asked this question
    back then.</p></div></li>
<li>Dawson Toth 2011-04-15

    <div><p>The customer's issue hasn't been fixed. The original code
    includes "multipart/form-data" as the content type, so I'm not sure
    why this is marked as fixed-in-qa when I believe it isn't.</p>
    <p>Please let me know if you would like an additional ticket
    created for supporting multipart messages.</p></div></li>
<li>Stephen Tramer 2011-04-15

    <div><p>Supporting multipart mime is a different issue from "Can't set
    Content-Type request header." The bug, as described in the original
    ticket, is fixed.</p>
    <p>Create a second bug for multipart support.</p></div></li>
<li>Pedro Enrique 2011-04-15

    <div><p>Initial bug fixed.</p>
    <p>Tested on iPhone Simulator 4.2 with code provided</p>
    <p>Ti SDK 1.6 (Jan 27 2011 16:11 rc27ef530)</p></div></li>
<li>Andre Carregal 2011-04-15

    <div><p>I've added a new bug report ((#3145)) for the multipart
    support.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2675.json">JSON Source</a></p>