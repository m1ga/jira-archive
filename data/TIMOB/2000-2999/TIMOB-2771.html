---
title: "[TIMOB-2771] Android: Facebook publish stream does clear/reset its data"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T02:00:02.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0 M04</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, enterprise, facebook, regression, release-1.6.0, reported-1.5.1, rplist</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-04-15T03:29:05.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T02:00:02.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>From Fred:</p>
<p>Login and tap 'Post 01'. Rather than submitting, close and tap
'Post 02' - It's using the same data from the first publish, even
though the data is different in source. App data has to be
completely cleared before this stops, but it continues to use the
same publish data from the first publish request.</p>
<p>app.js:</p>
<pre>
<code class="javascript">var win = Ti.UI.createWindow();
var fbBtn = Ti.Facebook.createLoginButton({
    'style':'wide',
    'apikey':'9494e611f2a93b8d7bfcdfa8cefdaf9f',
    'sessionProxy':'<a href="http://api.appcelerator.net/p/fbconnect/" rel="nofollow" target="_blank">http://api.appcelerator.net/p/fbconnect/</a>',
    bottom:10
});

var post01Btn = Ti.UI.createButton({ title:'Post 01', left:10, right:10, top:10, height:30 });
var post02Btn = Ti.UI.createButton({ title:'Post 02', left:10, right:10, top:50, height:30 });

post01Btn.addEventListener('click', function(e) {
    if (Ti.Facebook.isLoggedIn()) {
        var data = {
            "name": "Sample Title 01",
            "href": "<a href="http://google.com" rel="nofollow" target="_blank">http://google.com</a>",
            "description": "Sample Description 01",
            "caption": "Sent via a test Appcelerator App."
        };
        
        Ti.Facebook.publishStream("POST NUMBER 01", data, null, function(r) {                     
            if (r.success) {
                alert('Posted.');
            } else {
                alert('Not Posted.');
            }
        });
    }
});

post02Btn.addEventListener('click', function(e) {
    if (Ti.Facebook.isLoggedIn()) {
        var data = {
            "name": "Sample Title 02",
            "href": "<a href="http://google.com" rel="nofollow" target="_blank">http://google.com</a>",
            "description": "Sample Description 02",
            "caption": "Sent via a test Appcelerator App."
        };
        
        Ti.Facebook.publishStream("POST NUMBER 02", data, null, function(r) {                     
            if (r.success) {
                alert('Posted.');
            } else {
                alert('Not Posted.');
            }
        });
    }
});

win.add(post01Btn);
win.add(post02Btn);
win.add(fbBtn);
win.open();</code>
</pre></div>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/c1584226b7836da0ed07d1dedc290bcd9dee5b0c"
   title=
   "Changeset [c1584226b7836da0ed07d1dedc290bcd9dee5b0c]">[c1584226b7836da0ed07d1dedc290bcd9dee5b0c]</a>)
   [<a href="/projects/32238/tickets/2771" title=
   "Ticket #2771">#2771</a> state:fixed-in-qa] Our new remote image
   cache seems to cache all requests made on Java HttpURLConnection,
   not just those for images. Facebook dialog to publish stream uses
   HttpUrlConnection and the same query string (with different post
   data), and the same cached response was being shown over and over
   again. Explicitly disable caching on HttpUrlConnection objects used
   in Facebook module. <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/c1584226b7836da0ed07d1dedc290bcd9dee5b0c" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/c1584226b7836da0ed07d1dedc290bcd9dee5b0c</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/c1584226b783..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/c1584226b783...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>This bug makes multiple publishing of stream/status updates
   impossible in the same running FB session under Titanium 1.5.X,
   therefore I'll also cherry-pick to 1.5.X.</p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/682e79e0d2a24922bfff09c5aa9a87504b3714e8"
   title=
   "Changeset [682e79e0d2a24922bfff09c5aa9a87504b3714e8]">[682e79e0d2a24922bfff09c5aa9a87504b3714e8]</a>)
   [<a href="/projects/32238/tickets/2771" title=
   "Ticket #2771">#2771</a> state:fixed-in-qa] Our new remote image
   cache seems to cache all requests made on Java HttpURLConnection,
   not just those for images. Facebook dialog to publish stream uses
   HttpUrlConnection and the same query string (with different post
   data), and the same cached response was being shown over and over
   again. Explicitly disable caching on HttpUrlConnection objects used
   in Facebook module. <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/682e79e0d2a24922bfff09c5aa9a87504b3714e8" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/682e79e0d2a24922bfff09c5aa9a87504b3714e8</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/682e79e0d2a2..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/682e79e0d2a2...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/95363ab6703354bd71d35a7f553c6c3b997a8910"
   title=
   "Changeset [95363ab6703354bd71d35a7f553c6c3b997a8910]">[95363ab6703354bd71d35a7f553c6c3b997a8910]</a>)
   [<a href="/projects/32238/tickets/2771" title=
   "Ticket #2771">#2771</a>] Update KS Facebook 'publish stream' test
   to include indication that cached responses are not being used.
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/95363ab6703354bd71d35a7f553c6c3b997a8910" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/95363ab6703354bd71d35a7f553c6c3b997a8910</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/95363ab67033..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/95363ab67033...</a></a></p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p><a href="/projects/32238/changesets/INFO" title=
   "Changeset [INFO]">[INFO]</a> Titanium SDK version: 1.6.0 (01/10/11
   08:25 3452f06) still need to check in 1.5.2</p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p><a href="/projects/32238/changesets/INFO" title=
   "Changeset [INFO]">[INFO]</a> Titanium SDK version: 1.5.2 (01/14/11
   10:34 8e8e048) 1.6 and 2.2.1</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2771.json">JSON Source</a></p>