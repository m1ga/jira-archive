---
title: "[TIMOB-2841] Android: Rotation is not honored."
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T02:00:13.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0 M06</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, enterprise, release-1.6.0, reported-1.6.0, rplist</td></tr>
<tr><th>Reporter</th><td>Fred Spencer</td></tr>
<tr><th>Assignee</th><td>Don Thorp</td></tr>
<tr><th>Created</th><td>2011-04-15T03:30:47.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T02:00:13.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Rotation is not honored on a view. HTC Evo 2.2</p>
<pre>
<code class=
"javascript">var win = Ti.UI.createWindow({ backgroundColor:'#000' });
var view = Ti.UI.createView({ width:100, height:100, backgroundColor:'#f00' });
var overlay = Ti.UI.createView({ top:0, left:0, right:0, bottom:0 });
var rotateSlider = Ti.UI.createSlider({ left:10, right:10, bottom:10, height:30, min:0, max:359 });
var scaleSlider = Ti.UI.createSlider({ left:10, right:10, bottom:50, height:30, min:30, max:200 });

var t = Ti.UI.create2DMatrix();

function moveView(e) {
    view.animate({
        transform:t,
        center: {
            x: e.x,
            y: e.y
        },
        duration: 0
    });
    
    view.center = {
        x: e.x,
        y: e.y
    };
    view.transform = t;
}


function rotateView(e) {
    t = t.rotate(e.value);
    
    view.animate({ transform:t, duration:1 });
    view.transform = t;
}

function scaleView(e) {
    view.animate({
        width:(e.value * 0.01) * 100,
        height:(e.value * 0.01) * 100,
        duration:0
    });
}

rotateSlider.addEventListener('change', rotateView);
scaleSlider.addEventListener('change', scaleView);
overlay.addEventListener('touchmove', moveView);

win.add(view);
win.add(overlay);
win.add(rotateSlider);
win.add(scaleSlider);

win.open();</code>
</pre></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-2841_18227/img_0408.MOV">img_0408.MOV</td></td><td>2011-04-15T03:30:48.000+0000</td><td>2985470</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/0e1d3bf52c8d2e3b1d4d46ee9de361941da3aaab"
   title=
   "Changeset [0e1d3bf52c8d2e3b1d4d46ee9de361941da3aaab]">[0e1d3bf52c8d2e3b1d4d46ee9de361941da3aaab]</a>)
   refactor Ti2DMatrix and animations to make use of actual Android
   Matrices. Changing a view's<br>
   transform does the right thing now, but could<br>
   still use more optimization. More work will be<br>
   needed for rotate and scale animations to use a<br>
   correct anchorPoint relative the view's size.<br>
   Added a default "null" for callbacks so we don't<br>
   try to construct one for APIs that use optional<br>
   KrollCallbacks. [<a href="/projects/32238/tickets/2841" title=
   "Ticket #2841">#2841</a> state:fixed-in-qa]<br>
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/0e1d3bf52c8d2e3b1d4d46ee9de361941da3aaab" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/0e1d3bf52c8d2e3b1d4d46ee9de361941da3aaab</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/0e1d3bf52c8d..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/0e1d3bf52c8d...</a></a></p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p><em>UPDATE</em> : I've modified this example to take into
   account the new changes to matrix and relative anchor points</p>
   <pre>
   <code class="javascript">
   var view = Ti.UI.createView({ width:100, height:100, backgroundColor:'#f00' });
   var overlay = Ti.UI.createView({ top: 0, left: 0, right: 0, bottom: 151 });
   var scaleSlider = Ti.UI.createSlider({ left:10, right:100, bottom:150, height:50, min:30, max:200, value:100 });
   var scaleLabel = Ti.UI.createLabel({ right: 10, width: 80, bottom:150, height:50, text: '100%', color: 'black'});
   var rotateSlider = Ti.UI.createSlider({ left:10, right:100, bottom:50, height:50, min:0, max:359 });
   var rotateLabel = Ti.UI.createLabel({ right: 10, width: 80, bottom:50, height:50, text: '0d', color: 'black'});
   
   var rotate = 0;
   var scale = 1.0;
   
   function moveView(e) {
       view.center = {
           x: e.x,
           y: e.y
       };
   }
   
   function rotateView(e) {
       Ti.API.debug("rotate: " + e.value);
       rotate = e.value;
       rotateLabel.text = rotate + "d";
       transformView(e);
   }
   
   function scaleView(e) {
       Ti.API.debug("scale: " + (e.value * 0.01));
       scale = e.value * 0.01;
       scaleLabel.text = e.value + "%";
       transformView(e);
   }
   
   var filter = 300; // wait 300ms between transform updates
   var time = new Date().getTime();
   function transformView(e) {
       var now = new Date().getTime();
       if (now - time &gt; filter)
       {
           view.transform = Ti.UI.create2DMatrix({ rotate: rotate, anchorPoint: { x: 0.5, y: 0.5 } }).scale(scale);
           time = now;
       }
   }
   
   rotateSlider.addEventListener('change', rotateView);
   scaleSlider.addEventListener('change', scaleView);
   overlay.addEventListener('touchmove', moveView);
   
   win.add(view);
   win.add(overlay);
   win.add(rotateSlider);
   win.add(rotateLabel);
   win.add(scaleSlider);
   win.add(scaleLabel);</code>
   </pre></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/5b58229a4a9ebaf4f37a9e7e9264f94005d0a39c"
   title=
   "Changeset [5b58229a4a9ebaf4f37a9e7e9264f94005d0a39c]">[5b58229a4a9ebaf4f37a9e7e9264f94005d0a39c]</a>)
   fix for iterating back in the matrix linked list, don't even try to
   interpolate frames when the user supplies a transform. this
   makes<br>
   constant transform application much smoother [<a href=
   "/projects/32238/tickets/2841" title="Ticket #2841">#2841</a>]
   [<a href="/projects/32238/tickets/2873" title=
   "Ticket #2873">#2873</a>]<br>
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/5b58229a4a9ebaf4f37a9e7e9264f94005d0a39c" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5b58229a4a9ebaf4f37a9e7e9264f94005d0a39c</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/5b58229a4a9e..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5b58229a4a9e...</a></a></p></div></li>
<li>Opie Cyrus 2011-04-15

   <div><p>Verified with test from Marshall on 2.2 emulator.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2841.json">JSON Source</a></p>