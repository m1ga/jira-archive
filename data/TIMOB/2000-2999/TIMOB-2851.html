---
title: "[TIMOB-2851] Android: Opacity property and animation not working as expected."
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-09-28T13:59:28.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.6.2</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-37, Release 1.8.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>stage</td></tr>
<tr><th>Reporter</th><td>Fred Spencer</td></tr>
<tr><th>Assignee</th><td>Allen Yeung</td></tr>
<tr><th>Created</th><td>2011-04-15T03:31:10.000+0000</td></tr>
<tr><th>Updated</th><td>2011-11-01T00:09:37.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>The specific problem relates to an issue where Android will not
display a view instantiated at 0.0 opacity. In addition, animation
works strangely even when instantiating at &gt; 0.0 opacity.</p>
<p>Sidebar: An additional expectation may lie in the necessity to
set the view's opacity after the animation completes. Should the
property be set by the completion of the animation, or leave this
to the developer?</p>
<p>Please note that the Android example uses a workaround for
issue: <a href=
"<a href="https://appcelerator.lighthouseapp.com/projects/32238/tickets/2776-android-animation-callback-is-called-multiple-times" rel="nofollow" target="_blank">https://appcelerator.lighthouseapp.com/projects/32238/tickets/2776-android-animation-callback-is-called-multiple-times</a>">
<a href="https://appcelerator.lighthouseapp.com/projects/32238/tickets/2776-android-animation-callback-is-called-multiple-times" rel="nofollow" target="_blank">https://appcelerator.lighthouseapp.com/projects/32238/tickets/2776-android-animation-callback-is-called-multiple-times</a></a></p>
<p>Comparison between iOS and Android @ 1.6.0 (HTC Evo 2.2)</p>
<pre>
<code class="javascript">// iOS / Ti 1.6.0:
// Red box displays at 0.0 opacity. Use toggle button to fade in and fade out view.

var win = Ti.UI.createWindow({ backgroundColor:'#000' });
var view = Ti.UI.createView({ backgroundColor:'#f00', opacity:0.0, width:100, height:100 });
var toggleBtn = Ti.UI.createButton({ width:200, height:30, bottom:10, title:'toggle opacity' });

function toggleOpacity(e) {
    view.animate({ opacity:(view.opacity === 0.0) ? 1.0 : 0.0, duration:1000 }, function(e) {
        view.opacity = (view.opacity === 0.0) ? 1.0 : 0.0;
            Ti.API.info(view.opacity);
    });
}

toggleBtn.addEventListener('click', toggleOpacity);

win.add(view);
win.add(toggleBtn);
win.open();</code>
</pre>
<pre>
<code class="javascript">// iOS / Ti 1.6.0:
// Red box displays at 1.0 opacity. Use toggle button to fade out and fade in view.

var win = Ti.UI.createWindow({ backgroundColor:'#000' });
var view = Ti.UI.createView({ backgroundColor:'#f00', opacity:1.0, width:100, height:100 });
var toggleBtn = Ti.UI.createButton({ width:200, height:30, bottom:10, title:'toggle opacity' });

function toggleOpacity(e) {
    view.animate({ opacity:(view.opacity === 0.0) ? 1.0 : 0.0, duration:1000 }, function(e) {
        view.opacity = (view.opacity === 0.0) ? 1.0 : 0.0;
            Ti.API.info(view.opacity);
    });
}

toggleBtn.addEventListener('click', toggleOpacity);

win.add(view);
win.add(toggleBtn);
win.open();</code>
</pre>
<pre>
<code class="javascript">// Android 2.2 HTC Evo / Ti 1.6.0
// Red box displays at 1.0 opacity. Toggle button will successfully fade.
// After fade, toggle button will not work until the second press. Fade back in.
// Next press will fade out to 0.0. Rinse, repeat. :-)

var win = Ti.UI.createWindow({ backgroundColor:'#000' });
var view = Ti.UI.createView({ backgroundColor:'#f00', opacity:1.0, width:100, height:100 });
var toggleBtn = Ti.UI.createButton({ width:200, height:30, bottom:10, title:'toggle opacity' });

function toggleOpacity(e) {
    var counter = 0;
    
    view.animate({ opacity:(view.opacity === 0.0) ? 1.0 : 0.0, duration:1000 }, function(e) {
        if (counter === 0) {
            Ti.API.info('This is only called once due to the counter.');
            
            view.opacity = (view.opacity === 0.0) ? 1.0 : 0.0;
            
            Ti.API.info(view.opacity);
            
            counter ++;
        }
    });
}

toggleBtn.addEventListener('click', toggleOpacity);

win.add(view);
win.add(toggleBtn);
win.open();</code>
</pre></div>

<h3>Comments</h3>

<ol>
<li>Pedro Enrique 2011-06-01

   There is a helpdesk ticket that has encounter a similar problem where the webViews do not obey the opacity property.
   
   Here is a sample code:
   <code><pre>
   var win = Ti.UI.createWindow({ backgroundColor: 'black' });
   var web = Ti.UI.createWebView({ backgroundColor: 'white', opacity: 0.5 });
   win.add(web);
   win.open();
   </pre></code>
   
   <a href="http://support.appcelerator.com/tickets/APP-338713/tickets" rel="nofollow" target="_blank">http://support.appcelerator.com/tickets/APP-338713/tickets</a></li>
<li>Allen Yeung 2011-09-20

   We also need to test adding a view with 0 opacity and verify that it works.</li>
<li>Allen Yeung 2011-09-26

   To test, use the following in app.js:
   
   <code><pre>
   // Android 2.2 HTC Evo / Ti 1.6.0
   // Red box displays at 1.0 opacity. Toggle button will successfully fade.
   // After fade, toggle button will not work until the second press. Fade back in.
   // Next press will fade out to 0.0. Rinse, repeat. :-)
   
   var win = Ti.UI.createWindow({ backgroundColor:'#000' });
   var view = Ti.UI.createView({ backgroundColor:'#f00', opacity:1.0, width:100, height:100 });
   var toggleBtn = Ti.UI.createButton({ width:200, height:30, bottom:10, title:'toggle opacity' });
   
   function toggleOpacity(e) {
       var counter = 0;
       
       view.animate({ opacity:(view.opacity === 0.0) ? 1.0 : 0.0, duration:1000 }, function(e) {
           if (counter === 0) {
               Ti.API.info('This is only called once due to the counter.');
               
               view.opacity = (view.opacity === 0.0) ? 1.0 : 0.0;
               
               Ti.API.info(view.opacity);
               
               counter ++;
           }
       });
   }
   
   toggleBtn.addEventListener('click', toggleOpacity);
   
   win.add(view);
   win.add(toggleBtn);
   win.open();
   </pre></code>
   
   Click on the "toggle opacity" button and verify that it fades in and out without any flickering</li>
<li>Fred Spencer 2011-09-27

   Adding a view at 0.0 and animating opacity to 1.0 doesn't appear to animate the view or show.
   
   <code><pre>
   var win = Ti.UI.createWindow({ backgroundColor:'#000' });
   var view = Ti.UI.createView({ opacity:0.0, backgroundColor:'#f00', width:100, height:100 });
   
   win.add(view);
   
   win.open();
   
   view.animate({ opacity:1.0, duration:1000 });
   </pre></code>
   
   Original test case shows that view is at 0.0. However, 0.0 -> 1.0 does not appear to work. After 1 second, the view appears at 1.0, but that seems to be due to the opacity set on animation callback.
   <code><pre>
   var win = Ti.UI.createWindow({ backgroundColor:'#000' });
   var view = Ti.UI.createView({ backgroundColor:'#f00', opacity:0.0, width:100, height:100 });
   var toggleBtn = Ti.UI.createButton({ width:200, height:30, bottom:10, title:'toggle opacity' });
   
   function toggleOpacity(e) {
       view.animate({ opacity:(view.opacity === 0.0) ? 1.0 : 0.0, duration:1000 }, function(e) {
           view.opacity = (view.opacity === 0.0) ? 1.0 : 0.0;
               Ti.API.info(view.opacity);
       });
   }
   
   toggleBtn.addEventListener('click', toggleOpacity);
   
   win.add(view);
   win.add(toggleBtn);
   win.open();
   </pre></code></li>
<li>Bill Dawson 2011-09-28

   Re-resolving after merge of newer fixes.</li>
<li>Natalie Huynh 2011-10-05

   Tested with 1.8.0.v20111005130613 on
   Galaxy Tab 10 3.1
   Hero 2.1
   iPod Touch 5.0</li>
</ol>


<p><a href="/TIMOB/TIMOB-2851.json">JSON Source</a></p>