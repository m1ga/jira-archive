---
title: "[TIMOB-2900] Deadlock in app termination for devices that don't support multitasking"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2012-01-26T15:21:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>deadlock, threading</td></tr>
<tr><th>Reporter</th><td>Damien Elmes</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2011-04-15T03:32:25.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-09T23:10:15.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Titanium is sometimes getting stuck in a deadlock during app
shutdown. Originally reported in <a href=
"<a href="https://appcelerator.lighthouseapp.com/projects/32238/tickets/2658-crash-on-app-resume" rel="nofollow" target="_blank">https://appcelerator.lighthouseapp.com/projects/32238/tickets/2658-crash-on-app-resume</a>">
<a href="https://appcelerator.lighthouseapp.com/projects/32238/tickets/2658-..." rel="nofollow" target="_blank">https://appcelerator.lighthouseapp.com/projects/32238/tickets/2658-...</a></a>
and recently updated with info in this helpdesk ticket: <a href=
"<a href="http://developer.appcelerator.com/helpdesk/view/66761" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/66761</a>"><a href="http://developer.appcelerator.com/helpdesk/view/66761" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/66761</a></a></p>
<p>Because the main thread is getting stuck while waiting for the
bridge to shut down, modules and the database never get a chance to
unload. I have a user with quite a few instances of these deadlocks
in his crash logs, and this user is also reporting problems with
the database my app uses, so I can't help but wonder whether the
unclean shutdown could be related.</p>
<p>I'm attaching three files that demonstrate the deadlock.
Terminate.txt contains full debug info showing that the main thread
is stuck on NSCondition's waitUntilDate. Terminate2.txt shows the
problem occurs on the KitchenSink and not just my app. Terminate*
were made with Ti 1.5.1; log2.txt is an older log made with a
previous version of Titanium.</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-2900_18237/anki_2011-01-30-122636_edwinbradfords-iphonecrash.txt">anki_2011-01-30-122636_edwinbradfords-iphonecrash.txt</td></td><td>2011-04-15T03:32:26.000+0000</td><td>19592</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-2900_18236/anki_2011-01-30-123924_edwinbradfords-iphonecrash.txt">anki_2011-01-30-123924_edwinbradfords-iphonecrash.txt</td></td><td>2011-04-15T03:32:26.000+0000</td><td>20450</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-2900_18238/log2.txt">log2.txt</td></td><td>2011-04-15T03:32:26.000+0000</td><td>22558</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-2900_18235/terminate.txt">terminate.txt</td></td><td>2011-04-15T03:32:26.000+0000</td><td>19912</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-2900_18234/terminate2.txt">terminate2.txt</td></td><td>2011-04-15T03:32:26.000+0000</td><td>24530</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Damien Elmes 2011-04-15

   <div><p>I have another user with similar crash reports who is reporting
   a more serious issue: the app is freezing during normal operation.
   Since they can't do anything with the app, they hit the home
   button, and similar crash logs are generated. Attaching two from
   this new user - one saying the app failed to terminate in time, and
   one soon after where the app fails to 'resume' when restarted right
   after (but the user is on 3.1.2)</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>Reading logs, this should be fixed by <a href=
   "/projects/32238/tickets/2979" title="Ticket #2979">#2979</a>.</p></div></li>
<li>Stephen Tramer 2011-04-15

   <div><p>For in-app deadlocks, scheduled to look at threading in 1.7.</p></div></li>
<li>Stephen Tramer 2012-01-26

   iOS versions which do not support multitasking (<4.0) are no longer supported by Titanium.</li>
<li>Lee Morris 2017-03-09

   Closing ticket as the issue will not fix.</li>
</ol>


<p><a href="/TIMOB/TIMOB-2900.json">JSON Source</a></p>