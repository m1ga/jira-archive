---
title: "[TIMOB-2922] Android: Facebook Module NPE on Logout"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T02:00:27.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0 M07</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, release-1.6.0, reported-1.6.0</td></tr>
<tr><th>Reporter</th><td>Don Thorp</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-04-15T03:33:00.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T02:00:27.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Found in: #e1cb22a</p>
<ol>
<li>Mashup &gt; Facebook &gt; Login/Logout<br></li>
<li>Login<br></li>
<li>Press back button<br></li>
<li>Login/Logout<br></li>
<li>Press Logout</li>
</ol>
<pre>
<code>I/ActivityManager(   85): Displayed activity com.appcelerator.titanium/org.appcelerator.titanium.TiActivity: 234 ms (total 234 ms)
D/KrollContext( 2004): (kroll$15) [1207,222604] Running evaluated script: app://examples/facebook_login_logout.js
D/dalvikvm( 2004): GC_FOR_MALLOC freed 25979 objects / 4384184 bytes in 71ms
D/LoginButtonProxy( 2004): (kroll$15) [99,222703] Second constructor called
D/Facebook-Util( 2004): GET URL: <a href="https://api.facebook.com/restserver.php?access_token=134793934930%7C0e5b712c915b0558ffc8b434-712472015%7ClUYHI9lZmgT2491I1vvVrnXabL8&amp" rel="nofollow" target="_blank">https://api.facebook.com/restserver.php?access_token=134793934930%7C0e5b712c915b0558ffc8b434-712472015%7ClUYHI9lZmgT2491I1vvVrnXabL8&amp</a>;method=auth.expireSession&amp;format=json
E/TiUIView( 2004): (main) [991,223694] TAP, TAP, TAP on [Ti.TiFacebookModuleLoginButton]
W/dalvikvm( 2004): threadid=28: thread exiting with uncaught exception (group=0x4001d7f0)
E/TiUncaughtHandler( 2004): (Thread-61) [280,223974] Sending event: exception on thread: Thread-61 msg:java.lang.NullPointerException; Titanium 1.6.0,2011/01/24 09:44,1cb22a
E/TiUncaughtHandler( 2004): java.lang.NullPointerException
E/TiUncaughtHandler( 2004):   at ti.modules.titanium.facebook.LoginButton.updateButtonImage(LoginButton.java:94)
E/TiUncaughtHandler( 2004):   at ti.modules.titanium.facebook.LoginButton$4.logout(LoginButton.java:136)
E/TiUncaughtHandler( 2004):   at ti.modules.titanium.facebook.FacebookModule.fireLoginChange(FacebookModule.java:417)
E/TiUncaughtHandler( 2004):   at ti.modules.titanium.facebook.FacebookModule.completeLogout(FacebookModule.java:313)
E/TiUncaughtHandler( 2004):   at ti.modules.titanium.facebook.SessionListener.onLogoutFinish(SessionListener.java:37)
E/TiUncaughtHandler( 2004):   at ti.modules.titanium.facebook.SessionEvents.onLogoutFinish(SessionEvents.java:115)
E/TiUncaughtHandler( 2004):   at ti.modules.titanium.facebook.FacebookModule$LogoutRequestListener.onComplete(FacebookModule.java:450)
E/TiUncaughtHandler( 2004):   at com.facebook.android.AsyncFacebookRunner$1.run(AsyncFacebookRunner.java:82)
D/TiApplication( 2004): (Thread-61) [13,223987] Analytics Event: type=</code>
</pre></div>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/5c05db961b8fb19e61f8a98f45e08ab0779dd6c3"
   title=
   "Changeset [5c05db961b8fb19e61f8a98f45e08ab0779dd6c3]">[5c05db961b8fb19e61f8a98f45e08ab0779dd6c3]</a>)
   [<a href="/projects/32238/tickets/2922" title=
   "Ticket #2922">#2922</a> state:fixed-in-qa] Cleanup Facebook
   session state listeners orphaned by a torn down login button so
   they don't go all wild and start firin' outta turn and what not.
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/5c05db961b8fb19e61f8a98f45e08ab0779dd6c3" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5c05db961b8fb19e61f8a98f45e08ab0779dd6c3</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/5c05db961b8f..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/5c05db961b8f...</a></a></p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>verified working on Nexus S / 2.3.2</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-2922.json">JSON Source</a></p>