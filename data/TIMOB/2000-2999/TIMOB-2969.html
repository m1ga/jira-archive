---
title: "[TIMOB-2969] Android: event listeners orphaned from their contexts continue to be invoked"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2017-07-28T19:30:01.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>api</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2011-04-15T03:33:54.000+0000</td></tr>
<tr><th>Updated</th><td>2017-07-28T19:30:01.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>This is most notable if the event listener is added to a
<strong>module</strong> as opposed to another type of proxy,
because modules are effectively singletons (created once in the
root context) and therefore their event listener collections
survive long.</p>
<p>As a sample failcase, create a new Ti project and make this the
app.js:</p>
<pre>
<code class="javascript">Titanium.UI.setBackgroundColor('#000');
var win = Titanium.UI.createWindow({  
    title:'Test',
    backgroundColor:'#fff',
    exitOnClose: true
});

var btn = Ti.UI.createButton({
    title: 'Open second window'
});
btn.addEventListener('click', function() {
    Ti.UI.createWindow({
        url: 'win.js',
        backgroundColor: 'black',
        fullscreen: false
    }).open();
});
win.add(btn);
win.open();</code>
</pre>
<p>Then create a new file, win.js, with this in it:</p>
<pre>
<code class="javascript">var win = Ti.UI.currentWindow;
Ti.App.addEventListener('test_event', function(){Ti.API.info("TEST EVENT LISTENER");});
var btn = Ti.UI.createButton({
    top: 10, left: 30, right: 30, height: 40,
    title:'Fire event'
});
btn.addEventListener('click',function(){
    Ti.App.fireEvent('test_event', {});
});
win.add(btn);

var btnClose = Ti.UI.createButton({
    top: 60, left: 30, right: 30, height: 40,
    title: 'Close window'
});
btnClose.addEventListener('click', function(){win.close();});
win.add(btnClose);</code>
</pre>
<p>Run the application and do the following:</p>
<ul>
<li>Click "Open second window."</li>
<li>At the next window, click the "Fire event" button.</li>
<li>Look at the console: you'll see one info message "TEST EVENT
LISTENER".</li>
<li>Now back out of this window to go back to the first
window.</li>
<li>Again click "Open second window."</li>
<li>Again click "Fire event".</li>
<li>Look at the console: <strong>two</strong> more "TEST EVENT
LISTENER" info messages will have appeared, when we would expect
only one more.</li>
</ul>
<p>If you keep going back and forth between the windows like this,
you'll keep getting more and more "TEST EVENT LISTENER" info
messages -- these are event listeners stranded from all the other
times that the second window was opened.</p>
<p>It could be argued that our user-devs are responsible for
removing event listeners when they are no longer wanted, such as
when a heavyweight window closes and that heavyweight window's JS
code created the event listeners. However, this problem does not
exist on iPhone.</p></div>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>Assigning to Don for milestoning</p></div></li>
<li>Junaid Younus 2012-08-29

   Tested on a Samsung Galaxy S2 using TiSDK 2.2.0v20120828153312, issue still valid. </li>
<li>Lee Morris 2017-07-28

   Closing due to inactivity. If this issue still exists, please raise a new ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-2969.json">JSON Source</a></p>