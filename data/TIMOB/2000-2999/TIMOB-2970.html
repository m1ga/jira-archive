---
title: "[TIMOB-2970] Android: event listeners on modules and from heavyweight windows cannot show alerts."
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2017-07-28T19:30:21.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>api</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2011-04-15T03:33:56.000+0000</td></tr>
<tr><th>Updated</th><td>2017-07-28T19:30:21.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>If an event listener is put on to a <strong>module</strong> and
the event listener itself is created in a heavyweight context --
or, more specifically, is created <em>outside the root context</em>
-- that event listener, when invoked, will be unable to
successfully display alert dialogs.</p>
<p>The problem here -- I believe -- is that the module, which is
responsible for invoking the event, belongs to the root context
(all modules are now "booted" in the root context.) So the root
activity context is invoking the event listener, but the listener's
android context is not the root activity.</p>
<p>To see a failcase, create a new Titanium project and make this
its app.js:</p>
<pre>
<code class="javascript">Titanium.UI.setBackgroundColor('#000');
var win = Titanium.UI.createWindow({  
    title:'Test',
    backgroundColor:'#fff',
    exitOnClose: true
});
win.add( Ti.UI.createLabel({
    text: 'This is a lightweight window',
    left: 5, right: 5, top: 5, height: 40,
    color: 'black'
}) );

Ti.App.addEventListener('test1', function(){
    alert('This is an alert');
});

var btnTest = Ti.UI.createButton({
    title: 'Test alert() from event listener',
    top: 50, left: 5, right: 5, height: 40
});
btnTest.addEventListener('click', function() {
    Ti.App.fireEvent('test1', {});
});
win.add(btnTest);

var btn = Ti.UI.createButton({
    title: 'Open heavy window',
    top: 95, left: 5, right: 5, height: 40
});
btn.addEventListener('click', function() {
    Ti.UI.createWindow({
        url: 'win.js',
        backgroundColor: '#fff',
        fullscreen: false
    }).open();
});
win.add(btn);
win.open();</code>
</pre>
<p>Then add a new file, win.js, and make this its contents:</p>
<pre>
<code class="javascript">var win = Ti.UI.currentWindow;
win.add( Ti.UI.createLabel({
    text: 'This is a heavyweight window',
    left: 5, right: 5, top: 5, height: 40,
    color: 'black'
}) );
Ti.App.addEventListener('test2', function(){
    alert('This is an alert');
});
var btnTest = Ti.UI.createButton({
    title: 'Test alert() from event listener',
    top: 50, left: 5, right: 5, height: 40
});
btnTest.addEventListener('click', function() {
    Ti.App.fireEvent('test2', {});
});
win.add(btnTest);

var btn = Ti.UI.createButton({
    title: 'Close',
    top: 95, left: 5, right: 5, height: 40
});
btn.addEventListener('click', function() {
    win.close();
});
win.add(btn);</code>
</pre>
<p>Run the project and follow these steps:</p>
<ul>
<li>At the first (root, lightweight) window, if you click the "Test
alert() from event listener" button, you will successfully see the
alert.</li>
<li>Then click "Open heavy window" to open a heavyweight window to
run the same kind of test.</li>
<li>At the heavyweight window, if you click the "Test alert() from
event listener" button, you won't see the alert. (If you then click
the Close button, you might actually see the alert, as it has
popped up over the root window.)</li>
</ul></div>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>Assigned to Don for milestoning.</p></div></li>
<li>Junaid Younus 2012-08-29

   Tested on a Samsung Galaxy S2 using TiSDK 2.2.0v20120828153312, issue unable to reproduce. However, you get multiple alerts once you open/exit the heavyweight window. Related to TIMOB-2969. </li>
<li>Lee Morris 2017-07-28

   Closing due to inactivity. If this issue still exists, please raise a new ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-2970.json">JSON Source</a></p>