---
title: "[TIMOB-20139] iOS Peek & Pop: Events do not include itemIndex, sectionIdex, itemId for TableView"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2015-12-16T19:58:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.1.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.4.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>3dtouch, peekandpop, qe-5.4.0, tableview</td></tr>
<tr><th>Reporter</th><td>Jason Kneen</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2015-12-14T12:56:51.000+0000</td></tr>
<tr><th>Updated</th><td>2016-06-09T18:09:18.000+0000</td></tr>
</table>

<h3>Description</h3>

When attempting to use Peek and Pop with a Tableview previewContext property, no index properties are provided when a row is clicked, making it impossible to display row-specific information / content.

Code missing TableView implementation:
<a href="https://github.com/appcelerator/titanium_mobile/blob/a8b6440f99f7d1eb945ba92a1fe3e6602fbcc1ec/iphone/Classes/TiPreviewingDelegate.m#L112-L160" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/a8b6440f99f7d1eb945ba92a1fe3e6602fbcc1ec/iphone/Classes/TiPreviewingDelegate.m#L112-L160</a>

<h3>Comments</h3>

<ol>
<li>Fokke Zandbergen 2015-12-14

   Looks like we forgot to implement TIMOB-19763 for TableViews as we did for ListViews.</li>
<li>Hans Knöchel 2015-12-14

   We didn't implement the features because we don't support new features for the (legacy) <code>Ti.UI.TableView</code> anymore. Developers should use <code>Ti.UI.ListView</code> for new features like peek and pop.</li>
<li>Jason Kneen 2015-12-14

   There are sometimes good reasons for using a tableview and to limit the features to list view when it *appears* that it's easy enough to implement with a tableview (I've got a basic version working by using touch start to get the index) doesn't make any sense to me.
   
   Basically this is forcing us to use listviews for apps where we want peek and pop but that might not be the right list based solution for us -- apparently the fix is quite easy?</li>
<li>Fokke Zandbergen 2015-12-14

   Well, we did implement it in part:
   <a href="https://github.com/appcelerator/titanium_mobile/blob/a8b6440f99f7d1eb945ba92a1fe3e6602fbcc1ec/iphone/Classes/TiPreviewingDelegate.m#L122-L129" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/a8b6440f99f7d1eb945ba92a1fe3e6602fbcc1ec/iphone/Classes/TiPreviewingDelegate.m#L122-L129</a>
   
   And do document it (by inheritance) here:
   <a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI.TableView-property-previewContext
   
   And since there's still quite some use cases which ListView doesn't support I think we do need to add this to TableView as well.</li>
<li>Hans Knöchel 2015-12-14

   The only reason it's in the docs is because we apply it to every TiViewProxy by default from which the table view inherits. We could plan it for some later release, but since we are after code freeze for 5.2, I'm not sure if we should hype this up. 
   
   The <code>Ti.UI.TableView</code> will most likely be deprecated in the future, so we encourage developers to migrate the API since 3 years now :-)</li>
<li>Jason Kneen 2015-12-14

   So because of something that could happen "in the future" you're not going to solve this problem now?</li>
<li>Hans Knöchel 2015-12-14

   No, because it's no critical bug right now + we provide an API to fix it on the developer side + we are after code freeze for 5.2.0. Thats why.</li>
<li>Jason Kneen 2015-12-14

   wow.
   
   ok. closing ticket.</li>
<li>Hans Knöchel 2015-12-14

   Relax, all good :-) Just means, that it cannot be addressed right now, but for a 5.2.1 Release (or 5.2.0 backport). Since I'm off in december, maybe [~apetkov] can help?</li>
<li>Tim Poulsen 2015-12-14

    Appc has been going to deprecate TableView for about 3 years now. But keep in mind that TableView and ListView are not interchangeable components. Switching from TableView to ListView can involve significant re-architecting of your app (I know, I just did it and it was a royal pain in the you-know-what). There are many things you can do with TableView that you can't do with ListView. For small lists, the speed advantage of ListView is often not worth the effort compared to the coding and conceptual simplicity of the direct-view-access nature of TableView. </li>
<li>Angel Petkov 2015-12-14

    [~jasonkneen] Hello , I can understand you're fustrated ,however we are currently at code freeze as we have a release coming out very soon. This change will be added to the following release after that, i apologies for the inconvenience this might have caused to your app development. </li>
<li>Hans Knöchel 2015-12-15

    PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/7580" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7580</a>
    
    Docs not updated, since we strongly recommend to use the <code>Ti.UI.ListView</code> to use Peek and Pop.</li>
<li>Jason Kneen 2015-12-15

    But for what reason? Performance or just because it doesn't work out-of-the-box on TableView?
    
    I've got an app working with existing TableViews, and peek and pop and it's fine -- I had to do a workaround if I wanted to do the peek against the tableview itself -- using touch start to set the index before the peek -- otherwise it's possible to do the peek against the tableview row much like the mail app does.
    
    Thanks for the PR -- assuming this will work fine now for TableViews.</li>
<li>Tim Poulsen 2015-12-15

    [~hansknoechel] You realize that neither <a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI.TableView nor <a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI.ListView state that TableView is in a need-to-be-fixed-only state or that ListView is recommended in place of TableView. It's only with a good bit of digging through the guides that one might find details of your recommendation to use ListView. If you're going to deprecate a component, which you're essentially doing here, that should be clearly documented in the API docs.</li>
<li>Angel Petkov 2015-12-16

    FT and CR approved. Thanks Hans!
    
    <code><pre>
    var actions = [];
    var win = Ti.UI.createWindow({
        backgroundColor: "white"
    });
    
    // The view to be previewed while popping.
    var previewView = Ti.UI.createView({
        backgroundColor: "blue"
    });
    
    // The window to be opened after popping the preview.
    var detailWindow = Ti.UI.createWindow({
        backgroundColor: "yellow"
    });
    
    detailWindow.add(Ti.UI.createLabel({
        text: "You made it!"
    }));
    
    // The actions to be added to the preview context.
    var action = Ti.UI.iOS.createPreviewAction({
        title: "Preview Action",
        style: Ti.UI.iOS.PREVIEW_ACTION_STYLE_DEFAULT
    });
    
    action.addEventListener("click", function(e) {
        alert(
            "Title: " + e.title +
            "\nStyle: " + e.style +
            "\nIndex: " + e.index +
            "\nSectionIndex: " + e.sectionIndex +
            "\nItemIndex: " + e.itemIndex
        );
    });
    
    actions.push(action);
    
    // Create the preview context
    var context = Ti.UI.iOS.createPreviewContext({
        preview: previewView,
        actions: actions, // Can have both Ti.UI.iOS.PreviewAction + Ti.UI.iOS.PreviewActionGroup
        contentHeight: 300 // When unspecified, we use the available height
    });
    
    // Fired after peeking the preview
    // Use this event to configure the preview depending on the sectionIndex / itemIndex
    context.addEventListener("peek", function(e) {
        Ti.API.warn("sectionIndex: " + e.sectionIndex);
        Ti.API.warn("itemIndex: " + e.itemIndex);
    });
    
    // Fired after popping the preview
    context.addEventListener("pop", function(e) {
        detailWindow.open();
    });
    
    // Assign the preview context
    
    
    var section1 = Ti.UI.createTableViewSection({
        headerTitle: "Section 1"
    });
    
    var section2 = Ti.UI.createTableViewSection({
        headerTitle: "Section 2"
    });
    
    
    for(var i = 1; i &lt;= 5; i++) {
        section1.add(Ti.UI.createTableViewRow({ title: 'Item'+i }));
        section2.add(Ti.UI.createTableViewRow({ title: 'Item'+i }));
    }
    
    var tableView = Ti.UI.createTableView({
        previewContext 	: context, // Will be ignored on unsupported devices
        data 			: [section1, section2]
    });
    
    win.add(tableView);
    win.open();
    </pre></code></li>
<li>Josh Longton 2016-06-09

    Verified as fixed as an improvement. 
    Tested on: 
    iPhone 6s Plus (9.3.1)
    Mac OSX El Capitan 10.11.4
    Studio: 4.7.0.201606070951
     Ti SDK: 5.4.0.v20160608165242
     Appc NPM: 4.2.7-2
    Appc CLI: 5.4.0-13
     Xcode 7.3
    Node v0.12.7
    *Closing Ticket.*</li>
</ol>


<p><a href="/TIMOB/TIMOB-20139.json">JSON Source</a></p>