---
title: "[TIMOB-20208] Android 6.0: Issues with writing to file"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2016-04-21T02:16:47.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>Android</td></tr>
<tr><th>Reporter</th><td>Jacob Budin</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2015-12-21T17:28:47.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T22:24:14.000+0000</td></tr>
</table>

<h3>Description</h3>

*Steps to reproduce:*

1. Add the code below to controllers/index.js:

<code><pre>
function doClick(e) {
        var file = Ti.Filesystem.getFile(Ti.Filesystem.externalStorageDirectory, "test.txt");
	file.write("i love writing to files");
}

$.index.open();
</pre></code>

2. Launch the app.

3. Click on the "Hello, World" text.

*Results:*


<code><pre>
12-21 12:15:24.350: E/TiBlob(12960): (KrollRuntimeThread) [19,12681] /storage/emulated/0/com.androidwritefailure/test.txt: open failed: ENOENT (No such file or directory)
12-21 12:15:24.350: E/TiBlob(12960): java.io.FileNotFoundException: /storage/emulated/0/com.androidwritefailure/test.txt: open failed: ENOENT (No such file or directory)
12-21 12:15:24.350: E/TiBlob(12960): 	at libcore.io.IoBridge.open(IoBridge.java:452)
12-21 12:15:24.350: E/TiBlob(12960): 	at java.io.FileInputStream.&lt;init&gt;(FileInputStream.java:76)
12-21 12:15:24.350: E/TiBlob(12960): 	at org.appcelerator.titanium.io.TiFile.getInputStream(TiFile.java:264)
12-21 12:15:24.350: E/TiBlob(12960): 	at org.appcelerator.titanium.TiBlob.getInputStream(TiBlob.java:389)
12-21 12:15:24.350: E/TiBlob(12960): 	at org.appcelerator.titanium.TiBlob.guessContentTypeFromStream(TiBlob.java:209)
12-21 12:15:24.350: E/TiBlob(12960): 	at org.appcelerator.titanium.TiBlob.loadBitmapInfo(TiBlob.java:270)
12-21 12:15:24.350: E/TiBlob(12960): 	at org.appcelerator.titanium.TiBlob.blobFromFile(TiBlob.java:140)
12-21 12:15:24.350: E/TiBlob(12960): 	at org.appcelerator.titanium.TiBlob.blobFromFile(TiBlob.java:113)
12-21 12:15:24.350: E/TiBlob(12960): 	at org.appcelerator.titanium.io.TiFile.read(TiFile.java:351)
12-21 12:15:24.350: E/TiBlob(12960): 	at org.appcelerator.titanium.TiFileProxy.read(TiFileProxy.java:239)
</pre></code>


*Notes:*

The code is working in Android 5.1 and Android 5.0.

<h3>Comments</h3>

<ol>
<li>Ashraf Abu 2016-01-08

   This has to do with Storage permission required in Android 6.0.
   Workaround for now is to write it this way:-
   <code><pre>
      if (Ti.Media.hasCameraPermissions()) {
          var f = Ti.Filesystem.getFile(Ti.Filesystem.externalStorageDirectory, "tests.txt");
          f.write('writing to the file would be enough to create it');
      } else { 
          Ti.Media.requestCameraPermissions(function(e) {
                   if (e.success === true) {
                       var f = Ti.Filesystem.getFile(Ti.Filesystem.externalStorageDirectory, "tests.txt");
                       f.write('writing to the file would be enough to create it');
                   } else {
                       alert("Access denied, error: " + e.error);
                   }
          });
      }
   </pre></code>
   
   This will provide the storage permission needed.</li>
<li>Michael Gangolf 2016-01-08

   <a href="https://github.com/gimdongwoo/Ti-Android-RequestStoragePermission" rel="nofollow" target="_blank">https://github.com/gimdongwoo/Ti-Android-RequestStoragePermission</a>
   this plugin should request only the storage permission without the camera permission.</li>
<li>carlo 2016-01-26

   </li>
<li>Michael Gangolf 2016-04-20

   Should be fixed by this PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/7948" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7948</a>
   You can use:
   
   <code><pre>
   var storagePermission = "android.permission.READ_EXTERNAL_STORAGE";
   var hasStoragePerm = Ti.Android.hasPermission(storagePermission);
   var permissionsToRequest = [];
   if (!hasStoragePerm) {
       permissionsToRequest.push(storagePermission);
   }
   if (permissionsToRequest.length &gt; 0) {
       Ti.Android.requestPermissions(permissionsToRequest, function(e) {
           if (e.success) {
               Ti.API.info("SUCCESS");
           } else {
               Ti.API.info("ERROR: " + e.error);
           }
       });
   }
   </pre></code></li>
<li>Ashraf Abu 2016-04-21

   Thanks [~michael]
   
   Resolving this ticket as there are tickets that have solved the issue such as TIMOB-20320</li>
<li>Lee Morris 2017-03-22

   Closing ticket as duplicate and links to the related ticket have been provided above.</li>
</ol>


<p><a href="/TIMOB/TIMOB-20208.json">JSON Source</a></p>