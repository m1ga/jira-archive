---
title: "[TIMOB-20346] Cant load certain NPM modules because of Syntax"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2016-02-10T04:45:59.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Creative</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2015-12-29T08:17:21.000+0000</td></tr>
<tr><th>Updated</th><td>2017-04-04T15:08:52.000+0000</td></tr>
</table>

<h3>Description</h3>

Lets take a practical example: we use <code>mocha.js</code> using npm, but as soon as we try to compile the project, it fails because of some JS syntax error in the <code>tests</code> directory of this module (for instance, I got an error like ' # is not a valid expression', or something related).

My npm modules reside in <code>app/lib/node_modules/..</code> so I can access them in my app. I have another node_modules in the root of my project, for modules like <code>Grunt</code> (since those didnt compile either because of the JS checking) and I dont need those in the runtime.

Please do not suggest ti-mocha since that is not the issue here.

<h3>Comments</h3>

<ol>
<li>Creative 2015-12-29

   error example:
   
   
   <code><pre>
   [ERROR] :  Error generating AST for "**somepath**/*.js"
   [ERROR] :  Unexpected character '#'
   [ERROR] :  line 1
   </pre></code>
   </li>
<li>Sharif AbuDarda 2015-12-29

   Hello, If you don't actually show a simple test case (not your whole app) we can't run that exhibits the problem, the best anyone can do is make guesses. AST errors will generally tell you exactly what line and in what file they occur in. That should show you exactly where the error in your code is. Again, the best anyone can do is guess based on the single line of error log you provided and the fact that you haven't yet shared the full error output.
   
   So, Provide a sample test case which causing the error. Provide full platform information and component versions. Provide the full error log. And descrive the problem thoroughly. Thanks.
   </li>
<li>Creative 2016-01-20

   Do you even read bug reports?
   
   Just make a js-file somewhere in your app directory so it gets compiled when you build the app. Make sure the file starts with 
   <code><pre>
   #!/usr/bin/env node
   </pre></code>
   or some other expression with a pound/hash-symbol. Basically loading a specific NPM module causes the same issue since that just downloads a pack of js-files into your app.
   
   Although this is not valid javascript, a lot of npm modules use this notation for some unix reason. It cant be compiled by uglify. A solution here would be that you can ignore specific files by just copying them over instead of compiling them.</li>
<li>Sharif AbuDarda 2016-01-21

   I tried your way. I created a js file with the name of "#test.js". I put it on the resource directory. The app compiles fine. No Error or exceptions. Tested with SDK 5.1.2.GA. Thanks.</li>
<li>Creative 2016-02-04

   yes you dont read bug reports carefully.
   
   Now Try again with the line:
   
   TESTCASE (put this in any .js file on the 1st line for instance):
   <code><pre>
   #!/usr/bin/env node --expose_gc
   </pre></code>
   
   This is used in quite some npm modules and it prevents us from compiling.
   
   Thanks.</li>
<li>Chris Barber 2016-02-10

   Titanium only supports standard JavaScript files. Files that begin with a shebang/hashbang are not standard JavaScript files.
   
   The shebang is a Unix-specific character sequence that is not supported by ECMAScript standard.
   
   We have no plans to support this. You will need to strip the shebang line, remove the .js extension, or remove the file altogether.</li>
<li>Lee Morris 2017-03-23

   Closing ticket as Won't Fix with reference to the above comments.</li>
<li>Creative 2017-04-04

   </li>
<li>Chris Barber 2017-04-04

   [~uzbbert] Well, Uglify is only part of the problem. I reiterate my comment above. I will take a look at ALOY-1540.</li>
</ol>


<p><a href="/TIMOB/TIMOB-20346.json">JSON Source</a></p>