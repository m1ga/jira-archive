---
title: "[TIMOB-20439] Android: Using camera bloats app storage"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-11-14T21:38:50.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.2.0, Release 5.1.2</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android</td></tr>
<tr><th>Reporter</th><td>Sharif AbuDarda</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2016-02-22T15:12:09.000+0000</td></tr>
<tr><th>Updated</th><td>2017-11-15T05:42:37.000+0000</td></tr>
</table>

<h3>Description</h3>

During our testing we have realized that continuously taking camera images bloats app size. There is currently no way for us to check what is being stored.

1) Problem Description - taking a bunch of pictures (without saving them) bloats up app internal storage size.

2) Exact steps to reproduce:
Download the app [here](<a href="https://c.na10.content.force.com/servlet/servlet.FileDownload?file=00PF000000WBSKA)." rel="nofollow" target="_blank">https://c.na10.content.force.com/servlet/servlet.FileDownload?file=00PF000000WBSKA).</a>
- install supplied test app
- in application manager: note the size of the app and storage space used
- load supplied app
- press "Open Camera Pictures"
- press "Take"
- press "Retake"
- repeat 10 times
- kill the app
- go back to application manager and note size difference

3) Expected Behavior - no data to be saved. (Image saving is turned off by default according to docs)

4) Number of users affected - all Android users 

<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2016-02-22

   Salesforce ticket 1[00008173](<a href="https://na10.salesforce.com/500F000000oUfKq)." rel="nofollow" target="_blank">https://na10.salesforce.com/500F000000oUfKq).</a>
   Salesforce ticket 2[00008174](<a href="https://na10.salesforce.com/500F000000oUfts)." rel="nofollow" target="_blank">https://na10.salesforce.com/500F000000oUfts).</a>
   
   </li>
<li>Sharif AbuDarda 2016-03-08

   Hello, If saveToPhotoGallery is set to false, taking image will increase the app size. 
   
   *Steps to Reproduce*
   
   saveToPhotoGallery property must be set to false
   <code><pre>
   var showCamera = function() {
   	
   		Ti.Media.showCamera({
   			success:function(event) {
                                  alert('success');
   				
   			},
   			cancel:function() {			
   				// called when user cancels taking a picture
   			},
   			error:function(error) {
   				alert('error');
   			},
   			saveToPhotoGallery:false,
   		    // allowEditing and mediaTypes are iOS-only settings
   		});
   	};
   
   showCamera();
   
   </pre></code>
   
   Actual Result
   
   Every photo taken by camera (no matter if later saved or not) will take some space (data on device). There is no way to release that space or get that file, so it will continuously increase taken space until no space is left.
   If you save the image after taking it, than the space taken is doubled (you create additional file). Of course you can delete saved image but it will only release half of taken space.
   
   There is no problem if saveToPhotoGallery is set to true
   
   Expected Result
   
   Space taken by the image should be released or there should be the way to get the files taking that space.</li>
<li>Hieu Pham 2016-03-08

   On Android, if saveToPhotoGallery is false, we store the image in internal storage and return it via success callback. If you wish to NOT use the image that is returned, you can delete it by doing something like this:
   <code><pre>
   success:function(event) {
                                   alert('success');
   				var blob = event.media;
   				var file = blob.getFile();
   				file.deleteFile();
   }
   </pre></code>
   
   This is likely the same for iOS.</li>
<li>Nazmus Salahin 2016-03-09

   I am able to reproduce this issue with the given project and given steps. Initially the application manager showed that the app used 23.7 MB internal storage but after following the given steps it becomes 39.4 MB.
   
   But if I change the "openCamera()" function in the project as follows:
   
   [Gist Link](<a href="https://gist.github.com/N-Salahin/05c9819b41005bb73cd1)" rel="nofollow" target="_blank">https://gist.github.com/N-Salahin/05c9819b41005bb73cd1)</a>
   
   then the issue is solved. The app size remains 23.7 MB even after following the steps now.
   
   *Environment*:
   
   *Device info:* Nexux7 (android 6.0.1)
   *Node.js Version:* 0.12.7
   *npm Version:* 2.11.3
   *Titanium SDKs:* 5.2.0 and 5.1.2.GA
   *Java Development Kit Version:* 1.8.0_73
   *Titanium CLI Version:*  5.0.5
   </li>
<li>Collin Price 2016-03-21

   If I don't use *deleteFile* when is the file flushed from internal storage?
   </li>
<li>Sharif AbuDarda 2016-03-31

   Hello, 
   
   It depends on the internal storage, The operation will just increase the app size. And you can clean the data manually from the app. I think the best resolution for an user is to put the delete function in the app and automatically delete a file when not saved. Cause the user might not always clean the cache. So, from a developer perspective using the automatically delete option should be best practice.
   
   Regards,
   Sharif</li>
<li>Nikita Radaev 2016-03-31

   I disagree. This IS a bug. In my opinion it should be fixed instead of using workarounds. 
   
   This functionality should be an option of Ti.Media.ShowCamera in CameraOptionsType. 
   
   Otherwise, you rely on developers using workaround that is not documented anywhere.</li>
<li>Nikita Radaev 2017-03-24

   How is this being marked as resolved? Nothing has been done to resolve this issue....</li>
<li>Gary Mathews 2017-08-28

   master: <a href="https://github.com/appcelerator/titanium_mobile/pull/9362" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9362</a></li>
<li>Lokesh Choudhary 2017-11-13

    FR Passed.
    Waiting for merge to get enabled.</li>
<li>Lokesh Choudhary 2017-11-14

    PR Merged.</li>
<li>Abir Mukherjee 2017-11-15

    Changes are seen in SDK 7.0.0.v20171114202841.</li>
</ol>


<p><a href="/TIMOB/TIMOB-20439.json">JSON Source</a></p>