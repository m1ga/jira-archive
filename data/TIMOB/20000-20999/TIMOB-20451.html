---
title: "[TIMOB-20451] Window.close should use new activity*Transition instead of activity*Animation or default"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-04-28T06:58:28.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.2.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.4.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Fokke Zandbergen</td></tr>
<tr><th>Assignee</th><td>Srikanth Sombhatla</td></tr>
<tr><th>Created</th><td>2016-02-24T12:22:51.000+0000</td></tr>
<tr><th>Updated</th><td>2016-07-14T22:25:24.000+0000</td></tr>
</table>

<h3>Description</h3>

With TIMOB-19580 we have introduced <code>activity*Transition</code> properties for <code>Ti.UI.Window</code>.

We also still have <code>activity*Animation</code> properties for <code>Ti.UI.Window.open()</code> and <code>Ti.UI.Window.close()</code>.

<h4>The Issue</h4>

This is confusing, but also seems to not always work as expected:

If you try the _Activity Transitions_ example in the [Ti 5.2.0 Sample App](<a href="https://github.com/appcelerator-developer-relations/appc-sample-ti520)" rel="nofollow" target="_blank">https://github.com/appcelerator-developer-relations/appc-sample-ti520)</a> and set all <code>activity*Transition</code> properties to <code>TRANSITION_NONE</code> you will see that if you use the system navigation bar (or hardware) back button in Window B it will indeed close without animation. But if you use the Action Bar Level Up icon (which simply calls <code>Ti.UI.Window.close()</code>) it will fade out.

<h4>Solution</h4>

We should:

1. Make sure that if I call <code>Ti.UI.Window.close()</code> without <code>activityEnterAnimation</code> and <code>activityExitAnimation</code>, it will honour <code>Ti.UI.Window.activityReturnTransition</code>.

2. Deprecate and in 6.0 remove the <code>activity*Animation</code> properties.

<h4>Source</h4>

Related code:

<a href="https://github.com/appcelerator/titanium_mobile/blob/a67afc862cd344bf1293b16142317aad0b5ee122/android/modules/ui/src/java/ti/modules/titanium/ui/WindowProxy.java#L135-L184" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/a67afc862cd344bf1293b16142317aad0b5ee122/android/modules/ui/src/java/ti/modules/titanium/ui/WindowProxy.java#L135-L184</a>

<h3>Comments</h3>

<ol>
<li>Srikanth Sombhatla 2016-04-22

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/7961" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7961</a>
   Using <code>Ti.UI.Window.close()</code> or device back should close with transition. 
   
   <code><pre>
   Ti.UI.setBackgroundColor('#000');
   var win = Ti.UI.createWindow({
     backgroundColor: 'black',
     fullscreen: false,
     title: 'Master'
   });
    
   var IMG_BASE = '<a href="https://github.com/appcelerator/titanium_mobile/raw/master/demos/KitchenSink/Resources/images/" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/raw/master/demos/KitchenSink/Resources/images/</a>';
   var defaultFontSize = Ti.Platform.name === 'android' ? 16 : 14;
    
   var tableData = [];
    
   for (var i=1; i&lt;=20; i++){
     var row = Ti.UI.createTableViewRow({
       className:'forumEvent', // used to improve table performance
       selectedBackgroundColor:'white',
       rowIndex:i, // custom property, useful for determining the row during events
       height:110
     });
    
     var avatar = createAvatar();
     avatar.transitionName = "avatar";
     row.add(avatar);
      
     var labelUserName = Ti.UI.createLabel({
       color:'#576996',
       font:{fontFamily:'Arial', fontSize:defaultFontSize+6, fontWeight:'bold'},
       text:'Fred Smith ' + i,
       left:70, top: 6,
       width:200, height: 30,
     });
     row.add(labelUserName);
    
     var labelDetails = Ti.UI.createLabel({
       color:'#222',
       font:{fontFamily:'Arial', fontSize:defaultFontSize+2, fontWeight:'normal'},
       text:'Replied to post with id ' + randomInt(1000) + '.',
       left:70, top:44,
       width:360
     });
     row.add(labelDetails);
    
     var imageCalendar = Ti.UI.createImageView({
       image:IMG_BASE + 'custom_tableview/eventsButton.png',
       left:70, bottom: 2,
       width:32, height: 32
     });
     row.add(imageCalendar);
    
     var labelDate = Ti.UI.createLabel({
       color:'#999',
       font:{fontFamily:'Arial', fontSize:defaultFontSize, fontWeight:'normal'},
       text:'on ' + randomInt(30) + ' Nov 2012',
       left:105, bottom:10,
       width:200, height:20
     });
     row.add(labelDate);
    
     tableData.push(row);
   }
    
   var tableView = Ti.UI.createTableView({
     backgroundColor:'white',
     data:tableData
   });
    
   tableView.addEventListener('click', function(e){
   	var masterAvatar = e.row.children[0];
   	var masterUsername = e.row.children[1];
   	
   	var win2 = Ti.UI.createWindow({
   	animated: true,
   	  layout: 'vertical',
   	  backgroundColor: 'white',
   	  title: 'Details-',
   	  activityEnterAnimation: Ti.Android.R.anim.fade_in,
         activityExitAnimation: Ti.Android.R.anim.fade_out
   	});
   	
   	var avatar = createAvatar();
   	avatar.width = 80;
   	avatar.height = 80;
   	avatar.left = 100;
   	avatar.transitionName = "avatar";
     	var labelUserName2 = Ti.UI.createLabel({
   	    color:'#576996',
   	    font:{fontFamily:'Arial', fontSize:defaultFontSize+6, fontWeight:'bold'},
   	    text:'Tap to close',
   	    top: 20,
   	    width:250, height: 60,
   	    transitionName: "username",
   	  });
   	labelUserName2.addEventListener('click', function() {
   		win2.close()
   	});
   	  
   	win2.add(avatar)  
       win2.add(labelUserName2);
   	win2.addSharedElement(masterAvatar, "avatar");
   	win2.addSharedElement(masterUsername, "username");
   	win2.open(); 
   });
   win.add(tableView);
   win.open();
    
   function createAvatar() {
     var avatar = Ti.UI.createView({
       backgroundColor: 'green',
       left:10, top:5,
       width:50, height:50,
     });
     return avatar; 
   }
   
   // generate random number, used to make each row appear distinct for this example
   function randomInt(max){
     return Math.floor(Math.random() * max) + 1;
   }
   </pre></code></li>
<li>Hans Kn√∂chel 2016-04-22

   We should move this to 5.4.0</li>
<li>Ashraf Abu 2016-04-28

   PR merged</li>
<li>Fokke Zandbergen 2016-05-02

   Thanks [~ssombhatla]!
   
   [~msamah] The PR deals with #1 - what are your thoughts on #2?
   
   * Deprecate and in 6.0 remove the <code>activity*Animation</code> properties.</li>
<li>Lokesh Choudhary 2016-06-13

   [~msamah], I have verified the fix for #1, & as [~fokkezb] commented are we doing anything for #2.
   I am gonna leave it resolved as the fix is just for #1 as of now.
   
   Environment:
   Appc Studio : 4.6.0.201605201934
   Ti SDK :  5.4.0.v20160608165242
   Ti CLI : 5.0.8
   Alloy : 1.8.7
   MAC El Capitan : 10.11.4
   Appc NPM : 4.2.7-2
   Appc CLI : 5.4.0-11
   Node: 4.4.4
   Nexus 6 - Android 6.0.0</li>
<li>Lokesh Choudhary 2016-07-14

   Closing.
   
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-20451.json">JSON Source</a></p>