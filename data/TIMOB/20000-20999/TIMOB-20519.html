---
title: "[TIMOB-20519] '--project dir .' causes module build to fail"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-03-07T20:50:38.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.2.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.2.1</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>qe-5.2.1</td></tr>
<tr><th>Reporter</th><td>Eric Wieber</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2016-03-04T22:10:57.000+0000</td></tr>
<tr><th>Updated</th><td>2016-03-07T22:00:16.000+0000</td></tr>
</table>

<h3>Description</h3>

When specifying <code>--project-dir .</code> when trying to build a module, the build will fail.

*Steps to reproduce issue*
1. Try to build a module with <code>ti build -p ios --project-dir . -b</code>

*Actual Results*
The build fails with:
<code>[ERROR] Unable to find "undefined" module</code>

*Expected Results*
The build succeeds

<h3>Comments</h3>

<ol>
<li>Chris Barber 2016-03-04

   There are two things that need to be done.
   
   <h4>Change the order of the <code>\-\-platform</code> and <code>\-\-project\-dir</code> options in <a href="https://github.com/appcelerator/titanium_mobile/blob/master/cli/commands/build.js." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/cli/commands/build.js.</a> Currently <code>\-\-project\-dir</code> is validated first, then <code>\-\-platform</code>. If we swap this, then <code>cli.argv.platform</code> will be set when the <code>\-\-project\-dir</code> validation runs.</h4>
   <h4>Normalize the platform name in the module's manifest which is done here: <a href="https://github.com/appcelerator/titanium_mobile/blob/master/node_modules/titanium-sdk/lib/titanium.js#L359." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/node_modules/titanium-sdk/lib/titanium.js#L359.</a> This is done like this:</h4>
   
   <code><pre>
   if (cli.argv.platform !== exports.resolvePlatform(manifest.platform)) {
   </pre></code></li>
<li>Chris Barber 2016-03-07

   Master PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/7806" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7806</a>
   5_2_X PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/7807" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7807</a>
   5_3_X PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/7808" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/7808</a></li>
<li>Feon Sua Xin Miao 2016-03-07

   PR merged.</li>
<li>Eric Wieber 2016-03-07

   Verified fixed, using:
   
   MacOS 10.11.3 (15D21)
   Studio 4.5.0.201602170821
   Ti SDK 5.2.1.v20160307134704
   Appc NPM 4.2.4.2
   Appc CLI 5.2.1-11
   Alloy 1.7.35
   Xcode 7.2 (7C68)
   
   Able to successfully build modules using <code>--project-dir .</code> and <code>--platform</code> in the command, in any order.</li>
</ol>


<p><a href="/TIMOB/TIMOB-20519.json">JSON Source</a></p>