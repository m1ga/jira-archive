---
title: "[TIMOB-23382] Parity: Cannot require directory as done in NodeJS"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-06-10T08:07:56.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.3.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.0.0</td></tr>
<tr><th>Components</th><td>Android, iOS</td></tr>
<tr><th>Labels</th><td>notable, parity</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2016-05-16T17:13:43.000+0000</td></tr>
<tr><th>Updated</th><td>2018-11-16T15:40:54.000+0000</td></tr>
</table>

<h3>Description</h3>

If you attempt to require a directory, NodeJS has well-defined behavior: <a href="https://nodejs.org/api/modules.html#modules_all_together" rel="nofollow" target="_blank">https://nodejs.org/api/modules.html#modules_all_together</a>

Namely:
- try to load <code>dir/package.json</code> and grab the <code>main</code> property, load the file pointed to by that.
- try to load <code>dir/index.js</code> as JS
- try to load <code>dir/index.json</code> as JSON

Trying this on Android and iOS, it just throws a runtime error that the requested module was not found.


<h3>Comments</h3>

<ol>
<li>Christopher Williams 2016-05-16

   The NodeJS require algorithm _is_ implemented for Windows SDK.</li>
<li>Christopher Williams 2016-05-17

   <a href="https://github.com/appcelerator/titanium_mobile/pull/8004" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8004</a></li>
<li>Chee Kiat Ng 2016-06-10

   Works great!
   
   <h4>Steps to test</h4>
   1. *appc new --classic*
   2. Obtain this module <code>scapegoat</code> from <a href="https://github.com/brentertz/scapegoat" rel="nofollow" target="_blank">https://github.com/brentertz/scapegoat</a>
   3. put the module in <code>/Resources/scapegoat</code>
   4. put this in app.js
   <code><pre>
   Ti.UI.createWindow().open();
   var scapegoat = require('scapegoat')
         escape = scapegoat.escape,
         unescape = scapegoat.unescape;
   
   var html = '&lt;h1&gt;Hello World&lt;/h1&gt;',
         escaped = escape(html),
         unescaped = unescape(escaped);
         
   alert('html: ' + html + '\nescaped: ' + escaped + '\nunescaped: ' + unescaped);
   </pre></code>
   5. *appc run -p ios*
   
   <h4>Expected Result</h4>
   An alert will show with this result 
   <code><pre>
   html: &lt;h1&gt;Hello World&lt;/h1&gt;
   escaped: &lt;h1&gt;Hello World&lt;/h1&gt;
   unescaped: &lt;h1&gt;Hello World&lt;/h1&gt;
   </pre></code>
   
   Repeat with *appc -run -p android* you can get the same result
   
   PR MERGED!!</li>
<li>Ashraf Abu 2016-06-10

   Did the same for android. Same results.
   <code><pre>
   html: &lt;h1&gt;Hello World&lt;/h1&gt;
   escaped: &lt;h1&gt;Hello World&lt;/h1&gt;
   unescaped: &lt;h1&gt;Hello World&lt;/h1&gt;
   </pre></code>
   Works well.</li>
<li>Chee Kiat Ng 2016-06-10

   [~bimmel] probably need to be documented somehow like "hey, Titanium can require directory like what NodeJS does normally now"</li>
<li>(deactived) Brian Immel 2016-06-10

   Thanks for the heads up [~cng]. I'll add this to the docs when we get to 6.0.0 release.
   </li>
<li>(deactived) Brian Immel 2016-06-10

   Thanks [~cwilliams]. I'll take a look at it and write up a little something and post it back here for review.</li>
<li>(deactived) Brian Immel 2016-06-10

   [~cwilliams] and [~cng], I've written up a first draft of the changes per this ticket:
   <a href="https://wiki.appcelerator.org/display/~bimmel/2016/06/10/Daily+Update+6-10-16#DailyUpdate6-10-16-RequireDirectory" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/~bimmel/2016/06/10/Daily+Update+6-10-16#DailyUpdate6-10-16-RequireDirectory</a>
   
   Let me know what I got right and wrong.
   Thanks</li>
<li>Lokesh Choudhary 2016-08-15

   Verified the fix.
   Used the test case above.
   
   Closing.
   
   Environment:
   Appc Studio : 4.7.0.201607250649
   Ti SDK :  6.0.0.v20160814220332
   Ti CLI : 5.0.9
   Alloy : 1.9.1
   MAC El Capitan : 10.11.6
   Appc NPM : 4.2.7
   Appc CLI : 6.0.0-24
   Node: 4.4.4
   Nexus 6 - Android 6.0.1
   iOS simulator: Iphone 6s 9.3</li>
</ol>


<p><a href="/TIMOB/TIMOB-23382.json">JSON Source</a></p>