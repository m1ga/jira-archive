---
title: "[TIMOB-23383] Parity: Titanium CommonJS modules cannot require relative files"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-07-14T04:43:46.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.3.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.0.0</td></tr>
<tr><th>Components</th><td>Android, iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2016-05-16T17:21:03.000+0000</td></tr>
<tr><th>Updated</th><td>2016-10-05T17:41:32.000+0000</td></tr>
</table>

<h3>Description</h3>

Titanium CommonJS modules have a hard limit to effectively all be contained in a single JS file whose base name matches the module.id.  If you have a CommonJS module, not only does it have to have an entry file matching the module id(TIMOB-23382), but that file will fail to require any other files relative to it.

For a simple example, I have a <code>modules/commonjs/ti.commonjs.require/1.0.0</code> folder and inside is:
- <code>ti.commonjs.require.js</code>
- <code>main.js</code>

I can do <code>require('ti.commonjs.require');</code> from my Titanium app, and it'll load the <code>modules/commonjs/ti.commonjs.require/1.0.0/ti.commonjs.require.js</code> file (regardless of whether I have a package.json pointing to another file or an index.js file there). But if that file has a <code>require('./main');</code> it'll throw a Runtime error that it's unable to load the main.js module.

<h3>Comments</h3>

<ol>
<li>Christopher Williams 2016-05-16

   Just for testing sake, doing a <code>require('main')</code> or <code>require('/main')</code> as fails.</li>
<li>Christopher Williams 2016-05-16

   On Android this appears to be the case because CommonJS modules are actually placed as a single file into the Resources folder of the generated app. One possible fix is to actually retain the module's full contents filtered down to just the *.js and *.json files, as a whole folder under the Resources folder?</li>
<li>Eric Wieber 2016-10-05

   Verified fixed, using:
   MacOS 10.12 (16A323)
   Studio 4.7.1.201609100950
   Ti SDK 6.0.0.v20161005072811
   Appc NPM 4.2.7
   Appc CLI 6.0.0-55
   Alloy 1.9.2
   Xcode 8.0 (8A218a)
   
   CommonJS modules can include relative files, without error (if specified as <code>require('./main')</code>). Tested by adding a log and require statement to a commonJS module then doing the same in the relative file. No errors were encountered and all logs were printed. Tested on both android and iOS simulators/emulators.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23383.json">JSON Source</a></p>