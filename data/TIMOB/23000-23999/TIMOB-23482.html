---
title: "[TIMOB-23482] Android: EmailDialog fails to attach files when using Outlook"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-01-19T23:15:39.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.0.2</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, emaildialog, outlook</td></tr>
<tr><th>Reporter</th><td>Martyn Joyce</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2016-06-07T08:50:43.000+0000</td></tr>
<tr><th>Updated</th><td>2018-01-22T18:35:57.000+0000</td></tr>
</table>

<h3>Description</h3>

I use createEmailDialog to send emails and attach locally created files to them.

On Android the attachment does not get added if the user selects to send the email via Outlook. Everything works correctly if the user selects to send the email via Gmail.

Please see screenshots in attachments

<code><pre>

var emailDialog = Ti.UI.createEmailDialog({});
emailDialog.subject = "Test email with attachment";
emailDialog.toRecipients = ["test@me.com"];
emailDialog.messageBody = 'the file should be attached';

var file = Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory, "test.txt");
		
emailDialog.addAttachment(file);
	
emailDialog.open();
</pre></code>


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-23482_59513/gmail.png">gmail.png</td></td><td>2016-06-07T08:48:41.000+0000</td><td>95128</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-23482_59512/outlook.png">outlook.png</td></td><td>2016-06-07T08:48:41.000+0000</td><td>84102</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Nazmus Salahin 2016-06-07

   Hello,
   I am able to reproduce this issue with given code and given step.
   *Steps:*
   1. Create a default classic project for android with following code.
   <code><pre>
   var win = Titanium.UI.createWindow({
   	title : 'Tab 1',
   	backgroundColor : '#fff'
   });
   
   win.open();
   
   var emailDialog = Ti.UI.createEmailDialog({});
   
   emailDialog.subject = "Test email with attachment";
   
   emailDialog.toRecipients = ["test@me.com"];
   
   emailDialog.messageBody = 'the file should be attached';
   
   var file = Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory, "test.txt");
   
   emailDialog.addAttachment(file);
   
   emailDialog.open();
   
   </pre></code>
   2. Paste test.txt file in resources folder.
   3. Build and run the app on android device.
   
   Result : On Android the attachment does not get added if the user selects to send the email via Outlook. Everything works correctly if the user selects to send the email via Gmail.
   
   Note: To test this issue Gamil and Outlook app must be installed in the device
   
   *Environment*:
   
   *Device info:* HTC One (Android 4.4.3)
   *Node.js Version:* 0.12.7
   *npm Version:* 2.11.3
   *Titanium SDKs:* 5.3.0.GA
   *Java Development Kit Version:* 1.8.0_73
   *Titanium CLI Version:*  5.0.5
   *Appcelerator CLI Version:*  5.2.2
   *Appcelerator Studio:* 4.5.0</li>
<li>Ashraf Abu 2016-06-08

   Based on what's happening, it looks like the Outlook application is not handling the receiving of the attachment.
   I believe there is nothing wrong with it. (I can be wrong but I'm leaning towards that Outlook is not handling the attachment correct).
   
   Another way to do this is to use Intents. <a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Android.Intent </li>
<li>Martyn Joyce 2016-06-08

   ok, thanks for looking into it</li>
<li>Ashraf Abu 2016-06-08

   [~martz256] Please let us know if there's any updates you want to give.</li>
<li>Joshua Quick 2017-12-01

   I've confirmed that the fix for [TIMOB-25541] fixes this issue as well...
   
   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/9520" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9520</a></li>
<li>Joshua Quick 2018-01-09

   PR (7.0.x): <a href="https://github.com/appcelerator/titanium_mobile/pull/9709" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9709</a></li>
<li>Lokesh Choudhary 2018-01-10

   FR passed for master & PR merged.
   FR passed for backport , waiting for merge to get enabled.
   </li>
<li>Lokesh Choudhary 2018-01-19

   Master & backport PR's merged.</li>
<li>Lokesh Choudhary 2018-01-22

   Verified the fix with SDK 7.1.0.v20180121202754 & 7.0.2.v20180119173957.
   
   Closing.
   
   Studio Ver: 5.0.0.201712081732
   SDK Ver: 7.0.2.v20180119173957, 7.1.0.v20180121202754
   OS Ver: 10.13.2
   Xcode Ver: Xcode 9.2
   Appc NPM: 4.2.11
   Appc CLI: 7.0.1
   Daemon Ver: 1.0.1
   Ti CLI Ver: 5.0.14
   Alloy Ver: 1.10.10
   Node Ver: 8.9.1
   NPM Ver: 5.5.1
   Java Ver: 1.8.0_101
   Devices: samsung SM-G955U1 — Android 7.0
   google Nexus 5 — Android 6.0.1
   google Pixel — Android 7.1.1
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-23482.json">JSON Source</a></p>