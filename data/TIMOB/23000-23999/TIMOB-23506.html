---
title: "[TIMOB-23506] Add event listener for applicationWillTerminate"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-06-13T21:17:15.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>applicationWillTerminate, ios, titanium</td></tr>
<tr><th>Reporter</th><td>Uriel Lizama</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2016-06-13T16:01:42.000+0000</td></tr>
<tr><th>Updated</th><td>2016-10-05T16:42:44.000+0000</td></tr>
</table>

<h3>Description</h3>

I have an app that has a background service enabled, the user can elect to get a notification that alerts of the app being killed so that the user can manually restart the app.

There are some other apps that have this feature, examples are Mile IQ and Kevo (<a href="http://stackoverflow.com/questions/22938387/how-to-detect-if-an-ios-app-is-killed-when-it-is-not-in-forground-ios7)." rel="nofollow" target="_blank">http://stackoverflow.com/questions/22938387/how-to-detect-if-an-ios-app-is-killed-when-it-is-not-in-forground-ios7).</a>

When the app is about to shutdown iOS seems to call *applicationWillTerminate* and gives about 5 seconds, which is enough time to trigger a local notification.

Looking at the Titanium SDK code, you are already listening for this event, it would be great if we could surface it as a *Titanium.App.addEventListener('willterminate')* event.

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2016-06-13

   Hey there,
   
   I had a quick look into our existing code-base and there is an (undocumented) event <code>close</code> which can be accessed like this:
   
   <code><pre>
   Ti.App.addEventListener("close", function() {
       // Application will terminate
   });
   </pre></code>
   
   So different to the <code>close</code> event in <code>Ti.UI.Window</code>, this one gets triggered by the core when reaching the <code>- (void)applicationWillTerminate:(UIApplication *)application</code> delegate. Give it a try! I will add the docs if it works for you. Thanks!</li>
<li>Hans Knöchel 2016-06-13

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8056" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8056</a>
   Demo: Paste the below code and quit the app using multitasking. The below log <code>applicationWillTerminate</code> should be shown in the console.
   <code><pre>
   var win = Ti.UI.createWindow({
     backgroundColor : "#fff"
   }); 
   
   Ti.App.addEventListener("close", function() {
       Ti.API.warn("applicationWillTerminate");
   });
   
   win.open();
   </pre></code></li>
<li>Uriel Lizama 2016-06-13

   What SDK version are you using?
   
   I have:
   
   
   
   {noformat}
   	Titanium.App.addEventListener("close", function() {
   	    Ti.API.warn("applicationWillTerminate");
   		var notification = Ti.App.iOS.scheduleLocalNotification({
   		    alertBody: 'You app is terminating',
   		    date: new Date(new Date().getTime() + 100)
   		});
   	});
   {noformat}
   
   
   
   I open the app, move it to background and then remove it using multitasking, but no warning and no notication.
   
   I'm on 5.2.2.GA</li>
<li>Abir Mukherjee 2016-09-28

   With this environment:
   
   NPM Version: 2.15.9
   Node Version: 4.5.0
   Mac OS: 10.11.6
   Appc CLI: 5.5.0
   Appc CLI NPM: 4.2.7
   Titanium SDK version: 6.0.0.v20160927062927
   Appcelerator Studio, build: 4.7.1.201609100950
   Xcode 8.0 GM
   
   I created and installed an app using Han's demo code. I opened it, moved it to the background, and then removed it using multitasking, but there was no warning. This was done on a device (iPhone 6S Plus, iOS 10.0.1). In short, I believe the issue is not resolved.</li>
<li>Hans Knöchel 2016-10-01

   [~amukherjee] Did you use the Console.app to watch the logs? There is an known issue regarding logging (TIMOB-23786) that is currently being investigated. I will retry the PR as well, but to be sure, use the Console.app for device-logs. Thx!
   
   *EDIT*: Just tried, looks good:
   <code><pre>
   2016-10-01 11:22:32.172 Titanium[1147:23479] [INFO] The application is being shutdown
   2016-10-01 11:22:32.173 Titanium[1147:23479] [WARN] applicationWillTerminate
   </pre></code></li>
<li>Abir Mukherjee 2016-10-01

   I had checked the Console Window in Studio. But I will check Console.app and report back.
   
   Update: I tried using iOS SImulator, and did see the warning. I don't have an actual device here; so I'll try that on Monday.</li>
<li>Abir Mukherjee 2016-10-05

   Using this environment:
   NPM Version: 2.15.9
   Node Version: 4.5.0
   Mac OS: 10.11.6
   Appc CLI: 5.5.0
   Appc CLI NPM: 4.2.7
   Titanium SDK version: 5.5.0.GA
   Appcelerator Studio, build: 4.8.0.201609290836
   Xcode 8.0 GM
   
   I was able to verify that the warning was shown in the console with iOS simulator. Also, with a device, a warning message was shown on the console with an iOS 9.2 phone. There was no warning when using a iOS 10.0 phone.</li>
<li>Hans Knöchel 2016-10-05

   That's only because of TIMOB-23786.</li>
<li>Abir Mukherjee 2016-10-05

   Ok, since we have a ticket for iOS 10 device, I'll close this one.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23506.json">JSON Source</a></p>