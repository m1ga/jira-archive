---
title: "[TIMOB-23537] Windows: Improve handling of an unsupported Visual Studio version"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Done</td></tr>
<tr><th>Resolution Date</th><td>2019-06-05T07:42:45.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.3.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>qe-5.4.0</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2016-06-17T17:21:24.000+0000</td></tr>
<tr><th>Updated</th><td>2019-06-05T07:42:45.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

Currently, when just Visual Studio "15" preview is installed attempting to build will fail with the below error, this should be handled better and a warning/error shown to the user when they attempt to use an SDK that does not support that version.

<code><pre>
C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\windows\cli\commands\_build\logInfo.js:63
        this.logger.debug(__('CMake generator name: %s', this.cmakeGeneratorName.cyan));
                                                                         ^
TypeError: Cannot read property 'cyan' of undefined
    at WindowsBuilder.loginfo (C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\windows\cli\commands\_build\logInfo.js:63:74)
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:689:13
    at iterate (C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:265:13)
    at process._tickCallback (node.js:355:11)
---------------------------------------------
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:275:35
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:44:16
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:694:17
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:173:37
    at WindowsBuilder.initialize (C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\windows\cli\commands\_build\initialize.js:88:2)
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:689:13
    at iterate (C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:265:13)
    at process._tickCallback (node.js:355:11)
---------------------------------------------
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:275:35
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:44:16
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:694:17
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:173:37
    at WindowsBuilder.doAnalytics (C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\windows\cli\commands\_build\analytics.js:56:2)
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:689:13
    at iterate (C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:265:13)
    at process._tickCallback (node.js:355:11)
---------------------------------------------
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:275:35
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:44:16
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:694:17
    at C:\ProgramData\Titanium\mobilesdk\win32\5.3.0.GA\node_modules\node-appc\node_modules\async\lib\async.js:173:37
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:52:16
    at WindowsBuilder.done (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:248:21)
    at WindowsBuilder.<anonymous> (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:44:16)
    at CLI._fireHookCallback (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\lib\hook.js:269:12)
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\lib\hook.js:248:10
---------------------------------------------
    at Object.exports.execFile (child_process.js:821:9)
    at exports.exec (child_process.js:649:18)
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\node-appc\lib\environ.js:267:3
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:697:13
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:52:16
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:272:32
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:44:16
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:694:17
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:173:37
---------------------------------------------
    at Object.exports.execFile (child_process.js:821:9)
    at exports.exec (child_process.js:649:18)
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\node-appc\lib\environ.js:255:6
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:689:13
    at iterate (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:265:13)
    at async.forEachOfSeries.async.eachOfSeries (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:284:9)
    at _parallel (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:688:9)
    at Object.async.series (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:710:9)
    at Object.getOSInfo (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\node-appc\lib\environ.js:223:8)
---------------------------------------------
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:275:35
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:44:16
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:694:17
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:173:37
    at CLI.detectMissingArguments (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\lib\cli.js:695:13)
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:689:13
    at iterate (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:265:13)
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:277:29
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:44:16
---------------------------------------------
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:275:35
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:44:16
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:694:17
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:173:37
    at CLI.<anonymous> (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\lib\cli.js:523:9)
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:689:13
    at iterate (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:265:13)
    at process._tickCallback (node.js:355:11)
---------------------------------------------
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:275:35
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:44:16
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:694:17
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:173:37
    at CLI.<anonymous> (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\lib\cli.js:523:9)
    at C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:689:13
    at iterate (C:\Users\ewan\AppData\Roaming\npm\node_modules\titanium\node_modules\async\lib\async.js:265:13)
    at process._tickCallback (node.js:355:11)
</pre></code>

<h4>Steps to reproduce</h4>

1. Install Visual Studio 15 Preview 
2. Attempt to build for Windows Platform <code>appc run -p windows -T wp-emulator</code>

<h4>Actual result</h4>

The build fails with an unhelpful error

<h4>Expected result</h4>

The build should fail telling the user that the version of VS is unsupported in this version of the SDK

<h3>Comments</h3>

<ol>
<li>Ewan Harris 2016-12-01

   </li>
<li>Ewan Harris 2016-12-01

   Not necessarily fixed, windowslib can not detect VS as the registry keys have changed. Investigating</li>
<li>Kota Iguchi 2019-06-05

   I think this ticket can be closed for now because we already support VS 2017. Feel free to create new ticket if we have similar issue on latest environment.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23537.json">JSON Source</a></p>