---
title: "[TIMOB-23722] Hyperloop: Classes that are unavailable on watchOS/tvOS are also not compiled on iOS"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-08-18T08:48:05.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.5.0, hyperloop 1.2.7</td></tr>
<tr><th>Components</th><td>Hyperloop, iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Jan Vennemann</td></tr>
<tr><th>Created</th><td>2016-08-03T20:00:04.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-31T22:15:54.000+0000</td></tr>
</table>

<h3>Description</h3>

The <code>CLBeaconRegion</code> class and others (TIMOB-2377) do not work. -We need the reason why only certain classes do not work and what their pattern is-. The problem is that classes that have the unavailable-macro for watchOS/tvOS during the metabase AST-analysis.

In detail, these two bad boys produce the problems:
<code><pre>
__TVOS_PROHIBITED __WATCHOS_PROHIBITED
</pre></code>
So we need to check for them explicitly and only skip a class when <code>__IOS_UNAVAILABLE</code> occurs.

Example: 
<code><pre>
var CLBeaconRegion = require("CoreLocation/CLBeaconRegion");
var NSUUID = require("Foundation/NSUUID");

var uuid = NSUUID.alloc().initWithUUIDString("B9407F30-F5F8-466E-AFF9-25556B57FE6D");
var region = CLBeaconRegion.alloc().initWithProximityUUIDMajorMinorIdentifier(uuid, 1, 1, "com.appcelerator.beacons");
</pre></code>

*Expected behavior*: The initialization of the object works.
*Actual behavior*: The following log is thrown and the object is not initialized:
<code><pre>
[ERROR] Script Error {
[ERROR]     column = 42;
[ERROR]     line = 12;
[ERROR]     message = "undefined is not a function (evaluating 'CLBeaconRegion.alloc()')";
[ERROR]     sourceURL = "file:///Users/hans/Library/Developer/CoreSimulator/Devices/765A790D-A9C5-4C7C-B3F7-15D024664D22/data/Containers/Bundle/Application/260A0F3D-2B17-4735-95ED-EBFB46671133/Hyperloop_Sample.app/alloy/controllers/beacons.js";
[ERROR]     stack = "startDiscovery@file:///Users/hans/Library/Developer/CoreSimulator/Devices/765A790D-A9C5-4C7C-B3F7-15D024664D22/data/Containers/Bundle/Application/260A0F3D-2B17-4735-95ED-EBFB46671133/Hyperloop_Sample.app/alloy/controllers/beacons.js:12:42";
[ERROR] 
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23722_60064/hyperloop.zip">hyperloop.zip</td></td><td>2016-08-17T15:35:04.000+0000</td><td>2360110</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23722_60062/Simulator Screen Shot 17.08.2016, 17.25.37.png">Simulator Screen Shot 17.08.2016, 17.25.37.png</td></td><td>2016-08-17T15:35:08.000+0000</td><td>76276</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23722_60063/Simulator Screen Shot 17.08.2016, 17.32.43.png">Simulator Screen Shot 17.08.2016, 17.32.43.png</td></td><td>2016-08-17T15:35:08.000+0000</td><td>60867</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Francisco Ruaro Varisco 2016-08-17

   No news about this?
   I'm having the same issue.</li>
<li>Jan Vennemann 2016-08-17

   Could someone please zip their hyperloop folder under the build directory and attach it to this issue? I'm trying to reproduce this but seeing another error regarding CLBeaconReagion at the moment and i would like to compare the generated files.</li>
<li>Jan Vennemann 2016-08-17

   PR: <a href="https://github.com/appcelerator/hyperloop.next/pull/60" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/60</a>
   
   This fixes classes like CLBeaconRegion and UIStepper (TIMOB-23777) being unavailable in Hyperloop. Tested it with with the example given here, Hyperloop Examples Project and the environment described in this ticket. Since the error reported here is a little different from the one i was able to reproduce, this might need some more testing and verification. </li>
<li>Hans Knöchel 2016-08-17

   PR approved and merged. I will bump the 1.2.7 then and publish the new release for QE</li>
<li>Lee Morris 2017-03-31

   Closing ticket as fixed, if there are any problems, please file a new ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23722.json">JSON Source</a></p>