---
title: "[TIMOB-23726] iOS: Debugger for Alloy project hangs on Device with run-on-main-thread enabled"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2016-08-25T02:13:20.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.4.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>needs-5_5_X-Backport, qe-5.4.0, regression</td></tr>
<tr><th>Reporter</th><td>Harry Bryant</td></tr>
<tr><th>Assignee</th><td>Angel Petkov</td></tr>
<tr><th>Created</th><td>2016-08-04T00:19:53.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-20T21:26:43.000+0000</td></tr>
</table>

<h3>Description</h3>

Running an Alloy project in Debug mode to Device causes the app to hang on "The Debugger is waiting for you to launch the app on your device".

*This is a Regression from 5.3.0.GA*
The hang does not occur on simulator.
The hang does not occur for a classic titanium mobile project.
The hang does not occur with run-on-main-thread disabled.

<h4>Steps to Reproduce</h4>

1. Create a new Default Alloy Project.
2. Add breakpoints to the project, preferably in the index.js file.
3. Ensure that your iOS device and Computer are connected to the same WiFi Network.
4. Run the app to an iOS device in Debug mode.

<h4>Actual Result</h4>

Device and Studio hangs on "Waiting for Debugger to Connect"

<h4>Expected Result</h4>

Device and Studio should not hang.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-23726_60074/screenshot-1.png">screenshot-1.png</td></td><td>2016-08-17T22:08:56.000+0000</td><td>7576</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-23726_60075/screenshot-2.png">screenshot-2.png</td></td><td>2016-08-17T22:13:07.000+0000</td><td>7628</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Chee Kiat Ng 2016-08-04

   [~htbryant] Is this with run-on-main-thread enabled or disabled? And I need to know if this is a regression. </li>
<li>Harry Bryant 2016-08-04

   [~cng] Edited the above description, it only occurs when run-on-main-thread is enabled. Checked for regression, 5.3.1.GA is affected but 5.3.0.GA works fine.</li>
<li>Harry Bryant 2016-08-05

   Additionally, tested with run-on-main-thread enabled with 5.3.0.GA and was able to reproduce the same behaviour as that of 5.4.0</li>
<li>Chee Kiat Ng 2016-08-16

   Additional findings:
   This only happens specifically in one scenario. Hangs on device with run-on-main-thread enabled.
   Doesn't matter if it's alloy or classic. And it doesn't happen on simulator.
   
   </li>
<li>Chee Kiat Ng 2016-08-16

   [~htbryant] I can't reproduce it. with this environment:
   APPC CLI 5.4.0-31
   Titanium SDK 5.4.0.v20160802165655
   iPhone 6S Plus device
   Alloy project
   run-on-main-thread true
   
   I did get it stuck once, on a classic project on device. But when i came back to revisit it, it worked again.I'm suspecting that this 'hanging' issue is unrelated to run-on-main-thread. Even when i visit the debugger code, there seems to be at no point it makes any distinguishing between device and simulator code for run-on-main-thread.
   
   Can you retry a few more times? And probably come up with an accurate matrix of combination of environments that can reproduce it consistently?
   </li>
<li>Harry Bryant 2016-08-17

   [~cng] After reinvestigating this issue, I've found a consistent pattern with the Debugger hang:
   !screenshot-2.png!
   
   It seems that with run-on-main-thread set to <code>TRUE</code> in a 5.4.0 SDK built app, the debugger will function correctly upon a fresh build, but will hang on subsequent builds. when run-on-main-thread is set to <code>FALSE</code> in a 5.4.0 SDK built app, clean and subsequent builds will not hang.
   
   Tested On:
   iPhone 6S (9.3.4) Device
   Mac OSX El Capitan 10.11.6
   Ti SDK: 5.4.0.GA
   Appc Studio: 4.7.0.201607250649
   Appc NPM: 4.2.7
   App CLI: 5.4.0-31
   Xcode 8.0 beta 6 (8S193k)
   Node v4.4.7
   </li>
<li>Chee Kiat Ng 2016-08-18

   GRRRRR. I can't reproduce this. 
   APPC CLI 5.5.0-1
   Titanium SDK 5.4.0.v20160802165655
   iPhone 6S Plus device
   APpc NPM: 4.2.7
   Xcode 7.3.1
   Node v4.2.2
   Studio 4.7.0.201607250649
   
   BUT. one thing i did realise was, i was able to reproduce consistently using Node 0.12.7, or was it 0.10.40. because i forgot to set it back to 4.2.2 when testing some other PRs. 
   </li>
<li>Chee Kiat Ng 2016-08-18

   GRRRR. I tried again with an environment much more similar to yours:
   iPhone 6S Plus (9.3.4) Device 
   Mac OSX El Capitan 10.11.6 
   Ti SDK: 5.4.0.v20160802165655
   Appc Studio: 4.7.0.201607250649 
   Appc NPM: 4.2.7 
   App CLI: 5.4.0-31 
   Xcode 7.3.1
   Node v4.4.7
   
   And i run a 2nd a 3rd and it's still wooooorking.</li>
<li>Harry Bryant 2016-08-24

   So after a full investigation of this issue using 5_5_X components, it was found that the debugger will hang on device with the "Waiting for Debugger to Connect" alert when setting a breakpoint at $.index.open(). _(or win.open() for classic)_ However once you press the "resume" button the alert is dismissed and debugging can continue as normal. It was determined that due to the implementation of main thread (5.4.0), there was an issue with the alert being dismissed correctly, as it was being run on an another thread.</li>
<li>Chee Kiat Ng 2016-08-25

    Since debugger works as per normal, stopping at the breakpoints, I'll be resolving this ticket as invalid. the "Waiting for Debugger to Connect" only stays there if the breakpoint is set at $index.open(). </li>
<li>Lee Morris 2017-03-20

    Closing ticket as invalid.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23726.json">JSON Source</a></p>