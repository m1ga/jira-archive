---
title: "[TIMOB-23729] Hyperloop: iOS: Local-embedded frameworks not working with TICORE"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-08-04T10:13:27.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.4.0</td></tr>
<tr><th>Components</th><td>Hyperloop, iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Chee Kiat Ng</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2016-08-04T09:41:35.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-31T22:27:59.000+0000</td></tr>
</table>

<h3>Description</h3>

Just found out that local frameworks will get a build failure if <use-jscore-framework>false</use-jscore-framework>

You are going to need this framework and this tessdata.
<a href="https://github.com/gali8/Tesseract-OCR-iOS" rel="nofollow" target="_blank">https://github.com/gali8/Tesseract-OCR-iOS</a>
<a href="https://github.com/tesseract-ocr/tessdata" rel="nofollow" target="_blank">https://github.com/tesseract-ocr/tessdata</a>

or look for [~jlongton].

<h4>Steps to reproduce</h4>

1. *appc new --classic*
2. install the packaged hyperloop module here: <a href="https://github.com/appcelerator/hyperloop.next/releases/tag/1.2.5" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/releases/tag/1.2.5</a>
3. in tiapp.xml include
<code><pre>
<ios>
	<use-app-thinning>false</use-app-thinning>
	<use-jscore-framework>false</use-jscore-framework>
</ios>

<modules>
	<module platform="iphone" version="1.2.5">hyperloop</module>
</modules>

<plugins>
	<plugin>hyperloop</plugin>
</plugins>
</pre></code>
4. create a <code>src</code> folder and put TesseractOCR.framework in
5. add <code>Lenore3.png</code> to Resources/iPhone
6. add tessdata folder to Resources/iPhone
7. create a <code>appc.js</code> file, and use this as content 
<code><pre>
/**
 * Hyperloop configuration
 */


module.exports = {
	type: 'app',
	group: 'titanium',
	dependencies: {
	},
	hyperloop: {
		ios: {
			xcodebuild: {
				/**
				 * any flags available to be passed into the Xcode can be
				 * included here to further customize the xcode build
				 */
				flags: {
//					GCC_PREPROCESSOR_DEFINITIONS: 'foo=bar'
					FRAMEWORK_SEARCH_PATHS: '../../src'
				},
				/**
				 * this sample doesn't use StoreKit but this demonstrates
				 * how you can bring in frameworks explicitly. Hyperloop
				 * will automatically determine the required frameworks
				 * but in case you want to force a specific version, you can
				 * include it here
				 */
				frameworks: [
					'TesseractOCR'
				]
			},
			/**
			 * optionally, you can bring in third-party or first-party libraries,
			 * source code, resources etc. by including them here. The 'key' is the
			 * name of the package that will be used in the require (if code).
			 * the values can either be an Array or String value to the directory
			 * where the files are located
			 */
			thirdparty: {
				'TesseractOCR': {
					// these can be an array or string
					source: ['src'],
					header: 'src',
					resource: 'src'
				}
			}
		}
	}
};
</pre></code>
6. in <code>Resources/app.js</code>, use this
<code><pre>
var G8Tesseract = require('TesseractOCR/G8Tesseract');
var UIImage = require('UIKit/UIImage');

var win = Ti.UI.createWindow({
	backgroundColor: 'white',
	layout: 'vertical'
});

var imageView = Ti.UI.createImageView({
	image: 'Lenore3.png'
});

win.add(imageView);

var btn = Ti.UI.createButton({
	title: 'OCR THIS'
});

win.add(btn);

var textArea = Ti.UI.createTextArea({
	borderWidth: 2,
	borderColor: 'blue',
	width: Ti.UI.FILL,
	height: Ti.UI.FILL
});
win.add(textArea);

btn.addEventListener('click', function(e) {
	var tess = G8Tesseract.alloc().initWithLanguage('eng+ita');
	var img = UIImage.imageNamed('Lenore3.png');	
	tess.setImage(img);
	tess.recognize();
	textArea.setValue(tess.recognizedText.toString());
});

win.open();
</pre></code>

<h4>Expected Result</h4>
app builds flawlessly

<h4>Actual Result</h4>
<code><pre>
[TRACE] :  /Users/kiat/titaniumTestWatch/HLTesseract/build/iphone/Classes/TiToJS.h:125:9: fatal error: 'JavaScriptCore/TiCore.h' file not found
[TRACE] :  #import "JavaScriptCore/TiCore.h"
[TRACE] :          ^
[TRACE] :  1 error generated.
[ERROR] ** BUILD FAILED **
[ERROR] The following build commands failed:
[ERROR]         CompileC build/Intermediates/HLTesseract.build/Debug-iphonesimulator/HLTesseract.build/Objects-normal/x86_64/TiFile.o Classes/TiFile.m normal x86_64 objective-c com.apple.compilers.llvm.clang.1_0.compiler
</pre></code>

<h3>Comments</h3>

<ol>
<li>Chee Kiat Ng 2016-08-04

   PRs:
   <a href="https://github.com/appcelerator/hyperloop.next/pull/51" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/51</a>
   <a href="https://github.com/appcelerator/hyperloop.next/pull/50" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/50</a>
   
   And you can test easily with this pre-release <a href="https://github.com/appcelerator/hyperloop.next/releases/tag/1.2.6_b1" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/releases/tag/1.2.6_b1</a></li>
<li>Hans Knöchel 2016-08-04

   PR's (master & 1_2_X) merged. Do we want this in 5.4.0.GA as well?</li>
<li>Josh Longton 2016-08-09

   [~cng] I am not able to run the Tesseract application on a device.
   
   <h4>Tested on</h4>
   
   {noformat}
   iPhone 6s plus (9.3.1)
   iPhone 5 (9.1)
   iPhone Simulator (9.3)
    Mac OSX El Capitan 10.11.6
   Studio: 4.7.0.201607250649
    Ti SDK: 5.4.0.v20160809033140
    Appc NPM: 4.2.7
   Appc CLI: 5.4.0-40
   Xcode 7.3.1
   Node: v4.4.4
   Hyperloop: 1.2.6
   CocoaPods: 1.0.1
   {noformat}
   
   <h4>Simulator </h4>
   On the simulator the application works just throwing a <code>failed to load</code> error for the language params. 
   {noformat}
   [ERROR] : failed to load /Users/Josh/Library/Developer/CoreSimulator/Devices/D5EEC5AB-078C-46AA-AC55-05BBBD410CB7/data/Containers/Bundle/Application/FA4E6363-7592-4B2C-BD6D-8425F3B56303/Josh-HyperLoop-Test-app.app/tessdata/ita.special-words
   [ERROR] Using default language params
   {noformat}
   
   <h4>Device </h4>
   On the device the application throws an application error as soon as <code>OCR this</code> is clicked. 
   
   {noformat}
   [ERROR] Cannot find class with name: G8Tesseract
   [ERROR] Script Error {
   [ERROR]     column = 32;
   [ERROR]     description = "Cannot find class with name: G8Tesseract";
   [ERROR]     line = 105;
   [ERROR]     message = "Cannot find class with name: G8Tesseract";
   [ERROR]     name = ClassNotFound;
   [ERROR]     nativeStack = "1   libobjc.A.dylib                     0x36e9edff objc_exception_throw + 38\n2   Josh-HyperLoop-Test-app             0x0023ac3d Josh-HyperLoop-Test-app + 1723453\n3   Josh-HyperLoop-Test-app             0x00233b5d Josh-HyperLoop-Test-app + 1694557\n4   JavaScriptCore                      0x26e31de3 <redacted> + 366\n5   JavaScriptCore                      0x26bf9d43 <redacted> + 314\n6   JavaScriptCore                      0x26bf856d <redacted> + 120\n7   JavaScriptCore                      0x26ebf393 <redacted> + 20386\n8   JavaScriptCore                      0x26ebf39d <redacted> + 20396\n9   JavaScriptCore                      0x26eba1e1 <redacted> + 336\n10  JavaScriptCore                      0x26e136b7 <redacted> + 102\n11  JavaScriptCore                      0x26bfc9f9 <redacted> + 344\n12  JavaScriptCore                      0x26bfc89d _ZN3JSC4callEPNS_9ExecStateENS_7JSValueENS_8CallTypeERKNS_8CallDataES2_RKNS_7ArgListE + 60\n13  JavaScriptCore                      0x26dbf73f <redacted> + 126\n14  JavaScriptCore                      0x26f185b7 _ZNK3JSC12PropertySlot14functionGetterEPNS_9ExecStateE + 42\n15  JavaScriptCore                      0x26bf4101 <redacted> + 1408\n16  JavaScriptCore                      0x26ebc83d <redacted> + 9292\n17  JavaScriptCore                      0x26ebf39d <redacted> + 20396\n18  JavaScriptCore                      0x26eba1e1 <redacted> + 336\n19  JavaScriptCore                      0x26e136b7 <redacted> + 102\n20  JavaScriptCore                      0x26bfc9f9 <redacted> + 344\n21  JavaScriptCore                      0x26bfc89d _ZN3JSC4callEPNS_9ExecStateENS_7JSValueENS_8CallTypeERKNS_8CallDataES2_RKNS_7ArgListE + 60\n22  JavaScriptCore                      0x26bfc7b5 JSObjectCallAsFunction + 300\n23  Josh-HyperLoop-Test-app             0x001d9e15 Josh-HyperLoop-Test-app + 1326613\n24  Josh-HyperLoop-Test-app             0x00136c25 Josh-HyperLoop-Test-app + 658469\n25  Josh-HyperLoop-Test-app             0x001d9d0f Josh-HyperLoop-Test-app + 1326351\n26  Josh-HyperLoop-Test-app             0x001d9f9d Josh-HyperLoop-Test-app + 1327005\n27  Josh-HyperLoop-Test-app             0x000b45bf Josh-HyperLoop-Test-app + 124351\n28  Josh-HyperLoop-Test-app             0x000b46ab Josh-HyperLoop-Test-app + 124587\n29  Josh-HyperLoop-Test-app             0x00136c25 Josh-HyperLoop-Test-app + 658469\n30  Josh-HyperLoop-Test-app             0x000b466d Josh-HyperLoop-Test-app + 124525\n31  Josh-HyperLoop-Test-app             0x001da02b Josh-HyperLoop-Test-app + 1327147\n32  Josh-HyperLoop-Test-app             0x001d963d Josh-HyperLoop-Test-app + 1324605\n33  Josh-HyperLoop-Test-app             0x0011b217 Josh-HyperLoop-Test-app + 545303\n34  Josh-HyperLoop-Test-app             0x000d5045 Josh-HyperLoop-Test-app + 258117\n35  Josh-HyperLoop-Test-app             0x0010daef Josh-HyperLoop-Test-app + 490223\n36  Josh-HyperLoop-Test-app             0x0011ae63 Josh-HyperLoop-Test-app + 544355\n37  Josh-HyperLoop-Test-app             0x0010ff9d Josh-HyperLoop-Test-app + 499613\n38  UIKit                               0x299495e1 <redacted> + 80\n39  UIKit                               0x29949571 <redacted> + 64\n40  UIKit                               0x29931487 <redacted> + 446\n41  UIKit                               0x29948ec1 <redacted> + 616\n42  UIKit                               0x29948b2f <redacted> + 646\n43  UIKit                               0x2994144f <redacted> + 642\n44  UIKit                               0x299122f1 <redacted> + 204\n45  UIKit                               0x29910937 <redacted> + 5134\n46  CoreFoundation                      0x257a07c7 <redacted> + 14\n47  CoreFoundation                      0x257a03b7 <redacted> + 454\n48  CoreFoundation                      0x2579e71f <redacted> + 806\n49  CoreFoundation                      0x256f10d9 CFRunLoopRunSpecific + 516\n50  CoreFoundation                      0x256f0ecd CFRunLoopRunInMode + 108\n51  GraphicsServices                    0x2ea66af9 GSEventRunModal + 160\n52  UIKit                               0x2997a2dd UIApplicationMain + 144\n53  Josh-HyperLoop-Test-app             0x0009cf3f Josh-HyperLoop-Test-app + 28479\n54  libdyld.dylib                       0x375ec873 <redacted> + 2";
   [ERROR]     sourceURL = "file:///var/mobile/Containers/Bundle/Application/967340AF-0866-4BDE-AFED-1F86CC245A15/Josh-HyperLoop-Test-app.app/hyperloop/tesseractocr/g8tesseract.js";
   [ERROR] } 
   {noformat}
   
   *I have attached my application used [here](<a href="https://www.dropbox.com/s/34w2fl884ea83m2/Josh-HyperLoop-Test-app.zip?dl=0)" rel="nofollow" target="_blank">https://www.dropbox.com/s/34w2fl884ea83m2/Josh-HyperLoop-Test-app.zip?dl=0)</a>*
   </li>
<li>Lee Morris 2017-03-31

   Closing ticket as fixed, if there are any problems, please file a new ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23729.json">JSON Source</a></p>