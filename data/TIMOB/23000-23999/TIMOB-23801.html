---
title: "[TIMOB-23801] Titanium Android module build fails with Titanium SDK 6.1.0"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-09-02T20:30:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.0.0, Release 6.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.0.0</td></tr>
<tr><th>Components</th><td>Android, Tooling</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Chris Barber</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2016-08-22T19:22:28.000+0000</td></tr>
<tr><th>Updated</th><td>2016-09-15T22:02:12.000+0000</td></tr>
</table>

<h3>Description</h3>

When building an Android module, the build fails:

<code><pre>
[ERROR] Failed to run ndk-build
[ERROR]   
[ERROR] jni/Android.mk:35: warning: overriding commands for target <code>/Users/chris/appc/workspace/mymodule/android/build/generated/KrollGeneratedBindings.cpp'
[ERROR] jni/Android.mk:35: warning: ignoring old commands for target </code>/Users/chris/appc/workspace/mymodule/android/build/generated/KrollGeneratedBindings.cpp'
[ERROR] In file included from jni/com.appcelerator.mymodule.ExampleProxy.h:12:0,
[ERROR]                  from jni/com.appcelerator.mymodule.ExampleProxy.cpp:10:
[ERROR] /Users/chris/Library/Application Support/Titanium/mobilesdk/osx/6.1.0/android/native/include/Proxy.h:11:16: fatal error: v8.h: No such file or directory
[ERROR]  #include <v8.h>
[ERROR]                 ^
[ERROR] compilation terminated.
[ERROR] make: *** [/Users/chris/appc/workspace/mymodule/android/build/generated/obj/local/armeabi-v7a/objs/com.appcelerator.mymodule/com.appcelerator.mymodule.ExampleProxy.o] Error 1
</pre></code>

To reproduce:

<code><pre>
ti create -t module -n mymodule --id com.appc.mymodule -p all -d .
cd mymodule/android
ti build -p android --build-only
</pre></code>

We're also seeing:

<code><pre>
[ERROR] Failed to compile Java source files:
[ERROR]   
[ERROR] warning: [options] bootstrap class path not set in conjunction with -source 1.6
[ERROR] Note: [KrollBindingGen] Running Kroll binding generator.
[ERROR] Note: [KrollBindingGen] No binding data found, creating new data file: org.appcelerator.titanium.bindings/123abc.json
[ERROR] Note: [KrollBindingGen] Found binding for proxy Example
[ERROR] Note: [KrollBindingGen] Found binding for module my123abc
[ERROR] Note: [KrollBindingGen] Generating JSON: file:/Users/chris/appc/workspace/123abc/android/build/generated/json/org/appcelerator/titanium/bindings/123abc.json
[ERROR] /Users/chris/appc/workspace/123abc/android/src/com/test/app/ExampleProxy.java:32: error: cannot find symbol
[ERROR]         private static final boolean DBG = TiConfig.LOGD;
[ERROR]                                            ^
[ERROR]   symbol:   variable TiConfig
[ERROR]   location: class ExampleProxy
[ERROR] /Users/chris/appc/workspace/123abc/android/src/com/test/app/ExampleProxy.java:81: error: cannot find symbol
[ERROR]         		Log.d(LCAT, "example created with message: " + options.get("message"));
[ERROR]         		^
[ERROR]   symbol:   variable Log
[ERROR]   location: class ExampleProxy
[ERROR] /Users/chris/appc/workspace/123abc/android/src/com/test/app/ExampleProxy.java:89: error: cannot find symbol
[ERROR]         	Log.d(LCAT, "printing message: " + message);
[ERROR]         	^
[ERROR]   symbol:   variable Log
[ERROR]   location: class ExampleProxy
[ERROR] /Users/chris/appc/workspace/123abc/android/src/com/test/app/ExampleProxy.java:102: error: cannot find symbol
[ERROR]             Log.d(LCAT, "Tried setting module message to: " + message);
[ERROR]             ^
[ERROR]   symbol:   variable Log
[ERROR]   location: class ExampleProxy
[ERROR] 4 errors
</pre></code>

<h3>Comments</h3>

<ol>
<li>Ashraf Abu 2016-08-24

   Able to reproduce.
   Looks like a CLI or Tooling issue?
   
   Using <code><pre> ant </pre></code> works and compiles the android module.</li>
<li>Feon Sua Xin Miao 2016-08-31

   <code>ant</code> fails for me too. Ti SDK 6.0.0.v20160830110225.
   
   <code><pre>
   process.annotations:
       [javac] Compiling 2 source files to /Users/feonsua/work/testapps/abc123/android/build/classes
       [javac] warning: [options] bootstrap class path not set in conjunction with -source 1.6
       [javac] Note: [KrollBindingGen] Running Kroll binding generator.
       [javac] Note: [KrollBindingGen] Succesfully loaded existing binding data: /Users/feonsua/work/testapps/abc123/android/build/generated/json/org/appcelerator/titanium/bindings/abc123.json
       [javac] Note: [KrollBindingGen] Found binding for module Abc123
       [javac] Note: [KrollBindingGen] Found binding for proxy Example
       [javac] /Users/feonsua/work/testapps/abc123/android/src/com/test/app/ExampleProxy.java:15: error: cannot find symbol
       [javac] import org.appcelerator.titanium.util.Log;
       [javac]                                      ^
       [javac]   symbol:   class Log
       [javac]   location: package org.appcelerator.titanium.util
       [javac] /Users/feonsua/work/testapps/abc123/android/src/com/test/app/ExampleProxy.java:16: error: cannot find symbol
       [javac] import org.appcelerator.titanium.util.TiConfig;
       [javac]                                      ^
       [javac]   symbol:   class TiConfig
       [javac]   location: package org.appcelerator.titanium.util
       [javac] Note: [KrollBindingGen] Generating JSON: file:/Users/feonsua/work/testapps/abc123/android/build/generated/json/org/appcelerator/titanium/bindings/abc123.json
       [javac] 2 errors
   
   BUILD FAILED
   
   </pre></code></li>
<li>Ashraf Abu 2016-09-01

   The error faced by you is a different error.
   The classes created eg, <code>android/titanium/src/java/org/appcelerator/titanium/util/Log.java</code> were removed in <a href="https://github.com/appcelerator/titanium_mobile/pull/8101" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8101</a> TIMOB-20221
   
   Meaning, the default module that is created needs to be updated. (cc: [~cwilliams]) (We would need to create a ticket to address this issue).
   
   If you remove the classes in the code that the error is talking about, it will work.</li>
<li>Ashraf Abu 2016-09-01

   This would also mean default module creation in SDK 6.0.0 is broken with this same issue.</li>
<li>Ashraf Abu 2016-09-01

   I believe I need to update <a href="https://github.com/appcelerator/titanium_mobile/blob/415bd6c66dcc55b1a59a59574f3babd3c3a84ede/android/templates/module/default/template/android/src/%7B%7BModuleIdAsFolder%7D%7D/ExampleProxy.java.ejs" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/415bd6c66dcc55b1a59a59574f3babd3c3a84ede/android/templates/module/default/template/android/src/%7B%7BModuleIdAsFolder%7D%7D/ExampleProxy.java.ejs</a></li>
<li>Ashraf Abu 2016-09-01

   [~fmiao] To make <code>ant</code> work, please edit the ExampleProxy.java in this manner:
   
   <h4>Change line 15 : <code>import org.appcelerator.titanium.util.Log;</code> to <code>import org.appcelerator.kroll.common.Log;</code></h4>
   <h4>Comment line 16: <code>import org.appcelerator.titanium.util.TiConfig;</code> to <code>import org.appcelerator.kroll.common.TiConfig;</code></h4>
   
   In the mean time, I'm doing a PR to update the template.</li>
<li>Ashraf Abu 2016-09-01

   Master PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8303" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8303</a>
   6_0_X PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8304" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8304</a>
   [~cbarber] for your review.
   
   This fixes the compilation issue. Ant will compile.
   
   After this is merged and Ant working again, the main issue of this ticket can then be looked into for investigation.</li>
<li>Chris Barber 2016-09-01

   Usage of Ant has been deprecated and replaced by a fantastic Node.js-based build command. Upon applying your patch, I create a new module, then build it by running <code>ti build -p android --build-only</code>. The build fails with the following error:
   
   <code><pre>
   [ERROR] Failed to run ndk-build
   [ERROR]   
   [ERROR] jni/Android.mk:35: warning: overriding commands for target <code>/Users/chris/appc/workspace/mymodule/android/build/generated/KrollGeneratedBindings.cpp'
   [ERROR] jni/Android.mk:35: warning: ignoring old commands for target </code>/Users/chris/appc/workspace/mymodule/android/build/generated/KrollGeneratedBindings.cpp'
   [ERROR] In file included from jni/../MymoduleBootstrap.cpp:17:0:
   [ERROR] /Users/chris/appc/workspace/mymodule/android/build/generated/KrollGeneratedBindings.gperf:14:28: warning: declaration 'struct titanium::bindings::BindEntry' does not declare anything
   [ERROR]  struct titanium::bindings::BindEntry;
   [ERROR]                             ^
   [ERROR] jni/../MymoduleBootstrap.cpp: In function 'v8::Local<v8::Value> Mymodule_getBinding(const v8::FunctionCallbackInfo<v8::Value>&)':
   [ERROR] jni/../MymoduleBootstrap.cpp:31:126: error: invalid conversion from 'const char*' to 'const uint8_t* {aka const unsigned char*}' [-fpermissive]
   [ERROR]    isolate->ThrowException(Exception::Error(String::NewFromOneByte(isolate, "Mymodule.getBinding requires 1 argument: binding")));
   [ERROR]                                                                                                                               ^
   [ERROR] In file included from jni/../MymoduleBootstrap.cpp:10:0:
   [ERROR] /Users/chris/Library/Application Support/Titanium/mobilesdk/osx/6.1.0/android/native/include/v8.h:2332:24: note: initializing argument 2 of 'static v8::Local<v8::String> v8::String::NewFromOneByte(v8::Isolate*, const uint8_t*, v8::String::NewStringType, int)'
   [ERROR]    static V8_DEPRECATED(
   [ERROR]                         ^
   [ERROR] jni/../MymoduleBootstrap.cpp:32:3: error: return-statement with no value, in function returning 'v8::Local<v8::Value>' [-fpermissive]
   [ERROR]    return;
   [ERROR]    ^
   [ERROR] jni/../MymoduleBootstrap.cpp:57:33: error: too few arguments to function 'v8::Local<v8::Primitive> v8::Undefined(v8::Isolate*)'
   [ERROR]    return scope.Escape(Undefined());
   [ERROR]                                  ^
   [ERROR] In file included from jni/../MymoduleBootstrap.cpp:10:0:
   [ERROR] /Users/chris/Library/Application Support/Titanium/mobilesdk/osx/6.1.0/android/native/include/v8.h:324:27: note: declared here
   [ERROR]    friend Local<Primitive> Undefined(Isolate* isolate);
   [ERROR]                            ^
   [ERROR] jni/../MymoduleBootstrap.cpp:61:36: error: request for member 'GetCurrentContext' in 'isolate', which is of pointer type 'v8::Isolate*' (maybe you meant to use '->' ?)
   [ERROR]   extBinding->bind(exports, isolate.GetCurrentContext());
   [ERROR]                                     ^
   [ERROR] jni/../MymoduleBootstrap.cpp: In function 'void Mymodule_init(v8::Local<v8::Object>, v8::Local<v8::Context>)':
   [ERROR] jni/../MymoduleBootstrap.cpp:73:81: error: invalid conversion from 'const char*' to 'const uint8_t* {aka const unsigned char*}' [-fpermissive]
   [ERROR]    Local<String> name = String::NewFromOneByte(isolate, titanium::natives[i].name);
   [ERROR]                                                                                  ^
   [ERROR] In file included from jni/../MymoduleBootstrap.cpp:10:0:
   [ERROR] /Users/chris/Library/Application Support/Titanium/mobilesdk/osx/6.1.0/android/native/include/v8.h:2332:24: note: initializing argument 2 of 'static v8::Local<v8::String> v8::String::NewFromOneByte(v8::Isolate*, const uint8_t*, v8::String::NewStringType, int)'
   [ERROR]    static V8_DEPRECATED(
   [ERROR]                         ^
   [ERROR] jni/../MymoduleBootstrap.cpp:80:59: error: invalid conversion from 'const char*' to 'const uint8_t* {aka const unsigned char*}' [-fpermissive]
   [ERROR]   exports->Set(String::NewFromOneByte(isolate, "getBinding"), FunctionTemplate::New(isolate, Mymodule_getBinding)->GetFunction(context).ToLocalChecked());
   [ERROR]                                                            ^
   [ERROR] In file included from jni/../MymoduleBootstrap.cpp:10:0:
   [ERROR] /Users/chris/Library/Application Support/Titanium/mobilesdk/osx/6.1.0/android/native/include/v8.h:2332:24: note: initializing argument 2 of 'static v8::Local<v8::String> v8::String::NewFromOneByte(v8::Isolate*, const uint8_t*, v8::String::NewStringType, int)'
   [ERROR]    static V8_DEPRECATED(
   [ERROR]                         ^
   [ERROR] jni/../MymoduleBootstrap.cpp:80:112: error: invalid conversion from 'v8::Local<v8::Value> (*)(const v8::FunctionCallbackInfo<v8::Value>&)' to 'v8::FunctionCallback {aka void (*)(const v8::FunctionCallbackInfo<v8::Value>&)}' [-fpermissive]
   [ERROR]   exports->Set(String::NewFromOneByte(isolate, "getBinding"), FunctionTemplate::New(isolate, Mymodule_getBinding)->GetFunction(context).ToLocalChecked());
   [ERROR]                                                                                                                 ^
   [ERROR] In file included from jni/../MymoduleBootstrap.cpp:10:0:
   [ERROR] /Users/chris/Library/Application Support/Titanium/mobilesdk/osx/6.1.0/android/native/include/v8.h:4477:34: note: initializing argument 2 of 'static v8::Local<v8::FunctionTemplate> v8::FunctionTemplate::New(v8::Isolate*, v8::FunctionCallback, v8::Local<v8::Value>, v8::Local<v8::Signature>, int)'
   [ERROR]    static Local<FunctionTemplate> New(
   [ERROR]                                   ^
   [ERROR] make: *** [/Users/chris/appc/workspace/mymodule/android/build/generated/obj/local/armeabi-v7a/objs/com.appc.mymodule/__/MymoduleBootstrap.o] Error 1
   </pre></code></li>
<li>Ashraf Abu 2016-09-02

   This seems V8 related. [~cwilliams] Can you help?</li>
<li>Christopher Williams 2016-09-02

    Master/6.1.X: <a href="https://github.com/appcelerator/titanium_mobile/pull/8306" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8306</a>
    6.0.X: <a href="https://github.com/appcelerator/titanium_mobile/pull/8307" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8307</a></li>
<li>Christopher Williams 2016-09-02

    When I updated V8, I had updated the templates used by the ant/python module build system. There's a parallel set used by the node-based system, which this PR now updates (to effectively match the ones I updated for ant/python).</li>
<li>Lokesh Choudhary 2016-09-15

    Verified the fix.
    
    Android module build does not fail.
    Closing.
    
    Environment:
    Appc Studio : 4.8.0.201609061702
    Ti SDK :  6.0.0.v20160913184210, 6.1.0.v20160915135333
    Ti CLI : 5.0.9
    Alloy : 1.9.1
    MAC El Capitan : 10.11.6
    Appc NPM : 4.2.8-6
    Appc CLI : 6.0.0-38
    Node: 4.4.4
    Nexus 6 - Android 6.0.1
    </li>
</ol>


<p><a href="/TIMOB/TIMOB-23801.json">JSON Source</a></p>