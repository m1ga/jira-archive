---
title: "[TIMOB-23810] iOS: Delay in firing click event listener on View when using run-on-main-thread"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-01-09T22:54:02.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.4.0, Release 5.3.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>listview, run-on-main-thread, scrollableView</td></tr>
<tr><th>Reporter</th><td>Neeraj Mishra</td></tr>
<tr><th>Assignee</th><td>Vijay Singh</td></tr>
<tr><th>Created</th><td>2016-08-23T22:30:48.000+0000</td></tr>
<tr><th>Updated</th><td>2017-01-13T18:59:45.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem Description:</h4>
Customer is having an application with multiple views on the top of the screen and a Scrollable view in the bottom with that many views in it.The issue that they are facing here is with receiving 'click' event when the view in the top is clicked and receiving 'scroll' event when the scrollable view is scrolled. Sometimes there is lot of delay in receiving these events and hence effecting the application's responsiveness.
 
<h4>Steps to re-produce: </h4>
Due to complexity of the app neither we nor customer could reproduce the issue at smaller scale.Attaching app provided from customer which would show the skeleton of the app but do not reproduce the issue.

<h4>Expected Behavior:</h4>

Application should response fast enough when clicking on view on top of the screen or while scrolling the pages.

<h4>Fault Isolation: </h4>
As the ListViews in application has different elements like Label, TextField, Switch.
 Removing the ListViews in the Scrollable View and just keep empty views with a Label in it, the screen is responsive.Does ListViews cause memory issues in the screen if they are heavy with different kinds of elements?

Attaching the skeleton app which customer share with us which will help to understand how different components are used within the app.


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23810_60118/appc.rtf">appc.rtf</td></td><td>2016-08-23T22:22:27.000+0000</td><td>66734</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23810_61020/Bug.zip">Bug.zip</td></td><td>2016-12-06T23:20:42.000+0000</td><td>10474593</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23810_60116/KeyTest.zip">KeyTest.zip</td></td><td>2016-08-23T22:25:22.000+0000</td><td>10475488</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23810_60117/Simulator_Screen_Shot_Aug_12_2016_11.10.53_AM.png">Simulator_Screen_Shot_Aug_12_2016_11.10.53_AM.png</td></td><td>2016-08-23T22:24:36.000+0000</td><td>150349</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ingo Muschenetz 2016-12-01

   [~nmishra] We need a copy of the app that reproduces the problem with click events.</li>
<li>Vijay Singh 2017-01-05

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8728" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8728</a>
   
   
   <code><pre>
   var win = Titanium.UI.createWindow();
   
   var view = Titanium.UI.createView({
     height : 110,
     top : 20,
     backgroundColor : 'red'
   });
   
   view.addEventListener("click", function(e) {
     Ti.API.info('Clicked!');
     Ti.API.info(e.source);
   });
   
   
   var labelBGView = Titanium.UI.createView({
     backgroundColor : 'black',
     height: 100,
     width: 200
   });
   
   var label = Titanium.UI.createLabel({
     text : 'Click on the text',
     backgroundColor : 'green',
     height: 80,
   });
   
   
   labelBGView.add(label);
   view.add(labelBGView);
   
   win.add(view);
   win.open();
   </pre></code></li>
<li>Hans Knöchel 2017-01-05

   Second test-case (from TIMOB-23954):
   <code><pre>
   var index = Ti.UI.createWindow({
       layout: "vertical",
       backgroundColor: "white",
   });
   var viewContainer = Ti.UI.createView({
       layout: "vertical",
       backgroundColor: "white",
   });
    
   index.add(viewContainer);
    
   // Should also be triggered by it's childs
   index.addEventListener("click", function(e) {
       alert("clicked!");
       Ti.API.warn(e.source);
   });
    
   for (var i = 0; i &lt; 10; i++) {
       var view = Ti.UI.createView({
           height: 40,
           backgroundColor: "red"
       });
       view.add(Ti.UI.createLabel({
           text: "Label " + i
       }));
       viewContainer.add(view);
   }
    
   index.open();
   </pre></code></li>
<li>Ricardo Pereira 2017-01-09

   I'm facing the same issue, most of my app views is a ScrollableView with bullets and each page has a ListView with templates.
   
   Even when the ListView is created and the user starts to scroll in it, if he tries to click in a item, it takes some seconds (I prevent this: if he click on multiple items, after that delay, it runs the itemclick event the same number of times that the user clicked on it)
   
   But when the ScrollableView and it's ListView's are created if the user wait that delay time, all events works properly.
   
   Problem: if I'm using a ScrollableView with 2 or 3 pages, each page has a ListView with 4 or more columns, it takes a lot of time to be ready (to handle events), because at this time it's possible to scroll on the ScrollableView and on their ListView's
   
   
   I've 24 templates because I've to cover all the cases for the number of the columns:
   
   !<a href="https://i.stack.imgur.com/hEEKK.png" rel="nofollow" target="_blank">https://i.stack.imgur.com/hEEKK.png</a>!
   !<a href="https://i.stack.imgur.com/ZnieY.png" rel="nofollow" target="_blank">https://i.stack.imgur.com/ZnieY.png</a>!
   
   In order to reach this result:
   
   !<a href="https://i.stack.imgur.com/dbpQU.png" rel="nofollow" target="_blank">https://i.stack.imgur.com/dbpQU.png</a>!
   !<a href="https://s29.postimg.org/cagj2hp9z/Screen_Shot_2017_01_09_at_15_58_18.png" rel="nofollow" target="_blank">https://s29.postimg.org/cagj2hp9z/Screen_Shot_2017_01_09_at_15_58_18.png</a>!</li>
<li>Ricardo Pereira 2017-01-09

   I've made a sample video: [youtube sample video](<a href="https://youtu.be/_Mu-S-y_kjo)" rel="nofollow" target="_blank">https://youtu.be/_Mu-S-y_kjo)</a>
   
   I've clicked on the several ListView items several times</li>
<li>Eric Wieber 2017-01-09

   FR passed, merged.
   
   All click events were recognized on the views in the test cases. Also tested toggling main thread and auto layout. No click events failed to fire.</li>
<li>Ricardo Pereira 2017-01-10

   [~ewieber], this change it's available in the nightly builds available today?</li>
<li>Hans Knöchel 2017-01-10

   It is: <a href="http://builds.appcelerator.com/mobile/master/mobilesdk-6.1.0.v20170110020513-osx.zip" rel="nofollow" target="_blank">http://builds.appcelerator.com/mobile/master/mobilesdk-6.1.0.v20170110020513-osx.zip</a></li>
<li>Ricardo Pereira 2017-01-10

   [~hansknoechel] I've downloaded that sdk version this morning, an build the app with it, but the delay is still happening</li>
<li>Ricardo Pereira 2017-01-10

    [~hansknoechel] and [~ewieber], I've created a simple app using these 2 elements (ScrollableView and ListView) please take a look at this:
    
    After creating the views, in the 'Try me' button, if you click on the rows and scroll to another page, there is a delay before calling the events, but every thing else is working fine.
    
    If there is any other event or function that's called before de delay time is over, it will be called after that delay.
    
    The more you click on 'Try me' the more it happens.
    
    [TIMOB-23810 Test APP](<a href="https://www.zipshare.com/download/eyJhcmNoaXZlSWQiOiIwZDUwZTgyZS01NDdkLTQwMjItYTgzZC1lMTg4ZWFhY2U5MjYiLCJlbWFpbCI6InJqY3BlcmVpcmFAb3V0bG9vay5wdCJ9)" rel="nofollow" target="_blank">https://www.zipshare.com/download/eyJhcmNoaXZlSWQiOiIwZDUwZTgyZS01NDdkLTQwMjItYTgzZC1lMTg4ZWFhY2U5MjYiLCJlbWFpbCI6InJqY3BlcmVpcmFAb3V0bG9vay5wdCJ9)</a>
    
    I can't add files to this ticket so I've updated the sample app tho zipshare, without assets</li>
<li>Hans Knöchel 2017-01-10

    Hey Ricardo,
    
    the test-app cannot be used in it's state. We need a single isolated test-file like used above to test the changes. Your test-case currently also has a lot of unrelated code like database-queries and other UI. 
    
    Are you the original reporter behind this ticket? Because using run-on-main-thread fixed the issue for the initial problem as I read the earlier comments. 
    
    Also make sure you enabled the main-thread like recommended using <code>&lt;property name="run-on-main-thread" type="bool"&gt;true&lt;/property&gt;</code>.</li>
<li>Ricardo Pereira 2017-01-11

    [~hansknoechel], Thanks again for your time, I'll do some more tests and create a single isolated file, if needed I'll create another ticket</li>
<li>Abir Mukherjee 2017-01-13

    As reporter will open a new ticket, closing this one.</li>
<li>Neeraj Mishra 2017-01-13

    [~hansknoechel]: Thanks,  It works fine now.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23810.json">JSON Source</a></p>