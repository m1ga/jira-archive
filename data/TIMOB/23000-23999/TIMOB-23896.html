---
title: "[TIMOB-23896] iOS: Add Ti.App.iOS \"handleurl\" event to handle incoming URL schemes"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-09-13T00:01:12.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.5.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2016-09-12T17:02:30.000+0000</td></tr>
<tr><th>Updated</th><td>2016-09-14T22:14:33.000+0000</td></tr>
</table>

<h3>Description</h3>

We should be able to get notified when a new URL scheme is handled by the application delegate.

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2016-09-12

   Will be fixed as part of TIMOB-23890 and also provides a solution for TIMOB-23884.</li>
<li>Hans Knöchel 2016-09-12

   Demo-code: <a href="https://gist.github.com/hansemannn/d2263475b40469d3f2e4b82f03cc345c" rel="nofollow" target="_blank">https://gist.github.com/hansemannn/d2263475b40469d3f2e4b82f03cc345c</a></li>
<li>Chee Kiat Ng 2016-09-12

   Updated the sample code here:
   <code><pre>
   var safari = require('ti.safaridialog');
   
   var win = Ti.UI.createWindow({
       backgroundColor: 'white'
   })
   
   var btn = Ti.UI.createButton({
       title: "Open safari dialog"
   });
   
   btn.addEventListener("click", function() {
       safari.open({
           url:"<a href="http://hans-knoechel.de/TIMOB-23884.php" rel="nofollow" target="_blank">http://hans-knoechel.de/TIMOB-23884.php</a>",
           title:"Hello World"
       });
   });
   
   Ti.App.iOS.addEventListener("handleurl", function(e) {
       // If the handled url is provided by the safari-dialog, close it (use-case for OAuth)
       if (e.launchOptions.source == "com.apple.SafariViewService") {
           safari.close();
       }
   });
   
   win.add(btn);
   win.open();
   </pre></code>
   [~hansknoechel] But when i click on "Open Test App", I get "Safari cannot open the page because the address is invalid". Not sure what to expect here?</li>
<li>Hans Knöchel 2016-09-12

   Your tiapp.xml must be able to handle the url-scheme <code>safaritest://</code>, so you need the following in there:
   
   <code><pre>
   &lt;ios&gt;
       &lt;plist&gt;
         &lt;dict&gt;
           &lt;key&gt;CFBundleURLTypes&lt;/key&gt;
           &lt;array&gt;
             &lt;dict&gt;
               &lt;key&gt;CFBundleURLName&lt;/key&gt;
               &lt;string&gt;com.appc.safaridialogtest&lt;/string&gt;
               &lt;key&gt;CFBundleURLSchemes&lt;/key&gt;
               &lt;array&gt;
                 &lt;string&gt;safaritest&lt;/string&gt;
               &lt;/array&gt;
             &lt;/dict&gt;
           &lt;/array&gt;
         &lt;/dict&gt;
       &lt;/plist&gt;
   &lt;/ios&gt;
   </pre></code></li>
<li>Chee Kiat Ng 2016-09-13

   APPROVED. CR and FT passed.</li>
<li>Christy Thomas 2016-09-13

   Would this be available to test via a nightly build?  If so which one?
   
   I gave 5.5.0.v20160913000746 a try this morning and I'm not getting the handleurl event. 
   
   Will this require more than just using the right SDK?
   
   </li>
<li>Hans Knöchel 2016-09-13

   It's there. Use the following event:
   <code><pre>
   Ti.App.iOS.addEventListener("handleurl", function(e) {
       // If the handled url is provided by the safari-dialog, close it (use-case for OAuth)
       if (e.launchOptions.source == "com.apple.SafariViewService") {
           safari.close();
       }
   });
   </pre></code>
   Just checked the build-server as well, just to be sure. Also check that you selected the correct SDK version in your tiapp.xml.</li>
<li>Christy Thomas 2016-09-13

   It worked.  Thank you.  I was missing the iOS part.</li>
<li>Eric Wieber 2016-09-14

   Verified fixed, using:
   
   MacOS 10.12 (16A313a)
   Studio 4.7.1.201609100950
   Ti SDK 5.5.0.GA
   Appc NPM 4.2.7
   Appc CLI 5.5.0
   Alloy 1.9.2
   Xcode 8.0 (8A218a)
   
   handleurl event is fired and correctly handled. Tested using the provided test code as well as modified versions of it. The event was fired and caught properly.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23896.json">JSON Source</a></p>