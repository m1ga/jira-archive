---
title: "[TIMOB-23902] Hyperloop: iOS - Numeric attribute in blocks not returned correctly"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-04-04T14:39:42.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Hyperloop 2.1.0</td></tr>
<tr><th>Components</th><td>Hyperloop, iOS, Tooling</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Kn√∂chel</td></tr>
<tr><th>Assignee</th><td>Jan Vennemann</td></tr>
<tr><th>Created</th><td>2016-09-14T15:32:21.000+0000</td></tr>
<tr><th>Updated</th><td>2017-04-17T22:20:33.000+0000</td></tr>
</table>

<h3>Description</h3>

Numeric values that are returned in block-attributes are returned to the application incorrectly.

*Use-case*: 
Copy the following in the plist-section of your tiapp.xml:
<code><pre>
&lt;key&gt;NSSpeechRecognitionUsageDescription&lt;/key&gt;
&lt;string&gt;Can we parse your spoken words?&lt;/string&gt;
</pre></code>

Run the following code on an iOS 10 device with a new appc-project (<code>appc new -p ios</code>):
<code><pre>
var SFSpeechRecognizer = require("Speech/SFSpeechRecognizer");
var SFSpeechRecognizerAuthorizationStatusAuthorized = require("Speech").SFSpeechRecognizerAuthorizationStatusAuthorized;
    
var win = Ti.UI.createWindow({
    backgroundColor: "#fff"
});

var btn = Ti.UI.createButton({
    title: "Request authorization"
});

btn.addEventListener("click", function() {
    SFSpeechRecognizer.requestAuthorization(function(status) {
        alert(status) // The "status" returns "{}" instead of "3" (int-value of the constant)

        // This will return "false", since the status ({}) is not equal the constant (3)
        // alert("Authorized: " + status == SFSpeechRecognizerAuthorizationStatusAuthorized);
    });
});

win.add(btn);
win.open();
</pre></code>

Expected behavior: An alert "3" is shown
Actual behavior: An alert "{}" is shown

<h3>Comments</h3>

<ol>
<li>Jan Vennemann 2016-10-10

   No, this one is caused by a wrong handling of enums in the block callback wrapper. I will look into it and see how we can properly detect the type of the enum and then do the required conversions.</li>
<li>Jan Vennemann 2017-04-04

   PR (master): <a href="https://github.com/appcelerator/hyperloop.next/pull/139" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/139</a>
   PR (2_0_X): <a href="https://github.com/appcelerator/hyperloop.next/pull/140" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/140</a></li>
<li>Abir Mukherjee 2017-04-17

   Verified fix with this environment:
   Node Version: 6.10.1
   NPM Version: 3.10.10
   Mac OS: 10.12.4
   Appc CLI: 6.1.0
   Appc CLI NPM: 4.2.9
   Appcelerator Studio, build: 4.8.1.201612050850
   Xcode 8.2.1
   Hyperloop 2.1.0 (master) and 2.0.1
   iOS 10.2
   
   I tested the above demo code on an iOS 10.2 Device and found that it worked as expected. Specifically, I confirmed that "3" was shown in the Alert box after pressing the button.</li>
</ol>


<p><a href="/TIMOB/TIMOB-23902.json">JSON Source</a></p>