---
title: "[TIMOB-23908] Xcode 8: Builds with SDK 5.5.0 are missing APS-entitlements for push-notifications"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-09-23T19:22:26.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.5.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 5.5.1</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>aps, entitlement, pushnotification, xcode8</td></tr>
<tr><th>Reporter</th><td>Peter Ladis</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2016-09-14T12:36:57.000+0000</td></tr>
<tr><th>Updated</th><td>2017-05-04T10:37:50.000+0000</td></tr>
</table>

<h3>Description</h3>

Attached are two screen shots....1. With SDK 5.3 yesterday...2. With SDK 5.5 Today

Notice the IPA is identical except for the missing entitlement 

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23908_60259/Screen Shot 2016-09-14 at 8.30.56 AM.png">Screen Shot 2016-09-14 at 8.30.56 AM.png</td></td><td>2016-09-14T12:34:43.000+0000</td><td>173201</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-23908_60260/Screen Shot 2016-09-14 at 8.31.25 AM.png">Screen Shot 2016-09-14 at 8.31.25 AM.png</td></td><td>2016-09-14T12:34:43.000+0000</td><td>196151</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Gary Crook 2016-09-14

   Getting this too.
   
   Saw this on the Apple forum - note Engineer's reply:
   <a href="https://forums.developer.apple.com/thread/61571" rel="nofollow" target="_blank">https://forums.developer.apple.com/thread/61571</a>
   
   _You need to add the entitlement to your entitlements file. Xcode will no longer automatically merge it from the provisioning profile. You can enable the capability in the project editor to have Xcode do this automatically._
   
   I loaded the generated .xcodeproj into Xcode 8, did the above and then Product > Archive. After this I'm back to 5 entitlements including aps-environment production.</li>
<li>Kai De Sutter 2016-09-14

   Having the same issue. I also cannot seem to work around it as building directly from XCode gives errors with hyperloop modules.</li>
<li>Thomas Neerup 2016-09-14

   Same issue. But using xcode 7 instead of 8 with SDK 5.5 seems to include the APS entitlement.</li>
<li>Hans Knöchel 2016-09-15

   As said above, it's a breaking change from Apple in Xcode 8. All that Xcode does when opening the Xcode-project and adding the capability is that it generated an entitlements file. In Titanium, you can do the same and place it in <code>/platform/ios/<app-name>.entitlements</code>. Example:
   
   *MyApp.entitlements*:
   <code><pre>
   <?xml version="1.0" encoding="UTF-8"?>
   <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "<a href="http://www.apple.com/DTDs/PropertyList-1.0.dtd" rel="nofollow" target="_blank">http://www.apple.com/DTDs/PropertyList-1.0.dtd</a>">
   <plist version="1.0">
   <dict>
   	<key>aps-environment</key>
   	<string>development</string> <!-- Either development or production -->
   </dict>
   </plist>
   </pre></code>
   
   I would suggest an update to our [wiki-page](<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/guide/Push_Notifications) and maybe do a blog-post to inform developers about the change in iOS 10 / Xcode 8. 
   
   Everybody good with that? Thanks for informing us!</li>
<li>Gary Crook 2016-09-15

   Adding the <code>/platform/ios/<app-name>.entitlements</code> worked for me.</li>
<li>Jérôme Danthinne 2016-09-15

   This doesn't work for me.
   In my tiapp.xml, the name of my app is <name>AVD</name>, so I've created the AVD.entitlements file, but either in development or production,  Xcode doesn't seem to catch it.</li>
<li>Gary Crook 2016-09-15

   Tried cleaning your project before building?</li>
<li>Jérôme Danthinne 2016-09-15

   Yes.</li>
<li>Hans Knöchel 2016-09-15

   Can you attach your entitlements-file? And please make sure that your app has no localized name. In this case the entitlements-file needs to go into the language-specific directory.</li>
<li>Jérôme Danthinne 2016-09-15

    Exactly as in a previous comment.
    <code><pre>
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "<a href="http://www.apple.com/DTDs/PropertyList-1.0.dtd" rel="nofollow" target="_blank">http://www.apple.com/DTDs/PropertyList-1.0.dtd</a>">
    <plist version="1.0">
    <dict>
    	<key>aps-environment</key>
    	<string>development</string> <!-- Either development or production -->
    </dict>
    </plist>
    </pre></code>
    </li>
<li>Hans Knöchel 2016-09-15

    Try to remove the comment, I don't think .entitlements files allow those kind of comments.</li>
<li>Jérôme Danthinne 2016-09-15

    Nope. Removed comments, cleaned project, but still not working.</li>
<li>Gary Crook 2016-09-15

    Is it saved as plain text? Paste it into TextEdit on Mac (Format > Make Plain Text) or Notepad on Windows, remove any empty rows, then save.</li>
<li>Jérôme Danthinne 2016-09-16

    Still not working. I'm sticking with 5.4… :-(</li>
<li>Gary Crook 2016-09-16

    And your platform/ios/ folder is alongside Resources, not inside it? This works for my Classic style project, not sure about an Alloy project.</li>
<li>Jérôme Danthinne 2016-09-16

    Yes…
    !<a href="http://www.grincheux.be/remote/entitlements.png" rel="nofollow" target="_blank">http://www.grincheux.be/remote/entitlements.png</a>!</li>
<li>Martin Williamson 2016-09-16

    Thanks for fix guys, adding the entitlements file did the trick - note the platform folder in question has actually moved else gets overwritten
    <code><pre>
     /app/platform/ios/<app-name>.entitlements
    </pre></code>
     For completeness, i copied the empty entitlements file from my build directory and added the entitlements</li>
<li>Jérôme Danthinne 2016-09-16

    After checking, it seems that the file is correctly copied to the build/ directory (haven't checked that before). But Push still doesn't work…
    !<a href="http://www.grincheux.be/remote/entitlements_ok.png" rel="nofollow" target="_blank">http://www.grincheux.be/remote/entitlements_ok.png</a>!</li>
<li>Kai De Sutter 2016-09-16

    Same here, the entitlements file contents (aps-environment: production) were copied successful into the generated entitlements but push still doesn't work on an Adhoc installation while it did before Xcode 8.</li>
<li>Jerod Fritz 2016-09-17

    Creating the entitlement file with Alloy at app/platform/iphone/<appname>.entitlements solved the problem for me as well</li>
<li>Kai De Sutter 2016-09-18

    My apologies, I was using the commonjs ti-push-notification module in which the iOS check broke with iOS 10!
    With that fixed and the entitlements file, it works for me as well! :-)</li>
<li>Hans Knöchel 2016-09-18

    [~kaiiserni] Good to know, thanks! 
    [~jerodfritz] Can you test placing it in <code>app/platform/ios/</code> as well? Wondering if it needs to be <code>iphone/</code> or <code>ios/</code> is also ok. Thanks!
    
    I just added a paragraph about using entitlements in Xcode in [our wiki](<a href="https://wiki.appcelerator.org/display/guides2/iOS+Interactive+Notifications)" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides2/iOS+Interactive+Notifications)</a> and will do the same for the [registerForPushNotifications docs](<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Network).</li>
<li>Hans Knöchel 2016-09-18

    Docs PR for the first phase: <a href="https://github.com/appcelerator/titanium_mobile/pull/8393" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8393</a></li>
<li>(deactived) Brian Immel 2016-09-19

    Updated content looks good. Merged PR.</li>
<li>Jérôme Danthinne 2016-09-20

    Kai De Sutter: Good catch. I wasn't using ti-push-notification, but ti.parsepushnotifications, which has the same platform check bug with iOS10. Fixed now.</li>
<li>Chris Barber 2016-09-22

    Ti SDK master PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8416" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8416</a>
    Ti SDK 6_0_X PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8417" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8417</a>
    Ti SDK 5_5_X PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8418" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8418</a></li>
<li>Eric Wieber 2016-09-27

    Verified fixed, using:
    MacOS 10.12 (16A323)
    Studio 4.7.1.201609100950
    Ti SDK 5.5.1.v20160927053850
    Appc NPM 4.2.7
    Appc CLI 5.5.1-1
    Alloy 1.9.2
    Xcode 8.0 (8A218a)
    
    App using push correctly has the aps entitlement when trying to submit to the app store. Tested by creating a project that can successfully receive push notifications, then packaging and submitting it for the app store. <code>aps-environment</code> was correctly shown under Binary and Entitlements</li>
<li>Shawn Lan 2016-10-05

    With SDK 5.5.1 I don't have to fix anything manually, right?</li>
<li>Chris Barber 2016-10-05

    [~shawnlan] Correct!</li>
<li>Hani Hamadeh 2016-10-26

    I spent a whole hour struggling with aps entitlements in one of my apps with Titanium 5.5.1.
    At the end I found that the issue was related to the entitlement file I added as suggested for Facebook login on Simulator.
    Turns out that Appcelerator Studio copies this file (missing aps entitlements) inside the project to overwrite the one generated by Xcode.<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Modules.Facebook</li>
<li>Hans Knöchel 2016-11-12

    Hey [~hini], here to help! So when creating a custom entitlements-file, it overwrites the generated one containing the aps-environment? That's clearly an issue and I will file an own ticket for this use-case. 
    
    In the mean-time, is there a workaround to use both, e.g. placing the entitlements in the <plist/> section of the tiapp.xml? At least I would suggest to copy the content of the generated entitlements to your local one and go with that one for now until we fix this. Thx!</li>
<li>Yahya Uddin 2017-05-03

    If this issue is closed can we update the following doc: <a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/guide/iOS_Interactive_Notifications-section-src-40930452_iOSInteractiveNotifications-SendanInteractivePushNotification where it mentions:
    
    {quote}
    In Xcode 8 and later, you need to add the push capabilities to your application manually, since Xcode does not reference them from the provisioning profile automatically any more. To do so, you need to create an entitlements file called <app-name>.entitlements, where <app-name> should be replaced with the app-name used in your tiapp.xml. When using Alloy, the file needs to be created in app/platform/iphone/ and in platform/ios/ when using a classic project. The content of that file should look like this:
    
    [some code]
    
    Please note that you either need to specify development for device-builds or production for distribution builds on the App Store. We are working on automating that process, so the developer does not need to do additional steps. Please follow TIMOB-23908 on JIRA for the process of that.
    {quote}</li>
<li>Hans Knöchel 2017-05-03

    Thanks Yahya! I've updated the underlaying Wiki-page, the docs will be updated the next time our docs team (cc [~bimmel]) pushed the wiki to the docs.</li>
<li>Yahya Uddin 2017-05-04

    When will this be?</li>
<li>Hans Knöchel 2017-05-04

    Anytime soon, usually around a release. But it's just a docs change right? You can see the updated page with the removed paragraph [here](<a href="https://wiki.appcelerator.org/display/guides2/iOS+Interactive+Notifications)." rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides2/iOS+Interactive+Notifications).</a></li>
<li>Yahya Uddin 2017-05-04

    Cool thanks!</li>
</ol>


<p><a href="/TIMOB/TIMOB-23908.json">JSON Source</a></p>