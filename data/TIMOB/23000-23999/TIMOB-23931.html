---
title: "[TIMOB-23931] Windows: Allow an event to be logged to the console for inspection"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-11-13T20:31:37.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>parity, qe-6.0.0</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2016-09-20T11:15:34.000+0000</td></tr>
<tr><th>Updated</th><td>2016-12-22T23:49:23.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

On Windows, when trying to inspect an event that is returned to an event listener a user will be faced with one of the two following results.

<code><pre>
var win = Ti.UI.createWindow();
var label = Ti.UI.createLabel({
  backgroundColor:'darkgray',
  text: 'Your Test here',
});
win.add(label);
label.addEventListener('click', function(e) {
	console.log(e.source);
	console.log(JSON.stringify(e.source));
});
win.open();
</pre></code>

<code><pre>
[INFO] [object class TitaniumWindows::UI::Label]
</pre></code>

<code><pre>
[ERROR] :  Application Error: "Runtime Error: JSON.stringify cannot serialize cyclic structures."
</pre></code>

However, when trying to log an event on iOS and Android the following is returned

<code><pre>
[INFO] :   {"wordWrap":true,"textAlign":"center","text":"Your Test here","ellipsize":2,"enabled":true,"visible":true,"touchEnabled":true,"backgroundColor":"darkgray","backgroundRepeat":false,"size":{"height":100,"width":360,"y":0,"x":0},"rect":{"height":100,"width":360,"y":229,"x":0},"keepScreenOn":false,"children":[],"width":"fill","height":100,"bubbleParent":true,"apiName":"Ti.UI.Label","_events":{"click":{}}}

</pre></code>

<code><pre>
[INFO] :   {"wordWrap":true,"textAlign":"center","text":"Your Test here","ellipsize":2,"enabled":true,"visible":true,"touchEnabled":true,"backgroundColor":"darkgray","backgroundRepeat":false,"size":{"height":100,"width":360,"y":0,"x":0},"rect":{"height":100,"width":360,"y":229,"x":0},"keepScreenOn":false,"children":[],"width":"fill","height":100,"bubbleParent":true,"apiName":"Ti.UI.Label","_events":{"click":{}}}
</pre></code>

<code><pre>
[INFO]  [object TiUILabel]
</pre></code>

<code><pre>
{"horizontalWrap":true,"visible":true,"height":100,"backgroundColor":"darkgray","width":"FILL","textAlign":"center","text":"Your Test here","touchEnabled":true}
</pre></code>


<h4>Steps to reproduce</h4>

<h4>Add the code above to an exisiting app.js</h4>
<h4>Build using <code>appc run -p windows -T wp-emulator</code></h4>

<h4>Actual result</h4>

When attempting to get information on the event returned from the event listener, either
<h4>When attempting to use JSON.stringify an application error will be thrown as the JSON contains cyclic structures</h4>
<h4>When logging just the event, the object type will be logged</h4>

<h4>Expected result</h4>

In parity with other platforms and to aid a developer I would expect to be able to log an event to the console to inspect the properties returned in the JSON payload.


<h3>Comments</h3>

<ol>
<li>Kota Iguchi 2016-10-07

   For the cyclic structure, I can see that <code>e.source.parent</code> property could cause the issue because <code>e.source.parent.children</code> obviously contains <code>e.source</code> itself. I would rather be surprised that iOS and Android implementation doesn't dump entire properties but only few properties on <code>JSON.stringify</code>. It seems we have been using custom implementation for <code>JSON.stringify</code> for them, and we might want to emulate what iOS does on Windows to fix this issue.
   
   FYI When I JSON.stringify <code>Ti.UI.Button</code> instance on Windows, I got a lot more properties compared to the other platforms:
   
   <code><pre>
   {
     "title": "This is a button",
     "color": "",
     "textAlign": 1,
     "image": null,
     "font": {
       "fontFamily": "",
       "fontSize": "",
       "fontStyle": -842150451,
       "fontWeight": -842150451,
       "textStyle": -842150451
     },
     "verticalAlign": 1,
     "titleid": "",
     "rect": {
       "x": 217,
       "y": 369,
       "width": 66,
       "height": 35
     },
     "left": "",
     "backgroundGradient": {
       "type": "GRADIENT_TYPE::Unknown",
       "backfillStart": false,
       "backfillEnd": false,
       "endRadius": 0,
       "startRadius": 0,
       "startPoint": {
         "x": 0,
         "y": 0
       },
       "endPoint": {
         "x": 0,
         "y": 0
       },
       "colors": []
     },
     "keepScreenOn": false,
     "bottom": "",
     "pullBackgroundColor": "",
     "children": [],
     "accessibilityLabel": "",
     "backgroundLeftCap": -6.2774385622041925e+66,
     "backgroundFocusedImage": "",
     "parent": null,
     "borderWidth": 0,
     "borderColor": "",
     "backgroundFocusedColor": "",
     "backgroundSelectedImage": "",
     "borderRadius": 0,
     "accessibilityValue": "",
     "backgroundColor": "",
     "horizontalWrap": true,
     "accessibilityHint": "",
     "viewShadowColor": "",
     "backgroundSelectedColor": "",
     "viewShadowRadius": -6.2774385622041925e+66,
     "size": {
       "x": 0,
       "y": 0,
       "width": 66,
       "height": 35
     },
     "width": "",
     "animatedCenter": {
       "x": 0,
       "y": 0
     },
     "anchorPoint": {
       "x": 0,
       "y": 0
     },
     "touchEnabled": true,
     "backgroundDisabledColor": "",
     "accessibilityHidden": false,
     "tintColor": "",
     "backgroundDisabledImage": "",
     "backgroundTopCap": -6.2774385622041925e+66,
     "transform": null,
     "right": "",
     "visible": true,
     "opacity": 1,
     "overrideCurrentAnimation": true,
     "softKeyboardOnFocus": 3452816845,
     "backgroundImage": "",
     "center": {
       "x": 0,
       "y": 0
     },
     "top": "",
     "height": "",
     "layout": "",
     "focusable": true,
     "clipMode": 3452816845,
     "backgroundRepeat": true,
     "zIndex": -842150451,
     "enabled": true,
     "viewShadowOffset": {
       "x": 0,
       "y": 0
     },
     "lifecycleContainer": null,
     "bubbleParent": true,
     "apiName": "Ti.UI.Button"
   }
   </pre></code></li>
<li>Kota Iguchi 2016-11-04

   <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/891" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/891</a></li>
<li>Kota Iguchi 2016-11-04

   So the actual issue here is that we were not able to <code>JSON.stringify</code> Ti.UI.Views. I noticed that Ti.UI.View and its subclasses has <code>parent</code> and <code>children</code> property, and they are enumerable. That makes it impossible to log them through <code>JSON.stringify</code> because of circular references. We can easily workaround it by configuring them non-enumerable.</li>
<li>Samir Mohammed 2016-12-22

   Verified improvement with the code provided in the description.
   *Windows: console.log(JSON.stringify(e))*; now displays the following information:
   <code><pre>
   [INFO] {"textAlign":1,"textid":"","verticalAlign":1,"ellipsize":false,"text":"Your Test here","color":"","wordWrap":true,"font":{"fontFamily":"","fontSize":"","fontStyle":0,"fontWeight":0,"textStyle":0},"attributedString":null,"rect":{"x":118,"y":271,"width":124,"height":27},"left":"","backgroundGradient":{"type":"GRADIENT_TYPE::Unknown","backfillStart":false,"backfillEnd":false,"endRadius":0,"startRadius":0,"startPoint":{"x":0,"y":0},"endPoint":{"x":0,"y":0},"colors":[]},"keepScreenOn":false,"bottom":"","pullBackgroundColor":"","accessibilityLabel":"","backgroundLeftCap":8e-323,"backgroundFocusedImage":"","borderWidth":0,"borderColor":"","backgroundFocusedColor":"","backgroundSelectedImage":"","borderRadius":0,"accessibilityValue":"","backgroundColor":"darkgray","horizontalWrap":true,"accessibilityHint":"","viewShadowColor":"","backgroundSelectedColor":"","viewShadowRadius":2.6631047824235e-311,"size":{"x":0,"y":0,"width":124,"height":27},"width":"","animatedCenter":{"x":0,"y":0},"anchorPoint":{"x":0,"y":0},"touchEnabled":true,"backgroundDisabledColor":"","accessibilityHidden":false,"tintColor":"","backgroundDisabledImage":"","backgroundTopCap":0,"transform":null,"right":"","visible":true,"opacity":1,"overrideCurrentAnimation":false,"softKeyboardOnFocus":59756584,"backgroundImage":"","center":{"x":0,"y":0},"top":"","height":"","layout":"","focusable":true,"clipMode":1932,"backgroundRepeat":true,"zIndex":0,"enabled":true,"viewShadowOffset":{"x":0,"y":0},"lifecycleContainer":null,"bubbleParent":true,"apiName":"Ti.UI.Label","constructor":{"textAlign":1,"textid":"","verticalAlign":1,"ellipsize":false,"text":"","color":"","wordWrap":true,"font":{"fontFamily":"","fontSize":"","fontStyle":0,"fontWeight":0,"textStyle":0},"attributedString":null,"keepScreenOn":false,"accessibilityLabel":"","accessibilityValue":"","accessibilityHint":"","accessibilityHidden":false,"softKeyboardOnFocus":0,"focusable":true,"clipMode":0,"lifecycleContainer":null,"bubbleParent":true,"apiName":"Ti.UI.Label"}}
   </pre></code>
   
   *Environment*
   <code><pre>
   Nokia Lumia 640 LTE (RM-1073)
   version 1607
   OS Build: 10.0.14393.576
   Mobile Emulator 10.0.14393.0 WVGA 4 inch 512MB
    
   Operating System
   Name                        = Microsoft Windows 10 Pro
   Version                     = 10.0.14393
   Architecture                = 64bit
   <h4>CPUs                      = 4</h4>
   Memory                      = 17034395648
    
   Node.js
   Node.js Version             = 4.4.4
   npm Version                 = 2.11.3
    
   Titanium SDK
   SDK Version                 =6.1.0.v20161222061413
   </pre></code>
   Closing ticket. 
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-23931.json">JSON Source</a></p>