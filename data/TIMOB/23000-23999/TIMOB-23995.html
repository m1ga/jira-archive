---
title: "[TIMOB-23995] iOS: Using __dirname in app.js errors with Can't find variable: __dirname "
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-08-10T13:06:53.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.0.0, Release 5.5.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>Android, iOS</td></tr>
<tr><th>Labels</th><td>qe-6.0.0</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2016-10-06T16:31:46.000+0000</td></tr>
<tr><th>Updated</th><td>2018-09-24T14:16:17.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

*This is not a regression occurs using 5.5.1.GA stack*

When using <code>__dirname</code> in an app.js file the following is thrown

*Using __dirname in any file other than app.js works*

<code><pre>
[ERROR] :  Application Error: {
[ERROR] :    "line": 2,
[ERROR] :    "column": 10,
[ERROR] :    "message": "require: Error while require(/app) Can't find variable: __dirname",
[ERROR] :    "native_stack": [
[ERROR] :      "JSExportClass<class Titanium::GlobalObject>::CallNamedFunction"
[ERROR] :    ]
[ERROR] :  }
</pre></code>

<h4>Steps to reproduce</h4>

<h4>In your app.js add <code>console.log(__dirname)</code></h4>
<h4>Build for Android, iOS or Windows</h4>

<h4>Actual result</h4>

The above error is thrown

<h4>Expected result</h4>

__dirname should be able to be used in app.js file

<h3>Comments</h3>

<ol>
<li>Brenton House 2016-11-23

   [~cng] I am guessing this is the same issue, but <code>__dirname</code> is undefined (in any file) when using LiveView.   When LiveView is not used, <code>__dirname</code>  works as expected.   </li>
<li>Kota Iguchi 2016-12-19

   PR for Windows: <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/903" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/903</a></li>
<li>Kota Iguchi 2016-12-20

   Fixed for Windows: <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/903" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/903</a></li>
<li>Hans Knöchel 2018-08-09

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/10241" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10241</a>
   
   Test-Case (use a classic "app.js" and create a "test.js" in a directory named "dir"): 
   *app.js*
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor: '#fff'
   });
   
   var btn1 = Ti.UI.createButton({
       title: 'Show __dirname and __filename',
       top: 100
   });
   
   btn1.addEventListener('click', function() {
       alert('__dirname: ' + __dirname + '\n__filename: ' + __filename);
   });
   
   var btn2 = Ti.UI.createButton({
       title: 'require() other file',
       top: 200
   });
   
   btn2.addEventListener('click', function() {
       var test = require('./dir/test');
       test.showProps();
   });
   
   win.add(btn1);
   win.add(btn2);
   
   win.open();
   </pre></code>
   */dir/test.js*
   <code><pre>
   exports.showProps = function () {
       alert('__dirname: ' + __dirname + '\n__filename: ' + __filename);
   };
   </pre></code>
   
   [~jquick] Are we good on Android already? The current unit-test assumes that.
   
   *EDIT*: Android does not seem to handle this so far. I'll check, but it may require some more attention from the Android team. I assumed this could work, but it does not:
   <code><pre>
   kroll->Set(NEW_SYMBOL(isolate, "__dirname"), STRING_NEW(isolate, "/"));
   kroll->Set(NEW_SYMBOL(isolate, "__filename"), STRING_NEW(isolate, "/app.js"));
   </pre></code></li>
<li>Joshua Quick 2018-08-09

   Hmm... interesting.
   
   In C/C\+\+, the equivalent would be done via macros. For example, the C/C\+\+ <code>\_\_FILE\_\_</code> preprocessor would be substituted with a string referencing the source file's path.
   
   So, string substitution of <code>\_\_dirname</code> and <code>\_\_filename</code> in JavaScript would be an alternative solution when doing an app build, but would be problematic for LiveView. However, if there was a JavaScript equivalent of the C/C\+\+ <code>\_\_LINE\_\_</code> macro for line numbers, then string substitution would be the best solution if JS transpiling was involved.
   
   If we were to do this natively on Android, then I believe we override the <code>require()</code> method in our "module.js" below. We should be able to set the properties per module there... or in 1 of the JS files in that directory. (I've never mucked with this part of the code, but I believe this is where the magic happens.)
   <a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/runtime/common/src/js/module.js" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/runtime/common/src/js/module.js</a>
   </li>
<li>Samir Mohammed 2018-09-24

   *Closing ticket.* Verified fix in SDK version <code>7.5.0.v20180920040518</code>. Able to use <code>__dirname</code> and <code>__filename</code> without any issues.
   
   *FR Passed (Test Steps)*
   <h4>Created a new titanium application </h4>
   <h4>Created a <code>dir</code> directory in the <code>Resources</code> folder and named it <code>test.js</code></h4>
   <h4>Copied the above code in to the files</h4>
   <h4>Ran the program</h4>
   <h4>Pressed <code>Show __dirname and __filename</code> button</h4>
   <h4><code>Show __dirname and __filename</code> values were returned </h4>
   <h4>Pressed <code>require() other file</code> button </h4>
   <h4># <code>Show __dirname and __filename</code> values were returned </h4>
   
   *Test Environment*
   <code><pre>
   APPC Studio: 5.1.0.201808080937
   iPhone 6 (12.0)
   APPC CLI: 7.0.7-master.1
   Operating System Name: Mac OS High Sierra
   Operating System Version: 10.13.6
   Node.js Version: 8.9.1
   Xcode 10.0
   </pre></code>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-23995.json">JSON Source</a></p>