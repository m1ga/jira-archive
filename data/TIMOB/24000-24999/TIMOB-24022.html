---
title: "[TIMOB-24022] Hyperloop: Android: Unable to instantiate hyperloop classes"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-10-12T21:12:34.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Hyperloop 2.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.0.0, Hyperloop 2.0.0</td></tr>
<tr><th>Components</th><td>Android, Hyperloop</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2016-10-12T20:00:33.000+0000</td></tr>
<tr><th>Updated</th><td>2016-10-25T01:19:51.000+0000</td></tr>
</table>

<h3>Description</h3>

When attempting to instantiate a native class in JS, we end up with a class cast exception about casting a String to Integer.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-24022_60504/Screen Shot 2016-10-12 at 3.59.13 PM.png">Screen Shot 2016-10-12 at 3.59.13 PM.png</td></td><td>2016-10-12T19:59:25.000+0000</td><td>191580</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Christopher Williams 2016-10-12

   This is a result of a behavior change due to the fix for TIMOB-23966. We now force JS objects to turn into Map<String, Object> going across the bridge. Before it would auto-convert a key like '1' to an actual Integer on the Java side, which broke analytics. Hyperloop relied on this broken conversion when receiving an array of arguments and assumed we'd get Map<Integer, Object>. We no longer do, so I need to handle Map<String, Object> instead.</li>
<li>Christopher Williams 2016-10-12

   To test, try this as your app.js in a hyperloop project:
   <code><pre>
   var Intent = require('android.content.Intent');
   var Activity = require('android.app.Activity');
   var Uri = require("android.net.Uri");
   
   var win = Ti.UI.createWindow({
       backgroundColor: "#fff"
   });
   
   var btn = Ti.UI.createButton({
       title: "Trigger"
   });
   
   btn.addEventListener("click", openIntent);
   
   win.add(btn);
   win.open();
   
   function openIntent() {
       var activity = new Activity(Ti.Android.currentActivity);
   
       var intent = Ti.Android.createIntent({
           action: Ti.Android.ACTION_VIEW
       });
   
       var nativeIntent = new Intent(intent);
       nativeIntent.setData(Uri.parse("sms://"));
       nativeIntent.putExtra("sms_body", "Hello world!");
   
       activity.startActivity(nativeIntent);
   }
   
   </pre></code></li>
<li>Christopher Williams 2016-10-12

   PR (master): <a href="https://github.com/appcelerator/hyperloop.next/pull/86" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/86</a>
   PR (2_0_X): <a href="https://github.com/appcelerator/hyperloop.next/pull/85" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/85</a></li>
<li>Lokesh Choudhary 2016-10-25

   Verified the fix.
   
   Hyperloop classes can be instantiated successfully.
   Closing.
   
   Appc Studio : 4.8.0.201610171310
   SDK Version : 6.0.0.v20161024145110
   Mac OS Version : 10.11.6
   Xcode Version : Xcode 8.0 Build version 8A218a
   Appc CLI AND Appc NPM : {"NPM":"4.2.8-9","CLI":"6.0.0-64"}
   Ti CLI : 5.0.10
   Alloy : 1.9.3
   Node : v4.6.0
   Hyperloop: 2.0.0 Beta 4</li>
</ol>


<p><a href="/TIMOB/TIMOB-24022.json">JSON Source</a></p>