---
title: "[TIMOB-24101] Windows: Ability to use 3rd-party native classes"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-04-11T13:09:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.4.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0, Hyperloop 2.1.0</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Kota Iguchi</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2016-11-04T06:38:01.000+0000</td></tr>
<tr><th>Updated</th><td>2017-04-21T17:26:01.000+0000</td></tr>
</table>

<h3>Description</h3>

Add ability to use third-party dependencies in your Hyperloop enabled project. This may be done by putting WinMD(<code>.winmd</code>) or DLL (<code>.dll</code>) on certain place on your project.

*Steps to test*

1. Create Windows Runtime Component

Create Windows Runtime Component named <code>WindowsRuntimeComponent1</code> from Visual Studio. Compile it and you should get <code>WindowsRuntimeComponent1.winmd</code> somewhere under in your Visual Studio project folder.  You might want to use [^WindowsRuntimeComponent1.winmd] if you want to skip this step. 

<code><pre>
using System;

namespace WindowsRuntimeComponent1
{
    public sealed class Test
    {
        public int SampleNumber { get; set; }

        public static string SayHello(string str)
        {
            return String.Format("Hello, {0}!", str);
        }

        public string sayNumber()
        {
            return String.Format("SampleNumber is {0}.", SampleNumber);
        }
    }
}
</pre></code>

2. Copy your <code>WindowsRuntimeComponent1.winmd</code> file into <code>lib/windows/win10/x86/</code> folder under your Titanium app project folder.

<code><pre>
var win = Ti.UI.createWindow({ backgroundColor: 'green' }),
    Test = require('WindowsRuntimeComponent1.Test'),
    test = new Test();

win.addEventListener('open', function() {
    alert(test.SayHello('World!'));
});

win.open();
</pre></code>

3. Place <code>appc.windows.js</code> directly under your Titanium project folder. Make sure it contains names of your Windows Runtime component under <code>hyperloop.windows.thirdparty</code> key. It should look like below.

<code><pre>
/**
 * Hyperloop configuration
 */
module.exports = {
	type: 'app',
	group: 'titanium',
	dependencies: {},
	hyperloop: {
		windows:
		{
			/**
			 * Optionally, you can bring in third-party or first-party Windows Runtime components.
			 * The 'key' is the root namespace of the component that will be used in the require.
			 * There's no values for now but we reserve them for future release.
			 *
			 * Place the library files into the lib/windows/(phone|store|win10)/(x86|ARM)/ folder under your app project.
			 * Hyperloop will pick up the winmd files and will generate necessary bindings and include the winmd in your app. 
			 */
			thirdparty: {
				'WindowsRuntimeComponent1': {}
			}
		}
	}
};
</pre></code>
4. Make sure to enable hyperloop, and then run it using <code>appc run -p windows --wp-sdk 10.0 --target ws-local -l trace</code>.
5. Then you should see "Hello, World!!" dialog box in your Titanium app.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-24101_61987/WindowsRuntimeComponent1.winmd">WindowsRuntimeComponent1.winmd</td></td><td>2017-04-07T04:59:59.000+0000</td><td>6656</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Kota Iguchi 2017-04-07

   <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/967" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/967</a></li>
<li>Abir Mukherjee 2017-04-21

   Validated fix with this environment: 
   Node Version: 6.10.1 
   NPM Version: 4.4.4 
   Appc CLI: 6.2.0 
   Appc CLI NPM: 4.2.9 
   Titanium SDK version: 6.1.0.v20170421082637
   Appcelerator Studio, build: 4.8.1.201612050850 
   OS: Windows 10.0.14393 
   Targets: Windows 8.1 & 10 Devices. Windows 10 Emulator 
   Hyperloop 2.1.0
   
   FR passed with above environment, and fixes were verified in the SDK version noted above.</li>
</ol>


<p><a href="/TIMOB/TIMOB-24101.json">JSON Source</a></p>