---
title: "[TIMOB-24189] Windows: Add support for Visual Studio 2017"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-08-25T13:01:25.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Fix Version/s</th><td>windowslib 0.4.29, Release 6.2.0</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2016-12-02T00:17:37.000+0000</td></tr>
<tr><th>Updated</th><td>2017-08-25T14:05:35.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

windowslib does not detect VS 2017 RC, this is because Microsoft has made VS more isolated so that multiple editions can coexist and now stores the key we look for (\VisualStudio\<VERSION>_Config) in a private registry that can be found under <code>C:\Users\ewan\AppData\Local\Microsoft\VisualStudio\15.0_d5badba5</code>, to inspect this registry:

<h4>Open regedit</h4>
<h4>Click on <code>HKLM</code> folder</h4>
<h4>File->Load Hive</h4>
<h4>Load the <code>privateregistry.bin</code> at the above location and give it a name</h4>
<h4>File->Unload Hive when done</h4>

Reference <a href="http://www.visualstudioextensibility.com/2016/11/23/some-implications-of-the-new-modular-setup-of-visual-studio-2017-for-vsx-developers/" rel="nofollow" target="_blank">http://www.visualstudioextensibility.com/2016/11/23/some-implications-of-the-new-modular-setup-of-visual-studio-2017-for-vsx-developers/</a>

<h3>Comments</h3>

<ol>
<li>Ewan Harris 2017-01-29

   Spent some time reading about the changes in VS 2017 and found this sample for setup detection <a href="https://github.com/Microsoft/vs-setup-samples" rel="nofollow" target="_blank">https://github.com/Microsoft/vs-setup-samples</a>
   One interesting note <code>This change to the Visual Studio platform requires new ways of discovering Visual Studio where simple registry detection does not provide the flexibility required in many scenarios.</code></li>
<li>Kota Iguchi 2017-02-17

   Pushing this in current sprint because VS 2017 will be released soon. </li>
<li>Kota Iguchi 2017-03-06

   Pushed <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/959" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/959</a>
   
   But still failing to make <code>msbuild</code> work. I suspect <code>msbuild</code> has issues because it fails even when you execute msbuild manually against default UWP application project (that Visual Studio creates via "New Project -> Windows Universal C# app").
   
   <code><pre>
   &gt;C:\PROGRA~2\MICROS~1\2017\COMMUN~1\VC\AUXILI~1\Build\VCVARS~1.BAT x86 && MSBuild /v:d /p:Platform=x86 /p:Cofiguration=Release  "Projects\UWP1\UWP1.sln"
   </pre></code>
   
   So what's interesting is that when you open .sln file manually from Visual Studio 2017, you are able to build it. So maybe Visual Studio does something more than executing msbuild behind the scenes. maybe setting up configurations, or giving additional parameters to msbuild...? Pushing this so that hopefully we could get something from community to this PR.</li>
<li>Kota Iguchi 2017-03-14

   <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/959" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/959</a>
   <a href="https://github.com/appcelerator/windowslib/pull/66" rel="nofollow" target="_blank">https://github.com/appcelerator/windowslib/pull/66</a>
   </li>
<li>Kota Iguchi 2017-03-20

   <a href="https://github.com/appcelerator/titanium_mobile/pull/8893" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8893</a></li>
<li>Kota Iguchi 2017-08-15

   Merged. <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/1074" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/1074</a></li>
<li>Ewan Harris 2017-08-22

   Verified changes in 6.2.0.v20170821203442</li>
</ol>


<p><a href="/TIMOB/TIMOB-24189.json">JSON Source</a></p>