---
title: "[TIMOB-24196] iOS: Debugging app with Safari throws error when adding event-listeners"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2016-12-05T19:05:52.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>debugger, ios, jscore, safari</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2016-12-05T18:34:16.000+0000</td></tr>
<tr><th>Updated</th><td>2016-12-05T23:02:43.000+0000</td></tr>
</table>

<h3>Description</h3>

In TIMOB-23871, we introduced the ability to debug apps with Safari - this is great! While testing around it, I found out that adding event listeners throws an error in the Inspector (no visible error on the app). 

The errors are caused by [this](<a href="https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/KrollObject.m#L1343)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/KrollObject.m#L1343)</a> and [this](<a href="https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/KrollObject.m#L1359)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/KrollObject.m#L1359)</a> line. They can be resolved by checking the value of <code>jsEventHash</code> beforehand (thanks [~cwilliams]!). 

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-24196_60828/debugger-safari.m4v">debugger-safari.m4v</td></td><td>2016-12-05T19:05:09.000+0000</td><td>6108271</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Christopher Williams 2016-12-05

   <a href="https://github.com/appcelerator/titanium_mobile/pull/8659" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8659</a></li>
<li>Hans Knöchel 2016-12-05

   *To test this ticket*:
   
   1. Create a new app with <code>appc new -p ios</code> 
   1a. Ensure you have the <code>&lt;use-jscore-framework&gt;true&lt;/use-jscore-framework&gt;</code> property in your <code>&lt;ios&gt;</code> section of the tiapp.xml
   2. Paste the following code in your app:
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor: '#fff'
   });
   
   var btn1 = Ti.UI.createButton({
       title: 'Toggle event-listener #1',
       top: 40
   });
   
   btn1.addEventListener('click', function() {
       alert('#1 works!');
   });
   
   var btn2 = Ti.UI.createButton({
       title: 'Toggle event-listener #2',
       top: 120
   });
   
   btn2.addEventListener('click', myHandler);
   
   win.add(btn1);
   win.add(btn2);
   win.open();
   
   function myHandler() {
       alert('#2 works!');
   }
   </pre></code>
   3. Run the app in the iOS Simulator
   4. Open Safari and select the app by navigating to <code>Develop &gt; Simulator &gt; JSContext</code>. If the menu is not there, enable it in <code>Settings &gt; Advanced &gt; "Enable Develop menu in menu bar"</code>.
   5. Set a breakpoint to both event listeners
   6. Click both event listeners
   
   *Expected behavior*: The breakpoints are hit, the app doesn't crash and the Safari console does not throw any error.
   
   Please also see the attached video <code>debugger-safari.m4v</code> to see how I tested the PR.  </li>
<li>Samir Mohammed 2016-12-05

   Verified fixed, the Debugger on Safari no longer shows an error on event listeners and breakpoints are able to be hit (tested with the code provided above).
   
   *Environement*
   <code><pre>
   Appcelerator Command-Line Interface, version 6.0.0
   IOS 10.1
   IOS Simulator: iphone 7 plus 
   Safari version: 10.0.1 (11602.2.14.0.7)
   Operating System Name: Mac OS X El Capitan
   Operating System Version: 10.11.6
   Node.js Version: 4.6.0
   npm: 4.2.8
   Titanium CLI Version: 5.0.10
   Titanium SDK Version: 6.1.0.v20161204170304
   Xcode: 8.0
   Appcelerator Studio: 4.8.0.201611121409
   </pre></code>
   </li>
<li>Samir Mohammed 2016-12-05

   Just realized didn't update the SDK Version build in the environement. ^
   <code><pre>
   Titanium SDK Version: 6.1.0.v20161205110006
   </pre></code>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-24196.json">JSON Source</a></p>