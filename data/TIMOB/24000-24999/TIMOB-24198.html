---
title: "[TIMOB-24198] Hyperloop: iOS - API availability annotation parsed incorrectly"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-03-16T13:50:25.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Hyperloop 2.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Hyperloop 2.0.1</td></tr>
<tr><th>Components</th><td>Hyperloop, iOS</td></tr>
<tr><th>Labels</th><td>qe-hyperloop</td></tr>
<tr><th>Reporter</th><td>Jan Vennemann</td></tr>
<tr><th>Assignee</th><td>Jan Vennemann</td></tr>
<tr><th>Created</th><td>2016-12-06T01:32:09.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-16T17:17:08.000+0000</td></tr>
</table>

<h3>Description</h3>

The Hyperloop metabase is missing classes annotated with a of <code>API_AVAILABLE</code> and <code>API_UNAVAILABLE</code> and which are not explicitly including the Foundation framework.

For example the the <code>INPreferences</code> class of the new <code>Intents</code> framework is annotated with <code>API_AVAILABLE(ios(10.0)) API_UNAVAILABLE(macosx)</code> and won't be processed by the metabase parser.

*Steps to reproduce the behavior*
1. Create a new hyperloop enabled application with <code>appc new -t app</code>
2. Make a require to the INPreference class: <code>var INPreferences = require('Intents/INPreferences');</code>
3. Run the app with <code>appc run -p ios</code>

*Actual behavior*
The following error is thrown:
<code><pre>[ERROR] Script Error Couldn't find module: /hyperloop/intents/inpreferences for architecture: x86_64</pre></code>

*Expected behavior*
The app launches without errors.

*Additional notes*
The issue is solved by explicitly requiring the Foundation framework, forcing it to be included during metabase generation.

<h3>Comments</h3>

<ol>
<li>Jan Vennemann 2017-01-31

   PR (master): <a href="https://github.com/appcelerator/hyperloop.next/pull/114" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/114</a>
   PR (2_0_X): <a href="https://github.com/appcelerator/hyperloop.next/pull/115" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/115</a></li>
<li>Hans Kn√∂chel 2017-03-15

   Reopening ticket, the issue reproduces on latest 2.0.1, so something happened after the code-review in February.</li>
<li>Jan Vennemann 2017-03-16

   The new code generator introduced in TIMOB-23907 was unintentionally excluding classes that were required but never used, like in the test case for this ticket. The following PR fixes this issue: 
   
   PR (master): <a href="https://github.com/appcelerator/hyperloop.next/pull/135" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/135</a>
   PR (2_0_X): <a href="https://github.com/appcelerator/hyperloop.next/pull/136" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/136</a></li>
<li>Josh Longton 2017-03-16

   Verified as fixed, The error above in no longer thrown when requiring to the intents such as INPreference.
   
   Tested on:
   {noformat}
   macOS Sierra 10.12.3
   iPhone 6 (10.2.1)
   iOS simulator (10.2, 10.0)
   Ti SDK: 6.0.3.v20170315154238
   Hyperloop: 2.0.1
   Appc CLI: 6.1.0
   Appc NPM: 4.2.9-1
   Node v4.6.0
   {noformat}
   
   *Closing Ticket.*</li>
</ol>


<p><a href="/TIMOB/TIMOB-24198.json">JSON Source</a></p>