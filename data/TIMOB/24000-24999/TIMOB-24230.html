---
title: "[TIMOB-24230] Android: Ti.TouchID fails on SDK < 23"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-01-08T23:03:28.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>feedback</td></tr>
<tr><th>Reporter</th><td>Thomas Neerup</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2016-12-15T16:21:17.000+0000</td></tr>
<tr><th>Updated</th><td>2017-01-11T18:32:22.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>isSupported() method fails with null pointer exception when used on SDK < 23.</h4>

<h4>Module is missing method for canceling probing for fingerprints</h4>

I have included my fix for TouchidModule.java:

<code><pre>

	@Kroll.method
	public boolean isSupported() {
/* Added SDK check to avoid null pointer Exception */
		if (Build.VERSION.SDK_INT >= 23) {
			return mfingerprintHelper.isDeviceSupported();
		}
		return false;
	}

/* New method to cancel probing for fingerprints */
	@Kroll.method
	public void cancelAuthenticate() {
		if (mfingerprintHelper != null) {
			mfingerprintHelper.stopListening();
		}	
	}
</pre></code>


<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2016-12-15

   Thanks for the ticket. Can you create a pull request for it? Our Engineers will take care it. </li>
<li>Hans Knöchel 2016-12-17

   Hey Thomas, thanks for the great ticket! The <code>isSupported</code> fix is in the following ticket and the <code>cancelAuthenticate</code> has been added to [this PR](<a href="https://github.com/appcelerator-modules/ti.touchid/pull/23)" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/pull/23)</a>, since iOS will also support it in the next feature version. Thx!
   
   PR: <a href="https://github.com/appcelerator-modules/ti.touchid/pull/24" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/pull/24</a>
   Packaged module: <a href="https://github.com/appcelerator-modules/ti.touchid/releases/tag/android-2.0.2" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.touchid/releases/tag/android-2.0.2</a>
   
   Note: I bumped to 2.0.2 for SDK release 6.1.0, but with the other PR already bumping to 2.1.0, we'll probably have the 2.1.0 (iOS / Android) for 6.1.0 instead, incorporating all changes. 
   
   Test-case:
   1. Create an app with the following content:
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor: '#fff'
   });
   
   var btn = Ti.UI.createButton({
       title: 'Check isSupported()'
   });
   
   btn.addEventListener('click', function() {
       var TiTouchID = require('ti.touchid');
       alert('Supported: ' + TiTouchID.isSupported());
   });
   
   win.add(btn);
   win.open();
   </pre></code>
   2. Run the app on an Android device with API level < 23
   
   Expected behavior: No crash!</li>
<li>Samir Mohammed 2017-01-11

   Verified improvement, app no longer crashes  and message for <code>isSupported</code> is displayed. 
   *Environment*
   <code><pre>
   Appcelerator Command-Line Interface, version 6.1.0
   Ti.TouchID Module 2.0.2
   Samsung Galaxy Note II (Android 4.3)
   Nexus 6p (Android 7.1)
   Operating System Name: Mac OS X El Capitan
   Operating System Version: 10.11.6
   Node.js Version: 4.6.0
   npm: 4.2.8
   Titanium SDK Version: 6.1.0.v20170110133045
   Xcode: 8.2
   Appcelerator Studio: 4.8.1.201612050850
   </pre></code>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-24230.json">JSON Source</a></p>