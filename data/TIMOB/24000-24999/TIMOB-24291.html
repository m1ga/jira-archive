---
title: "[TIMOB-24291] Hyperloop: iOS - Unable to specify Hyperloop argument type for NSDictionary"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-05-03T20:02:21.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Hyperloop 2.1.1</td></tr>
<tr><th>Components</th><td>Hyperloop, iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Kevin Southworth</td></tr>
<tr><th>Assignee</th><td>Jan Vennemann</td></tr>
<tr><th>Created</th><td>2017-01-10T18:44:36.000+0000</td></tr>
<tr><th>Updated</th><td>2018-08-06T17:49:35.000+0000</td></tr>
</table>

<h3>Description</h3>

I'm trying to define a custom hyperloop class to use as a callback delegate for CoreBluetooth on iOS.

However, I'm not able to specify the argument type properly for <code>NSDictionary&lt;NSString *,id&gt;</code>

I'm trying to define my delegate class to match <a href="https://developer.apple.com/reference/corebluetooth/cbcentralmanagerdelegate/1518937-centralmanager?language=objc" rel="nofollow" target="_blank">https://developer.apple.com/reference/corebluetooth/cbcentralmanagerdelegate/1518937-centralmanager?language=objc</a>


<code><pre>
var Delegate = Hyperloop.defineClass('CentralManagerDelegate', 'NSObject',["CBCentralManagerDelegate"]);

Delegate.addMethod({
  selector: "centralManager:didDiscoverPeripheral:advertisementData:RSSI:",  
  arguments: ["CBCentralManager","CBPeripheral","NSDictionary&lt;NSString *,id&gt;","NSNumber"],
  callback: function(central, peripheral, advertisementData, rssi) {
    if(this.didDiscoverPeripheral) {
      this.didDiscoverPeripheral(central, peripheral, advertisementData, rssi);
    }
  }
});
</pre></code>

But the <code>NSDictionary&lt;NSString *,id&gt;</code> string in the <code>arguments</code> array is generating a compile-time error:

<code><pre>
unknown encoding [CBCentralManager][CBPeripheral][NSDictionary&lt;NSString *,id&gt;][NSNumber] start at index 32
</pre></code>

If I change it to just <code>NSDictionary</code> it compiles, but then I don't have the correct data type inside my callback / delegate function

<h3>Comments</h3>

<ol>
<li>Hans Kn√∂chel 2017-01-10

   Hey [~ksouthworth], interesting issue! I agree we should support type specifications (not only in NSDictionary but also in other types like NSArray). Moving to TIMOB to be investigated!</li>
<li>Jan Vennemann 2017-03-31

   [~ksouthworth], omitting the generic part for the argument in your method definition shouldn't have an impact on the data you receive because the encoding stays the same. What exactly do you receive inside your callback and what's different than expected? I do not have a BLE device for testing at my disposal so i created a minimal [example Gist](<a href="https://gist.github.com/janvennemann/22c756b929dcaee3fefb716700de546e)" rel="nofollow" target="_blank">https://gist.github.com/janvennemann/22c756b929dcaee3fefb716700de546e)</a> and i can access the content of the NSDictionary just fine.
   
   However, i totally agree that you should be able to specify the parameter as <code>NSDictionary&lt;NSString *,id&gt;</code> without Hyperloop throwing the unknown encoding error.</li>
<li>Jan Vennemann 2017-05-03

   PR (master): <a href="https://github.com/appcelerator/hyperloop.next/pull/166" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/166</a>
   PR (2_1_X): <a href="https://github.com/appcelerator/hyperloop.next/pull/167" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/167</a>
   
   [~hansknoechel], tested it with Gist from my previous comment. The reporter being unable to properly access the data from the NSDictionary argument was probably related to TIMOB-24383.</li>
<li>Eric Merriman  2018-08-06

   Cleaning up older fixed issues. If this issue should not have been closed as fixed, please reopen.</li>
</ol>


<p><a href="/TIMOB/TIMOB-24291.json">JSON Source</a></p>