---
title: "[TIMOB-24312] Android: L() function not working in 6.0.1.GA but working as expected in 5.5.1.GA(Regression)"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-12-04T15:33:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.0.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Nazmus Salahin</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2017-01-16T13:35:04.000+0000</td></tr>
<tr><th>Updated</th><td>2018-12-04T15:33:40.000+0000</td></tr>
</table>

<h3>Description</h3>

Hi,
L() function not working on 6.0.1.GA but working as expected on 5.5.1.GA on android. 

Step to reproduce:
1. Create a test project.
2. Add the following code on app.js
<code><pre>
Ti.UI.setBackgroundColor('white');
var win = Ti.UI.createWindow({
	title : 'Click window to test',
	backgroundColor : 'white',
	exitOnClose : true,
	fullscreen : false
});

win.open();

function L(text) {
	if (Ti.App.languageXML === undefined || Ti.App.languageXML === null) {
		var langFile = Ti.App.Properties.getString('last_lang'); 
		var file = Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory,+langFile + '/string.xml'); 
		if (!file.exists()) {
			var langFile = "en"; // Fall back to english as the default
			file = Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory,'lang/' + langFile + '/string.xml');
		}
		var xmltext = file.read().text;
		var xmldata = Titanium.XML.parseString(xmltext); // Parse the xml
		Ti.App.languageXML = xmldata; // Store the parsed xml so that we don't
										
	}

	// Get the localised string from xml file
	var xpath = "/resources/string[@name='" + text + "']/text()";
	Ti.API.info("PAROLE PATH: " + JSON.stringify(xpath));
	var result = Ti.App.languageXML.evaluate(xpath).item(0);

	if (result) {
		return result.text;
	} else {
		return text;// Return the text if localised version not found
	}
}

alert("MICRO: "+JSON.stringify(L('microscope')));

Ti.API.info("MICRO: "+JSON.stringify(L('microscope')));

win.open();
</pre></code>
4. Add attached  string.xml  on i18n/en 

5. Now build with 5.5.1.GA
<code><pre>
[INFO] :   PAROLE PATH: "/resources/string[@name='microscope']/text()"
[INFO] :   MICRO: "MICROSCOPE"
</pre></code>
6. Now build with 6.0.1.GA
<code><pre>
[INFO] :   PAROLE PATH: "/resources/string[@name='microscope']/text()"
[INFO] :   MICRO: undefined
</pre></code>


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-24312_61255/strings.xml">strings.xml</td></td><td>2017-01-16T13:36:59.000+0000</td><td>16634</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-01-16

   Hey [~nsalahin],
   
   am I missing something or why don't you store you language keys in i18n/en/strings.xml?</li>
<li>Nazmus Salahin 2017-01-16

   Hi,
   I store language keys in i18n/en/strings.xml</li>
<li>Hans Knöchel 2017-01-16

   Sorry, I don't get that. Why are you creating an own <code>L()</code> function to the one that already exists and handles all this? If you followed [this guide](<a href="https://wiki.appcelerator.org/display/guides2/Internationalization)" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides2/Internationalization)</a>, the keys should work fine. </li>
</ol>


<p><a href="/TIMOB/TIMOB-24312.json">JSON Source</a></p>