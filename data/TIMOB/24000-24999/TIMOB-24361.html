---
title: "[TIMOB-24361] iOS: Using rgb color values causing a false warning, Android: 2-digit float-values do not work"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-05-09T22:33:03.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Components</th><td>Android, iOS</td></tr>
<tr><th>Labels</th><td>merge-6.1.0</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2017-01-31T20:42:25.000+0000</td></tr>
<tr><th>Updated</th><td>2017-05-09T23:14:18.000+0000</td></tr>
</table>

<h3>Description</h3>

In TIMOB-23453 we fixed an issue where a warning log was thrown when using <code>rgba()</code> values. Unfortunately, this did not include rgb-values, so for <code>rgb()</code> values the <code>[WARN] Hex color passed looks invalid: rgb(...)</code> warning is still logged. This should be fixed!

<h3>Comments</h3>

<ol>
<li>Michael Gangolf 2017-01-31

   The Android part of rgba() has a bug too:
   <a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/titanium/src/java/org/appcelerator/titanium/util/TiColorHelper.java#L28" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/titanium/src/java/org/appcelerator/titanium/util/TiColorHelper.java#L28</a>
   
   doesn't allow to have more than one number after the <code>.</code>
   
   while this is working in 6.0.1: <code>rgba(0.3, 1.0, 1.0, 0.1)</code> something like this won't work: <code>rgba(0.35, 0.55, 0.55, 0.15)</code>
   
   Fix for TiColorHelper.java:
   <code><pre>
   static Pattern rgbaPattern = Pattern.compile("rgba\\(\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*(\\d\\.\\d+)\\s*\\)");
   static Pattern floatsPattern = Pattern.compile("rgba\\(\\s*(\\d\\.\\d+)\\s*,\\s*(\\d\\.\\d+)\\s*,\\s*(\\d\\.\\d+)\\s*,\\s*(\\d\\.\\d+)\\s*\\)");
   </pre></code>
    the second <code>\d</code> always needs a <code>+</code>
   
   PR and test will follow. </li>
<li>Hans Knöchel 2017-01-31

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8809" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8809</a>
   
   Test-Case:
   <code><pre>
   var win = Titanium.UI.createWindow({
   	backgroundColor: 'rgb(255, 255, 0)', // Shoult not throw a warning, making the background yellow
   });
   
   win.addEventListener('click', function() {
   	win.setBackgroundColor('rgb(255.00, 255.00, 255.00, 0.55)'); // Should also work on Android, making the background gray
   });
   
   win.open();
   </pre></code></li>
<li>Vijay Singh 2017-02-08

   iOS changes are fine. </li>
<li>Gary Mathews 2017-02-14

   [~hansknoechel] [~vijaysingh] Here's a fixed test case, you may want to re-test iOS?
   
   <code><pre>
   var win = Titanium.UI.createWindow({
   	backgroundColor: 'rgb(255, 255, 0)', // background yellow
   });
    
   win.addEventListener('click', function() {
   	win.setBackgroundColor('rgba(1.00, 1.00, 1.00, 0.55)'); // background gray
   });
    
   win.open();
   </pre></code></li>
<li>Hans Knöchel 2017-02-16

   If Android works like this, we have a more critical parity issue than I thought here. They definitely need to work the same in the future. But that could be handled in an own ticket, where we need to think on how to deprecate properly without removing backwards compatibility.</li>
<li>Hans Knöchel 2017-05-03

   It has to be from 0-255, on both platforms. See the <code>Colors</code> section of [the docs](<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI) for details.
   
   Requested PR (6_1_X): <a href="https://github.com/appcelerator/titanium_mobile/pull/9011" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9011</a></li>
<li>Hans Knöchel 2017-05-03

   And [~michael]: I think we got confused by your comment about <code>rgba(0.3, 1.0, 1.0, 0.1)</code>, because the docs say 0-255 and you talked about 0-1. You ok as well with sticking with the 255-bit length?</li>
<li>Michael Gangolf 2017-05-03

   </li>
<li>Eric Wieber 2017-05-09

   FR Passed, using:
   MacOS 10.12 (16A323)
   Studio 4.9.0.201704061825
   Ti SDK 6.1.0.v20170503095848
   Appc NPM 4.2.9
   Appc CLI 6.2.0
   Alloy 1.9.11
   Xcode 8.3.2 (8E2002)
   
   2-digit float values are accepted on both iOS and Android platforms, for rgb() and rgba().</li>
<li>Eric Wieber 2017-05-09

    Fix verified in builds:
    6.1.0.v20170509153815
    6.2.0.v20170509154110</li>
</ol>


<p><a href="/TIMOB/TIMOB-24361.json">JSON Source</a></p>