---
title: "[TIMOB-24397] iOS: WebView - load a webpage with request headers"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-02-16T17:56:21.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, regression</td></tr>
<tr><th>Reporter</th><td>Christoph Eck</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2017-02-10T12:58:26.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-03T17:33:22.000+0000</td></tr>
</table>

<h3>Description</h3>

*Problem*
Opening a webpage like <a href="https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending" rel="nofollow" target="_blank">https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending</a> with request headers does not work.

_actual behavior_
<h4>click on 'open web page'</h4>
<h4>in the log is shown</h4>
{noformat}
[INFO] :   beforeload: <a href="https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending" rel="nofollow" target="_blank">https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending</a>
[INFO] :   beforeload: <a href="https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending" rel="nofollow" target="_blank">https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending</a>
[INFO] :   load: about:blank
[INFO] :   beforeload: about:blank
[INFO] :   beforeload: about:blank
[INFO] :   beforeload: about:blank
[INFO] :   beforeload: about:blank
{noformat}
<h4>webpage is not loaded</h4>

_expected behavior_
<h4>click on 'open web page'</h4>
<h4>in the log is shown</h4>
{noformat}
[INFO] :   beforeload: <a href="https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending" rel="nofollow" target="_blank">https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending</a>
[INFO] :   beforeload: <a href="https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending" rel="nofollow" target="_blank">https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending</a>
[INFO] :   load: <a href="https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending" rel="nofollow" target="_blank">https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending</a>
{noformat}
<h4>webpage is loaded</h4>

*Test case*
file index.js
<code><pre>
var win = Ti.UI.createWindow({
    backgroundColor : 'white'
});

var openButton = Ti.UI.createButton({
    title : 'Open web page',
    top : '200',
    height : Ti.UI.SIZE,
    left : '30',
});

openButton.addEventListener('click', function() {

    var ldf = Ti.Platform.displayCaps.logicalDensityFactor;
    var webView = Ti.UI.createWebView({
        height : Math.floor(Ti.Platform.displayCaps.platformHeight / ldf),
        width : Math.floor(Ti.Platform.displayCaps.platformWidth / ldf),
        backgroundColor : "white",
    });

    webView.setBasicAuthentication("username", "password");
    var requestHeaders = {
        "Accept-Language" : "en",
        "X-Agent" : "Mobile"
    };
    webView.setRequestHeaders(requestHeaders);

    webView.addEventListener('load', function() {
        Ti.API.info('load: ' + webView.url);
    });

    webView.addEventListener('beforeload', function() {
        Ti.API.info('beforeload: ' + webView.url);
    });

    webView.addEventListener('error', function() {
        Ti.API.info('error: ' + webView.url);
    });

    win.add(webView);

    var button = Ti.UI.createButton({
        title : 'Close',
        top : 25,
        bottom : 0,
        height : Ti.UI.SIZE,
        width : 100
    });

    button.addEventListener('click', function() {
        win.remove(webView);
    });

    webView.add(button);
    var url = "<a href="https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending" rel="nofollow" target="_blank">https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending</a>";
    webView.setUrl(url);
});

win.add(openButton);

win.open(); 
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-24397_61545/index.js">index.js</td></td><td>2017-02-10T12:56:17.000+0000</td><td>1526</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2017-02-10

   Hello, I can see the webpage loads fine in SDK 6.0.1.GA in iOS simulator. Please use the GA release. </li>
<li>Christoph Eck 2017-02-10

   Hi
   
   The setting of request headers is new for a WebView module and will be released in the version 6.1.0. Sorry I could not set the release version 6.1.0. Try it with the latest version 6.1.0.v20170209111025 and see if you could see the request headers set in the landing page. I have a pull request ready to solve the issue.
   
   Best regards
   
   Christoph</li>
<li>Sharif AbuDarda 2017-02-10

   Hello, yes, I was able to reproduce the issue in SDK 6.1.0 master release. Please add the PR. Thanks.</li>
<li>Hans Knöchel 2017-02-10

   Thanks for h follow-up Christoph, we will take care of it.</li>
<li>Hans Knöchel 2017-02-11

   QE: Test-cases can be found in TIMOB-24329 and TIMOB-17467, thx!</li>
<li>Josh Longton 2017-03-03

   
   {noformat}
   Mac OS Version : 10.12.3
   Xcode Version : Xcode 8.2 Build version 8C38
   Appc CLI : 6.1.0
   Appc NPM : 4.2.9-1
   Node : v4.6.0
   Device: iPhone 6 (10.2.1) iPhone 5 (9.3.5)
   {noformat}
   
   Using above env passed FR. After merge, the changes are present in SDK <code>6.1.0.v20170227120704</code>.
   
   *Closing*</li>
</ol>


<p><a href="/TIMOB/TIMOB-24397.json">JSON Source</a></p>