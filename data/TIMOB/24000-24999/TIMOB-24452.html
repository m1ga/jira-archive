---
title: "[TIMOB-24452] iOS: Handling responses from Ti.URLSession UploadTask API in the SDK"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-07-11T16:48:51.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>ios, networking</td></tr>
<tr><th>Reporter</th><td>Richard Lustemberg</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2017-03-03T13:11:49.000+0000</td></tr>
<tr><th>Updated</th><td>2018-10-23T09:53:46.000+0000</td></tr>
</table>

<h3>Description</h3>

Version 2.1.0 of ti.urlsession has support for NSURLSessionUploadTask.
Once the NSURLRequest is completed, the <code>sessioncompleted</code> event is fired with a success status, because the request received it's response. 
However, the response might have been a 401,still a success code would be set, because NSURLSessionUploadTask does not care for HTTP error statuses.
We might also want to handle the response code after the upload task is completed.
To do this we only need to add a delegate method from <code>NSURLSessionDataDelegate</code> and modify the sessioncompleted delegate. 
I will make a PR with the required changes, which are adding:

<code><pre>
-(void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)dataTask didReceiveData:(NSData *)data
</pre></code>

 and modify this other delegate method:
<code><pre>
-(void)URLSession:(NSURLSession *)session task:(NSURLSessionTask *)task didCompleteWithError:(NSError *)error
</pre></code>


<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2017-03-03

   Hello, Please create the PR and assign here. Moving to TIBOB.</li>
<li>Richard Lustemberg 2017-03-03

   I've renamed my branch to this Jira ticket and made the PR again. Do we need to apply again to have rights to create TIMOB tickets?</li>
<li>Hans Knöchel 2017-03-08

   Marking as Duplicate of MOD-2328 to centralize the communication.</li>
<li>Lee Morris 2017-03-22

   Closing ticket as duplicate and links to the related ticket has been provided above.</li>
<li>Hans Knöchel 2018-06-28

   Reopening since the other one was module-focussed and this one is SDK focussed. Assigning for our next release!</li>
<li>Hans Knöchel 2018-06-28

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8860" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8860</a></li>
<li>Hans Knöchel 2018-07-11

   Follow-up PR to fix the type warnings that only occurred after integrating into master: <a href="https://github.com/appcelerator/titanium_mobile/pull/10168" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10168</a></li>
<li>Samir Mohammed 2018-10-23

   *Closing ticket.* Verified fix in SDK version <code>7.5.0.v20181018133006</code>.
   
   *Test Environment*
   <code><pre>
   APPC Studio: 5.1.0.201808080937
   iPhone 6 Sim (iOS 12)
   APPC CLI: 7.0.6
   Operating System Name: Mac OS Mojave
   Operating System Version: 10.14
   Node.js Version: 8.9.1
   Xcode 10.0</pre></code>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-24452.json">JSON Source</a></p>