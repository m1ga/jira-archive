---
title: "[TIMOB-24453] iOS: Don't include metadata.json when no assets, utilize module version as a compiler flag"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-04-14T13:48:23.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2017-03-05T16:24:01.000+0000</td></tr>
<tr><th>Updated</th><td>2017-04-14T13:48:23.000+0000</td></tr>
</table>

<h3>Description</h3>

There are many use-cases where developers want the module version inside the module.xcconfig (e.g. when manually linking frameworks like [here](<a href="https://github.com/appcelerator-modules/ti.facebook/blob/master/ios/module.xcconfig#L12)" rel="nofollow" target="_blank">https://github.com/appcelerator-modules/ti.facebook/blob/master/ios/module.xcconfig#L12)</a> or [here](<a href="https://github.com/hansemannn/ti.googlesignin/blob/master/iphone/module.xcconfig#L9)." rel="nofollow" target="_blank">https://github.com/hansemannn/ti.googlesignin/blob/master/iphone/module.xcconfig#L9).</a> Module developers usually bump the version in both the manifest and this file, which can easily cause problems when they forget it (I did twice as well).

Long story short, we would add the compiler flag <code>TI_MODULE_VERSION</code> to the generated <code>module.xcconfig</code>, so people can use the flag with <code>$(TI_MODULE_VERSION)</code>.

Another thing was that we should only generate the <code>metadata.json</code> when there are JS files to encrypt. Otherwise, it will generate an empty json file that isn't required and also not generated when using the old build.py (rot in hell).

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-03-05

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8861" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8861</a>
   
   To test:
   <h4>Create a new iOS module with <code>appc new -t -p ios</code></h4>
   <h4>Build the module with <code>appc run -p ios --build-only</code></h4>
   <h4>Unzip the generated module</h4>
   <h4>Inspect the <code>modules/iphone/&lt;module-name&gt;/1.0.0/module.xcconfig</code> to include the <code>TI_MODULE_VERSION</code> compiler flag at the top of the file</h4></li>
</ol>


<p><a href="/TIMOB/TIMOB-24453.json">JSON Source</a></p>