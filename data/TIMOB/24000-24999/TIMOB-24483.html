---
title: "[TIMOB-24483] iOS: Unable to package with enterprise ad-hoc provision"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-03-20T17:01:26.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.0.2</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.0.3</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Eric Merriman </td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2017-03-13T23:54:06.000+0000</td></tr>
<tr><th>Updated</th><td>2017-05-15T14:36:24.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description:</h4>
Based on some customer feedback I believe we have an issue packaging using enterprise adhoc provisions. We will get an enterprise developer account and validate as soon as possible.

I am unsure if this is limited to Studio builds and not the CLI as we don't have data to show it works from the CLI.

<h4>Steps to reproduce:</h4>
1) Attempt to package a project with an enterprise adhoc provision

<h4>Result:</h4>
Failure as seen in TIMOB-24444

<h4>Expected Result:</h4>
Build completes successfully 


<h3>Comments</h3>

<ol>
<li>Thomas Neerup 2017-03-14

   I can verify that using CLI results in the same error</li>
<li>Chris Barber 2017-03-16

   Titanium SDK master PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8890" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8890</a>
   Titanium SDK 6_0_X PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8891" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8891</a>
   
   Note that you can no longer select ad hoc provisioning profiles for app store builds and vice versa.
   
   Observe that enterprise ad hoc provisioning profiles are now displayed in the <code>ti info -t ios</code> output.
   
   There is a flaw that I chose not to fix at this time where you can select a distribution cert that is not listed in the provisioning profile. The build will fail when Xcode signs the app. In the future, we should properly identify certs and filter out provisioning profiles that aren't associated to that cert. Ticket: TIMOB-24494.</li>
<li>Chris Barber 2017-03-16

   Note that Studio needs to properly handle enterprise provisioning profiles. Here's the ticket: TISTUD-8729.</li>
<li>Abir Mukherjee 2017-03-17

   Passed FR using this environment:
   NPM Version: 2.15.9
   Node Version: 4.5.0
   Mac OS: 10.12.3
   Appc CLI: 6.1.0
   Appc CLI NPM: 4.2.8
   Appcelerator Studio, build: 4.8.1.201612050850
   Xcode 8.2.1
   
   Passed FR. I created an Adhoc build with an Apple Enterprise account using the CLI, and no errors were seen.</li>
<li>Abir Mukherjee 2017-03-17

   Fixes are seen in this SDK:
   SDK 6.0.3.v20170317093820</li>
<li>Michael Landeck 2017-03-21

   I have still the same error with my enterprise profile, just a different error message 
   (works fine with 6.0.1):
   
   [INFO] :   Packaging for Ad Hoc distribution
   [ERROR] :  Failed to export archive to ipa
   [ERROR] :  The selected provisioning profile doesn't appear to be a Ad Hoc provisioning profile or match the signing identity.
   [ERROR] :  Please ensure you are using a valid Ad Hoc provisioning that is linked to the signing identity, then try again.
   [INFO] :   Finished building the application in 38s 432ms
   
   
   Operating System
     Name                        = Mac OS X
     Version                     = 10.12.3
     Architecture                = 64bit
     # CPUs                      = 4
     Memory                      = 17179869184
   Node.js
     Node.js Version             = 6.10.0
     npm Version                 = 3.10.10
   Titanium CLI
     CLI Version                 = 5.0.11
   Titanium SDK
     SDK Version                 = 6.0.3.v20170317093820
     SDK Path                    = /Users/ml/Library/Application Support/Titanium/mobilesdk/osx/6.0.3.v20170317093820
     Target Platform             = iphone
   
   </li>
<li>Hans Knöchel 2017-03-21

   [~mlandeck] Did you use Studio or CLI?</li>
<li>Chris Barber 2017-03-21

   [~mlandeck] If you're building from Studio, then it's possible Studio isn't displaying the valid list of provisioning profiles. I created TISTUD-8729 to address this.
   
   If you build using the CLI, then it should work.</li>
<li>Michael Landeck 2017-03-21

   Hi Hans,
   i'm using Studio..</li>
<li>Hans Knöchel 2017-03-21

    Ok, then it's what we suggested. You could use <code>appc run -p ios -T dist-adhoc</code> and select your correct profile from the CLI and we get the Studio fix ready asap. Sounds like a deal?</li>
<li>Michael Landeck 2017-03-21

    Ok, thanks, sounds good.</li>
<li>Alberto Marcone 2017-05-10

    this solution (and the update to 6.0.4) doesn't work on my install.
    I tried the "appc run -p ios -T dist-adhoc" and, after selecting identity and provisioning,  I get the error:
    
    [INFO]  Optimizing .plist and .png files
    [INFO]  Invoking xcodebuild
    [INFO]  Packaging for Ad Hoc distribution
    {color:red}[ERROR] Failed to export archive to ipa
    [ERROR] The selected provisioning profile "xxx (xxx)" is most likely not a valid Ad Hoc provisioning profile.
    [ERROR] Please ensure you are using a valid Ad Hoc provisioning that is linked to the signing identity, then try again.{color}
    [INFO]  Finished building the application in 49s 423ms
    
    
    The provisioning is valid and it's linked to the signing identity, we used it before and I double checked it.
    
    macOS 10.12.4, Xcode 8.3.1, TiSDK 6.0.4</li>
<li>Chris Barber 2017-05-10

    [~a.marcone] View the trace level log output and you'll see the exact command the build runs to export the IPA from the archive. You can copy and paste it to run it again and see the full error for yourself. The error is almost certainly a provisioning profile related problem.</li>
<li>Alberto Marcone 2017-05-15

    you were right, I put the trace level and this is the exact error:
    
    
    [TRACE] 2017-05-15 16:00:37.875 xcodebuild[26823:15650404] [MT] IDEDistribution: -[IDEDistributionLogging _createLoggingBundleAtPath:]: Created bundle at path '/var/folders/hq/km1drj0141v1bf195s13yq740000gp/T/xxx_2017-05-15_16-00-37.873.xcdistributionlogs'.
    [TRACE] 1.2.840.113635.100.1.61
    [TRACE] 2017-05-15 16:00:55.196 xcodebuild[26823:15650404] [MT] IDEDistribution: Step failed: <IDEDistributionThinningStep: 0x7ffbbd5b2c50>: Error Domain=IDEDistributionErrorDomain Code=14 "No applicable devices found." UserInfo={NSLocalizedDescription=No applicable devices found.}
    [TRACE] error: exportArchive: No applicable devices found.
    [TRACE]   
    [TRACE] Error Domain=IDEDistributionErrorDomain Code=14 "No applicable devices found." UserInfo={NSLocalizedDescription=No applicable devices found.}
    
    I found a thread on SO mentioning this ticket. I'm using TiSDK 6.0.4.</li>
<li>Alberto Marcone 2017-05-15

    updating to Xcode 8.3.2 fixed this. Thank you</li>
</ol>


<p><a href="/TIMOB/TIMOB-24483.json">JSON Source</a></p>