---
title: "[TIMOB-24605] Android: Setting "backgroundImage" to a web URL causes a crash if JS is running on the UI thread"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-08-24T01:43:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, backgroundImage, defaultImage, url, view</td></tr>
<tr><th>Reporter</th><td>ILAY SENER</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2017-04-20T09:40:20.000+0000</td></tr>
<tr><th>Updated</th><td>2018-08-24T01:43:44.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
Setting Android <code>View</code> property "backgroundImage" to a URL will cause a crash if "tiapp.xml" property "run-on-main-thread" is set to <code>true</code>.

_(This also happens with <code>ImageView</code> "defaultImage" property as well.)_

*Steps to reproduce:*
<h4>Uninstall the app from the device if already installed. (Will delete cached web responses.)</h4>
<h4>Make sure the Android device has Internet access.</h4>
<h4>Set "tiapp.xml" file property "run-on-main-thread" to <code>true</code>.</h4>
<h4>Build and run the below code.</h4>
<h4>Notice that the app crashes/hangs on startup.</h4>

tiapp.xml
<code><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ti:app xmlns:ti="<a href="http://ti.appcelerator.org" rel="nofollow" target="_blank">http://ti.appcelerator.org</a>"&gt;
	&lt;property name="run-on-main-thread" type="bool"&gt;true&lt;/property&gt;
&lt;/ti:app&gt;
</pre></code>

app.js
<code><pre>
var window = Ti.UI.createWindow();
window.add(Ti.UI.createView({
	backgroundImage: "<a href="http://raw.githubusercontent.com/recurser/exif-orientation-examples/master/Portrait_1.jpg" rel="nofollow" target="_blank">http://raw.githubusercontent.com/recurser/exif-orientation-examples/master/Portrait_1.jpg</a>",
}));
window.open();
</pre></code>


----
*Original Post:*
I am unable to set background image for an imageView using an external URL. It crashes the app, but only if ran via main thread.

*index.xml*
<code><pre>
&lt;Alloy&gt;
	&lt;Window&gt;
	        &lt;ImageView id="imageView" /&gt;
	&lt;/Window&gt;
&lt;/Alloy&gt;
</pre></code>

*index.js*
<code><pre>
var b = "<a href="http://www.onlineinstruments.co.in/assets/images/Online%20Logo_PNG.png" rel="nofollow" target="_blank">http://www.onlineinstruments.co.in/assets/images/Online%20Logo_PNG.png</a>";
$.imageView.setBackgroundImage(b);
</pre></code>

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2018-08-01

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/10222" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10222</a></li>
<li>Samir Mohammed 2018-08-14

   *Closing ticket.* Verified improvement in SDK version: <code>7.4.0.v20180810061237</code>. Application no longer crashes when setting a <code>backgroundimage</code> to a web URL when running on main thread. 
   
   *FR Passed (Test Steps):*
   <h4>Created a new application using Titanium </h4>
   <h4>Set the "tiapp.xml" file property "run-on-main-thread" to true.</h4>
   <h4>Built and ran the first test case in <a href="https://github.com/appcelerator/titanium_mobile/pull/10222" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10222</a></h4>
   <h4>Image was displayed successfully without any issues </h4>
   <h4>Uninstalled the created application</h4>
   <h4>Changed the code to match the second test case found in <a href="https://github.com/appcelerator/titanium_mobile/pull/10222" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10222</a></h4>
   <h4>Built and ran the second test case </h4>
   <h4>Image was displayed "upright" successfully and the application did not crash</h4>
   
   *Test Environment*
   <code><pre>
   APPC Studio: 5.0.0.201712081732
   APPC CLI: 7.0.4
   Pixel XL (8.1)
   Operating System Name: Mac OS High Sierra
   Operating System Version: 10.13
   Node.js Version: 8.9.1
   Xcode 9.2
   </pre></code>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-24605.json">JSON Source</a></p>