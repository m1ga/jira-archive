---
title: "[TIMOB-24686] Calling getWindow() on a null Activity reference"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>n/a</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Caio Iglesias</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2017-05-11T12:38:16.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-28T19:55:16.000+0000</td></tr>
</table>

<h3>Description</h3>

I have been eventually getting a crash with this exception:

<code><pre>
lang.java.NullPointerException: (Attempt to invoke virtual method 'android.view.Window android.app.Activity.getWindow()' on a null object reference)
at proxy.titanium.appcelerator.org.TiViewProxy.handleMessage(TiViewProxy.java:323)
at proxy.titanium.appcelerator.org.TiWindowProxy.handleMessage(TiWindowProxy.java:116)
at ui.titanium.modules.ti.WindowProxy.handleMessage(WindowProxy.java:453)
at os.android.Handler.dispatchMessage(Handler.java:98)
at os.android.Looper.loop(Looper.java:145)
at app.android.ActivityThread.main(ActivityThread.java:5951)
at reflect.lang.java.Method.invoke(Native Method)
at reflect.lang.java.Method.invoke(Method.java:372)
at os.internal.android.com.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1400)
at os.internal.android.com.ZygoteInit.main(ZygoteInit.java:1195)
</pre></code>

I checked [proxy.titanium.appcelerator.org.TiViewProxy's handleMessage method](<a href="https://github.com/appcelerator/titanium_mobile/blob/a8aceeaeee02ed9c8ea70c835a0e78960e254a55/android/titanium/src/java/org/appcelerator/titanium/proxy/TiViewProxy.java#L227)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/a8aceeaeee02ed9c8ea70c835a0e78960e254a55/android/titanium/src/java/org/appcelerator/titanium/proxy/TiViewProxy.java#L227)</a> and it indeed calls getWindow() on what is returned by TiApplication.getAppCurrentActivity(), on [MSG_GETSIZE](<a href="https://github.com/appcelerator/titanium_mobile/blob/a8aceeaeee02ed9c8ea70c835a0e78960e254a55/android/titanium/src/java/org/appcelerator/titanium/proxy/TiViewProxy.java#L296)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/a8aceeaeee02ed9c8ea70c835a0e78960e254a55/android/titanium/src/java/org/appcelerator/titanium/proxy/TiViewProxy.java#L296)</a> and on [MSG_GETRECT](<a href="https://github.com/appcelerator/titanium_mobile/blob/a8aceeaeee02ed9c8ea70c835a0e78960e254a55/android/titanium/src/java/org/appcelerator/titanium/proxy/TiViewProxy.java#L323)." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/a8aceeaeee02ed9c8ea70c835a0e78960e254a55/android/titanium/src/java/org/appcelerator/titanium/proxy/TiViewProxy.java#L323).</a> The [docs](<a href="http://docs.appcelerator.com/module-apidoc/latest/android/org/appcelerator/titanium/TiApplication.html)" rel="nofollow" target="_blank">http://docs.appcelerator.com/module-apidoc/latest/android/org/appcelerator/titanium/TiApplication.html)</a> state that TiApplication.getAppCurrentActivity() returns ??the current activity if exists. Otherwise, the thread will wait for a valid activity to be visible.??, but [it does in fact return null](<a href="https://github.com/appcelerator/titanium_mobile/blob/11ce8248edb5d821d18e1c3217bf06b99c96d33f/android/titanium/src/java/org/appcelerator/titanium/TiApplication.java#L294)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/11ce8248edb5d821d18e1c3217bf06b99c96d33f/android/titanium/src/java/org/appcelerator/titanium/TiApplication.java#L294)</a> if no Activity is present.

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-24686.json">JSON Source</a></p>