---
title: "[TIMOB-24816] Update the mocha suite in titanium_mobile_windows"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Epic</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Done</td></tr>
<tr><th>Resolution Date</th><td>2017-11-30T15:00:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Ewan Harris</td></tr>
<tr><th>Created</th><td>2017-06-13T16:48:42.000+0000</td></tr>
<tr><th>Updated</th><td>2017-11-30T15:00:49.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

Currently there are two mocha suites in existence:

* [titanium-mobile-mocha-suite](<a href="https://github.com/appcelerator/titanium-mobile-mocha-suite)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium-mobile-mocha-suite)</a>
 ** This is used in the titanium_mobile repo and is pulled down on each build

* [NMocha](<a href="https://github.com/appcelerator/titanium_mobile_windows/tree/master/Examples/NMocha)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/tree/master/Examples/NMocha)</a>
 ** This is specific to Windows, it lives in the Windows repo and is used for unit tests in the Windows SDK build process

These have diverged over time and there are differences between the two, it has been attempted to merge them previously <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/733" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/733</a>

It would be ideal to restart this effort of merging together with the eventual goal of updating the Windows SDK build process to pull the git repository like titanium_mobile

After discussions these are the steps to be taken for this

<h4>Work through the test files in comparing them against and updating titanium-mobile-mocha-suite</h4>
<h4>Merge the results of the above into titanium-mobile-mocha-suite, ensuring we do not cause failures on other platforms</h4>
<h4>Take the resulting suite from the merge, update NMocha with this for the short term</h4>
<h4>Investigate how we can use the titanium-mobile-mocha-suite repo in titanium_mobile_windows, initially we should look to use this in the build process, then we should look at how to update NMocha to pull this suite rather than checking the files in</h4>

Along the way the following should also be done

* File tickets for FIXME/TODO comments where appropriate, linking them in the mocha suite


<h3>Comments</h3>

<ol>
<li>Ewan Harris 2017-06-13

   A naively generated patch file of a diff between all .js files in Resources/ and Assets/ <a href="https://gist.github.com/ewanharris/dad0ba4c37104257335a5d48272fb252" rel="nofollow" target="_blank">https://gist.github.com/ewanharris/dad0ba4c37104257335a5d48272fb252</a></li>
<li>Ewan Harris 2017-06-16

   <a href="https://github.com/appcelerator/titanium-mobile-mocha-suite/pull/17" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium-mobile-mocha-suite/pull/17</a></li>
<li>Ewan Harris 2017-07-24

   Some thoughts I have
   
   - Don't use ti.facebook for the test, (or implement it for Windows), we probably want a dummy module of some sort
   - Should we move ti.map tests out (we still need to split it out of Windows core)
   - Should we move out tests like geolocation and contacts that seem to prompt and break things. They would be a perfect use for Appium!
   - Could we try and make HTTPClient less flaky? Avoid external network connections etc. or just skip in general in CI
   - Could we try and have some sort of percentage hit for total tests ran? Will help prevent the skipping of tests</li>
<li>Ewan Harris 2017-09-01

   </li>
<li>Ewan Harris 2017-11-30

   Closing as done as titanium_mobile_windows has been using the mocha-suite for a while now, kudos to [~kiguchi] and [~cwilliams] for carrying the effort over the line :D</li>
</ol>


<p><a href="/TIMOB/TIMOB-24816.json">JSON Source</a></p>