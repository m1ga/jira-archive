---
title: "[TIMOB-25012] Windows: Crash in mocha suite when checking instanceof against a blob"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2017-09-01T05:01:07.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>failure-reviewed</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2017-07-24T10:43:12.000+0000</td></tr>
<tr><th>Updated</th><td>2018-08-02T22:20:05.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description </h4>

When running the mocha suite, the ti.blob - constructed from image test crashes the application,
it crashes on the <code>should(blob).be.an.instanceof(Ti.Blob);</code> check

You can use <a href="https://github.com/ewanharris/mocha-test" rel="nofollow" target="_blank">https://github.com/ewanharris/mocha-test</a> to test this, just paste the code from the test suite it and it _should_ work

Interestingly, this is what the .instanceof assertion boils down to <code> Object(this.obj) instanceof constructor</code> so I think this crash might happen in the should.js lib somewhere

<h4>Steps to reproduce</h4>

<h4>Grab the code from the link in environment</h4>
<h4>Add to the test app provided at the git repo above</h4>
<h4>Build for any Windows target</h4>

<h4>Actual</h4>

App crashes

<h4>Expected</h4>

App should not crash

<h3>Comments</h3>

<ol>
<li>Kota Iguchi 2017-09-01

   So even when I create <code>Ti.Blob</code> instance from <code>new Ti.Blob()</code>, <code>blob instanceof Ti.Blob</code> fails. I think it's something to do in HAL implementation.
   
   <code><pre>
   var blob = new Ti.Blob();
   alert(blob instanceof Ti.Blob);
   </pre></code>
   
   Interestingly this code does not work with iOS too. As we think iOS as reference platform, I would think we can skip this test for now.
   
   <code><pre>
   var win = Ti.UI.createWindow({ backgroundColor: 'green' });
   var blob = Ti.Filesystem.getFile('app.js').read();
   win.addEventListener('open', function () {
       alert((blob instanceof Ti.Blob));
   });
   
   win.open();
   </pre></code>
   </li>
<li>Eric Merriman  2018-08-02

   Closing old "Won't fix" tickets. If you disagree, please reopen.</li>
</ol>


<p><a href="/TIMOB/TIMOB-25012.json">JSON Source</a></p>