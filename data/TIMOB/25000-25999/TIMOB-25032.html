---
title: "[TIMOB-25032] iOS: Resolve asset-catalog hashes back to real names, fail build when detecting duplicates"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-02-14T22:24:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.1.1, Release 8.2.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>asset-catalog, breaking-change, cb-tooling, engReviewed, ios</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Vijay Singh</td></tr>
<tr><th>Created</th><td>2017-07-27T14:13:17.000+0000</td></tr>
<tr><th>Updated</th><td>2020-02-14T22:24:49.000+0000</td></tr>
</table>

<h3>Description</h3>

As discussed during engineering week, we should step away from generating custom asset-image hashes and instead use the real name. Here are some reasons I had:
* Custom hashes make it extremly uggly to deal with custom storyboards that include images / icons. This is very common, since storyboards should show an empty UI state, that can have tab-icons in it. I've made one for a customer last year and it took me double the time dealing with hashes than implementing a full split-view storyboard
* Custom hashes cannot be used in Hyperloop. There could be utility-methods for it, but that attacks performance again when working with a larger number of images to process
* Custom hashes cannot be used in native module. Same struggle than above. For the [Ti.AlternateIcon](<a href="https://github.com/ccavazos/titanium-alternate-icons)" rel="nofollow" target="_blank">https://github.com/ccavazos/titanium-alternate-icons)</a> module, I needed to basically copy and paste half of our TiFilesystem API's into the module to generate the hashes.
* The *only* contra-point is that a developer might have an image in different directories that has the same name. Besides the fact that no one should ever do that anyway, I don't think anyone actually does. At least I didn't do in 50+ Titanium apps.

So what do we need to change?
* Remove the hash-generator from our iOS build
* Loop through the images to detect possible filename-duplicates. Throw error if any matches.
* Remove the hash-bridge in our Titanium core
* Add a note in the release-notes, so people having custom hashes right now can migrate

That's it!

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25032_67235/app.zip">app.zip</td></td><td>2020-01-16T20:55:35.000+0000</td><td>5015055</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25032_67173/TestAssetsCatalog.zip">TestAssetsCatalog.zip</td></td><td>2019-12-11T00:05:42.000+0000</td><td>48066</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2019-06-05

   Why have the watch status been removed from this? We need to prioritize this in order to support dark mode in iOS 13 properly. cc [~amukherjee] [~shaig]</li>
<li>Chris Barber 2019-06-05

   </li>
<li>Hans Knöchel 2019-06-05

   As discussed with Chris on Slack, I strongly disagree with him. On the native side (both iOS and Android) it will fail as well if you use same filenames, even when in different directories. Simply because modern asset managers do not use paths anymore but store them in a flat hierarchy. Hashing them was a *bad* idea in the first place and got worse every time it was touched. Issues with web views, launch screen images and now dark mode are making this an unmaintainable mess for the future and should be reverted. And again, I am speaking from a developer perspective where I have to suffer with this in really really large projects. Moving forward, the asset catalog plays a more and more important role in the iOS ecosystem (tvOS support, on-demand resources, iOS 13 binary optimization), so any non-conformant naming convention makes this harder in Titanium.
   
   And no, a cross-platform asset management system is not requested by anyone, so I wouldn't suggest to spend time on that, since it only breaks more overhead to the getting started with Titanium.</li>
<li>Chris Barber 2019-12-11

   [~vijaysingh] The only thing that comes to mind is the storyboards. If someone has a custom storyboard launch screen and wants to use a specific image, today they would need to build the app, then open the generated Xcode project to view the asset catalog and see what the hashed name is, then refer to the hashed image in the storyboard.
   
   If you remove the hashing, then their images won't be hashed and they won't be resolved. If the simply update their storyboards, then they're good to go.
   
   This is technically a breaking change, but we could add code that continues to hash images referenced from a storyboard -or- add code that fixes the images in the storyboard as it's copied to the build dir. The latter seems a little less horrible.</li>
<li>Vijay Singh 2020-01-16

   PR - <a href="https://github.com/appcelerator/titanium_mobile/pull/11437" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11437</a>
   
   Note - For testing, create alloy app. Replace app folder with attached folder. Run the app, click on label. It should add three image view on window.</li>
<li>Sohail Saddique 2020-02-04

   FR Passed. PR Merged.</li>
<li>Satyam Sekhri 2020-02-14

   Verified based on the test instructions.
   Verified on:
   Mac OS: 10.15.1
   SDK: 9.0.0.v20200214090043
   Appc 8.0.0-master.6
   JDK: 11.0.4
   Node: 10.16.3
   Studio: 6.0.0.201911251516
   Xcode: 11.2
   Device: iPhone XR(v13.2.2)</li>
</ol>


<p><a href="/TIMOB/TIMOB-25032.json">JSON Source</a></p>