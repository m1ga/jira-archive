---
title: "[TIMOB-25186] Android: Crash when clicking on label with SpannedString content"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-08-23T21:56:23.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.2.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android</td></tr>
<tr><th>Reporter</th><td>grebulon</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2017-08-22T10:15:12.000+0000</td></tr>
<tr><th>Updated</th><td>2017-08-28T21:40:53.000+0000</td></tr>
</table>

<h3>Description</h3>

TiUILabel sometimes crashes (rare) in onTouchEvent when clicking on a html link.

The bug is that the code calls:
<code>Layout layout = textView.getLayout();</code>
there is no test for:
<code>layout != null</code>
getLayout() can return null as described in the documentation.

It's hard to reproduce because the content of the textView has to change right before the click.

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-08-22

   Hey [~buddyguards], thank you for bringing this up! So this did not happen on SDK 6.1.1 and earlier? And as you already proposed a solution, may you be able to file a PR for the changed line as well? If not, our engineers will take care of it. Thank you!</li>
<li>Gary Mathews 2017-08-22

   master: <a href="https://github.com/appcelerator/titanium_mobile/pull/9340" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9340</a>
   6_2_X: <a href="https://github.com/appcelerator/titanium_mobile/pull/9341" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9341</a></li>
<li>Gary Mathews 2017-08-22

   [~hknoechel] I haven't assigned a fixVersion, not sure if this is going in <code>6.2.0</code> ?</li>
<li>Hans Knöchel 2017-08-22

   Should be save to take! Adding guards in this case cannot harm :). </li>
<li>Abir Mukherjee 2017-08-23

   Passed FR. I tried on two phones:
   *Android 7.1.2*: I was not able to reproduce the crash on the affected version. I did not see any crashes with the 6.2.0 fixVersion. I tried 200 times with each version.
   *Android 4.4.4* : I tried approximately 200 times with 6.2.0 and did not see any crashes. With 6.1.2.GA, I did see a crash after about 50 tries. I then tried another 300 times on 6.1.2.GA but did not see a crash. Although I was not able to consistently reproduce the issue on the affected version, I did not see any crash on the 6.2.0 fixVersion.</li>
<li>Abir Mukherjee 2017-08-28

   Changes are in SDKs:
   6.2.0.v20170827172423
   7.0.0.v20170828071347</li>
</ol>


<p><a href="/TIMOB/TIMOB-25186.json">JSON Source</a></p>