---
title: "[TIMOB-25287] iPhone X: Ti.UI.SearchBar in list-view get wrongly positioned"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-10-11T21:23:54.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.2.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.3.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>iphonex</td></tr>
<tr><th>Reporter</th><td>Vijay Singh</td></tr>
<tr><th>Assignee</th><td>Vijay Singh</td></tr>
<tr><th>Created</th><td>2017-09-15T09:45:35.000+0000</td></tr>
<tr><th>Updated</th><td>2018-11-01T10:28:27.000+0000</td></tr>
</table>

<h3>Description</h3>

While looking in TIMOB-25271, I found that when search started in list view in iPhone X, search bar get placed at wrong position. 


Test Case-


<code><pre>
var rows = [];
for (var i = 0; i &lt; 20; i++) {
    rows.push({ properties: { title: 'Row '+ i , backgroundColor: 'red', searchableText:'Row '+i}});
}
var win = Ti.UI.createWindow({
  title: 'TEST',
  backgroundColor: '#ffffff',
}); 
var sb = Ti.UI.createSearchBar();
 
var ls = Ti.UI.createListSection({
  items: rows
});
 
 var lv = Ti.UI.createListView({
    top : 0,
    sections: [ls],
    searchView: sb,
    resultsBackgroundColor: 'green',
    resultsSeparatorColor: 'blue'
});
 
sb.setHintText("test");
 sb.addEventListener('change', function(e){
  Ti.API.info(e.value);
});
 
 //when the return key is hit, remove focus from our searchBar
sb.addEventListener('return', function(e){
  sb.blur();
});
lv.addEventListener('itemclick', function(e) {
    Ti.API.info('click at index: ' + e.itemIndex);
});
 
win.add(lv);
win.open();
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25287_63279/screenshot_iphoneX.png">screenshot_iphoneX.png</td></td><td>2017-09-16T08:13:43.000+0000</td><td>78856</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-09-15

   Can you attach a screenshot?
   
   *EDIT*: Thanks! Also see [this post](<a href="https://www.bignerdranch.com/blog/get-your-apps-ready-for-iphone-x/)" rel="nofollow" target="_blank">https://www.bignerdranch.com/blog/get-your-apps-ready-for-iphone-x/)</a> that talks about the search-bar as well. The fix would basically be:
   <code><pre>
   if ([TiUtils isiOS11OrLater]) {
       self.navigationItem.searchController = searchController;
       searchController.isActive = YES;
   } else {
       // Old behavior
   }
   </pre></code></li>
<li>Matthew Delmarter 2017-09-16

   A couple of other interesting links in relation to issues with the searchBar in iOS 11. 
   
   The actual size of the searchBar has changed. It seems you might be able to control it:
   <a href="https://stackoverflow.com/questions/46037928/ios-11-uisearchbar-in-navigation-bar" rel="nofollow" target="_blank">https://stackoverflow.com/questions/46037928/ios-11-uisearchbar-in-navigation-bar</a>
   
   And then when the searchBar is needed in the navigationBar then as Hans mentioned in the previous comment, you need to use the new searchController option. This link has a nice screenshot of the problem etc:
   <a href="https://stackoverflow.com/questions/45350035/ios-11-searchbar-in-navigationbar" rel="nofollow" target="_blank">https://stackoverflow.com/questions/45350035/ios-11-searchbar-in-navigationbar</a></li>
<li>Matthew Delmarter 2017-09-16

   </li>
<li>Vijay Singh 2017-09-27

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/9483" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9483</a>
   PR (6_3_X): <a href="https://github.com/appcelerator/titanium_mobile/pull/9482" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9482</a>
   
   Test Case - 
   1 . 
   <code><pre>
   var rows = [];
   for (var i = 0; i &lt; 20; i++) {
       rows.push({ properties: { title: 'Row '+ i , backgroundColor: 'red', searchableText:'Row '+i}});
   }
   var win = Ti.UI.createWindow({
     title: 'TEST',
     backgroundColor: '#ffffff',
   }); 
   var sb = Ti.UI.createSearchBar();
    
   var ls = Ti.UI.createListSection({
     items: rows
   });
    var lv = Ti.UI.createListView({
       sections: [ls],
       searchView: sb,
   });
    
   sb.setHintText("test");
    sb.addEventListener('change', function(e){
     Ti.API.info(e.value);
   });
    //when the return key is hit, remove focus from our searchBar
   sb.addEventListener('return', function(e){
     sb.blur();
   });
   lv.addEventListener('itemclick', function(e) {
       Ti.API.info('click at index: ' + e.itemIndex);
   });
   win.add(lv);
   var navWin = Ti.UI.iOS.createNavigationWindow({window: win});
   navWin.open();
   </pre></code>
   
   2. 
   <code><pre>
   var rows = [];
   for (var i = 0; i &lt; 20; i++) {
       rows.push({ properties: { title: 'Row '+ i , backgroundColor: 'red', searchableText:'Row '+i}});
   }
   var win = Ti.UI.createWindow({
     title: 'TEST',
     backgroundColor: '#ffffff',
   }); 
   var sb = Ti.UI.createSearchBar();
    
   var ls = Ti.UI.createListSection({
     items: rows
   });
    
    var lv = Ti.UI.createListView({
       sections: [ls],
       searchView: sb,
       top:100
   });
   sb.setHintText("test");
    sb.addEventListener('change', function(e){
     Ti.API.info(e.value);
   });
    //when the return key is hit, remove focus from our searchBar
   sb.addEventListener('return', function(e){
     sb.blur();
   });
   lv.addEventListener('itemclick', function(e) {
       Ti.API.info('click at index: ' + e.itemIndex);
   });
    
   win.add(lv);
   win.open();
   </pre></code>
   
   3. TiUITableView
   
   <code><pre>
   var rows = [];
   for (var i = 0; i &lt; 20; i++) {
       rows.push({ title: 'Row '+ i});
   }
    
    
   var win = Ti.UI.createWindow({
     title: 'TEST',
     backgroundColor: '#ffffff',
   });
     
   var sb = Ti.UI.createSearchBar();
    
   var lv = Ti.UI.createTableView({
       hideSearchOnSelection: false,
       data: rows,
       search: sb,
       top:50
   });
    
    sb.setHintText("test");
    sb.addEventListener('change', function(e){
     Ti.API.info(e.value);
   });
    
    //when the return key is hit, remove focus from our searchBar
   sb.addEventListener('return', function(e){
   sb.blur();
   });
    
   //when the cancel button is tapped, remove focus from our searchBar
   sb.addEventListener('cancel', function(e){
   //sb.blur();
   });
   lv.addEventListener('click', function(e) {
       Ti.API.info('click at index: ' + e.index);
       Ti.API.info('clicked row data: ' + e.rowData.title);
    
   })
    
   win.add(lv);
   win.open();
   </pre></code></li>
<li>Eric Wieber 2017-10-11

   FR Passed. Searchbar displays in the correct position on iPhone X. Tested using the provided cases in this and the related ticket that the PR is for as well as the searchbar suite</li>
<li>Eric Wieber 2017-10-11

   Verified in SDK builds 6.3.0.v20171011142527 & 7.0.0.v20171009065347</li>
<li>Matthew Delmarter 2018-11-01

   Did the new searchController referred to by @Hans ever get implemented?
   
   He talked about...
   
   <code><pre>
   if ([TiUtils isiOS11OrLater]) {
       self.navigationItem.searchController = searchController;
       searchController.isActive = YES;
   } else {
       // Old behavior
   }
   </pre></code></li>
<li>Hans Knöchel 2018-11-01

   I don't think so far! I just created a new ticket (TIMOB-26509) to track this. We need this as well, thanks for the hint!</li>
</ol>


<p><a href="/TIMOB/TIMOB-25287.json">JSON Source</a></p>