---
title: "[TIMOB-25292] iOS: Failed to expand identifiers when using 6.2.0"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2017-09-21T18:15:30.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.2.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>icloud, ios</td></tr>
<tr><th>Reporter</th><td>Sebastian Klaus</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2017-09-15T14:04:27.000+0000</td></tr>
<tr><th>Updated</th><td>2018-08-06T17:52:04.000+0000</td></tr>
</table>

<h3>Description</h3>

{noformat}
Operating System
  Name                        = Mac OS X
  Version                     = 10.12.6
  Architecture                = 64bit
  # CPUs                      = 8
  Memory                      = 17179869184

Node.js
  Node.js Version             = 6.10.3
  npm Version                 = 4.6.1

Titanium CLI
  CLI Version                 = 5.0.14

Titanium SDK
  SDK Version                 = 6.2.0.GA
  SDK Path                    = /Users/sebastianklaus/Library/Application Support/Titanium/mobilesdk/osx/6.2.0.GA
  Target Platform             = iphone
{noformat}


I can't compile my project with 6.2.0.GA

I'm using an extra Entitlements.plist for some iCloud functions.

With 6.1.1.GA and 6.1.2.GA compiling works as expected.

<code><pre>
[ERROR] 2017-09-15 15:55:44.004 xcodebuild[58753:29013239] [MT] DVTAssertions: Warning in /Library/Caches/com.apple.xbs/Sources/IDEXcode3ProjectSupport/IDEXcode3ProjectSupport-12122/Xcode3Core/LegacyProjects/Frameworks/DevToolsCore/DevToolsCore/ProjectModel/Capabilities/Xcode3TargetCapabilitiesContext.m:308
[ERROR] Details:  Failed to expand identifiers "{(
[ERROR]     "iCloud.$(CFBundleIdentifier)"
[ERROR] )}": Error Domain=IDECapabilitiesErrorDomain Code=1 "The operation requires a selected developer portal team." UserInfo={NSLocalizedDescription=The operation requires a selected developer portal team., NSLocalizedRecoverySuggestion=}
[ERROR] Object:   &lt;Xcode3TargetCapabilitiesContext: 0x7f86fe3a5480&gt;
[ERROR] Method:   -_appIDFeatureStateIncludingEntitlements:buildConfiguration:
[ERROR] Thread:   &lt;NSThread: 0x7f86f9502720&gt;{number = 1, name = main}
[ERROR] Please file a bug at <a href="http://bugreport.apple.com" rel="nofollow" target="_blank">http://bugreport.apple.com</a> with this warning message and any useful information you can provide.
[ERROR] 2017-09-15 15:55:44.010 xcodebuild[58753:29013239] [MT] DVTAssertions: Warning in /Library/Caches/com.apple.xbs/Sources/IDEXcode3ProjectSupport/IDEXcode3ProjectSupport-12122/Xcode3Core/LegacyProjects/Frameworks/DevToolsCore/DevToolsCore/ProjectModel/Capabilities/Xcode3TargetCapabilitiesContext.m:308
[ERROR] Details:  Failed to expand identifiers "{(
[ERROR]     "iCloud.$(CFBundleIdentifier)"
[ERROR] )}": Error Domain=IDECapabilitiesErrorDomain Code=1 "The operation requires a selected developer portal team." UserInfo={NSLocalizedDescription=The operation requires a selected developer portal team., NSLocalizedRecoverySuggestion=}
[ERROR] Object:   &lt;Xcode3TargetCapabilitiesContext: 0x7f86fe3a5480&gt;
[ERROR] Method:   -_appIDFeatureStateIncludingEntitlements:buildConfiguration:
[ERROR] Thread:   &lt;NSThread: 0x7f86f9502720&gt;{number = 1, name = main}
[ERROR] Please file a bug at <a href="http://bugreport.apple.com" rel="nofollow" target="_blank">http://bugreport.apple.com</a> with this warning message and any useful information you can provide.
[ERROR] ** BUILD FAILED **
[ERROR] The following build commands failed:
[ERROR]         ProcessPCH++ build/Intermediates/PrecompiledHeaders/Fantastic_Library_Prefix-gjhhtrkmcwrhitdombgchdymigcr/Fantastic_Library_Prefix.pch.pch Fantastic_Library_Prefix.pch normal x86_64 objective-c++ com.apple.compilers.llvm.clang.1_0.compiler
[ERROR] (1 failure)
</pre></code>

I compared the _build.js of 6.1.2 und 6.2.0 and there are huge differences working with provisioning files. Maybe there is an bug?

Any hint what I can do?

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-09-15

   Hey there! Can you provide a sample project to reproduce? And do you use the latest Ti.iCloud module? Because that one injects the iCloud capabilities automatically. Rather than that, you could also try to setting the entitlements in the <entitlements> section of the tiapp.xml we introduced a few releases. But anyway, we will look into fixing this so you don't need any workaround. Thanks!
   
   EDIT: There are many discussions like [here](<a href="https://forums.developer.apple.com/thread/63625)" rel="nofollow" target="_blank">https://forums.developer.apple.com/thread/63625)</a> about it. The error is <code>The operation requires a selected developer portal team.</code>, did you try to fix that? Also ensure to not use a profile that uses automatic code-signing. We will troubleshoot more once we have the module version and requested infos.</li>
<li>Sebastian Klaus 2017-09-15

   Unfortunately I can't create an example project. I'm using this [module](<a href="https://github.com/sagar15bhavsar/iOSiCloudSyncDemo)" rel="nofollow" target="_blank">https://github.com/sagar15bhavsar/iOSiCloudSyncDemo)</a> 
   
   Setting the entitlements directly in the tiapp.xml section did not help.
   
   How to deactivate automatic code-signing? I never saw this option before.</li>
<li>Hans Knöchel 2017-09-16

   Ok. Automatic code-signing is just used in profiles created in Xcode. So as long as you create them via the developer portal, they would be manual like before. But I don't think that's the issue. It may be something in the code we changed to support Xcode 9, so it will be investigated.</li>
<li>Chris Barber 2017-09-19

   I'm having difficulties reproducing this. [~benutzername] does your <code>&lt;id&gt;</code> in the tiapp.xml have any special or unicode characters? I can't get the "Failed to expand identifiers" error to occur.
   
   Secondly, while trying to get this to work, I found a bug when exporting the IPA during packaging an app for distribution when the app using iCloud. See TIMOB-25319 for more information.</li>
<li>Sebastian Klaus 2017-09-20

   Hey Chris, I don't have any special chars in my id.</li>
<li>Sebastian Klaus 2017-09-20

   This is the iCloud module I'm currently using: [com.sagar.iclouddbsync](<a href="https://www.dropbox.com/s/81ib2q15jowcedr/com.sagar.iclouddbsync.zip?dl=0)" rel="nofollow" target="_blank">https://www.dropbox.com/s/81ib2q15jowcedr/com.sagar.iclouddbsync.zip?dl=0)</a>
   
   Maybe it helps to reproduce the bug</li>
<li>Hans Knöchel 2017-09-20

   [~benutzername] Did you try the [PR](<a href="https://github.com/appcelerator/titanium_mobile/pull/9447/files)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9447/files)</a> already? 
   
   Regarding the build-issues [~cbarber] had, it was an issue in the module where the module.xcconfig linked <code>Foundation</code> although Titanium does already. This may have worked before, but will now error out as we rewrote the framework-handling to be more smart (sounds weird in this context as it fails). So removing the "Foundation" framework from the xcconfig will resolve those issues, the other one could be solved by the above PR.</li>
<li>Sebastian Klaus 2017-09-20

   What I now did:
   
   Copied the module and created a version [6.0](<a href="https://www.dropbox.com/s/81ib2q15jowcedr/com.sagar.iclouddbsync.zip?dl=0)" rel="nofollow" target="_blank">https://www.dropbox.com/s/81ib2q15jowcedr/com.sagar.iclouddbsync.zip?dl=0)</a> where I removed the Foundation framework in the xcconfig. I also deleted the platform folder within the module version.
   
   After that I cleaned the build folder and compiled against 6.3.0.v20170919115627 with changes from the [PR](<a href="https://github.com/appcelerator/titanium_mobile/pull/9447/files)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9447/files)</a>
   
   The result is:
   
   {noformat}
   [INFO]  Writing i18n files
   [INFO]  Processing Titanium symbols
   [INFO]  Removing files
   [INFO]  Invoking xcodebuild
   [ERROR] ** BUILD FAILED **
   [ERROR] The following build commands failed:
   [ERROR]         Ld build/Products/Debug-iphonesimulator/Fantastic\ Library.app/Fantastic\ Library normal x86_64
   [ERROR] (1 failure)
   {noformat}
   </li>
<li>Hans Knöchel 2017-09-20

   For whatever reason, the module references a local "Foundation.framework" in platform/ as well (thanks to [~jvennemann] for noticing), which is a no-go for any module or framework. You may want to remove that one as well and contact the author about the behavior. After removing it, the build should succeed. If not, please send us over the trace log that will contain the actual xcodebuild error.</li>
<li>Sebastian Klaus 2017-09-20

    After some time playing it works now. Found some other "bugs" in modules like
    
    {noformat}
    [TRACE] :  Undefined symbols for architecture x86_64:
    [TRACE] :    "_OBJC_CLASS_$_TiUIiOSToolbarProxy", referenced from:
    [TRACE] :        l_OBJC_$_CATEGORY_TiUIiOSToolbarProxy_$_Extended in libdk.napp.ui.a(TiUIiOSToolbarProxy+Extended.o)
    [TRACE] :  ld: symbol(s) not found for architecture x86_64
    [TRACE] :  clang: error: linker command failed with exit code 1 (use -v to see invocation)
    {noformat}
    
    which I now try to fix</li>
<li>Chris Barber 2017-09-21

    This is starting to sound like an issue with the module and not with the iOS build. I'm tempted to resolve this as "invalid" or "not our bug", but if anybody has any strong feelings that there indeed is an issue with the iOS build, then we can keep this ticket open and try to fix it. Thanks!</li>
<li>Sebastian Klaus 2017-09-21

    It seems so. I followed the advices and everything works fine now. So it is not your bug. </li>
<li>Hans Knöchel 2017-09-21

    Beautiful, thanks! Btw, for the future, we may want to add the functionality of the module inside Ti.iCloud which we recently open-sourced :-).</li>
<li>Sebastian Klaus 2017-09-21

    That would be awesome  </li>
<li>Sebastian Klaus 2017-09-26

    [~hknoechel] can you say something about a programming start time for Ti.iCloud file managing?</li>
<li>Hans Knöchel 2017-09-26

    Not scheduled. The underlaying native library used is <a href="https://github.com/drewmccormack/icloudaccess" rel="nofollow" target="_blank">https://github.com/drewmccormack/icloudaccess</a>, so feel free to extend it until we come to it!</li>
<li>Eric Merriman  2018-08-06

    Closing as "not our bug". If you disagree, please reopen.</li>
</ol>


<p><a href="/TIMOB/TIMOB-25292.json">JSON Source</a></p>