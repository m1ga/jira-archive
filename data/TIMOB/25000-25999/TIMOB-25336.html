---
title: "[TIMOB-25336] iOS 11: openPhotoGallery/allowEditing does not crop correctly. "
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2020-03-10T17:25:22.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.2.2, Release 6.2.0, Release 6.2.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>applebug, engReviewed, ios11, openphotogallery</td></tr>
<tr><th>Reporter</th><td>Grant Wolz </td></tr>
<tr><th>Assignee</th><td>Vijay Singh</td></tr>
<tr><th>Created</th><td>2017-09-22T19:05:44.000+0000</td></tr>
<tr><th>Updated</th><td>2020-03-10T17:25:22.000+0000</td></tr>
</table>

<h3>Description</h3>

If you open the devices photos with allowEditing: true you are allowed to crop the photo in device. I have found that with the update to iOS 11 all of my crops do not match what the user as set in the crop window. 

Attached is a simple code to edit a photo and display it. 

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63348/1.png">1.png</td></td><td>2017-09-23T18:08:09.000+0000</td><td>1236501</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63349/2.png">2.png</td></td><td>2017-09-23T18:08:24.000+0000</td><td>2187749</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63350/3.png">3.png</td></td><td>2017-09-23T18:08:18.000+0000</td><td>1845384</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63347/app.js">app.js</td></td><td>2017-09-22T19:01:00.000+0000</td><td>949</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63351/B1.png">B1.png</td></td><td>2017-09-23T18:11:50.000+0000</td><td>2407618</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63352/B2.png">B2.png</td></td><td>2017-09-23T18:11:48.000+0000</td><td>1252082</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63369/captured_image.png">captured_image.png</td></td><td>2017-09-28T09:37:14.000+0000</td><td>401444</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63370/crop_rect.png">crop_rect.png</td></td><td>2017-09-28T09:37:14.000+0000</td><td>885356</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25336_63368/TestCameraImage.zip">TestCameraImage.zip</td></td><td>2017-09-28T09:37:02.000+0000</td><td>33756</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-09-23

   hey there, I tried reproducing the issue was unable to. Tested on an iPhone X and the images looks correctly (although in the example you were forcing a square-image which would stretch the image in some cases, e.g. for images where the width is greater than the height). If you can attach your results, we may be able to help, thx! I've added three images to show the select->crop->display flow between iOS < 11 and iOS 11.
   
   *EDIT*: However, B1 and B2 demonstrate the incorrect behavior, which is interesting because it's not for all kind of crops. Moving to TIMOB for now, but may even be an iOS 11 issue.
   
   *EDIT 2*: Ok, here is the issue: Edited images usually come/came in a lower quality (640x640px), so we introduced a manual cropping in TIMOB-7511 which now looks like it's causing issues - probably around scaling. Why ever this changed between iOS < 11 and iOS 11.
   
   These are the differences between iOS 10.3.1 and iOS 11 (same device, same photo):
   
   *iOS 10.3.1*:
   original: <UIImage: 0x608000289c90> size {4288, 2848} 
   edited: <UIImage: 0x60800009bda0> size {1239, 1239}
   edited rect: NSRect: <code>0, 0}, {2686, 2686</code>
   
   *iOS 11*:
   original: <UIImage: 0x60c0000a6000> size {4288, 2848}
   edited: <UIImage: 0x60c0000a5dc0> size {1242, 1209}
   edited rect: NSRect: <code>0, 0}, {1879, 1834</code>
   </li>
<li>Grant Wolz  2017-09-23

   Yes B1 and B2 shows the exact problem that I have been having in my testing. Glad you guys are working on it!</li>
<li>Vijay Singh 2017-09-28

   I have verified the behavior in native app (attached “TestCameraImage.zip”) for iOS11 and found that in native app also it is behaving same . I have attached two screenshots - 
   1. crop_rect.png - Screenshot taken when image is selected and open in crop mode.
   2. captured_image.png - Screenshot taken when “choose” button selected and cropped image set to image view.
   
   If you see ‘captured_image.png’, you will see that actually captured image has came from area bounded between two horizontal red lines in ‘crop_rect.png’. Ideally it should capture image from default crop rectangle area which can be seen in ‘crop_rect.png’.
   
   It looks cropping  rectangle is getting translated in vertical upward direction, which is problem with iOS 11.
    I think apple will correct in upcoming  releases of  iOS 11.
   Thanks!</li>
<li>Hans Knöchel 2017-09-28

   Thanks for the analysis Vijay! I've filed a bug-report at Apple: <a href="https://openradar.appspot.com/radar?id=4946037680635904" rel="nofollow" target="_blank">https://openradar.appspot.com/radar?id=4946037680635904</a></li>
<li>Vijay Singh 2019-04-04

   Checked on iOS 12.2 / Xcode 10.2 still issue is there. It looks apple has not fixed it yet.</li>
<li>Vijay Singh 2020-03-10

   Verified it in iOS 13.x . It is working fine. Apple has fixed the issue.</li>
</ol>


<p><a href="/TIMOB/TIMOB-25336.json">JSON Source</a></p>