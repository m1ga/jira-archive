---
title: "[TIMOB-25418] Android: Module build will fail if documentation folder contains non-markdown files"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-05-01T17:13:18.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, build-tools, module</td></tr>
<tr><th>Reporter</th><td>Michael Gangolf</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2017-09-25T17:26:19.000+0000</td></tr>
<tr><th>Updated</th><td>2018-06-27T14:26:16.000+0000</td></tr>
</table>

<h3>Description</h3>

When trying to compile this Android module: <a href="https://github.com/nuno/TiCollectionView" rel="nofollow" target="_blank">https://github.com/nuno/TiCollectionView</a> the current CLI will stop at
<code><pre>[INFO]  Packaging the module</pre></code>
because the documentation folder (<a href="https://github.com/nuno/TiCollectionView/tree/master/android/documentation)" rel="nofollow" target="_blank">https://github.com/nuno/TiCollectionView/tree/master/android/documentation)</a> contains images.

The _buildModule.js tries to generate markdown out of the files at
<a href="https://github.com/appcelerator/titanium_mobile/blob/b56b146871238abe931333ead44b5b5b027e877f/android/cli/commands/_buildModule.js" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/b56b146871238abe931333ead44b5b5b027e877f/android/cli/commands/_buildModule.js</a>

Since I'm not sure what files are allowed in this folder a fix would be to exclude images:
<code><pre>
if (fs.statSync(currentFile).isFile() &&
	currentFile.indexOf(".png") == -1 &&
	currentFile.indexOf(".gif") == -1) {
	var obj = {},
		contents = fs.readFileSync(currentFile).toString();

	obj[file] = markdown.toHTML(contents);
	this.documentation.push(obj);
}
</pre></code>

or only allow <code>.md</code> files (or even .txt) 

<code><pre>
if (fs.statSync(currentFile).isFile() &&
	(currentFile.indexOf(".md") != -1 ||
	currentFile.indexOf(".txt") != -1)) {
	var obj = {},
		contents = fs.readFileSync(currentFile).toString();

	obj[file] = markdown.toHTML(contents);
	this.documentation.push(obj);
}
</pre></code>

Ti 6.2.2.GA

<h3>Comments</h3>

<ol>
<li>Lorenzo Piccinini 2017-10-30

   I have different problem. TiCollectionView module works so good in iOS but there is little bug in android version and it doesn't works in Vanilla style project (Alloy version it seems works fine).
   Can someone try to solve it? I'm not able to do it.
   
   
   Best regards</li>
<li>Hans Knöchel 2018-01-28

   Ok, so here is the thing. Different to other (meta) directories, the <code>documentation</code> directory is meant to only store markdown files, as module build generates HTML docs based on those, like Michael stated above. So I would either propose to warn/error if there are other files or skip them for generation but include them in the generated docs, because the markdown files may have a reference to assets like images in them.</li>
<li>Hans Knöchel 2018-01-28

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/9778" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9778</a>
   
   Test-case:
   <h4>Create a new Android module with <code>appc new -t module</code></h4>
   <h4>Create a "documentation" directory in <code><module-name>/android/documentation</code></h4>
   <h4>Create an "index.md" with the following contents in it:</h4>
   <code><pre>
   <h4>Hello world</h4>
   
   <h4>Remote</h4>
   
   ![Image of Yaktocat](<a href="https://octodex.github.com/images/yaktocat.png)" rel="nofollow" target="_blank">https://octodex.github.com/images/yaktocat.png)</a>
   
   <h4>Local</h4>
   
   ![Hyperloop Logo](hyperloop-red.png)
   </pre></code>
   <h4>Copy the "hyperloop-red.png" from this ticket to the directory as well</h4>
   <h4>Package the module with <code>appc run -p android --build-only</code></h4>
   <h4>Unzip the module from dist/ and observe that the <code>documentation</code> directory includes both the index.html and hyperloop-red.png files.</h4></li>
<li>Samir Mohammed 2018-06-27

   *Closing ticket.* Verified fix can be seen in SDK Version: <code>7.3.0.v20180625114905</code>
   
   *FR (Passed) Test Steps:*
   
   <h4>Created an Android Module through the CLI</h4>
   <h4>Added the following content to the <code>index.md</code> in the <code>documentation</code> directory </h4>
   <code><pre>
   <h4>Hello world</h4>
    
   <h4>Remote</h4>
    
   ![Image of Yaktocat](<a href="https://octodex.github.com/images/yaktocat.png)" rel="nofollow" target="_blank">https://octodex.github.com/images/yaktocat.png)</a>
    
   <h4>Local</h4>
    
   ![Hyperloop Logo](hyperloop-red.png)
   </pre></code>
   <h4>Added a <code>hyperloop-red.png</code> in to the same directory </h4>
   <h4>Packaged the module (Android)</h4>
   <h4>Unzipped the module (dist folder) and observed the <code>documentation</code> directory</h4>
   <h4>Able to see an open the <code>index.md</code>, <code>hyperloop-red.png</code> files </h4>
   <h4>Also able to package the module from <a href="https://github.com/nuno/TiCollectionView" rel="nofollow" target="_blank">https://github.com/nuno/TiCollectionView</a></h4>
   
   *Test Environment*
   <code><pre>
   APPC CLI: 7.0.4
   Operating System Name: Mac OS High Sierra
   Operating System Version: 10.13
   Node.js Version: 8.9.1
   Xcode 9.2
   </pre></code>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-25418.json">JSON Source</a></p>