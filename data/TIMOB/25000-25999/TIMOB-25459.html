---
title: "[TIMOB-25459] iOS: toImage method needs parity with Android & Windows"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-11-10T01:05:07.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>Android, toImage</td></tr>
<tr><th>Reporter</th><td>Jorge Macias Garcia</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2017-10-30T13:28:08.000+0000</td></tr>
<tr><th>Updated</th><td>2017-11-15T05:26:33.000+0000</td></tr>
</table>

<h3>Description</h3>

When use toImage method on View we have a discrepance between iOS and the Android / Windows callback parameter

Sample:
index.js

<code><pre>
$.addListener($.index, 'postlayout', function (e) {
  $.box.toImage(function (e) {
        if (OS_IOS) {
            //e is a Event object who has a blob key: e.blob
            $.img.setImage(e.blob);
        } else if (OS_ANDROID || OS_WINDOWS) {
            //e is a Ti.Blob instead a Event object
            //e.blob -&gt; undefined
            $.img.setImage(e);
        }
  });
});

$.index.open();
</pre></code>

index.xml

<code><pre>
&lt;Alloy&gt;
  &lt;Window layout="vertical" backgroundColor="white"&gt;
    &lt;View id="box" width="Ti.UI.SIZE" height="Ti.UI.SIZE" backgroundColor="pink" layout="vertical" top="25"&gt;
      &lt;Label id="sample" text="This is my label" color="red"/&gt;
      &lt;ImageView image="/images/some_sample_image.jpg"/&gt;
    &lt;/View&gt;
    &lt;ImageView id="img"/&gt;
  &lt;/Window&gt;
&lt;/Alloy&gt;
</pre></code>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-10-30

   This should be a doc-ticket. No callback should return values directly but inside a dictionary. Please confirm that Android also works with "e.blob", otherwise Android needs an adjustment.</li>
<li>Jorge Macias Garcia 2017-10-30

   No, Android doesn't works with e.blob notation.</li>
<li>Hans Knöchel 2017-10-30

   To be considered for 7.0.0 as it's a breaking change.</li>
<li>Hans Knöchel 2017-11-03

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/9583" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9583</a>
   
   Test-Case:
   <code><pre>
   var win = Ti.UI.createWindow();
   var view = Ti.UI.createView({backgroundColor: 'green', width: 150, height: 150, top: 100});
   var content = Ti.UI.createView({backgroundColor: 'blue', width: 45, height: 45});
   var imageView = Ti.UI.createImageView({width: 150, height: 150, top: 300});
   view.add(content);
   win.add(view);
   win.addEventListener('postlayout', function() {
   	view.toImage(function(blob) {
   		imageView.setImage(blob);
   	});
   })
   win.add(imageView);
   win.open();
   </pre></code></li>
<li>Abir Mukherjee 2017-11-09

   FR Passed. PR merged.</li>
<li>Hans Knöchel 2017-11-11

   [~bimmel] This is a breaking change, we should add it to the list of major changes.</li>
<li>(deactived) Brian Immel 2017-11-13

   [~hknoechel], consider it done.
   </li>
<li>Abir Mukherjee 2017-11-15

   Changes are in SDK 7.0.0.v20171114202841.</li>
</ol>


<p><a href="/TIMOB/TIMOB-25459.json">JSON Source</a></p>