---
title: "[TIMOB-25513] Windows: Ti.Utils.base64encode behaves different between Android/iOS and Windows"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-10-16T12:38:34.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 3.2.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>parity</td></tr>
<tr><th>Reporter</th><td>Varun Joshi</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2017-11-15T04:01:20.000+0000</td></tr>
<tr><th>Updated</th><td>2018-10-16T15:29:30.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>

The result of Ti.Utils.base64encode is different between iOS and Android. On iOS there are newline characters included when the string is long enough, on Android the newline characters are stripped out (which is the correct way to do base64 UTF8 encoding). Please see the attached screenshot explaining the issue. 

<h4>Sample Code</h4>

{noformat}

(function() {
    
    var win = Ti.UI.createWindow({backgroundColor:'white'});
    win.open();
    var shortString = 'ABCDEFGHIJ1234567890ABCDEFGHIJ12|psndemo2|abcd:1';
    var longString  = 'ABCDEFGHIJ1234567890ABCDEFGHIJ12|psndemo2|abcd:12345678901234567890';
    var tiBase64ShortResult = Ti.Utils.base64encode(shortString);
    var tiBase64LongResult  = Ti.Utils.base64encode(longString);

    tiBase64ShortResult = String(tiBase64ShortResult);
    tiBase64LongResult = String(tiBase64LongResult);


     // BUG #2: Run this code in iOS and Android and compare the results
    // On iOS we get newline characters. On Android the newline characters are stripped out.
    // The correct behavior for UTF8 base64 encoding is to strip out the newline characters. 
    // Android's implementation is correct.
    tiBase64ShortResult = tiBase64ShortResult.replace(/\r\n/g,"***NEWLINE***");
    tiBase64LongResult  = tiBase64LongResult.replace(/\r\n/g,"***NEWLINE***");
    var alertDialog = Titanium.UI.createAlertDialog(
    {
        title: 'Result', 
        message: 'short: ' + tiBase64ShortResult + '\nlong: ' + tiBase64LongResult, buttonNames: ['OK','Cancel'] 
    });
    alertDialog.show();
})();

{noformat}

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25513_63598/encodedFile.txt">encodedFile.txt</td></td><td>2017-11-15T04:01:21.000+0000</td><td>29</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25513_63597/Screen shot 2012-05-08 at 3.43.47 PM.png">Screen shot 2012-05-08 at 3.43.47 PM.png</td></td><td>2017-11-15T04:01:21.000+0000</td><td>690743</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Kota Iguchi 2018-04-12

   <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/1220" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/1220</a></li>
<li>Keerthi Mahalingam 2018-10-03

   FR Passed. Waiting for CR and merge</li>
<li>Samir Mohammed 2018-10-16

   *Closing ticket*. Verified fix in SDK Version <code>7.5.0.v20181016071050.</code>
   
   Test and other information can be found at: 
   <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/1220" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/1220</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-25513.json">JSON Source</a></p>