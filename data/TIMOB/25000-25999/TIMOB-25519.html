---
title: "[TIMOB-25519] iOS: App can crash with unhandled Analytics SQLite error "
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-11-22T14:31:09.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 5.5.1, Release 7.0.0, Release 6.3.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>analytics, bug, ios, sqlite</td></tr>
<tr><th>Reporter</th><td>Rene Pot</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2017-11-16T11:01:46.000+0000</td></tr>
<tr><th>Updated</th><td>2018-08-06T17:49:16.000+0000</td></tr>
</table>

<h3>Description</h3>

I got the following Stacktrace when starting an app.
<code><pre>
[ERROR] :  The application has crashed with an uncaught exception 'PLSqliteException'.
[ERROR] :  Reason:
[ERROR] :  Attempted to access non-NSString * column as NSString *.
[ERROR] :  Stack trace:
[ERROR] :  0   CoreFoundation                      0x0000000181bd9d04 <redacted> + 124
[ERROR] :  1   libobjc.A.dylib                     0x0000000180e28528 objc_exception_throw + 56
[ERROR] :  2   CoreFoundation                      0x0000000181bd9c4c <redacted> + 0
[ERROR] :  3   Stapler                             0x0000000102e32f30 Stapler + 4190000
[ERROR] :  4   Stapler                             0x0000000102e2b948 Stapler + 4159816
[ERROR] :  5   libdispatch.dylib                   0x000000018155d048 <redacted> + 16
[ERROR] :  6   libdispatch.dylib                   0x0000000181599ea8 <redacted> + 56
[ERROR] :  7   Stapler                             0x0000000102e2b850 Stapler + 4159568
[ERROR] :  8   Stapler                             0x0000000102e2ff18 Stapler + 4177688
[ERROR] :  9   libdispatch.dylib                   0x000000018155d088 <redacted> + 24
[ERROR] :  10  libdispatch.dylib                   0x000000018155d048 <redacted> + 16
[ERROR] :  11  libdispatch.dylib                   0x000000018159b1c0 <redacted> + 520
[ERROR] :  12  libdispatch.dylib                   0x000000018159bb30 <redacted> + 340
[ERROR] :  13  libdispatch.dylib                   0x000000018159c528 <redacted> + 380
[ERROR] :  14  libdispatch.dylib                   0x00000001815a45c4 <redacted> + 640
[ERROR] :  15  libsystem_pthread.dylib             0x0000000181802fd0 _pthread_wqthread + 932
[ERROR] :  16  libsystem_pthread.dylib             0x0000000181802c20 start_wqthread + 4
-- End application log -------------------------------------------------------
</pre></code>

Further investigation showed issue had to do with analytics. Attached the analytics.db file which caused the issue. 

It started happening after the phone went in airplane mode.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-25519_63613/analytics.db">analytics.db</td></td><td>2017-11-16T11:00:56.000+0000</td><td>24576</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-11-16

   PR: <a href="https://github.com/appcelerator/aps_sdk/pull/305" rel="nofollow" target="_blank">https://github.com/appcelerator/aps_sdk/pull/305</a>
   Test-Case: It may be reproducible when switching to airplane mode, but unless [~topener] can provide more detailed testing-instructions, he might be able to share the app he used in a confidential way with the QE-team?</li>
<li>Rene Pot 2017-11-16

   I can sure share the app, but I'm not calling anything specific of the analytics lib. I just enabled it, haven't actually started using it with events and such.
   
   I switched to airplane mode while using the app (it was in memory). It was a development build but not sure if that matters. After starting the app again it crashes and was unable to recover, even after a new build from my mac.</li>
<li>Hans Knöchel 2017-11-16

   PR (titanium_mobile/master): <a href="https://github.com/appcelerator/titanium_mobile/pull/9612" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9612</a>
   
   Requires [this PR](<a href="https://github.com/appcelerator/titanium_mobile/pull/9591)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9591)</a> to be merged before!</li>
<li>Eric Merriman  2018-08-06

   Cleaning up older fixed issues. If this issue should not have been closed as fixed, please reopen.</li>
</ol>


<p><a href="/TIMOB/TIMOB-25519.json">JSON Source</a></p>