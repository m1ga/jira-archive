---
title: "[TIMOB-25562] CLI: Automatically migrate native Android modules to SDK 7 during module-build"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-11-28T21:09:44.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, migration, module</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2017-11-27T11:20:52.000+0000</td></tr>
<tr><th>Updated</th><td>2017-12-09T10:37:52.000+0000</td></tr>
</table>

<h3>Description</h3>

The V8 update forces module developers to recompile their modules, which can be quite a pain when having many modules to maintain. I would propose a small module-build hook inside the <code>_buildModule.js</code> that takes care of this by detecting the currently selected SDK and then migrates the module automatically, by:

- bumping the <code>apiversion</code> to <code>4</code>
- setting the minimum-sdk to <code>7.0.0</code>
- adding the <code>arm64-v8a</code> architecture
- optionally (recommended): bumping the version to the next major to indicate a new major version

We may want to ask the developer to confirm the changes, e.g. by printing the new file. It would greatly improve the dev-experience during module recompiling and could be the subject of our planned post about migrating to SDK 7.

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2017-11-28

   PR (including some open discussions): <a href="https://github.com/appcelerator/titanium_mobile/pull/9631" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9631</a></li>
<li>Lokesh Choudhary 2017-11-30

   Verified the fix with SDK 7.0.0.v20171129100330.
   Closing.</li>
<li>Michael Gangolf 2017-12-09

   Little bug: <code>description</code> field will be the module <code>name</code> after an auto update. It is still in the .bak file so you can copy it over again</li>
<li>Hans Knöchel 2017-12-09

   This is because the module template sets the <code>description</code> key to the module name by default: <code>description: &lt;%- moduleName %&gt;</code>. But I fixed it as part of TIMOB-25592, thanks!</li>
</ol>


<p><a href="/TIMOB/TIMOB-25562.json">JSON Source</a></p>