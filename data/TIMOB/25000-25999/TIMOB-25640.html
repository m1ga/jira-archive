---
title: "[TIMOB-25640] iOS: Ti.Media.VideoPlayer "playbackState" constants are undefined"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-01-17T09:21:18.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.0.2</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, videoplayer</td></tr>
<tr><th>Reporter</th><td>Mostafizur Rahman</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2018-01-02T17:54:33.000+0000</td></tr>
<tr><th>Updated</th><td>2018-02-05T15:20:18.000+0000</td></tr>
</table>

<h3>Description</h3>

Hello,

In iOS on SDK 7.0.0+, the playbackState constants are <code>*undefined*</code> (<a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Media.VideoPlayer-property-playbackState). 

- Ti.Media.VIDEO_PLAYBACK_STATE_INTERRUPTED 
- Ti.Media.VIDEO_PLAYBACK_STATE_PAUSED 
- Ti.Media.VIDEO_PLAYBACK_STATE_PLAYING 
- Ti.Media.VIDEO_PLAYBACK_STATE_SEEKING_BACKWARD 
- Ti.Media.VIDEO_PLAYBACK_STATE_SEEKING_FORWARD 
- Ti.Media.VIDEO_PLAYBACK_STATE_STOPPED 

*Testing Environment:*
Appcelerator Command-Line Interface, version 7.0.1
SDK: 7.0.1.GA
iOS simulator: iPhone 7

*Test Code:*
<code><pre>
var vidWin = Titanium.UI.createWindow({
    title : 'Video View Demo',
    backgroundColor : '#fff'
});
 
var videoPlayer = Titanium.Media.createVideoPlayer({
    top : 2,
    autoplay : true,
    backgroundColor : 'blue',
    height : 300,
    width : 300,
    mediaControlStyle : Titanium.Media.VIDEO_CONTROL_DEFAULT,
    scalingMode : Titanium.Media.VIDEO_SCALING_ASPECT_FIT
});

// Log raw-values of constants
Ti.API.info('Titanium.Media.VIDEO_PLAYBACK_STATE_INTERRUPTED ' + Titanium.Media.VIDEO_PLAYBACK_STATE_INTERRUPTED);
Ti.API.info('Titanium.Media.VIDEO_PLAYBACK_STATE_PLAYING ' + Titanium.Media.VIDEO_PLAYBACK_STATE_PLAYING);
Ti.API.info('Titanium.Media.VIDEO_PLAYBACK_STATE_STOPPED ' + Titanium.Media.VIDEO_PLAYBACK_STATE_STOPPED);
 
videoPlayer.url = 'video.mp4';
vidWin.add(videoPlayer);
videoPlayer.addEventListener('playbackstate', function() {
 
  var message = 'Unknown';
  switch (videoPlayer.playbackState) {
    case Ti.Media.VIDEO_PLAYBACK_STATE_INTERRUPTED:
    message = 'Interrupted';
    break;
    case Ti.Media.VIDEO_PLAYBACK_STATE_PLAYING:
    message = 'Playing';
    break;
    case Ti.Media.VIDEO_PLAYBACK_STATE_PAUSED:
    message = 'Paused';
    break;
    case Ti.Media.VIDEO_PLAYBACK_STATE_STOPPED:
    message = 'Stopped';
  }
  
  Ti.API.info(message);    
});
 
vidWin.open();
</pre></code>

*Test Results:*
<code><pre>
[INFO] :   Titanium.Media.VIDEO_PLAYBACK_STATE_INTERRUPTED undefined
[INFO] :   Titanium.Media.VIDEO_PLAYBACK_STATE_PLAYING undefined
[INFO] :   Titanium.Media.VIDEO_PLAYBACK_STATE_SEEKING_BACKWARD undefined
[INFO] :   Titanium.Media.VIDEO_PLAYBACK_STATE_SEEKING_FORWARD undefined
[INFO] :   Titanium.Media.VIDEO_PLAYBACK_STATE_STOPPED undefined
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-25640_63893/video.mp4">video.mp4</td></td><td>2018-01-04T10:09:21.000+0000</td><td>383631</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2018-01-03

   As discussed yesterday, release 7.0.0 replaced the underlaying API of the Ti.Media.VideoPlayer (MPMoviePlayerController) with the most recent API (AVPlayerViewController) that has a slightly different API. [~vijaysingh] will have more insight here, but the newer way of getting the current video state is to use the <code>playbackState</code> property itself, rather than the constants. I think the docs still need to be updated there and some parity work was missing in the initial 7.0.0.
   
   Scheduling this ticket for 7.1.0 to address the documentation- and possible parity-issues.
   
   For this particular case: To check whether the movie is currently playing, check if the <code>playbackState</code> property returns a value > 0. </li>
<li>Hans Knöchel 2018-01-04

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/9714" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9714</a>
   PR (7_0_X): <a href="https://github.com/appcelerator/titanium_mobile/pull/9715" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9715</a>
   
   Test-Case (use the attached mp4 file, as well as the test-case above):
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor: '#fff'
   });
   
   var video = Ti.Media.createVideoPlayer({
       url: 'video.mp4',
       height: 200
   });
   
   var btnPlay = Ti.UI.createButton({
     title: 'Play Video',
     top: 40
   });
   
   btnPlay.addEventListener('click', function(e) {
     video.play();
   });
   
   var btn = Ti.UI.createButton({
     title: 'Get current state',
     top: 100
   });
   
   btn.addEventListener('click', function(e) {
     var message = 'Unknown';
     
     switch (video.playbackState) {
       case Ti.Media.VIDEO_PLAYBACK_STATE_INTERRUPTED:
       message = 'Interrupted';
       break;
       case Ti.Media.VIDEO_PLAYBACK_STATE_PLAYING:
       message = 'Playing';
       break;
       case Ti.Media.VIDEO_PLAYBACK_STATE_PAUSED:
       message = 'Paused';
       break;
       case Ti.Media.VIDEO_PLAYBACK_STATE_STOPPED:
       message = 'Stopped';
     }
     
     Ti.API.info(message);
   });
   
   win.add(btnPlay);
   win.add(btn);
   win.add(video);
   
   win.open();
   </pre></code></li>
<li>Abir Mukherjee 2018-01-16

   FR passed.</li>
<li>Abir Mukherjee 2018-01-24

   Verified fix is found in:
   SDK 7.0.2.v20180124113923
   SDK 7.1.0.v20180124115505</li>
</ol>


<p><a href="/TIMOB/TIMOB-25640.json">JSON Source</a></p>