---
title: "[TIMOB-25696] Windows: Network.TCP causes app crash"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-02-22T14:01:38.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.1.0</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Kota Iguchi</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2018-01-23T06:09:40.000+0000</td></tr>
<tr><th>Updated</th><td>2018-05-16T23:37:55.000+0000</td></tr>
</table>

<h3>Description</h3>

Application crashes when there's runtime error during TCP callback. For example, following app crashes without any error logs.

<code><pre>
var win = Ti.UI.createWindow({ backgroundColor: 'white' });

win.addEventListener('open', function () {
    console.log('Connecting to server');
    var socket = Ti.Network.Socket.createTCP({
        host: '127.0.0.1', port: 6262,
        connected: function (e) {
            Ti.API.info('Connected to server at port ' + port);
            win.backgroundColor = 'green';
        },
        error: function (e) {
            alert(e.error);
            Ti.API.info('Error connecting to server (' + e.errorCode + '): ' + e.error);
            win.backgroundColor = 'red';
        },
    });
    socket.connect();
});

win.open();
</pre></code>

Expected: This Titanium app should not crash. This should alert <code>Can't find variable: port</code> because there's runtime error in <code>connected</code> callback (the variable <code>port</code> is not defined).

Here's a sample server code to debug the issue. Launch this using <code>node server.js</code> in Node.js in order to test this.

<code><pre>
var net = require('net'),
	port = 6262;

net.createServer(function (socket) {
	console.log('client ' + socket.remoteAddress + ' connected');

	socket.on('end', function () {
		console.log('client ' + socket.remoteAddress + ' disconnected');
	});

}).listen(port, function() {
	console.log('server listening on port ' + port);
});
</pre></code>

<h3>Comments</h3>

<ol>
<li>Kota Iguchi 2018-01-23

   <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/1173" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/1173</a></li>
<li>Ewan Harris 2018-02-21

   Master PR merged, [~kiguchi] Could you make a backport when you have time, thanks!</li>
<li>Kota Iguchi 2018-02-22

   7_1_X backport: <a href="https://github.com/appcelerator/titanium_mobile_windows/pull/1198" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile_windows/pull/1198</a></li>
<li>Ewan Harris 2018-02-22

   7_1_X PR merged, resolving and will close when changes verified in released SDK</li>
<li>Ewan Harris 2018-03-05

   Verified changes in 7.2.0.v20180302144729 and 7.1.0.v20180302141418.
   
   Closing ticket</li>
</ol>


<p><a href="/TIMOB/TIMOB-25696.json">JSON Source</a></p>