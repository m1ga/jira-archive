---
title: "[TIMOB-25742] CLI: Fails to install APK to Android 4.1 devices"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-02-16T22:02:56.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.1.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, appc, cli</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2018-02-02T01:17:47.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-01T19:24:50.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
The "appc" command line tool always fails to install a built APK to an Android 4.1 device. It can only successfully install to Android 4.2 and higher.

*How to Reproduce:*
<h4>Connect an Android 4.1 device to your machine.</h4>
<h4>In the top-left corner of Appcelerator Studio, select "Run" and the Android 4.1 device from the drop-down UI.</h4>
<h4>Click the "Run" button.</h4>
<h4>Observe the "Console" log.</h4>

_Alternatively, you can do this at the command line via..._
<code><pre>appc run -p android</pre></code>

*Result:*
The install fails after the build with the following error messages...
<code><pre>
[ERROR] :  Failed to install apk on "014E05E01600E012"
[ERROR] Application Installer abnormal process termination. Process exit value was 1
</pre></code>

*Cause:*
The CLI is installing the APK using Google's "adb" command line tool with the "-d" argument. Android 4.1 does not support the "-d" argument.
<a href="https://github.com/appcelerator/node-titanium-sdk/blob/master/lib/adb.js#L548" rel="nofollow" target="_blank">https://github.com/appcelerator/node-titanium-sdk/blob/master/lib/adb.js#L548</a>

*Recommended Solution:*
The "adb" command line does not return an error until near the end of the install, which can take a lot of time for large APKs. So, it would be best to fetch the API Level from the device first via the "adb shell getprop" command and then only use "adb install" with argument "-d" if the API Level is 17 or higher.

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2018-02-02

   PR: <a href="https://github.com/appcelerator/node-titanium-sdk/pull/22" rel="nofollow" target="_blank">https://github.com/appcelerator/node-titanium-sdk/pull/22</a></li>
<li>Abir Mukherjee 2018-02-16

   Need to validate the fix before closing after next CLI release (CLI 7.0.3 or later).</li>
<li>Abir Mukherjee 2018-03-01

   Validated with 7.0.2 from the CLI.</li>
</ol>


<p><a href="/TIMOB/TIMOB-25742.json">JSON Source</a></p>