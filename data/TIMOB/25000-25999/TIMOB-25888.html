---
title: "[TIMOB-25888] Android: getEventsBetweenDates() crashes"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-04-20T21:42:51.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>regression</td></tr>
<tr><th>Reporter</th><td>Michiel van Eerd</td></tr>
<tr><th>Assignee</th><td>Yordan Banev</td></tr>
<tr><th>Created</th><td>2018-03-20T08:47:26.000+0000</td></tr>
<tr><th>Updated</th><td>2018-06-22T16:33:25.000+0000</td></tr>
</table>

<h3>Description</h3>

On Android 8 with Titanium 7.1.0.GA the app crahses when calling getEventsBetweenDates(). With SDK 7.0.2.GA everything is okay.

This is the log I see after calling getEventsBetweenDates():

<code><pre>
[WARN]  W/System.err: java.lang.NullPointerException: Attempt to invoke virtual method 'java.lang.String[] java.lang.String.split(java.lang.String)' on a null object reference
[WARN]  W/System.err: 	at ti.modules.titanium.calendar.RecurrenceRuleProxy.fillFrequencyFields(RecurrenceRuleProxy.java:233)
[WARN]  W/System.err: 	at ti.modules.titanium.calendar.RecurrenceRuleProxy.&lt;init&gt;(RecurrenceRuleProxy.java:189)
[WARN]  W/System.err: 	at ti.modules.titanium.calendar.EventProxy.setRecurrenceRules(EventProxy.java:499)
[WARN]  W/System.err: 	at ti.modules.titanium.calendar.EventProxy.queryEventsBetweenDates(EventProxy.java:133)
[WARN]  W/System.err: 	at ti.modules.titanium.calendar.EventProxy.queryEventsBetweenDates(EventProxy.java:272)
[WARN]  W/System.err: 	at ti.modules.titanium.calendar.CalendarProxy.getEventsBetweenDates(CalendarProxy.java:187)
[WARN]  W/System.err: 	at org.appcelerator.kroll.runtime.v8.V8Object.nativeFireEvent(Native Method)
[WARN]  W/System.err: 	at org.appcelerator.kroll.runtime.v8.V8Object.fireEvent(V8Object.java:63)
[WARN]  W/System.err: 	at org.appcelerator.kroll.KrollProxy.doFireEvent(KrollProxy.java:962)
[WARN]  W/System.err: 	at org.appcelerator.kroll.KrollProxy.handleMessage(KrollProxy.java:1186)
[WARN]  W/System.err: 	at org.appcelerator.titanium.proxy.TiViewProxy.handleMessage(TiViewProxy.java:394)
[WARN]  W/System.err: 	at ti.modules.titanium.ui.PickerProxy.handleMessage(PickerProxy.java:351)
[WARN]  W/System.err: 	at android.os.Handler.dispatchMessage(Handler.java:101)
[WARN]  W/System.err: 	at android.os.Looper.loop(Looper.java:164)
[WARN]  W/System.err: 	at android.app.ActivityThread.main(ActivityThread.java:6541)
[WARN]  W/System.err: 	at java.lang.reflect.Method.invoke(Native Method)
[WARN]  W/System.err: 	at com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)
[WARN]  W/System.err: 	at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)
</pre></code>

<h3>Comments</h3>

<ol>
<li>Mostafizur Rahman 2018-03-20

   Hello [~michielve], Thanks for sharing with us. Please create a full reproducible test code and provide here for us to test the issue. Also, provide detail affected environment. Thanks.</li>
<li>Michiel van Eerd 2018-03-20

   No problem - *I see that this bug only happens with events that are repeated weekly*!.
   
   <code><pre>
   var calendarName = "Name of calendar that has weekly repeated events";
   
   function doClick(e) {
   	if (!Ti.Calendar.hasCalendarPermissions()) {
   		Ti.Calendar.requestCalendarPermissions(function(args) {
   			if (args.success) {
   				showCalendars();
   			}
   		});
   	} else {
   		showCalendars();
   	}
   }
   
   function showCalendars() {
   	console.log("In showCalendars");
   	var calendars = Ti.Calendar.allCalendars;
   	for (var i = 0; i &lt; calendars.length; i++) {
   		var cal = calendars[i];
   		if (cal.name === calendarName) {
   			console.log("Try to show weekly events from calendar " + calendarName);
   			var now = new Date();
   			try {
   				var events = cal.getEventsBetweenDates(new Date(now.getFullYear() - 1, now.getMonth(), now.getDate()), now);
   				console.log("I have " + events.length + " events");
   				events.forEach(function(event) {
   					console.log("Event " + event.title);
   				});
   			} catch (ex) {
   				console.error(ex);
   			}
   			return;
   		}
   	}
   }
   </pre></code></li>
<li>Yordan Banev 2018-03-20

   Thank you! I was able to reproduce the issue.</li>
<li>Yordan Banev 2018-03-20

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/9949" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9949</a></li>
<li>Lokesh Choudhary 2018-04-20

   FR Passed. PR Merged.</li>
<li>Lokesh Choudhary 2018-06-22

   Verified the fix in SDK 7.3.0.v20180618182516.
   Closing.</li>
</ol>


<p><a href="/TIMOB/TIMOB-25888.json">JSON Source</a></p>