---
title: "[TIMOB-26104] Android: Removing and re-adding drop-down picker resets last selection"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-10-02T17:54:17.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.2.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android</td></tr>
<tr><th>Reporter</th><td>Alexander de Greiff </td></tr>
<tr><th>Assignee</th><td>Yordan Banev</td></tr>
<tr><th>Created</th><td>2018-06-04T17:10:17.000+0000</td></tr>
<tr><th>Updated</th><td>2018-10-02T17:54:34.000+0000</td></tr>
</table>

<h3>Description</h3>

Starting with Ti 7.x incl. 7.1.1GA on Android the pickerview, when inside a tableview, resets its selected value after events like orientationchange, scroll outside of window and back in or focus on another ui element. 

(works perfectly on ios and used to work perfectly on Ti<=6.x)

example code:

{{
    var currentwindow = Ti.UI.createWindow({
    });

    var tabledata = [];

    var picker = Ti.UI.createPicker({
      top:20
    });

    var data = [];
    data[0]=Ti.UI.createPickerRow({title:'Bananas'});
    data[1]=Ti.UI.createPickerRow({title:'Strawberries'});
    data[2]=Ti.UI.createPickerRow({title:'Mangos'});

    picker.add(data);

    var myrow=Ti.UI.createTableViewRow({
    	'height' : '50sp'
    });

    myrow.add(picker);

    tabledata.push(myrow);

	var infotableview = Titanium.UI.createTableView({
		data:tabledata,
	});

	currentwindow.add(infotableview);

    //currentwindow.add(picker);

}}

<h3>Comments</h3>

<ol>
<li>Alexander de Greiff  2018-06-17

   what will happen with this issue now? do you need more info?</li>
<li>Michael Gangolf 2018-06-25

   I couldn't locate the problem but these _could_ be related to the bug:
   
   When e.g. the orientation changes the picker is created again and it is losing its [old selection value (TiUINativePicker.java)](<a href="https://github.com/appcelerator/titanium_mobile/blob/cd91879899ff3629ae78b369e1aa67ca57f48999/android/modules/ui/src/java/ti/modules/titanium/ui/widget/picker/TiUINativePicker.java#L215)." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/cd91879899ff3629ae78b369e1aa67ca57f48999/android/modules/ui/src/java/ti/modules/titanium/ui/widget/picker/TiUINativePicker.java#L215).</a>
   
   These PRs did some changes
   <a href="https://github.com/appcelerator/titanium_mobile/pull/9763/files" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9763/files</a>
   <a href="https://github.com/appcelerator/titanium_mobile/pull/9917/files" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9917/files</a>
   <a href="https://github.com/appcelerator/titanium_mobile/pull/9963/files" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/9963/files</a>
   
   so that would be a good place to start some debugging.
   If I have some more spare time I might have a look again, too</li>
<li>Joshua Quick 2018-07-10

   Okay. So, I've confirmed that this is not just an issue with a <code>TableView</code>. The root issue here is that if you remove the picker from a window and then re-add it, the picker will forget its last selected item and reset to the 1st item. The reason this can happen with a <code>TabelView</code> too is because Android's native behavior is to remove views that are scrolled off (for performance reasons) and then re-add them when they're scrolled-in. (I'm curious if this would be an issue with <code>TabGroups</code> as well.)
   
   Here's how to reproduce this issue without a <code>TableView</code>...
   
   *Steps to reproduce:*
   <h4>Build and run the below code on Android.</h4>
   <h4>Tap on the picker.</h4>
   <h4>Select a picker item other than "Item 1".</h4>
   <h4>Tap on the "Remove Picker" button. (This removes it from the window.)</h4>
   <h4>Tap on the "Add Picker" button. (This re-adds it to the window.)</h4>
   <h4>Notice that the picker's selection has been reset to "Item 1".</h4>
   
   <code><pre>
   var window = Ti.UI.createWindow();
   var picker = Ti.UI.createPicker({ width: "50%" });
   var rows = [];
   for (var index = 0; index &lt; 20; index++) {
   	rows.push(Ti.UI.createPickerRow({ title: "Item " + (index + 1).toString() }));
   }
   picker.add(rows);
   window.add(picker);
   function createButtonText() {
   	return window.children.includes(picker) ? "Remove Picker" : "Add Picker";
   }
   var button = Ti.UI.createButton({
   	title: createButtonText(),
   	bottom: "20dp",
   });
   button.addEventListener("click", function(e) {
   	if (window.children.includes(picker)) {
   		window.remove(picker);
   	} else {
   		window.add(picker);
   	}
   	button.title = createButtonText();
   });
   window.add(button);
   window.open();
   </pre></code>
   
   [~ybanev], this is an issue with the picker, not the table view. I think the solution may be to override the picker's <code>onAttachedToWindow()</code> method and restore the selection there. It's worth a shot.
   </li>
<li>Joshua Quick 2018-07-10

   [~adegreiff], is there any reason you're using a <code>TableView</code> instead of a <code>ScrollView</code>? I ask because a <code>ScrollView</code> is significantly simpler and would not have this picker issue.</li>
<li>Alexander de Greiff  2018-07-10

   [~jquick] , we have some enterprise client apps in production where the tableview is the central scaffold and the rows and containing ui objects/properties are coming from the server and interpreted/cached in the client (titanium classic). we are evaluating listviews but they are not as flexible as the layout can change with every row coming from the server.</li>
<li>Joshua Quick 2018-07-10

   I've tested for this issue in Titanium 6.0.2 and have confirmed that the picker "forgets" its last selection when detached/re-attached to the window as well. This looks like a Google issue/limitation with the picker that has always existed that we need to work-around. Perhaps Titanium's <code>TableView</code> has work-around it at one point, but regardless, this issue needs to be resolved in the picker's Java code. We'll look into it. Thanks for reporting this issue.</li>
<li>Yordan Banev 2018-07-25

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/10211" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10211</a></li>
<li>Keerthi Mahalingam 2018-09-18

   FR passed.</li>
<li>Christopher Williams 2018-10-02

   Closing since FR passed as well.</li>
</ol>


<p><a href="/TIMOB/TIMOB-26104.json">JSON Source</a></p>