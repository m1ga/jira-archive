---
title: "[TIMOB-26125] iOS: Sending background location updates to server"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-12-11T22:30:56.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Mostafizur Rahman</td></tr>
<tr><th>Assignee</th><td>Mostafizur Rahman</td></tr>
<tr><th>Created</th><td>2018-06-12T19:41:31.000+0000</td></tr>
<tr><th>Updated</th><td>2018-12-11T22:30:56.000+0000</td></tr>
</table>

<h3>Description</h3>

Hello,
This user wants to send the user location updates to the server every 1 minute in the background in iOS. 
The app requires to keep track of the driver’s position continuously similar to Uber and send it to the server every minute. 

*Approach 1:* 
They added location in UIBackgroundModes and tried using 
<code><pre>
Ti.App.iOS.registerBackgroundService({ 
  url : ‘locationService.js’ 
});
</pre></code> 

and have a 1-minute interval in the locationService.js 

It runs fine for 3 minutes(3 times) and then it stops. 

*Approach 2:*
They tried using background fetch and added fetch in UIBackgroundModes along with location and used 

<code><pre>
Ti.App.iOS.setMinimumBackgroundFetchInterval(Ti.App.iOS.BACKGROUNDFETCHINTERVAL_MIN);
</pre></code> 

In the backgroundfetch they tried using 

<code><pre>
Ti.App.iOS.addEventListener(‘backgroundfetch’, function(e) { 
  handleLocationUpdate(); 
    setTimeout(function() { 
      // Put the application back to sleep 
      Ti.App.iOS.endBackgroundHandler(e.handlerId); 
    }, 20000); 
});
</pre></code>

They kept a timeout before calling <code>endBackgroundHandler</code> as getting the location and making the service call with the updates might take some time. 
They tried without the timeout as well and still no luck. 

The first problem is they cant set my desired interval of 1 min and depend on OS to execute the fetch. 
Second, it gets the location and attempts to make the service call. But, the service call never goes through and they never see success/error message. But, when I bring the app to foreground immediately they see a timeout error. 
Third, it executes only 3 times as before and stops again. 

*Approach 3:* 
Add an event listener for location update 
<code><pre>
Ti.Geolocation.addEventListener(‘location’, updateLocation); 
Ti.Geolocation.distanceFilter = 10; 
</pre></code>
this approach again has a few problems 

In spite of the distance filter, I keep getting the location update every sec or two. 
They cant set the minUpdate time similar to Android to get once every minute. 
Also if I try to use <code>trackSignificantLocationChange</code> I won't get accurate values and also will get updates only after a long significant change. 

They haven’t tried this approach completely as it doesn't even meet the basic requirements. So, they don't know whether they will get location updates in the background more than thrice or will the app be able to make the service call after getting the location update.

They would like forward all the 3 approaches to our R&D team which they followed and let them know if they can send user location updates to the server every 1 minute in the background in iOS. 

Thanks

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-26125.json">JSON Source</a></p>