---
title: "[TIMOB-26128] Android: Allow asset directory names with a leading underscore to be included in the build"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-09-19T21:33:47.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, assets</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2018-06-13T18:49:05.000+0000</td></tr>
<tr><th>Updated</th><td>2018-10-09T12:32:38.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
Directory names have a leading underscore '_' (ex: "_MyDirectory") are automatically excluded from the built Android APK's "assets" directory. Google did this intentionally with their "aapt" command line tool. We should change this behavior since iOS and Windows doesn't have this restriction. (Makes it less confusing too.)

For JavaScript files under these directories, they will only be excluded when building for the emulator since they're added to the APK's "assets" directory in this case. For "device" and "production" builds, the JavaScript will be correctly included, but this is because they're compiled/encrypted and not bundled under the APK's "assets" directory in this case.

*Steps to reproduce:*
<h4>Create a Titanium "Classic" app.</h4>
<h4>Copy the attached [^Test.zip] file's contents to your app.</h4>
<h4>Build and run the app for the Android emulator.</h4>
<h4>On app startup, a runtime error will occur where <code>require()</code> will fail to find the JavaScript file under directory "_Test".</h4>
<h4>Build and run the app to an Android device. _(Note the emulator.)_</h4>
<h4>On app startup, note that a window is displayed, but it fails to display an image. _(The JS files was loaded, but the "_Test/AppcLogo.png" did not get included into the APK.)_</h4>

*Cause:*
Google's command line tool "aapt" will automatically exclude the following from the APK's assets directory:
* .svn
* .git
* .ds_store
* .scc
* .CVS
* thumbs.db
* picasa.ini
* _<directory>

We can change this behavior by using "aapt" argument <code>--ignore-assets</code> and tell it not to omit directories with a leading underscore.


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26128_65261/Test.zip">Test.zip</td></td><td>2018-06-13T20:47:56.000+0000</td><td>52679</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2018-06-16

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/10112" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10112</a></li>
<li>Lokesh Choudhary 2018-09-18

   FR Passed.
   
   Directories with "_" are included in the apk & assets in the test are displayed as expected.
   
   Studio Ver:     5.1.1.201809051655
   SDK Ver:        7.5.0 local build
   OS Ver:         10.13.5
   Xcode Ver:      Xcode 9.4.1
   Appc NPM:       4.2.13
   Appc CLI:       7.0.6
   Daemon Ver:     1.1.3
   Ti CLI Ver:     5.1.1
   Alloy Ver:      1.13.2
   Node Ver:       8.9.1
   NPM Ver:        5.5.1
   Java Ver:       10.0.2
   Devices:        ⇨ google Nexus 5 (Android 6.0.1)
                   ⇨ google Pixel (Android 9)
   Emulator:       ⇨ Android 4.1.2
   </li>
<li>Lokesh Choudhary 2018-09-19

   PR Merged.</li>
<li>Samir Mohammed 2018-10-09

   *Closing ticket.* Fix can now be verified in SDK version <code>7.5.0.v20181008124804</code>.
   
   Test and other information can be found at:
   <a href="https://github.com/appcelerator/titanium_mobile/pull/10112" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10112</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-26128.json">JSON Source</a></p>