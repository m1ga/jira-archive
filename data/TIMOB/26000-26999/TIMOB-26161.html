---
title: "[TIMOB-26161] Android: Activity Listening Broken on run-on-main-thread = true"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-08-24T01:27:17.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>activity, alloy, android, listener, reset</td></tr>
<tr><th>Reporter</th><td>josh.mocek</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2018-06-26T20:26:14.000+0000</td></tr>
<tr><th>Updated</th><td>2019-02-12T19:01:29.000+0000</td></tr>
</table>

<h3>Description</h3>

Tested with a Pixel on Android 8.0 using a wireless keyboard. Build the app and you will see the OS logs appear. When a wireless keyboard is connected to the device via bluetooth it causes the app to soft reset on Android. I used 
<code><pre>
Ti.App._restart();
</pre></code>
because I've had problems with the soft reset holding things in memory.

When
<code><pre>
&lt;property name="run-on-main-thread" type="bool"&gt;false&lt;/property&gt;
</pre></code>
the listener works correctly. The app restarts and runs 'Start by OS' and 'Resume by OS'.

When
<code><pre>
&lt;property name="run-on-main-thread" type="bool"&gt;true&lt;/property&gt;
</pre></code>
the listener does not fire the 'START' & 'RESUME' activity listener after the reset. You will notice this by the lack of error logs.


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26161_65296/index.js">index.js</td></td><td>2018-06-26T20:25:17.000+0000</td><td>1840</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26161_65297/index.xml">index.xml</td></td><td>2018-06-26T20:25:14.000+0000</td><td>180</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26161_65298/tiapp.xml">tiapp.xml</td></td><td>2018-06-26T20:25:09.000+0000</td><td>3624</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Hans Kn√∂chel 2018-06-27

   [~josh.mocek] Is this Android 8 only? And which Ti-SDK version are you using?</li>
<li>josh.mocek 2018-06-27

   Hans Knochel I can test on a different android version, and SDK is on 7.1.1</li>
<li>josh.mocek 2018-06-27

   Hans Knochel
   same bad results on
   Android 7.1.1 & SDK 7.1.1
   Android 7.1.1 & SDK 7.2.0
   Android 7.1.1 & SDK 7.0.2</li>
<li>Gary Mathews 2018-06-27

   master: <a href="https://github.com/appcelerator/titanium_mobile/pull/10137" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10137</a></li>
<li>Josh Longton 2018-08-14

   
   *Closing ticket.*
   
   Activity callbacks are now being called when running on main thread.
   
   The fix is present in SDK:
   
   
   {noformat}
   7.4.0.v20180810061237
   {noformat}
   
   *ENV*
   
   
   {noformat}
   Appc NPM: 4.2.13
   Appc CLI: 7.0.4
   Ti CLI: 5.1.1
   Node: 10.3.0
   NPM: 6.3.0
   {noformat}
   </li>
<li>josh.mocek 2019-02-12

   It is now firing the start and resume events, but not the destroy event like when run on main thread is false</li>
</ol>


<p><a href="/TIMOB/TIMOB-26161.json">JSON Source</a></p>