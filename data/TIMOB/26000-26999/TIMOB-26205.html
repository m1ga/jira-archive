---
title: "[TIMOB-26205] Android: getActionBar() throws "CalledFromWrongThreadException" exception"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-07-20T19:10:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>actionbar, android, bug</td></tr>
<tr><th>Reporter</th><td>Sergey Volkov</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2018-07-11T12:29:27.000+0000</td></tr>
<tr><th>Updated</th><td>2018-09-26T14:37:13.000+0000</td></tr>
</table>

<h3>Description</h3>

<code><pre>
[WARN]  W/System.err: android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
[WARN]  W/System.err:   at android.view.ViewRootImpl.checkThread(ViewRootImpl.java:6816)
[WARN]  W/System.err:   at android.view.ViewRootImpl.invalidateChildInParent(ViewRootImpl.java:975)
[WARN]  W/System.err:   at android.view.ViewGroup.invalidateChild(ViewGroup.java:5125)
[WARN]  W/System.err:   at android.view.View.invalidateInternal(View.java:12774)
[WARN]  W/System.err:   at android.view.View.invalidate(View.java:12738)
[WARN]  W/System.err:   at android.view.View.invalidate(View.java:12722)
[WARN]  W/System.err:   at android.widget.ImageView.invalidateDrawable(ImageView.java:246)
[WARN]  W/System.err:   at android.graphics.drawable.Drawable.invalidateSelf(Drawable.java:385)
[WARN]  W/System.err:   at android.graphics.drawable.Drawable.setVisible(Drawable.java:764)
[WARN]  W/System.err:   at android.widget.ImageView.onDetachedFromWindow(ImageView.java:1515)
[WARN]  W/System.err:   at android.view.View.dispatchDetachedFromWindow(View.java:14616)
[WARN]  W/System.err:   at android.view.ViewGroup.removeViewInternal(ViewGroup.java:4647)
[WARN]  W/System.err:   at android.view.ViewGroup.removeViewInternal(ViewGroup.java:4620)
[WARN]  W/System.err:   at android.view.ViewGroup.removeView(ViewGroup.java:4551)
[WARN]  W/System.err:   at android.support.v7.widget.Toolbar.setNavigationIcon(Toolbar.java:962)
[WARN]  W/System.err:   at android.support.v7.widget.ToolbarWidgetWrapper.updateNavigationIcon(ToolbarWidgetWrapper.java:613)
[WARN]  W/System.err:   at android.support.v7.widget.ToolbarWidgetWrapper.setDisplayOptions(ToolbarWidgetWrapper.java:392)
[WARN]  W/System.err:   at android.support.v7.app.ToolbarActionBar.setDisplayOptions(ToolbarActionBar.java:260)
[WARN]  W/System.err:   at android.support.v7.app.ToolbarActionBar.setDisplayOptions(ToolbarActionBar.java:254)
[WARN]  W/System.err:   at org.appcelerator.titanium.proxy.ActionBarProxy.&lt;init&gt;(ActionBarProxy.java:58)
[WARN]  W/System.err:   at org.appcelerator.titanium.proxy.ActivityProxy.getActionBar(ActivityProxy.java:258)
[WARN]  W/System.err:   at org.appcelerator.kroll.runtime.v8.V8Function.nativeInvoke(Native Method)
[WARN]  W/System.err:   at org.appcelerator.kroll.runtime.v8.V8Function.callSync(V8Function.java:57)
[WARN]  W/System.err:   at org.appcelerator.kroll.runtime.v8.V8Function.call(V8Function.java:43)
[WARN]  W/System.err:   at ti.modules.titanium.TitaniumModule$Timer.run(TitaniumModule.java:147)
[WARN]  W/System.err:   at android.os.Handler.handleCallback(Handler.java:739)
[WARN]  W/System.err:   at android.os.Handler.dispatchMessage(Handler.java:95)
[WARN]  W/System.err:   at android.os.Looper.loop(Looper.java:148)
[WARN]  W/System.err:   at org.appcelerator.kroll.KrollRuntime$KrollRuntimeThread.run(KrollRuntime.java:118)
</pre></code>

Patch with fix is in attachment.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26205_65344/0001-fix-ActionBar-CalledFromWrongThreadException.patch">0001-fix-ActionBar-CalledFromWrongThreadException.patch</td></td><td>2018-07-11T12:25:43.000+0000</td><td>3097</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2018-07-12

   Hello [~s.volkov], Thanks for the ticket. Our engineering will look into it.</li>
<li>Sergey Volkov 2018-07-12

   <a href="https://github.com/appcelerator/titanium_mobile/pull/10176" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10176</a></li>
<li>Samir Mohammed 2018-09-26

   *Closing ticket.* Verified fix in SDK version <code>7.5.0.v20180925002114</code>. <code>getActionBar()</code> no longer throws "CalledFromWrongThreadException" exception.	
   
   *Test Environment*
   <code><pre>
   APPC Studio: 5.1.0.201808080937
   Nexus 5X (API 23)
   APPC CLI: 7.0.7-master.1
   Operating System Name: Mac OS Mojave
   Operating System Version: 10.14
   Node.js Version: 8.9.1
   Xcode 10.0
   </pre></code>
   
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-26205.json">JSON Source</a></p>