---
title: "[TIMOB-26242] Android: Change in memory behavior"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-08-06T19:27:46.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.3.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Yordan Banev</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2018-07-27T11:15:23.000+0000</td></tr>
<tr><th>Updated</th><td>2020-08-31T16:14:21.000+0000</td></tr>
</table>

<h3>Description</h3>

[~jquick], [~gmathews]
I noticed a change in the memory management after the recent changes on it that I think deserves some attention. Until 7.2.0.GA the sample app I have attached had this behavior.

1. Open the application.
2. Click "Remove".
3. Force GC through the Android profiler tool.
4. Click "Add again".

The colorized views are successfully added again to the window.

After the merge of: <a href="https://github.com/appcelerator/titanium_mobile/pull/10174" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10174</a> the same sequence results in a crash (attached in the ticket). That happens because the Views are garbage collected.
The same goes with Ti.Map module when AnnotaionProxies are released (that happens when they are removed from the MapView) for example.
What bothers me is that this change may cause problems in applications that are relying on keeping the references to proxies in the same context after heavy memory usage (one that can cause the system to garbage collect). And I think if that is the case for Proxies in general we may have that problem in a variety of usages.

How do you think we should go about that?

Note: I haven't matched the position of the views to be related to the device's screen. I have been testing on Pixel emulator.

P.S. We talked with Joshua about that earlier this week and at that moment we had a upcoming changes in the most recent PR for memory management. I have tested today with it and the described change in behavior is still present.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26242_65395/app.js">app.js</td></td><td>2018-07-27T11:09:21.000+0000</td><td>1645</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26242_65394/consoleLog.txt">consoleLog.txt</td></td><td>2018-07-27T11:09:21.000+0000</td><td>3913</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26242_65408/lifecycle.svg">lifecycle.svg</td></td><td>2018-08-01T19:36:20.000+0000</td><td>14619</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Gary Mathews 2018-08-01

   master: <a href="https://github.com/appcelerator/titanium_mobile/pull/10221" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10221</a>
   7_3_X: <a href="https://github.com/appcelerator/titanium_mobile/pull/10224" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10224</a></li>
<li>Lokesh Choudhary 2018-08-08

   Verified the fix in SDK 7.3.0.v20180807095741 & 7.4.0.v20180807122127.
   
   Closing.
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-26242.json">JSON Source</a></p>