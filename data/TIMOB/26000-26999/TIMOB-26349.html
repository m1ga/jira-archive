---
title: "[TIMOB-26349] iOS 10: A couple of issues related to remote push-notifications"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2018-09-19T18:27:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 6.0.0, Release 7.0.0, Release 7.3.0, Release 7.3.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Hans Knöchel</td></tr>
<tr><th>Created</th><td>2018-09-01T10:52:01.000+0000</td></tr>
<tr><th>Updated</th><td>2018-09-19T18:27:32.000+0000</td></tr>
</table>

<h3>Description</h3>

There are a couple of issues with notifications on iOS right now:
<h4>On iOS 10+, if a notification is delivered while the app is opened, the notification is presented in-app and the usual callback is not fired</h4>
<h4>On iOS 10+, the contents of the "aps" key are not in the top-level of the "data" key that is returned by the callback of the <code>registerForPushNotifications</code> callback</h4>
<h4>On iOS 10+, the "localnotificationaction" event is triggered, although "remotenoticationaction" should be triggered</h4>
<h4>On iOS 10+, the "sound" property of queued pushes can lead to a crash because it's not bridged to a consumable JS-type</h4>
<h4>On all supported iOS versions, if a remote notification action is triggered and the app is closed, the <code>notificationaction</code> is not triggered</h4>
<h4>On all supported iOS versions, silent pushes are fired to both the <code>registerForPushNotifications</code> callback and <code>silentpush</code> event. it should only be fired to the <code>silentpush</code> event for parity and API clearance.</h4>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2018-09-01

   (PR was reverted to do some more tests)
   
   Test-Case:
   1. Create a new app suitable for remote push notifications (with it's certs, provisioning profiles, aps-environment etc)
   2. Copy the below code in the app.js / index.js
   3. Download the app "Pusher" to simulate push messages from your mac
   4. Import your .p12 certificate, paste your device-token received from the "success" callback of your push-registration and try around with it (leave out "content-available" to test non-silent-pushes):
   <code><pre>
   { "aps":{"alert":"Testing.. (30)","badge":1,"sound":"default", "content-available": 1 }}
   </pre></code>
   
   JS-code:
   <code><pre>
   var deviceToken = null;
   
   // Wait for user settings to be registered before registering for push notifications
   Ti.App.iOS.addEventListener('usernotificationsettings', function registerForPush() {
   
       // Remove event listener once registered for push notifications
       Ti.App.iOS.removeEventListener('usernotificationsettings', registerForPush);
   
       Ti.Network.registerForPushNotifications({
           success: deviceTokenSuccess,
           error: deviceTokenError,
           callback: receivePush
       });
   });
   
   Ti.App.iOS.addEventListener('silentpush', function(e) {
       Ti.API.info('SILENTPUSH received');
       Ti.API.info(e);
   });
   
   // Process incoming push notifications
   function receivePush(e) {
       Ti.API.info('Remote push received');
       Ti.API.info(e);
   }
   // Save the device token for subsequent API calls
   function deviceTokenSuccess(e) {
       deviceToken = e.deviceToken;
       Ti.API.info('Device-token: ' + deviceToken);
       Ti.API.info('Successfully registered for push notifications!');
   }
   
   function deviceTokenError(e) {
       alert('Failed to register for push notifications! ' + e.error);
   }
   
   var win = Ti.UI.createWindow({
       backgroundColor: '#fff'
   });
   
   win.addEventListener('open', function() {
       // Register notification types to use
       Ti.App.iOS.registerUserNotificationSettings({
           types: [
               Ti.App.iOS.USER_NOTIFICATION_TYPE_ALERT,
               Ti.App.iOS.USER_NOTIFICATION_TYPE_SOUND,
               Ti.App.iOS.USER_NOTIFICATION_TYPE_BADGE
           ]
       });
   });
   
   win.open();
   </pre></code></li>
<li>Hans Knöchel 2018-09-19

   Handled via TIMOB-26399</li>
</ol>


<p><a href="/TIMOB/TIMOB-26349.json">JSON Source</a></p>