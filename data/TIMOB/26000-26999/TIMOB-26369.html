---
title: "[TIMOB-26369] iOS: unhandledException Ti.App event no longer working."
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-09-22T15:05:24.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.3.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Richard Lustemberg</td></tr>
<tr><th>Assignee</th><td>Hans Kn√∂chel</td></tr>
<tr><th>Created</th><td>2018-09-06T10:25:41.000+0000</td></tr>
<tr><th>Updated</th><td>2019-05-01T20:25:45.000+0000</td></tr>
</table>

<h3>Description</h3>

When stack traces where added to the display of unhandled exceptions in May 2018, the functionality was removed. I can provide a PR to fix that.
Files that need to be modified:
AppModule.m , line 368
<code><pre>
[nc addObserver:self selector:@selector(errored:) name:kTiErrorNotification object:nil];
</pre></code>

TiExceptionHandler.m , line 58
<code><pre>
- (void)showScriptError:(TiScriptError *)error
{
  NSArray&lt;NSString *&gt; *exceptionStackTrace = [NSThread callStackSymbols];

  if (exceptionStackTrace == nil) {
    [[TiApp app] showModalError:[error description]];
    [[NSNotificationCenter defaultCenter] postNotificationName:kTiErrorNotification
                                                        object:self
                                                      userInfo:error.dictionaryValue];
  } else {
    NSMutableArray&lt;NSString *&gt; *formattedStackTrace = [[[NSMutableArray alloc] init] autorelease];
    NSUInteger exceptionStackTraceLength = [exceptionStackTrace count];

    // re-size stack trace and format results. Starting at index = 4 to not include the script-error API's
    for (NSInteger i = 4; i &lt; (exceptionStackTraceLength &gt;= 20 ? 20 : exceptionStackTraceLength); i++) {
      NSString *line = [[exceptionStackTrace objectAtIndex:i] stringByReplacingOccurrencesOfString:@"     " withString:@""];
      [formattedStackTrace addObject:line];
    }

    NSString *stackTrace = [formattedStackTrace componentsJoinedByString:@"\n"];
    [[TiApp app] showModalError:[NSString stringWithFormat:@"%@\n\n%@", [error description], stackTrace]];
    NSMutableDictionary *errorDict = [error.dictionaryValue mutableCopy];
    [errorDict setObject:stackTrace forKey:@"stackTrace"];
    [[NSNotificationCenter defaultCenter] postNotificationName:kTiErrorNotification
                                                        object:self
                                                      userInfo:errorDict];
  }
}
</pre></code>

<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2018-09-07

   Hello, please assign the PR to this ticket. Moving it to engineering. Thanks</li>
<li>Richard Lustemberg 2018-09-07

   Done :) </li>
<li>Samir Mohammed 2018-10-17

   *Closing ticket.* Verified fix in SDK Version <code>7.5.0.v20181016071050</code>
   
   Tested using the following test case:
   <code><pre>
   Ti.App.addEventListener('uncaughtException', function(evt) {
       alert({
           // Both iOS and Android:
           message: evt.message,
           line: evt.line,
   
           // iOS Only:
           sourceId: evt.sourceId,
           type: evt.type,
           sourceURL: evt.sourceURL,
           backtrace: String(evt.backtrace).substr(0, 100) + '...',
   
           // Android Only:
           title: evt.title,
           sourceName: evt.sourceName,
           lineSource: evt.lineSource,
           lineOffset: evt.lineOffset
       });
   });
   
   throw new Error('Hello, error handler!');</pre></code>
   
   Able to see:
   <code><pre>
   [DEBUG] :  Firing app event: uncaughtException
   </pre></code>
   This was not visible before this fix.
   
   *Test Environment*
   <code><pre>
   APPC Studio: 5.1.0.201808080937
   iPhone 6 Sim (iOS 12)
   APPC CLI: 7.0.6
   Operating System Name: Mac OS Mojave
   Operating System Version: 10.14
   Node.js Version: 8.9.1
   Xcode 10.0</pre></code>
   
   </li>
<li>Leonardo Amigoni 2019-05-01

   I'm still seeing this issue in 8.0. It was firing for a while but not it doesn't seem to. Unfortunately I can't seem to reproduce the case where it was firing. Android works fine iOS doesn't</li>
</ol>


<p><a href="/TIMOB/TIMOB-26369.json">JSON Source</a></p>