---
title: "[TIMOB-26407] iOS: Replace OSSpinLock API with os_unfair_lock"
---
<table>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Kn√∂chel</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2018-09-22T15:19:21.000+0000</td></tr>
<tr><th>Updated</th><td>2018-09-22T15:20:38.000+0000</td></tr>
</table>

<h3>Description</h3>

We use the <code>OSSpinlock</code> API in your kroll-core and some XML operations a lot. It has formally been deprecated as of iOS 10.0 and should be replaced by the <code>os_unfair_lock</code> (<code>os_unfair_lock_lock</code> and <code> os_unfair_lock_unlock</code>) API. The old API is meant to be unsafe on newer OS's, leading to possible crashes.

Note: Also the <code>os_unfair_lock</code> is a suggested replacement by Apple, we may want to consider other locks that are more GCD focussed.

Docs:
- <a href="https://github.com/moby/hyperkit/issues/47" rel="nofollow" target="_blank">https://github.com/moby/hyperkit/issues/47</a>
- <a href="https://developer.apple.com/documentation/os/1646466-os_unfair_lock_lock" rel="nofollow" target="_blank">https://developer.apple.com/documentation/os/1646466-os_unfair_lock_lock</a>
- <a href="https://blog.postmates.com/why-spinlocks-are-bad-on-ios-b69fc5221058" rel="nofollow" target="_blank">https://blog.postmates.com/why-spinlocks-are-bad-on-ios-b69fc5221058</a>

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-26407.json">JSON Source</a></p>