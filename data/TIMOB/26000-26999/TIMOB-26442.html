---
title: "[TIMOB-26442] Android: Toolbar with "extendBackground" true is too tall if both status bar and navigation bar is transparent"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-10-25T14:06:44.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, toolbar</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2018-10-06T00:09:41.000+0000</td></tr>
<tr><th>Updated</th><td>2018-10-25T19:39:19.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
If <code>Toolbar</code> property "extendBackground" is set <code>true</code> and the top status bar is transparent and the bottom navigation bar is transparent, then the <code>Toolbar</code> will end up being taller than expected. The <code>Toolbar</code>'s top padding will be set to the status bar's height and the <code>Toolbar</code>'s bottom padding will be set to the navigation bar's height.

*Steps to reproduce:*
<h4>Build and run the below code on Android 4.4 or higher.</h4>
<h4>Notice the <code>Toolbar</code> has too much bottom padding.</h4>

<code><pre>
var FLAG_TRANSLUCENT_STATUS = 67108864;
var FLAG_TRANSLUCENT_NAVIGATION = 134217728;
var window = Ti.UI.createWindow({
	theme: "Theme.AppCompat.NoTitleBar",
	windowFlags: FLAG_TRANSLUCENT_STATUS | FLAG_TRANSLUCENT_NAVIGATION,
//	windowFlags: FLAG_TRANSLUCENT_NAVIGATION,
//	windowFlags: FLAG_TRANSLUCENT_STATUS,
});
window.add(Ti.UI.createView({
	backgroundColor: "gray",
	width: Ti.UI.FILL,
	height: Ti.UI.FILL,
}));
var toolbar = Ti.UI.createToolbar({
	title: "My Toolbar",
	titleTextColor: "white",
	backgroundColor: "blue",
	extendBackground: true,
	top: 0,
	width: Ti.UI.FILL,
});
window.activity.supportToolbar = toolbar;
window.add(toolbar);
window.open();
</pre></code>

*Result:*
The <code>Toolbar</code>'s bottom padding is set to the height of the translucent navigation bar, as can be seen in attached screenshot "NavBarTransparent.png".
 !NavBarTransparent.png|thumbnail! 

*Expected Result:*
In this case, the <code>Toolbar</code>'s bottom padding is not desired. It's expected to look like attached screenshot "NavBarOpaque.png", where if the bottom navigation bar is opaque, no bottom padding is added to the <code>Toolbar</code>.
 !NavBarOpaque.png|thumbnail! 

*Notes:*
* This is likely an issue on Google's end since they handling the padding internally.
* This is a low priority issue since most apps (such as Google's apps) don't make both top and bottom system bars transparent at the same time.
* Work-around is to not make the bottom navigation bar translucent... or leave the "extendBackground" property <code>false</code> and color the status bar via a theme.
* Ideally, we would also want to support displaying a <code>Toolbar</code> at the bottom of the screen too. In which case, "extendBackground" should extend down beneath a transparent navigation bar. _(Would we need a new property indicating which direction we want to extend towards?)_

*Recommended Solution:*
Override the Java <code>Toolbar</code> class' <code>fitSystemWindows(Rect)</code> method and strip-off the top or bottom inset before passing the rect over to <code>super.fitSystemWindows(Rect)</code>. This will work because Google's base <code>View</code> implementation blindly adds the insets as padding to the view.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26442_65686/NavBarOpaque.png">NavBarOpaque.png</td></td><td>2018-10-05T23:55:51.000+0000</td><td>35584</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26442_65687/NavBarTransparent.png">NavBarTransparent.png</td></td><td>2018-10-05T23:55:51.000+0000</td><td>36041</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2018-10-06

   FYI: [~ybanev]
   
   I think this is a low priority issue, but I happened to find it while testing top and bottom notch support on Android P. When I finish adding "safeAreaRect" property support via [TIMOB-26427], the app developers will be able to position the <code>Toolbar</code> any way they see fit too without using "extendBackground".</li>
<li>Joshua Quick 2018-10-13

   This issue needs to be solved in 7.5.0 since it can happen when using the <code>Ti.UI.Window</code> "extendSafeArea" property for Android P notch/inset support.
   
   I have a solution now. Will submit a PR next week.</li>
<li>Joshua Quick 2018-10-18

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/10383" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10383</a></li>
<li>Josh Longton 2018-10-25

   *FR Passed*
   
   Waiting on Jenkins to merge</li>
<li>Keerthi Mahalingam 2018-10-25

   Verified the fix on SDK 7.5.0.v20181025085349.Working fine. Closing.
   <code><pre>
   Operating System
     Name                        = Mac OS X
     Version                     = 10.13.6
     Architecture                = 64bit
   Node.js
     Node.js Version             = 8.12.0
     npm Version                 = 6.4.1
   Titanium CLI
     CLI Version                 = 5.1.1
   Studio			=5.1.2.201810080801
   Titanium SDK
     SDK Version                 = 7.5.0.v20181025085349
   Device                    = Samsung s5 Android 6,pixel android 9 
   Emulator		   = Samsung galaxy s6 android 6,nexus 4.4
   </pre></code></li>
</ol>


<p><a href="/TIMOB/TIMOB-26442.json">JSON Source</a></p>