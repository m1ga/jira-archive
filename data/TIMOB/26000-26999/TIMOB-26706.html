---
title: "[TIMOB-26706] Android: AccessibilityLabel is on wrong element"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2021-08-19T10:51:09.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 10.1.0</td></tr>
<tr><th>Components</th><td>n/a</td></tr>
<tr><th>Labels</th><td>accessibility, accessibilityLabel, android, appium, emulator</td></tr>
<tr><th>Reporter</th><td>josh.mocek</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2019-01-03T15:56:43.000+0000</td></tr>
<tr><th>Updated</th><td>2021-08-19T10:51:09.000+0000</td></tr>
</table>

<h3>Description</h3>

Here is an appium project (it is not needed, but useful): [<a href="https://github.com/joshmocekMovista/AccessibiltyLabel_Bug" rel="nofollow" target="_blank">https://github.com/joshmocekMovista/AccessibiltyLabel_Bug</a>]
Here is the titanium app: [<a href="https://github.com/joshmocekMovista/accessLabelBug" rel="nofollow" target="_blank">https://github.com/joshmocekMovista/accessLabelBug</a>](<a href="http://example.com)" rel="nofollow" target="_blank">http://example.com)</a>

Use the files that I had for the titanium app. You will notice that there are accessibilityLabels on multiple elements in the XML. So far the accessibilityLabels work somewhat on iOS. On Android they are currently showing up on Labels, but you will notice that they are on the wrong element on "TextFields" and "ImageViews". You can inspect the elements with appium or with the Android Tool UIAutomatorViewer.

Reference "textInputLayout-editText.png", "editText.png", "appium-TextInputLayout.png", and "appium-editText.png". 

Here is the titanium XML:
<code><pre>
&lt;TextField accessibilityLabel="textField" /&gt;
</pre></code>

On "TextFields" instead of being on the <EditText> element it is on the parent and looks like (disclaimer Android add a '.' to the accessibilityLabels:

<code><pre>
&lt;TextInputLayout content-desc="textField."&gt;
    &lt;FrameLayout&gt;
       &lt;EditText /&gt;
    &lt;/FrameLayout&gt;
&lt;/TextInputLayout&gt;
</pre></code>

This messes up automated testing since in selenium I want to run the same code for iOS and Android (it works on iOS currently). Here is they python code I run in selenium to add text to a <TextField> in iOS this works on Android it can't send the keys because it is trying to send the keys to the <TextInputLayout> element instead of <EditText> element:

<code><pre>
context.driver.find_element_by_accessibility_id('textField.').send_keys('text added by automated test')
</pre></code>

I think the Android XML should look like this:

<code><pre>
&lt;TextInputLayout&gt;
    &lt;FrameLayout&gt;
        &lt;EditText content-desc="textField." /&gt;
    &lt;/FrameLayout&gt;
&lt;/TextInputLayout&gt;
</pre></code>

This is also a problem with the <ImageView> element. Reference "viewGroup-imageView.png" and "imageView.png". You will notice that the accessibilityLabel is on the <ViewGroup> element instead of the <ImageView> element. The Android looks like this:

<code><pre>
&lt;ViewGroup content-desc="textField."&gt;
    &lt;ImageView /&gt;
&lt;/ViewGroup&gt;
</pre></code>

I think it should look like this:

<code><pre>
&lt;ViewGroup&gt;
    &lt;ImageView content-desc="textField." /&gt;
&lt;/ViewGroup&gt;
</pre></code>

Once again this works on iOS and it doesn't on Android because it doesn't find the correct element because the "accessibilityLabel" is tied to the <ViewGroup> element instead of the <ImageView> element.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66043/appium-editText.png">appium-editText.png</td></td><td>2019-01-03T15:33:46.000+0000</td><td>575330</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66042/appium-TextInputLayout.png">appium-TextInputLayout.png</td></td><td>2019-01-03T15:33:46.000+0000</td><td>510108</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66044/edtiText.png">edtiText.png</td></td><td>2019-01-03T15:33:46.000+0000</td><td>545687</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66045/imageView.png">imageView.png</td></td><td>2019-01-03T15:33:46.000+0000</td><td>505821</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66047/index.js">index.js</td></td><td>2019-01-03T15:30:49.000+0000</td><td>796</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66046/index.tss">index.tss</td></td><td>2019-01-03T15:30:49.000+0000</td><td>212</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66049/index.xml">index.xml</td></td><td>2019-01-03T15:30:49.000+0000</td><td>1324</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66040/textInputLayout-editText.png">textInputLayout-editText.png</td></td><td>2019-01-03T15:34:18.000+0000</td><td>522468</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66048/tiapp.xml">tiapp.xml</td></td><td>2019-01-03T15:30:49.000+0000</td><td>4230</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26706_66041/viewGroup-imageview.png">viewGroup-imageview.png</td></td><td>2019-01-03T15:34:18.000+0000</td><td>499348</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2019-01-04

   Hello, What seems to be the issue here. Can you explain a little more? I tested the issue with the sample code provided and I got the behavior when clicked on the "Label on view" the "ID" and "Access Label" changed from "nothing" to "labelInView" and the below info on console
   <code><pre>
   [INFO]  JSON.stringify(e):
   [INFO]  {"type":"click","source":{"shadowRadius":1,"wordWrap":true,"text":"Label
    in View","ellipsize":2,"color":"#000","hiddenBehavior":4,"enabled":true,"visibl
   e":true,"touchEnabled":true,"accessibilityLabel":"labelInView","backgroundRepeat
   ":false,"height":"size","width":"size","backgroundDisabledColor":null,"keepScree
   nOn":false,"children":[],"size":{"height":21,"y":0,"width":88,"x":0},"rect":{"he
   ight":21,"absoluteX":148,"y":15,"absoluteY":256,"x":56,"width":88},"apiName":"Ti
   .UI.Label","bubbleParent":true,"id":"labelInView","horizontalWrap":true,"soundEf
   fectsEnabled":true,"_events":{"click":{}}},"force":0,"y":20.584716796875,"size":
   0,"x":95.490234375,"bubbles":true,"cancelBubble":false}
   </pre></code>
   
   What seems to be the issue here? Thanks.</li>
<li>josh.mocek 2019-01-04

   Yeah, technically that part works. If you go to the UIAutomatorViewer and inspect the app you can see the Android XML.
   
   Refer to the "TextInputLayout-EditText.png".
   
   The accessibilityLabel is put on the <TextInputLayout> element, but should be on the <EditText> element. The reason this is a problem is because when you are using selenium or appium and running the following code to get the element by the accessibility id it gets the outer <TextInputLayout> element so trying to 'send_keys' to that field results in an error.
   
   <code><pre>
   context.driver.find_element_by_accessibility_id('textField.').send_keys('text added by automated test')
   </pre></code>
   
   Edit:
   You will notice that 'content-desc' is blank on <EditText> and in the <TextInputLayout> element you will see that 'content-desc' is the accessibility id. It is fine for it to be labeled 'content-desc', but that just needs to be on the <EditText> element so we can actually interact with the field. The Android XML should look like:
   <code><pre>
   &lt;TextInputLayout&gt;
       &lt;FrameLayout&gt;
           &lt;EditText content-desc="textField." /&gt;
       &lt;/FrameLayout&gt;
   &lt;/TextInputLayout&gt;
   </pre></code></li>
<li>Michael Gangolf 2019-05-12

   With setText() I'm able to write into a Textfield with <code>accessibilityLabel</code>:
   <code>driver.elementById("email.").setText("test@mail.com");</code>
   but I'm not able to read text without using xpath. So it would be nice to have the content-desc on the right element.</li>
<li>Gary Mathews 2021-03-10

   master: <a href="https://github.com/appcelerator/titanium_mobile/pull/12538" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12538</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-26706.json">JSON Source</a></p>