---
title: "[TIMOB-26768] Android : Beforeload event not working with PDF links on Android"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-03-20T18:04:05.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Aminul Islam</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2019-01-25T18:01:42.000+0000</td></tr>
<tr><th>Updated</th><td>2019-03-20T18:04:09.000+0000</td></tr>
</table>

<h3>Description</h3>

Hello, 
We have in our application a webview which is loading some links that redirect the user to some PDF files. We know that the Android browser has some issues with PDFs and as a workaround, we use the beforeload event to catch the URL and open the PDFs using other means. 
The problem that we see is that the event is only being triggered using an emulator. If we switch to a physical device (we tried on a Pixel 1 and on a Galxy S9) the event is not triggered but ONLY with the links that redirect the user to a PDF. If the link sends the user to a regular html file it works as expected. 

Test Code:
<code><pre>
$.index.open();

function init(){
    var webUrl = '<html><head></head><body><a href="<a href="https://www.apple.com/support/products/pdf/applecare_ipod_t_and_c_11182003.pdf" rel="nofollow" target="_blank">https://www.apple.com/support/products/pdf/applecare_ipod_t_and_c_11182003.pdf</a>">Open PDF
    	</a><br><a href="<a href="https://www.google.com" rel="nofollow" target="_blank">https://www.google.com</a>">Open regular url</a></body></html>';
    $.webView.html = webUrl;
}

init();

$.webView.addEventListener('beforeload', function(_evt){
    alert(_evt.url);
});
</pre></code>
Test Environemnt :
<code><pre>
Operating System
  Name                        = Mac OS X
  Version                     = 10.13.6
  Architecture                = 64bit
  # CPUs                      = 4
  Memory                      = 8589934592

Node.js
  Node.js Version             = 10.14.1
  npm Version                 = 6.4.1

Titanium CLI
  CLI Version                 = 5.1.1

Titanium SDK
  SDK Version                 = 7.5.0.GA
  SDK Path                    = /Users/user/Library/Application Support/Titanium/mobilesdk/osx/7.5.0.GA
  Target Platform             = android
</pre></code>
Please take a look on attached screenshot.


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26768_66110/Screenshot_20190125-231435.jpg">Screenshot_20190125-231435.jpg</td></td><td>2019-01-25T18:01:38.000+0000</td><td>54011</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26768_66109/Screenshot_20190125-231442.jpg">Screenshot_20190125-231442.jpg</td></td><td>2019-01-25T18:01:39.000+0000</td><td>75896</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Gary Mathews 2019-02-05

   Since <code>7.5.0</code> the <code>onlink</code> event is available. They can catch PDF links like so:
   <code><pre>
   let window = Ti.UI.createWindow(),
       webView = Ti.UI.createWebView({
           html: '<html><head></head><body><a href="<a href="https://www.apple.com/support/products/pdf/applecare_ipod_t_and_c_11182003.pdf" rel="nofollow" target="_blank">https://www.apple.com/support/products/pdf/applecare_ipod_t_and_c_11182003.pdf</a>">Open PDF</a><br><a href="<a href="https://www.google.com" rel="nofollow" target="_blank">https://www.google.com</a>">Open Google</a></body></html>',
           onlink: function (e) {
               if (e.url.endsWith('.pdf')) {
                   alert('PDF: ' + e.url);
                   return false; // do not open link
               }
               return true; // open link
           }
       });
   window.add(webView);
   window.open();
   </pre></code></li>
</ol>


<p><a href="/TIMOB/TIMOB-26768.json">JSON Source</a></p>