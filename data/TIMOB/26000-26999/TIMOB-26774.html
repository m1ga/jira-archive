---
title: "[TIMOB-26774] Android: When backgrounded, data intent no longer re-executes \"app.js\" as of 7.5.0"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-02-12T18:37:15.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 7.5.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 7.5.1</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>Escalation, android, intent, regression</td></tr>
<tr><th>Reporter</th><td>Riduanul Islam</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2019-01-28T20:28:55.000+0000</td></tr>
<tr><th>Updated</th><td>2019-02-22T10:25:47.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
If the Android app's UI is in the background and you attempt to launch it via a data intent (aka: URL scheme, notification, or <code>startActivity()</code> intent), then the app's splash screen will be displayed but nothing will happen. This is a *regression* as of 7.5.0. Titanium 7.4.2 and older versions would re-execute the "app.js" in this case.

*Cause:*
What's happening is that a new UI activity stack is being created by the data intent while an existing UI stack already exists in the background. Titanium only supports running 1 JavaScript runtime at a time (does not support multiple JS runtimes). So, when the 2nd UI stack is displayed, it attempts to load the "app.js" when it was already loaded before.

In Titanium 7.4.2 and older versions, Titanium would re-execute the "app.js" for the JavaScript runtime, even though it was already loaded before. This was unintended behavior, but some app developers depend on this behavior.

As of 7.5.0, Titanium now loads a "ti.main.js" script on startup (our bootstrap script) and then loads the "app.js" via the <code>require()</code> function. But for the 2nd UI stack, since it's re-using an existing JavaScript runtime and the "app.js" was loaded before, the <code>require()</code> function won't re-execute the script and returns a cached module instead. This behavior is technically correct, but the old unexpected behavior is what's desired for Titanium 7.5.x.

*Note:*
As of Titanium 8.0.0, the above is not an issue. Intent handling was refactored in 8.0.0 to guarantee that only one UI stack exists at a time. Data intents will instead resume the existing UI stack like how iOS works. See [TIMOB-26075] for more details.

*Steps to reproduce:*
<h4>Create a classic Titanium app.</h4>
<h4>Set project name to "IntentTest". (This is <code>&lt;name/&gt;</code> in "tiapp.xml".)</h4>
<h4>Set project's "Application Id" to "com.appc.intent.test". (This is <code>&lt;id/&gt;</code> in "tiapp.xml.)</h4>
<h4>Set up the "app.js" with the below code.</h4>
<h4>Build and run on Android.</h4>
<h4>Wait for the app to launch.</h4>
<h4>Open the Mac "Terminal" app.</h4>
<h4>CD (change directory) to: <code>~/Library/Android/sdk/platform-tools</code></h4>
<h4>In the terminal, enter: <code>./adb shell am start -n com.appc.intent.test/.IntenttestActivity -a android.intent.action.VIEW -d <a href="https://www.google.com" rel="nofollow" target="_blank">https://www.google.com</a> -f 0x04000000</code></h4>

<code><pre>
var window = Ti.UI.createWindow();
var text = "Hello World!";
if (Ti.Android) {
	text += "\n\nLaunch Intent:\n" + JSON.stringify(Ti.Android.currentActivity.intent);
}
window.add(Ti.UI.createLabel({
	text: text,
	width: Ti.UI.FILL,
	height: Ti.UI.SIZE,
}));
window.open();
</pre></code>

*Result:*
A new splash screen window instance is displayed, but doesn't show the window and label implemented via the "app.js" code.

*Expected Result:*
It should re-execute the "app.js" when 2nd UI stack is displayed to maintain old behavior.

----
*Original Description*
----
Using 7.5.0.GA, application gets stuck on the splash screen when navigating back from the TargetApp towards the SourceApp after having the TargetApp opened from the SourceApp. Using 7.4.2.GA, it was working fine.

If you make 2 apps use the code below and tap their buttons to launch the other app, you can reproduce this behavior.
 [^SourceApp.js]  [^TargetApp.js] 

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26774_66133/SourceApp.js">SourceApp.js</td></td><td>2019-02-06T01:50:58.000+0000</td><td>663</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26774_66132/TargetApp.js">TargetApp.js</td></td><td>2019-02-06T01:50:59.000+0000</td><td>578</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2019-02-06

   PR (7.5.x): <a href="https://github.com/appcelerator/titanium_mobile/pull/10678" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10678</a></li>
<li>Samir Mohammed 2019-02-11

   FR Passed. Awaiting on CR before merge. </li>
<li>Samir Mohammed 2019-02-22

   *Closing ticket* Fix verified in SDK Version <code>7.5.1.v20190219102458</code>.
   
   Test and other information can be found at: 
   <a href="https://github.com/appcelerator/titanium_mobile/pull/10678" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10678</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-26774.json">JSON Source</a></p>