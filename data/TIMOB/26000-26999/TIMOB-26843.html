---
title: "[TIMOB-26843] Android: Getting/Setting TabGroup \"activeTab\" property before open causes a crash as of 8.0.0.RC"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-03-08T18:34:23.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 8.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 8.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>TabGroup, android, regression</td></tr>
<tr><th>Reporter</th><td>Josh Longton</td></tr>
<tr><th>Assignee</th><td>Yordan Banev</td></tr>
<tr><th>Created</th><td>2019-02-21T16:04:25.000+0000</td></tr>
<tr><th>Updated</th><td>2019-03-08T18:34:23.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
Getting or setting the <code>TabGroup</code> "activeTab" property (or calling <code>getActiveTab()</code> or <code>setActiveTab()</code> methods) before the <code>TabGroup</code> has been opened causes a crash on Android as of Titanium 8.0.0.RC.

*Steps to reproduce*
<h4>Build and run the below code via Titanium 8.0.0.RC on Android.</h4>
<h4>Notice the app crashes on startup.</h4>

*Testcase*
{noformat}
var tabGroup = Ti.UI.createTabGroup();

var win1 = Titanium.UI.createWindow({
    title: 'Tab 1',
    backgroundColor: '#fff'
});
var tab1 = Titanium.UI.createTab({
    title: 'Tab 1',
    window: win1
});

var label1 = Titanium.UI.createLabel({
    color: '#999',
    text: 'I am Window 1',
    textAlign: 'center',
    width: 'auto'
});

win1.add(label1);
var win2 = Titanium.UI.createWindow({
    title: 'Tab 2',
    backgroundColor: '#fff'
});
var tab2 = Titanium.UI.createTab({
    title: 'Tab 2',
    window: win2
});

var label2 = Titanium.UI.createLabel({
    color: '#999',
    text: 'I am Window 2',
    textAlign: 'center',
    width: 'auto'
});

win2.add(label2);
tabGroup.addTab(tab1);
tabGroup.addTab(tab2);
tabGroup.activeTab = 1;
Ti.API.info("### activeTab: " + tabGroup.activeTab);
tabGroup.open();
{noformat}

*Expected*
No error is thrown and the seconf tab is in focus

*Actual*
{noformat}
[ERROR] TiExceptionHandler: (main) [70,70] Attempt to invoke virtual method 'void ti.modules.titanium.ui.widget.tabgroup.TiUITab.onSelectionChange(boolean)' on a null object reference
[ERROR] TiExceptionHandler:
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.TabProxy.onSelectionChanged(TabProxy.java:220)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.TabGroupProxy.onTabSelected(TabGroupProxy.java:551)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.TabGroupProxy.onTabSelected(TabGroupProxy.java:521)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.tabgroup.TiUITabLayoutTabGroup.onTabSelected(TiUITabLayoutTabGroup.java:232)
[ERROR] TiExceptionHandler:     android.support.design.widget.TabLayout.dispatchTabSelected(TabLayout.java:1165)
[ERROR] TiExceptionHandler:     android.support.design.widget.TabLayout.selectTab(TabLayout.java:1158)
[ERROR] TiExceptionHandler:     android.support.design.widget.TabLayout.selectTab(TabLayout.java:1128)
[ERROR] TiExceptionHandler:     android.support.design.widget.TabLayout$Tab.select(TabLayout.java:1427)
[ERROR] TiExceptionHandler:     android.support.design.widget.TabLayout.addTab(TabLayout.java:483)
[ERROR] TiExceptionHandler:     android.support.design.widget.TabLayout.addTab(TabLayout.java:465)
[ERROR] TiExceptionHandler:     android.support.design.widget.TabLayout.addTab(TabLayout.java:444)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.tabgroup.TiUITabLayoutTabGroup.addTabItemInController(TiUITabLayoutTabGroup.java:159)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.tabgroup.TiUIAbstractTabGroup.addTab(TiUIAbstractTabGroup.java:199)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.TabGroupProxy.handlePostOpen(TabGroupProxy.java:442)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.TabGroupProxy.windowCreated(TabGroupProxy.java:416)
[ERROR] TiExceptionHandler:     org.appcelerator.titanium.TiActivityWindows.windowCreated(TiActivityWindows.java:33)
[ERROR] TiExceptionHandler:     org.appcelerator.titanium.TiBaseActivity.windowCreated(TiBaseActivity.java:624)
[ERROR] TiExceptionHandler:     org.appcelerator.titanium.TiBaseActivity.onCreate(TiBaseActivity.java:767)
[ERROR] TiExceptionHandler:     org.appcelerator.titanium.TiActivity.onCreate(TiActivity.java:21)
[ERROR] TiExceptionHandler:     android.app.Activity.performCreate(Activity.java:6975)
[ERROR] TiExceptionHandler:     android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1213)
[ERROR] TiExceptionHandler:     android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2770)
[ERROR] TiExceptionHandler:     android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2892)
[ERROR] TiExceptionHandler:     android.app.ActivityThread.-wrap11(Unknown Source:0)
[ERROR] TiExceptionHandler:     android.app.ActivityThread$H.handleMessage(ActivityThread.java:1593)
[ERROR] TiExceptionHandler:     android.os.Handler.dispatchMessage(Handler.java:105)
[ERROR] TiExceptionHandler:     android.os.Looper.loop(Looper.java:164)
[ERROR] TiExceptionHandler:     android.app.ActivityThread.main(ActivityThread.java:6541)
[ERROR] TiExceptionHandler:     java.lang.reflect.Method.invoke(Native Method)
[ERROR] TiExceptionHandler:     com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)
[ERROR] TiExceptionHandler:     com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)
{noformat}

*Note:*
It will crash when set via a <code>Ti.UI.createTabGroup()</code> creation property as well.

*Work-Around:*
You can set the active tab after the <code>TabGroup</code> has been opened as shown below.
<code><pre>
tabGroup.addEventListener("open", function() {
	tabGroup.activeTab = 1;
});
</pre></code>


<h3>Comments</h3>

<ol>
<li>Joshua Quick 2019-02-21

   We only have 1 unit test for setting "activeTab" and it is done after the <code>TabGroup</code> has been opened.
   <a href="https://github.com/appcelerator/titanium-mobile-mocha-suite/blob/master/Resources/ti.ui.tabgroup.test.js" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium-mobile-mocha-suite/blob/master/Resources/ti.ui.tabgroup.test.js</a>
   
   We should add 2 more unit tests for:
   * Setting "activeTab" to an integer via a <code>Ti.UI.createTabGroup()</code> creation property.
   * Setting "activeTab" to an integer after the <code>Ti.UI.createTabGroup()</code> function call, but before open.
   
   For both tests above, we should read the <code>TabGroup.activeTab</code> property immediately afterwards and verify that it is assigned to the correct value. This is to verify that the getter does not crash on Android either.
   
   I've tested doing the above on iOS (assigning them to an int before open) and it works fine. This is just a regression on Android in 8.0.0.RC.
   </li>
<li>Joshua Quick 2019-02-22

   We also have an API doc issue.
   
   We document that the <code>TabGroup.setActiveTab()</code> method (which is deprecated as of 8.0.0) supports types <code>Number</code> and <code>Ti.UI.Tab</code>, which is true. Our <code>TabGroup.activeTab</code> property documents that it only supports <code>Ti.UI.Tab</code>. The property's documentation needs to be updated to indicate it supports <code>Number</code> as well, just like the setter method.
   <a href="https://github.com/appcelerator/titanium_mobile/blob/master/apidoc/Titanium/UI/TabGroup.yml#L269" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/apidoc/Titanium/UI/TabGroup.yml#L269</a>
   </li>
<li>Yordan Banev 2019-03-01

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/10740" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10740</a></li>
<li>Keerthi Mahalingam 2019-03-04

   FR passed. Waiting for resolving Test failure in jenkins and back port PR for 8.0</li>
<li>Yordan Banev 2019-03-07

   PR (8_0_X): <a href="https://github.com/appcelerator/titanium_mobile/pull/10759" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10759</a></li>
<li>Keerthi Mahalingam 2019-03-07

   FR passed . Jenkins is failing. Waiting for Resolving jenkin test failure to merge.</li>
<li>Christopher Williams 2019-03-08

   keerthi did the FR while this was still a PR on Github. I've merged the master and 8_0_X PRs.</li>
</ol>


<p><a href="/TIMOB/TIMOB-26843.json">JSON Source</a></p>