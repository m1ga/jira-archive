---
title: "[TIMOB-26849] iOS HTTPS module: Invalid argument passed to securityManager property"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>engSchedule</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Vijay Singh</td></tr>
<tr><th>Created</th><td>2019-02-22T10:37:31.000+0000</td></tr>
<tr><th>Updated</th><td>2019-10-28T18:30:34.000+0000</td></tr>
</table>

<h3>Description</h3>

When using the <code>appcelerator.https</code> module, the app sometimes (very rarely) spits out an error about an invalid type. Here is the code used:
<code><pre>
// Set some default options
const httpOptions = {
    onload: event =&gt; {
        
    },
    onerror: event =&gt; {
        
    },
    timeout: 10 * 1000
};

// Use security manager for HTTP pinning
if (Alloy.CFG.api.baseURL.startsWith('https://')) {
    httpOptions.securityManager = Https.createX509CertificatePinningSecurityManager([ {
        url: 'https://*.example.com',
        serverCertificate: 'certs/example_com.der'
    } ]);
}

const httpRequest = Ti.Network.createHTTPClient(httpOptions);
</pre></code>
The error comes from [here](<a href="https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/TiNetworkHTTPClientProxy.m#L40)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/TiNetworkHTTPClientProxy.m#L40)</a> and suggests that the <code>securityManager</code> does not conform to the <code>SecurityManagerProtocol</code> or is not properly initialized at the point of it's assignment to the http-client proxy. Unfortunately the module is closed source so we cannot fix this ourselves. See the screenshot for details.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26849_66179/IMG_1120.PNG">IMG_1120.PNG</td></td><td>2019-02-22T10:29:11.000+0000</td><td>537993</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Vijay Singh 2019-03-15

   [~hknoechel]
    I tried using following test case , but unable to reproduce the issue. Can you give me complete reproducible test app?
   
   And what is frequency for this issue?
   
   Thanks!
   
   <code><pre>
   var https = require('appcelerator.https');
   
   var win = Titanium.UI.createWindow({
     title: 'Pin Example',
     backgroundColor: 'white'
   });
   
   win.open();
   
   setInterval(function(){
     const httpOptions = {
       onload: event =&gt; {
           
       },
       onerror: event =&gt; {
           
       },
       timeout: 10 * 1000
   };
   
   httpOptions.securityManager = https.createX509CertificatePinningSecurityManager([ {
       url: '<a href="https://www.wellsfargo.com" rel="nofollow" target="_blank">https://www.wellsfargo.com</a>',
       serverCertificate: 'wellsfargo.cer'
   } ]);
   
   const httpRequest = Ti.Network.createHTTPClient(httpOptions);
   Ti.API.info('http request created');
   }, 3000);
   </pre></code>
   </li>
<li>Hans Knöchel 2019-03-15

   The frequency is rarely every 50th build, which makes even more critical to reproduce. I think it's some kind of race condition in the delegate assignment but I'm not sure.</li>
<li>Shak Hossain 2019-10-28

   [~hknoechel] - since we have not updated in a while, just checking to see if you still need us to address this.</li>
<li>Hans Knöchel 2019-10-28

   Well, we wait for you guys to fix the issue, there isn't more to update. Please fix this. </li>
</ol>


<p><a href="/TIMOB/TIMOB-26849.json">JSON Source</a></p>