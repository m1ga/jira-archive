---
title: "[TIMOB-26857] iOS: Crash when parsing JSON from Ti.Filesystem.File.getFile()"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 8.0.0, Release 8.1.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>engSchedule</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Abir Mukherjee</td></tr>
<tr><th>Created</th><td>2019-02-25T08:38:07.000+0000</td></tr>
<tr><th>Updated</th><td>2020-12-04T19:50:15.000+0000</td></tr>
</table>

<h3>Description</h3>

We had one (always reproducible) crash that occurs everything we open a certain window. Recently we integrated Crashlytics into our Titanium app and now are finally able to catch that exception (attached). It seems like the core has an issue converting some numbers correctly:

<code><pre>
0 JavaScriptCore
WTFCrashWithInfo(int, char const*, char const*, int, unsigned long long, unsigned long long, unsigned long long) + 12
1 JavaScriptCore
JSC::JSObject::toPrimitive(JSC::ExecState*, JSC::PreferredPrimitiveType) const + 4016
</pre></code>
This can be reproduced using our app (steps as discussed).

Note: This is *no* duplicate of TIMOB-26852.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26857_66185/crash.rtf">crash.rtf</td></td><td>2019-02-25T09:47:03.000+0000</td><td>4034</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-26857_66186/currencies.json">currencies.json</td></td><td>2019-02-25T16:17:34.000+0000</td><td>27017</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Jan Vennemann 2019-02-25

   Apparently the crash was caused by JSON parsing when repeatedly calling the following code:
   
   <code><pre>
   JSON.parse(Ti.Filesystem.getFile('/currencies.json').read());
   </pre></code>
   
   Can be easily avoided by switching to <code>require('/currencies.json');</code>. However we should still check why the first version crashes after repeated calls.</li>
<li>Luke Lu 2019-05-03

   @Hans Knöchel How were you able to integrate crashlytics in titanium? I tried <a href="https://github.com/hansemannn/titanium-crashlytics" rel="nofollow" target="_blank">https://github.com/hansemannn/titanium-crashlytics</a> and few other resources but didnt get any luck</li>
<li>dkjeune 2019-10-12

   You can add '.text' to solve your problem 
   JSON.parse(Ti.Filesystem.getFile('/currencies.json').read().text);</li>
</ol>


<p><a href="/TIMOB/TIMOB-26857.json">JSON Source</a></p>