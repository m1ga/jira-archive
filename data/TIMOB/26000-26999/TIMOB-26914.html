---
title: "[TIMOB-26914] Android: An OS forced-quit app displays a blank window upon relaunch as of 8.0.0"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-04-29T15:06:34.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 8.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 8.0.1</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, engSchedule, freeze, regression, restart</td></tr>
<tr><th>Reporter</th><td>Michael Gangolf</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2019-03-16T14:29:35.000+0000</td></tr>
<tr><th>Updated</th><td>2019-04-29T18:29:05.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
If the OS force-quits the app (such as due to low memory), then when you relaunch the app later, it'll show a blank window as of Titanium 8.0.0.

This is not an issue if the end-user force-quits the app.
This is not an issue when the app is launched via a data intent such as URL scheme or notification.

This was not an issue before Titanium 8.0.0 _(the old code would schedule an app restart)_.

*Steps to reproduce:*
<h4>On Android, go to its "Developer Options" screen.</h4>
<h4>Tap on the "Background process limit" row. _(It's near the bottom of the list.)_</h4>
<h4>Tap on "No background processes". _(This tells the OS to force quit the last displayed app when launching another app.)_</h4>
<h4>Create a "Classic" default Titanium project.</h4>
<h4>Build and run on the same Android device configured above.</h4>
<h4>Wait for the app to launch.</h4>
<h4>Tap on the Android "Home" button.</h4>
<h4>Launch a different app such as "Gmail".</h4>
<h4>Tap on the Android "Home" button.</h4>
<h4>Resume the Titanium app.</h4>

*Result:*
When resuming/relaunching the app, a blank window is displayed.

*Expected Result:*
Since the app was forced-quit by the OS, the app should restart normally, starting with the splash screen.

*Note:*
When the Android OS force-quits the app, next time you relaunch it with the same intent, the OS will attempt to restore it back to its previous state starting with its top-most child activity. The OS will recreate the activities in reverse order, starting with the last displayed top-most child activity and ending with the root activity. The OS won't attempt to restore/recreate the parent activity until you close/finish/destroy the child activity.

The OS won't perform the above restore behavior if the end-user force-quits the app.

_(Ticket description was rewritten now that issue has been isolated.)_

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26914_66321/test_restart.zip">test_restart.zip</td></td><td>2019-03-16T14:28:12.000+0000</td><td>3397832</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-26914_66322/ti_log2.txt">ti_log2.txt</td></td><td>2019-03-16T14:27:33.000+0000</td><td>3077</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Sharif AbuDarda 2019-03-17

   Hello, I have tested your sample app in Android 9 device. I followed your step of backgrounding the app and remain until the process stops and shown in the log. Now, going back to the backgrounded app and opening it, I see no black screen, just the white window I suppose to see. Is the issue is only with Android 7 device? Can you try with a different version of Android? Thanks.</li>
<li>Joshua Quick 2019-03-19

   I can reproduce this issue if I set Android's "Background process limit" to <code>1</code> under "Developer Options".
   
   The issue does not happen if the app has a service running.</li>
<li>Joshua Quick 2019-03-20

   -PR (master): https:// github.com/appcelerator/titanium_mobile/pull/10787-
   -PR (8.0.x): https:// github.com/appcelerator/titanium_mobile/pull/10790-
   
   *_Edit:_*
   _Closing the above PRs since it'll still display a blank window when system developer option "Don't keep activities" is enabled. My PRs below is the better solution._</li>
<li>Rainer Schleevoigt 2019-03-31

   In my app a foreground service with notification will started and the issue with gray screen happens nevertheless.</li>
<li>Joshua Quick 2019-04-12

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/10829" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10829</a></li>
<li>Joshua Quick 2019-04-26

   PR (8.0.x): <a href="https://github.com/appcelerator/titanium_mobile/pull/10868" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10868</a></li>
<li>Lokesh Choudhary 2019-04-26

   FR passed PR merged.</li>
<li>Rainer Schleevoigt 2019-04-27

   Where I can download? <a href="http://builds.appcelerator.com/#8_0_X" rel="nofollow" target="_blank">http://builds.appcelerator.com/#8_0_X</a> ?</li>
<li>Rainer Schleevoigt 2019-04-27

   I will test this mobilesdk-8.0.1.v20190426162041-osx.zip . </li>
<li>Rainer Schleevoigt 2019-04-27

    OK other behavior: Instead of splash screen I shorty see the gray screen. If I switch to "don't keep activities" the I can commit that the bug is partly fixed:
    
    First test:
    1. running app
    2. home
    3. start again  => OK (over gray splash screen )
    Second test:
    1. running app
    2. screen of
    3. screen on => restart app with last screen
      
    EDIT: was my failure, seems to work and the intro seems to be a little faster</li>
<li>Samir Mohammed 2019-04-29

    Closing ticket, fix verified in SDK version 8.0.1.v20190426162041 and SDK version 8.1.0.v20190426222341.
    
    Test and other information can be found at: 
    Master : <a href="https://github.com/appcelerator/titanium_mobile/pull/10829" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10829</a>
    8_0_X: <a href="https://github.com/appcelerator/titanium_mobile/pull/10868" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/10868</a></li>
<li>Joshua Quick 2019-04-29

    Thanks for testing it out [~titanium@webmasterei-hamburg.de].
    
    And you will see a gray screen on relaunch for a brief moment if you set system developer option "Background process limit" to "None", launch the app, launch a different app, and then relaunch your app. The reason is because the Android OS forced quit the app in the background and upon relaunch it attempts to launch via the last displayed child activity (in Titanium's case the "TiActivity") instead of the main activity. There's nothing we can really do about this and other apps will show this behavior as well, including Google's own apps. Our solution for Titanium 8.1.0 is to improve the app's cold start up time, which we've already done on the "master" branch. It now starts up 2-4 times faster depending the device.</li>
<li>Michael Gangolf 2019-04-29

    And you can set an image for TiActivity (e.g. the logo, a "app is loading...",...) with
    <code>&lt;activity android:name="org.appcelerator.titanium.TiActivity" android:theme="@style/Theme.Custom.Splash"/&gt;</code> in the application part of your tiapp.xml and set an image in the theme
    <code><pre>
    &lt;style name="Theme.Custom.Splash" parent="@style/Theme.Titanium"&gt;
    		&lt;item name="android:windowBackground"&gt;@drawable/background_cropped&lt;/item&gt;
    &lt;/style&gt;
    </pre></code>
    
    Looks way better than just a grey screen.</li>
<li>Joshua Quick 2019-04-29

    What [~michael] will work. Just note that it changes the default background for all <code>Ti.UI.Window</code> objects to use that image. You can get around that by applying your own background image or color to your child windows.</li>
</ol>


<p><a href="/TIMOB/TIMOB-26914.json">JSON Source</a></p>