---
title: "[TIMOB-26944] Inconsistent Android SDK/NDK and JDK detection logic"
---
<table>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 8.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android, CLI, Tooling</td></tr>
<tr><th>Labels</th><td>2019-cl, cb-tooling</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Chris Barber</td></tr>
<tr><th>Created</th><td>2019-03-27T19:55:03.000+0000</td></tr>
<tr><th>Updated</th><td>2019-04-11T16:19:34.000+0000</td></tr>
</table>

<h3>Description</h3>

This is an internal development and architecture issue.

We have 3 separate "codebases" around detecting the Android SDK/NDK and the JDK/JAVA_HOME.

For developers building our SDK, we have some logic I wrote up in our "scons" scripts: <a href="https://github.com/appcelerator/titanium_mobile/tree/master/build/lib/android" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/tree/master/build/lib/android</a>

For SDK users (Titanium/Appc CLI) we delegate to node-titanium-sdk: <a href="https://github.com/appcelerator/node-titanium-sdk/blob/master/lib/android.js" rel="nofollow" target="_blank">https://github.com/appcelerator/node-titanium-sdk/blob/master/lib/android.js</a>
Which also delegates the jdk/Java stuff to node-apps: <a href="https://github.com/appcelerator/node-appc/blob/master/lib/jdk.js" rel="nofollow" target="_blank">https://github.com/appcelerator/node-appc/blob/master/lib/jdk.js</a>

And for the Daemon, it uses androidlib and jdklib:
- <a href="https://github.com/appcelerator/androidlib/tree/master/src" rel="nofollow" target="_blank">https://github.com/appcelerator/androidlib/tree/master/src</a>
- <a href="https://github.com/appcelerator/jdklib/tree/master/src" rel="nofollow" target="_blank">https://github.com/appcelerator/jdklib/tree/master/src</a>
(And although not explicit, it really also uses <a href="https://github.com/appcelerator/appcd-plugin-jdk/blob/master/src/jdk-info-service.js" rel="nofollow" target="_blank">https://github.com/appcelerator/appcd-plugin-jdk/blob/master/src/jdk-info-service.js</a> to scan Windows registry, etc)

We should not keep re-inventing the wheel repeatedly here. We should be re-using the same logic to detect these pieces regardless of whether we are building the SDK, using the SDK or using the daemon.

<h3>Comments</h3>

<ol>
<li>Chris Barber 2019-04-11

   androidlib and jdklib exist to replace the jdk logic in node-appc and android logic in node-titanium-sdk. I don't believe we should invest in updating the existing tooling to use androidlib/jdklib. Instead, spend that time getting the new toolchain out the door, which everyday we're getting closer to doing.
   
   This ticket has no direct actionable item and will be indirectly resolved when the new Titanium CLI ships.</li>
</ol>


<p><a href="/TIMOB/TIMOB-26944.json">JSON Source</a></p>