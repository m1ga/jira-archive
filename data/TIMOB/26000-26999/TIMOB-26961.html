---
title: "[TIMOB-26961] Windows: Save HttpClient instance until callback is fired"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Done</td></tr>
<tr><th>Resolution Date</th><td>2019-04-08T04:04:24.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 8.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 8.1.0</td></tr>
<tr><th>Components</th><td>Windows</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Kota Iguchi</td></tr>
<tr><th>Assignee</th><td>Kota Iguchi</td></tr>
<tr><th>Created</th><td>2019-04-02T02:17:12.000+0000</td></tr>
<tr><th>Updated</th><td>2019-04-08T04:04:24.000+0000</td></tr>
</table>

<h3>Description</h3>

Currently HttpClient may be garbege-collected before its callback is fired under some circumstances if you don't save HttpClient instance from garbage collector. In that case application crashes. We might want to save HttpClient instance from garbage collection by protecting its instance until <code>onerror</code> or <code>onload</code> callback is called.

<code><pre>
var win = Ti.UI.createWindow({
    backgroundColor: 'green'
});

win.addEventListener('open', function () {
    var _tmpURL = "<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/"
    var _tmpClient = Ti.Network.createHTTPClient({
        onload: function (e) {
            alert('Loaded');
        },
        onerror: function (e) {
            alert("Error:" + e.error);
        },
        timeout: 30000
    });
    _tmpClient.open("GET", _tmpURL);
    _tmpClient.send();

    // In this case _tmpClient may be garbage-collected as soon as this function is finished.
    // We could think this as "logical" failure but I think Titanium developers tend to use HttpClient like this.
});

win.open();
</pre></code>

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-26961.json">JSON Source</a></p>