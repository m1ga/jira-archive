---
title: "[TIMOB-27181] CLI: add ability to install native modules via npm"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2019-10-02T14:32:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>CLI, iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Brenton House</td></tr>
<tr><th>Assignee</th><td>Ewan Harris</td></tr>
<tr><th>Created</th><td>2019-06-22T19:00:50.000+0000</td></tr>
<tr><th>Updated</th><td>2019-10-02T14:32:11.000+0000</td></tr>
</table>

<h3>Description</h3>

Related to TIMOB-26352 because both would take advantage of npm and node_modules in the root directory of the project.   

Specifically for native modules, the directories would not get copied to Resources directory like normal commonjs Titanium packages but would instead get "installed" by copying to the modules directory and modifying the <code>tiapp.xml file</code> to add those modules to the app.

One way of doing this would be to add a "titanium" property to the <code>package.json</code> of the npm package that contains the native modules.  

Possibly something like this:



<code><pre>

  "titanium": {
    "nativeModules": true
  }

</pre></code>





<h3>Comments</h3>

<ol>
<li>Christopher Williams 2019-06-28

   As you're now aware, we already have this done: <a href="https://github.com/appcelerator/node-appc/pull/148" rel="nofollow" target="_blank">https://github.com/appcelerator/node-appc/pull/148</a>
   
   
   The larger issues that we don't have tickets for:
   - I limited it to only scan top-level modules, not nested to try and avoid native module collisions. native modules are "singletons" - you can't make use of multiple versions of the same module. I don't know that our tooling will see that and enforce it especially when looking at an app that may have multiple installs under the node_modules folder
   - We do not yet publish any of our native modules to npm. We need to modify our Jenkins builds to support it
   - When we do publish them, should we do so under a scoped name like <code>@titanium</code>, <code>@appcelerator</code>, <code>@appcelerator-modules</code>?
   - There's duplication of effort on the user's point in that just installing a native module through npm does not modify the tiapp.xml for them - they need to add it there themselves and make sure the versions match up. Maybe we can do some magic in some npm script hook that'd run post install and do it for them?
   - Our native modules with multiple platforms often have wildly varying versions between the Ones. What do we publish the npm package as? The higher of the two? Publish separate packages for each platform?
   - The npm package name and the module id do not have to match. Do we want to begin moving that way?</li>
<li>Brenton House 2019-06-28

   [~cwilliams] - We can go ahead and close this one.  I wasn't aware of the changes in node-appc when I created this ticket.   We can just create separate tickets for the features in your list that we want to include.  </li>
</ol>


<p><a href="/TIMOB/TIMOB-27181.json">JSON Source</a></p>