---
title: "[TIMOB-27208] CLI: Build fails to find modules due to different naming in manifest and folder"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 8.1.0, Release 8.2.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>CLI</td></tr>
<tr><th>Labels</th><td>cb-tooling, engSchedule, regression</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2019-07-05T09:36:58.000+0000</td></tr>
<tr><th>Updated</th><td>2020-01-31T19:20:41.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description </h4>

When detecting modules prior to 8.1.0 the folder name was used as the source of truth for the module id, with the changes in TIMOB-20379 we started to use the id field in the manifest as the source of truth. 

I guess it could be argued that this is down to to.imagcache having an error and our behaviour now is more correct, it *_is_* a change of behaviour from previous SDKs.


<h4>Steps to reproduce</h4>
1. Clone <a href="https://github.com/ewanharris/test-module-detection" rel="nofollow" target="_blank">https://github.com/ewanharris/test-module-detection</a>
2. Build the project with <code>appc run -p ios --build-only</code>
3. Change the SDK to and 8.2.0 or 8.1.0 SDK 
4. Repeat step 2 

<h4>Actual</h4>

When using 8.2.0/8.1.0 the build fails as it cant find the to.imagecache module

<h4>Expected</h4>

Unsure, it could argued we're being more correct now but this has introduced a regression through a change in behaviour Build should find the to.imagecache module

<h3>Comments</h3>

<ol>
<li>Christopher Williams 2019-07-09

   So the module in question actually has a fixed moduleid as of a year ago. I'm not certain how common this is for 3rd party modules, but I think we should consider opening a separate ticket for the module build process to check inconsistencies like this one (and others).
   
   Possible checks:
   - inconsistent module id versus folder name
   - inconsistent version versus folder version
   - mis-matching versions across different platforms? (try to encourage keeping them in sync?)
   
   It was also raised that we should consider supporting package.json to replace the manifest file.</li>
<li>Chris Barber 2020-01-31

   I wonder if this is happening due to the module a legacy install with a different module id? Say you have a module with id "foo.bar", it will create the directory "foo.bar". Now we update the id to "Foo.Bar". Thanks to Windows and macOS (by default) having case-insensitive filesystems, it detects the directory as already existing and just dumps the module in a version directory.
   
   Node doesn't test case sensitivity. For example, <code>fs.mkdirSync('./foo'); console.log(fs.existsSync('./FOO')); // true</code>.
   
   I don't know where Studio is getting their module id from in the tiapp editor, but I suspect it's from <code>appc ti module -o json</code> and this command will return the modules grouped by the directory name.
   
   At the end of the day, the module manifest should be the source of truth. If you have a module FOO@1.0.0 and foo@2.0.0, on disk they can both live in a "FOO" or "foo" directory, but the detection code should treat them as 2 different modules.</li>
</ol>


<p><a href="/TIMOB/TIMOB-27208.json">JSON Source</a></p>