---
title: "[TIMOB-27247] Android 7: Content URL's are returned as MediaStore columns"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Resolved</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2019-07-17T07:49:41.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2019-07-16T18:09:04.000+0000</td></tr>
<tr><th>Updated</th><td>2019-07-17T20:32:31.000+0000</td></tr>
</table>

<h3>Description</h3>

On Android 7, different to Android 9 for example, content URL's are returned like the following:
<code><pre>
content://com.google.android.apps.docs.fetcher.FileProvider/vRHOEWuB7jY0n9y_26GoQn-5crFYq2Ljl6VgSX23hUA%3D?_display_name=pdf.pdf&mime_type=application%2Fpdf&_size=433994
</pre></code>
Note <code>_display_name</code> for example, which is the raw column of the MediaStore class.

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2019-07-17

   So, what's the problem?
   
   Yes, content URLs will be different between different apps and different app versions. This is normal. There is no consistency. An app's ContentProvider can set up the content URL any way they want.
   
   Note that Titanium already correctly reads the display name from a content URL. You can see us doing it in the code below. The correct way of doing it is querying it via a <code>ContentResolver</code> like how we are doing it. You never parse the content URL since there is no standard format you can rely on.
   <a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/titanium/src/java/org/appcelerator/titanium/io/TitaniumBlob.java#L57" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/titanium/src/java/org/appcelerator/titanium/io/TitaniumBlob.java#L57</a>
   
   You can get the "display name" from a content URL in Titanium as follows...
   <code><pre>
   var file = Ti.Filesystem.getFile(yourContentUrl);
   var displayName = file.name;
   </pre></code>
   </li>
<li>Hans Knöchel 2019-07-17

   Thanks Josh, I think we just handled the URL too manually until now. There is one remaining issue that is about <code>extension()</code> being null on those, but I think you filed a ticket for that already. I will close this again!</li>
<li>Joshua Quick 2019-07-17

   bq. I think we just handled the URL too manually until now.
   
   I'm not sure what else we can do about this. We don't have direct file access (and it might not exist in the filesystem at all). Natively, we have to go through a <code>ContentResolver</code>/<code>ContentProvider</code> interface to get the file's bytes and do SQL-like queries to get info about it. We wrap the content URL via a Titanium <code>File</code> and <code>Blob</code> to help make it as cross-platform as possible,
   
   FYI: A content URL may not always provide a file extension. Especially if it references an embedded "res" file within the APK (they never have extensions). However, we can fetch its mime-type via a <code>ContentResolver</code> and we support doing this. In Titanium, the only way to acquire a content URL's mime-type is doing a <code>File.read()</code> to get the blob and then read the blob's "mimetype" property. So, be warned that when we do implement the <code>extension()</code> method, it can still return null or empty string if URL has no extension. The "mimetype" string is the way to go in the end.</li>
<li>Hans Knöchel 2019-07-17

   Thanks for the insight! I just meant that we used to do string operations on the URL which isn't required anymore, since the Ti.File object works pretty good.</li>
</ol>


<p><a href="/TIMOB/TIMOB-27247.json">JSON Source</a></p>