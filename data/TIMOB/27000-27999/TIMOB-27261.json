{
	"id": "173892",
	"key": "TIMOB-27261",
	"fields": {
		"issuetype": {
			"id": "1",
			"description": "A problem which impairs or prevents the functions of the product.",
			"name": "Bug",
			"subtask": false
		},
		"project": {
			"id": "10153",
			"key": "TIMOB",
			"name": "Titanium SDK/CLI",
			"projectCategory": {
				"id": "10100",
				"description": "Titanium and related SDKs used in application development",
				"name": "Client"
			}
		},
		"fixVersions": [
			{
				"id": "20845",
				"name": "Release 8.1.1",
				"archived": false,
				"released": true,
				"releaseDate": "2019-08-29"
			}
		],
		"resolution": {
			"id": "1",
			"description": "A fix for this issue is checked into the tree and tested.",
			"name": "Fixed"
		},
		"resolutiondate": "2019-08-28T22:35:24.000+0000",
		"created": "2019-07-17T23:57:59.000+0000",
		"priority": {
			"name": "Critical",
			"id": "1"
		},
		"labels": [
			"engSchedule",
			"ios",
			"regression"
		],
		"versions": [
			{
				"id": "19882",
				"name": "Release 8.0.0",
				"archived": false,
				"released": true,
				"releaseDate": "2019-03-14"
			}
		],
		"issuelinks": [],
		"assignee": {
			"name": "vijaysingh",
			"key": "vijaysingh",
			"displayName": "Vijay Singh",
			"active": true,
			"timeZone": "America/Los_Angeles"
		},
		"updated": "2019-08-28T22:35:24.000+0000",
		"status": {
			"description": "The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.",
			"name": "Closed",
			"id": "6",
			"statusCategory": {
				"id": 3,
				"key": "done",
				"colorName": "green",
				"name": "Done"
			}
		},
		"components": [
			{
				"id": "10206",
				"name": "iOS",
				"description": "iOS Platform"
			}
		],
		"description": "Hello. Good afternoon. \r\n\r\nI created an adhoc build with the specs mentioned on the section of environment, so after that, I use the application loader to upload the build, but I am getting the issues attached in the image.\r\n\r\nSpecs: \r\nTitanium SDK : 8.0.2.GA\r\nCLI: 7.0.12\r\nNode : 8.9.1\r\nAxway Appcelerator Studio, build: 5.1.2.201903111843\r\nXcode : 10.2\r\n\r\n{code:java}\r\n  ERROR ITMS-90087: \"Unsupported Architecture. The executable for tony.app/Frameworks/TitaniumKit.framework contains unsupported architecture '[x86_64, i386]'.\"\r\n\r\n    ERROR ITMS-90209: \"Invalid segment Alignment. The App Binary at tony.app/Frameworks/TitaniumKit.framework/TitaniumKit does not have proper segment alignment. Try rebuilding the app with the latest xcode version.\" \r\n\r\n    ERROR ITMS-90125: \"The Binary is invalid. The encryption info in the LC_ENCRYPTION_INFO load command is either missing or invalid, or the binary is already encrypted. This binary does not seem to have been built with Apple's Linker.\"\r\n    WARNING ITMS-90080: \"The Executable Payload/tony.app/Frameworks/TitaniumKit.framework\" is not a Position Independent Executable. Please ensure that ur build settings are configured to create PIE executables.\"\r\n{code}\r\n\r\n\r\nNote: If use the following specs,  I will not get any complaint of apple in the application loader.\r\nTi SDK : 7.5.1.GA\r\nCLI: 6.2.2\r\nNode Version : 8.9.1\r\n Xcode: 10.2\r\n\r\nI do not have a reproduce project for the issue, since the project which I am using is very extensive like to put it in this jira ticket.\r\n\r\nPlease let me know whether you have any doubt or question.\r\n\r\nThanks, and best,\r\nAntonio Duran.",
		"attachment": [
			{
				"id": "66773",
				"filename": "Screen Shot 2019-07-17 at 4.26.56 PM.png",
				"author": {
					"name": "antonioduran",
					"key": "antonioduran",
					"displayName": "Francisco Antonio Duran Ramirez",
					"active": true,
					"timeZone": "America/Los_Angeles"
				},
				"created": "2019-07-17T23:44:55.000+0000",
				"size": 305077,
				"mimeType": "image/png"
			}
		],
		"flagged": false,
		"summary": "iOS Unsupported Architecture [x86_64, i386]",
		"creator": {
			"name": "antonioduran",
			"key": "antonioduran",
			"displayName": "Francisco Antonio Duran Ramirez",
			"active": true,
			"timeZone": "America/Los_Angeles"
		},
		"subtasks": [],
		"reporter": {
			"name": "antonioduran",
			"key": "antonioduran",
			"displayName": "Francisco Antonio Duran Ramirez",
			"active": true,
			"timeZone": "America/Los_Angeles"
		},
		"environment": "Titanium SDK : 8.0.2.GA\r\nCLI: 7.0.12\r\nNode : 8.9.1\r\nAxway Appcelerator Studio, build: 5.1.2.201903111843\r\nXcode : 10.2",
		"closedSprints": [
			{
				"id": 1160,
				"state": "closed",
				"name": "2019 Sprint 17",
				"startDate": "2019-08-12T07:59:28.950Z",
				"endDate": "2019-08-25T07:59:00.000Z",
				"completeDate": "2019-08-26T15:35:29.980Z",
				"originBoardId": 114
			},
			{
				"id": 1161,
				"state": "closed",
				"name": "2019 Sprint 18",
				"startDate": "2019-08-26T21:46:26.269Z",
				"endDate": "2019-09-08T21:46:00.000Z",
				"completeDate": "2019-09-09T20:39:58.761Z",
				"originBoardId": 114
			}
		],
		"comment": {
			"comments": [
				{
					"id": "449897",
					"author": {
						"name": "rmitro",
						"key": "rmitro",
						"displayName": "Rakhi Mitro",
						"active": false,
						"timeZone": "America/Los_Angeles"
					},
					"body": "Hello,\r\nThanks for sharing with us. Can you please check this [link|https://github.com/williamrijksen/com.williamrijksen.onesignal/issues/84]? Hope this helps.",
					"updateAuthor": {
						"name": "rmitro",
						"key": "rmitro",
						"displayName": "Rakhi Mitro",
						"active": false,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-07-18T05:53:20.000+0000",
					"updated": "2019-07-18T05:53:20.000+0000"
				},
				{
					"id": "449906",
					"author": {
						"name": "antonioduran",
						"key": "antonioduran",
						"displayName": "Francisco Antonio Duran Ramirez",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"body": "Hello @Rakhi Mitro. Good morning / afternoon.\r\n\r\nThank you for the input.\r\n\r\nYep I found that part yesterday, but that link is related about one signal module more specifically to the *OneSignal.framework* . In my case, I am not using onesignal module, and it is related about :\r\n\r\n*TitaniumKit.framework* contains unsupported architecture [x86_64, i386]\r\nSorry for the red part, I did not add any color.\r\n\r\nEmphasizing that this issue is not happening with 7.5.1.GA.\r\n\r\nPlease let me know whether you have any doubt or question.\r\n\r\nThanks, and best,\r\nAntonio Duran.",
					"updateAuthor": {
						"name": "antonioduran",
						"key": "antonioduran",
						"displayName": "Francisco Antonio Duran Ramirez",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-07-18T14:41:52.000+0000",
					"updated": "2019-07-18T14:41:52.000+0000"
				},
				{
					"id": "449909",
					"author": {
						"name": "jkneen",
						"key": "jkneen",
						"displayName": "Jason Kneen",
						"active": false,
						"timeZone": "Africa/Ceuta"
					},
					"body": "[~antonioduran] -- does you app use any native modules? If so, which ones and what versions?",
					"updateAuthor": {
						"name": "jkneen",
						"key": "jkneen",
						"displayName": "Jason Kneen",
						"active": false,
						"timeZone": "Africa/Ceuta"
					},
					"created": "2019-07-18T15:40:47.000+0000",
					"updated": "2019-07-18T15:40:47.000+0000"
				},
				{
					"id": "449924",
					"author": {
						"name": "antonioduran",
						"key": "antonioduran",
						"displayName": "Francisco Antonio Duran Ramirez",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"body": "Hello @Jason Kneen. Good afternoon / evening.\r\n\r\n{code:java}\r\n    <module platform=\"iphone\" version=\"1.2.4\">dk.napp.drawer</module>\r\n    <module platform=\"iphone\" version=\"1.4.0\">ti.paint</module>\r\n    <module platform=\"iphone\" version=\"1.2.0\">ti.imagefactory</module>\r\n    <module platform=\"iphone\" version=\"2.0.0\">ti.docscanner</module>\r\n    <module platform=\"iphone\" version=\"1.0.0\">com.tokbox.ti.opentok</module>\r\n    <module platform=\"iphone\" version=\"3.1.2\">ti.map</module>\r\n    <module platform=\"iphone\" version=\"6.1.0\">com.wikitude.ti</module>\r\n \r\n{code}\r\n\r\nPlease let me know whether you have any doubt or question.\r\n\r\nThanks, and best,\r\nAntonio Duran.\r\n",
					"updateAuthor": {
						"name": "antonioduran",
						"key": "antonioduran",
						"displayName": "Francisco Antonio Duran Ramirez",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-07-18T18:55:01.000+0000",
					"updated": "2019-07-18T23:29:19.000+0000"
				},
				{
					"id": "449960",
					"author": {
						"name": "vijaysingh",
						"key": "vijaysingh",
						"displayName": "Vijay Singh",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"body": "[~antonioduran]\r\nRather selecting 'iOS AdHoc' , please select 'iOS iTune Store'  while packing the app from Studio. After building successfully, it will launch an interface in Xcode where you can see Archives of your app. If it didn't get open, open Xcode  -> select Window -> select Organizer.\r\nSelect your app -> Click on 'Distribute App'.\r\nThere you have option for directly uploading app to App Store. \r\nIf you want to upload app via Application Loader select Ad Hoc option and export ipa from. Use this ipa to  upload to App Store. \r\n\r\nMeanwhile we will investigate the issue.\r\nThanks!",
					"updateAuthor": {
						"name": "vijaysingh",
						"key": "vijaysingh",
						"displayName": "Vijay Singh",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-07-19T20:38:12.000+0000",
					"updated": "2019-07-19T20:38:12.000+0000"
				},
				{
					"id": "449995",
					"author": {
						"name": "antonioduran",
						"key": "antonioduran",
						"displayName": "Francisco Antonio Duran Ramirez",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"body": "Hello @Vijay Singh. Good afternoon / evening.\r\n\r\nI tried with the option of Distribute - Apple iTunes Store from Appcelerator Studio, and  Apple no longer complained about the issue reported before, so at least we have a temporary workaround using Distribute - Apple iTunes Store.\r\n\r\nAlso I tried on the terminal executing the following:\r\n\r\n{code:java}\r\nappc run -p ios -T dist-appstore --output-dir ~/Desktop\r\n{code}\r\n\r\nand I noticed this part very important:\r\n*[INFO]  Removing invalid architectures from TitaniumKit.framework*\r\n\r\n{code:java}\r\n[INFO]  Writing bootstrap json\r\n[INFO]  Creating launch image set\r\n[INFO]  App thinning disabled, skipping asset image sets\r\n[INFO]  Encrypting JavaScript files\r\n[INFO]  Writing i18n files\r\n[INFO]  Processing Titanium symbols\r\n[INFO]  Removing files\r\n[INFO]  Removing invalid architectures from TitaniumKit.framework\r\n[INFO]  Optimizing .plist and .png files\r\n[INFO]  Writing index.json with listing of JS/JSON files\r\n[INFO]  Invoking xcodebuild\r\n[INFO]  Preparing xcarchive\r\n[INFO]  Archiving debug symbols: /Users/tony/Documents/mobile/build/iphone/build/Products/Release-iphoneos/tony.app.dSYM\r\n[INFO]  Packaging complete\r\n[INFO]  Package location: /Users/tony/Desktop/tony.ipa\r\n[INFO]  Finished building the application in 2m 58s 930ms\r\n{code}\r\n\r\nSo, the bug is when a build is created as an adhoc, and then if this build is used with the application loader to upload the app to the appstore, apple will complaint about the issues described in this ticket, so for some reason in the process of the creation of the adhoc the architectures of i386 & x86_64 are not removed from the TitaniumKit.framework.\r\n\r\nSo I am trying to have a workaround doing the following:\r\n\r\n{code:java}\r\nlipo -remove i386 -output TitaniumKit.framework/TitaniumKit TitaniumKit.framework/TitaniumKit\r\nlipo -remove x86_64 -output TitaniumKit.framework/TitaniumKit TitaniumKit.framework/TitaniumKit\r\n{code}\r\n\r\nbut not sure how to create this part to be executed as a script phase during/after the compilation .\r\n\r\nPlease let me know whether you have any doubt or question.\r\n\r\nThanks, and best,\r\nAntonio Duran.",
					"updateAuthor": {
						"name": "antonioduran",
						"key": "antonioduran",
						"displayName": "Francisco Antonio Duran Ramirez",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-07-22T21:29:12.000+0000",
					"updated": "2019-07-22T21:29:12.000+0000"
				},
				{
					"id": "450006",
					"author": {
						"name": "vijaysingh",
						"key": "vijaysingh",
						"displayName": "Vijay Singh",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"body": "Thanks for detail [~antonioduran].\r\n\r\nPR - https://github.com/appcelerator/titanium_mobile/pull/11072",
					"updateAuthor": {
						"name": "vijaysingh",
						"key": "vijaysingh",
						"displayName": "Vijay Singh",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-07-22T23:50:00.000+0000",
					"updated": "2019-07-22T23:50:44.000+0000"
				},
				{
					"id": "450012",
					"author": {
						"name": "jvennemann",
						"key": "jvennemann",
						"displayName": "Jan Vennemann",
						"active": true,
						"timeZone": "Europe/Berlin"
					},
					"body": "[~vijaysingh], i think this is something we should consider for 8.1.1. Can you please do a 8_1_X backport? Thanks!",
					"updateAuthor": {
						"name": "jvennemann",
						"key": "jvennemann",
						"displayName": "Jan Vennemann",
						"active": true,
						"timeZone": "Europe/Berlin"
					},
					"created": "2019-07-23T15:22:51.000+0000",
					"updated": "2019-07-23T15:22:51.000+0000"
				},
				{
					"id": "450111",
					"author": {
						"name": "vijaysingh",
						"key": "vijaysingh",
						"displayName": "Vijay Singh",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"body": "PR(8_1_X) : https://github.com/appcelerator/titanium_mobile/pull/11087",
					"updateAuthor": {
						"name": "vijaysingh",
						"key": "vijaysingh",
						"displayName": "Vijay Singh",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-07-26T23:36:30.000+0000",
					"updated": "2019-07-26T23:36:30.000+0000"
				},
				{
					"id": "450800",
					"author": {
						"name": "kmahalingam",
						"key": "kmahalingam",
						"displayName": "Keerthi Mahalingam",
						"active": false,
						"timeZone": "America/Los_Angeles"
					},
					"body": "FR passed. Waiting on Jenkins.",
					"updateAuthor": {
						"name": "kmahalingam",
						"key": "kmahalingam",
						"displayName": "Keerthi Mahalingam",
						"active": false,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-08-24T05:13:18.000+0000",
					"updated": "2019-08-24T05:13:18.000+0000"
				},
				{
					"id": "450869",
					"author": {
						"name": "vijaysingh",
						"key": "vijaysingh",
						"displayName": "Vijay Singh",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"body": "[~lchoudhary]\r\nPR (8_3_X) - https://github.com/appcelerator/titanium_mobile/pull/11183",
					"updateAuthor": {
						"name": "vijaysingh",
						"key": "vijaysingh",
						"displayName": "Vijay Singh",
						"active": true,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-08-27T17:53:42.000+0000",
					"updated": "2019-08-27T17:53:42.000+0000"
				},
				{
					"id": "450903",
					"author": {
						"name": "cwilliams",
						"key": "cwilliams",
						"displayName": "Christopher Williams",
						"active": true,
						"timeZone": "America/New_York"
					},
					"body": "Merged to master, 8_1_X and 8_3_X",
					"updateAuthor": {
						"name": "cwilliams",
						"key": "cwilliams",
						"displayName": "Christopher Williams",
						"active": true,
						"timeZone": "America/New_York"
					},
					"created": "2019-08-28T16:53:48.000+0000",
					"updated": "2019-08-28T16:53:48.000+0000"
				},
				{
					"id": "450917",
					"author": {
						"name": "kmahalingam",
						"key": "kmahalingam",
						"displayName": "Keerthi Mahalingam",
						"active": false,
						"timeZone": "America/Los_Angeles"
					},
					"body": "Verified the Fix on SDK 8.1.1.v20190828100656,8.2.0.v20190828134315 and 8.3.0.v20190828100616. Works as expected. able to upload app through application loader.\r\n{code}\r\n*Test Environment:*\r\nOperating System\r\n  Name                        = Mac OS X\r\n  Version                     = 10.14.5\r\n  Architecture                = 64bit\r\nNode.js\r\n  Node.js Version             = 10.16.2\r\n  npm Version                 = 6.9.0\r\nTitanium CLI\r\n  CLI Version                 = 5.2.1\r\nTitanium SDK\r\n  SDK Version                 = 8.3.0.v20190828100616\r\nDevice =iPhone X iOS 11\r\n{code}",
					"updateAuthor": {
						"name": "kmahalingam",
						"key": "kmahalingam",
						"displayName": "Keerthi Mahalingam",
						"active": false,
						"timeZone": "America/Los_Angeles"
					},
					"created": "2019-08-28T22:35:19.000+0000",
					"updated": "2019-08-28T22:35:19.000+0000"
				}
			],
			"maxResults": 16,
			"total": 16,
			"startAt": 0
		}
	}
}