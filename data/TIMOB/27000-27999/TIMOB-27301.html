---
title: "[TIMOB-27301] CLI: Block scoped variables in for loops are attempted to be added to the global scope"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 8.0.2, Release 8.1.0, Release 8.2.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>CLI</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2019-07-31T14:02:22.000+0000</td></tr>
<tr><th>Updated</th><td>2019-07-31T15:29:16.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

When using a for loop in the top level scope (i.e. not in a function) of an app.js or alloy.js file if the variable declaration used is a block scoped variable (const/let) the below error will be thrown. This is because we try to use add the level to the global scope, but as it is block scope we can't reference it outside of the for loop.

*workaround*: Use <code>var</code> to declare the variable, or move the code into a function and call that.

*Note*: I believe by default this will only be seen on Android as babel will convert const/let to var on iOS

<code><pre>
ERROR] TiExceptionHandler: (main) [218,218] /app.js:29
[ERROR] TiExceptionHandler: }global.col = col;
[ERROR] TiExceptionHandler:               ^
[ERROR] TiExceptionHandler: ReferenceError: col is not defined
</pre></code>

<h4>Steps to reproduce</h4>

1. Add the below code to your app.js
<code><pre>
for (const number of [ 1, 2,3 ]) {
    console.log(number);
}
</pre></code>
2. Build to android

<h4>Actual</h4>

App will crash with above error

<h4>Expected</h4>

App should not crash

<h3>Comments</h3>

<p>No comments</p>

<p><a href="/TIMOB/TIMOB-27301.json">JSON Source</a></p>