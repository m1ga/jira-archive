---
title: "[TIMOB-27364] TiAPI: Support globalThis"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android, iOS, Windows</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Ewan Harris</td></tr>
<tr><th>Created</th><td>2019-08-29T13:45:33.000+0000</td></tr>
<tr><th>Updated</th><td>2019-09-02T09:32:04.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

Spec document: <a href="https://github.com/tc39/proposal-global" rel="nofollow" target="_blank">https://github.com/tc39/proposal-global</a>

I believe we will want to implement the globalThis proposal to ensure JS code written that uses this works in Titanium. 

It is important to note that as it this is specced at the ECMAScript level our JS Engines (v8 and JSCore) will also implement this. Therefore we may wish to follow the polyfill outlined in that repo and ensure that we only define globalThis in environments where it is already defined

v8 implemented in release 71 <a href="https://v8.dev/blog/v8-release-71" rel="nofollow" target="_blank">https://v8.dev/blog/v8-release-71</a>
It looks like WebKit implemented in late 2018 <a href="https://bugs.webkit.org/show_bug.cgi?id=165171" rel="nofollow" target="_blank">https://bugs.webkit.org/show_bug.cgi?id=165171</a>

We might be able to use [test262](<a href="https://github.com/tc39/test262)" rel="nofollow" target="_blank">https://github.com/tc39/test262)</a> to verify our changes are spec compliant

This should be easy to add via the ti.main.js setup we have

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2019-09-02

   Is this really required and requested by the users? I don't think anyone "needs" this right now. Besides, it worries me that the ti.main is filled with any kind of "useful" polyfills although approx. 1 % of all Titanium users actually need it. Especially iOS worries me, since Android can precompile that file but iOS can't. Please prioritize between the actual need and performance in real word apps.</li>
<li>Ewan Harris 2019-09-02

   [~hknoechel], this was actually bought up on slack in the last few weeks. But this isn't a "feature request" per se, it's something we have to do to make sure we're tracking the standards compliance. If you're pulling in code from npm, it's possible that some of that code might be using globalThis</li>
<li>Hans Knöchel 2019-09-02

   Are there statistics on how many people actually use npm deps? And the performance impacts of the ti.main introduction since 7.5.0? This is very important for performance-critical apps.</li>
</ol>


<p><a href="/TIMOB/TIMOB-27364.json">JSON Source</a></p>