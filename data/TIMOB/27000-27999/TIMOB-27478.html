---
title: "[TIMOB-27478] Webpack: Use thread-loader in production builds"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Do</td></tr>
<tr><th>Resolution Date</th><td>2020-01-24T00:10:24.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Jan Vennemann</td></tr>
<tr><th>Assignee</th><td>Jan Vennemann</td></tr>
<tr><th>Created</th><td>2019-10-17T11:07:22.000+0000</td></tr>
<tr><th>Updated</th><td>2020-01-24T00:10:24.000+0000</td></tr>
</table>

<h3>Description</h3>

To speed up production builds we should include [thread-loader](<a href="https://github.com/webpack-contrib/thread-loader)" rel="nofollow" target="_blank">https://github.com/webpack-contrib/thread-loader)</a> before other expensive loaders, like babel-loader.

The thread-loader is currently having some issues with platform specific files which needs to be investigated. We override Webpack's default compiler input filesystem with [PlatformAwareFilesystem](<a href="https://github.com/appcelerator/titanium-webpack-devkit/blob/a6af9bea700d2aeaa776defcbea96fe573047060/packages/webpack-target-titanium/src/plugins/PlatformAwareFileSystemPlugin.js#L12)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium-webpack-devkit/blob/a6af9bea700d2aeaa776defcbea96fe573047060/packages/webpack-target-titanium/src/plugins/PlatformAwareFileSystemPlugin.js#L12)</a> to easily switch out files based on the current platform. For example, a require to <code>@/components/Platform.vue</code> uses <code>@/components/Platform.ios.vue</code> if available.

This works fine in other loaders because they use the internal compiler filesystem. However, therad-loader has no access to that in workers, so it resorts to Node's [fs](<a href="https://github.com/webpack-contrib/thread-loader/blob/488300f5ad86c2eb794848de4cbc71c0cc5637da/src/worker.js#L107)" rel="nofollow" target="_blank">https://github.com/webpack-contrib/thread-loader/blob/488300f5ad86c2eb794848de4cbc71c0cc5637da/src/worker.js#L107)</a> module.

<h3>Comments</h3>

<ol>
<li>Jan Vennemann 2020-01-24

   There are other issues with with vue-loader and our custom titanium-vue-template-compiler as well. We need to specify our custom vue template compile function, which is not supported by thread loader.
   
   Since this will just result in a slight build time improvements i'll close this ticket for now. We can open it again should the need for thread-loader come up again.</li>
</ol>


<p><a href="/TIMOB/TIMOB-27478.json">JSON Source</a></p>