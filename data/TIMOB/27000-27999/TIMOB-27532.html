---
title: "[TIMOB-27532] iOS: Ti.Utils.base64encode(image).toString() Broken on iOS 9 and 10"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Duplicate</td></tr>
<tr><th>Resolution Date</th><td>2019-12-03T18:40:02.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ACF</td></tr>
<tr><th>Reporter</th><td>Fazlul Haque</td></tr>
<tr><th>Assignee</th><td>Vijay Singh</td></tr>
<tr><th>Created</th><td>2019-11-07T16:28:33.000+0000</td></tr>
<tr><th>Updated</th><td>2019-12-06T17:49:49.000+0000</td></tr>
</table>

<h3>Description</h3>

Hello,

Ti.Utils.base64encode(image).toString() is broken on iOS 9 and 10. This function returns [object TiBlob] when it should return the base64 encoded string. On iOS 11, 12, and 13 it works as expected.

*Test Environment:*
SDK version: 8.2.1.GA
Appcelerator Command-Line Interface, version 7.1.1
iOS Device: iPhone 6 plus(12.4.1), iPod 5G (9.3.5)

*Test Code:*
index.xml
<code><pre>&lt;Alloy&gt;
	&lt;Window class="container"&gt;
		&lt;Label class="label" onClick="getImage"&gt;Get Image from Photos&lt;/Label&gt;
		&lt;Label id="base64Text" class="label" /&gt;
	&lt;/Window&gt;
&lt;/Alloy&gt;</pre></code>

index.js
<code><pre>
var image = null;

function getImage() {
	Ti.Media.openPhotoGallery({
		success: function(event){
			image = event.media;

			var imageText = Ti.Utils.base64encode(image).toString();

			// Rendering thousands of characters is error prone so 
			// I trim the string for this proof of concept.
			if (imageText.length &gt; 100) {
				imageText = imageText.substring(0, 100);
			}

		  	$.base64Text.text = imageText;
		},
		allowEditing: false,
		mediaTypes: [Ti.Media.MEDIA_TYPE_PHOTO]
	});
}
$.index.open();
</pre></code>

You can check the attached project also.

*Steps to reproduce the issue:*
1. Run the above code on iOS 9 or 10
2. Click on the "Get Image from Photos" label and it will choose an image from gallery.
3. You will get *"[object TiBlob]"* but it should be returned the base64 encoded string.

Thanks

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-27532_67111/blob-to-string.zip">blob-to-string.zip</td></td><td>2019-11-07T16:26:22.000+0000</td><td>8665196</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Vijay Singh 2019-11-12

   From SDK 8.1.0.GA, toString() API is broken for TiBlob. Please ask to use property [text](<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Blob-property-text) until we properly fix it.
   
   e.g
     var imageText = Ti.Utils.base64encode(image).text;
   
   Updated index.js -
   
   <code><pre>
   function getImage() {
   	Ti.Media.openPhotoGallery({
   		success: function(event){
   			image = event.media;
    
                           var imageText = Ti.Utils.base64encode(image).text;
    
   			// Rendering thousands of characters is error prone so 
   			// I trim the string for this proof of concept.
   			if (imageText.length &gt; 100) {
   				imageText = imageText.substring(0, 100);
   			}
    
   		  	$.base64Text.text = imageText;
   		},
   		allowEditing: false,
   		mediaTypes: [Ti.Media.MEDIA_TYPE_PHOTO]
   	});
   }
   $.index.open();
   </pre></code>
   
   
   </li>
<li>Vijay Singh 2019-12-03

   Duplicate of TIMOB-27350.</li>
<li>Adam Paxton 2019-12-05

   Is TIMOB-27350 internal only ticket? I am unable to view/follow it.</li>
</ol>


<p><a href="/TIMOB/TIMOB-27532.json">JSON Source</a></p>