---
title: "[TIMOB-27644] Android: Webview opens new window with webview if link target is \"_blank\""
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 8.3.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>engTriage</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Yordan Banev</td></tr>
<tr><th>Created</th><td>2019-12-06T19:58:13.000+0000</td></tr>
<tr><th>Updated</th><td>2019-12-09T16:32:57.000+0000</td></tr>
</table>

<h3>Description</h3>

On Android, a webview opens new window with webview if link target is "_blank". This does not happen on iOS and should not happen except the developer explicitly wants a new window.

Example:
<code><pre>
var win = Ti.UI.createWindow({ title: 'Test Window' });
var webView = Ti.UI.createWebView({
    html: '&lt;html&gt;&lt;body&gt;&lt;a href="<a href="https://google.com" rel="nofollow" target="_blank">https://google.com</a>" target="_blank"&gt;Click me!&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;'
});
webView.addEventListener('beforeload', function (event) {
    if (event.url.includes('google.com')) {
        alert('STOP LOADING');
        webView.stopLoading();
    }
});
win.add(webView);
win.open();
</pre></code>

Any workaround is appreciated. The <code>blacklistedURLs</code> property also does not help.

*EDIT*: There is an old [<code>onCreateWindow</code>](<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI.WebView-property-onCreateWindow) property which is meant to handle _blank links, but unfortunately, returning <code>null</code> there does also not stop the new window from popping up. Same for returning <code>false</code> in the <code>onLink</code> property.

<h3>Comments</h3>

<ol>
<li>Michael Gangolf 2019-12-06

   I think this should help: <a href="http://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">http://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI.WebView-property-onCreateWindow
   <code><pre>
   webView.onCreateWindow = function(e) {
   	return null; // don't open popup links
   };
   </pre></code>
   or expose this property: <a href="https://github.com/appcelerator/titanium_mobile/blob/13658500189a8de1c8fa9773518fbe0ee7947036/android/modules/ui/src/java/ti/modules/titanium/ui/widget/webview/TiUIWebView.java#L318" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/13658500189a8de1c8fa9773518fbe0ee7947036/android/modules/ui/src/java/ti/modules/titanium/ui/widget/webview/TiUIWebView.java#L318</a> and set it to false (which would be a good idea)</li>
<li>Hans Knöchel 2019-12-06

   Just tried that and unfortunately it does not work. Disabling the above property will probably help, will build a custom SDK again. For parity with iOS, it should even be disabled by property, preventing multiple windows from being opened.
   
   *EDIT*: Holy moly. Assigning the property after creation works. De-escalated, thanks Michael! But hopefully this can be properly fixed in 9.0.0.
   
   *EDIT 2*: Unfortunately this does also not work, because the <code>beforeload</code> event does not fire anymore at all.</li>
<li>Michael Gangolf 2019-12-06

   <code><pre>
   var win = Ti.UI.createWindow({
   	title: 'Test Window'
   });
   
   var webView = Ti.UI.createWebView({
   	html: '&lt;html&gt;&lt;body&gt;&lt;a href="<a href="https://google.com" rel="nofollow" target="_blank">https://google.com</a>" target="_blank"&gt;external link&lt;/a&gt; - &lt;a href="<a href="https://google.de" rel="nofollow" target="_blank">https://google.de</a>" &gt;internal link&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;'
   });
   
   webView.addEventListener('beforeload', function(event) {
   	if (event.url.includes('google.com')) {
   		alert('STOP LOADING');
   		webView.stopLoading();
   	}
   });
   
   var tmpWebView = Ti.UI.createWebView({
   	visible:false
   });
   
   webView.onCreateWindow = function(e) {
   	return tmpWebView;
   };
   
   win.add(webView);
   win.open();
   </pre></code>
   
   That will trigger the alert for the external link. </li>
<li>Hans Knöchel 2019-12-06

   Mhhh, but what to do with the webview? I want to handle the URL with an external browser and return to the app, so I feel this could lead into a memory leak.
   
   *EDIT*: Manually disabling the native property doesn't help btw. I compiled a new SDK and it works with the first click and fails for all additional clicks.</li>
</ol>


<p><a href="/TIMOB/TIMOB-27644.json">JSON Source</a></p>