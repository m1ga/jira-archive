---
title: "[TIMOB-27711] TiAPI: Add state querying methods to UI components"
---
<table>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-08-25T00:39:14.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.1.0</td></tr>
<tr><th>Components</th><td>TiAPI</td></tr>
<tr><th>Labels</th><td>engSchedule</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2020-01-08T15:40:38.000+0000</td></tr>
<tr><th>Updated</th><td>2021-02-08T18:58:38.000+0000</td></tr>
</table>

<h3>Description</h3>

This is a glaring issue when we look at our test suite and see the common <code>before</code> hooks we've written to clean up open windows/etc.

We have no means of telling if a Window is closed or open. So instead we fire off a 3-second <code>setTimeout</code> fallback to handle the "isClosed" case, and then hang an event listener for the close event and try to close the window. So in the case where the test never opened the window (or already closed it), we basically do nothing for 3 seconds and assume since the <code>close</code> event never fired that it must have been closed.

We have <code>Ti.UI.View.visible</code> which should tell us if a view is hidden or visible.

Proposed APIs:
<code>Ti.UI.Window.closed</code> - <code>boolean</code>, <code>true</code> or <code>false</code> 
* tells us if the window is closed (do we need <code>opened</code> equivalent? I assume they'd just be inversions of one another)
* Potential alternates? <code>isClosed</code>, <code>closed</code>, <code>opened</code>, <code>isOpened</code> (properties versus methods?)
    * Note that JavaFX uses <code>showing</code> as a roughly equivalent API here: <a href="https://openjfx.io/javadoc/13/javafx.graphics/javafx/stage/Window.html" rel="nofollow" target="_blank">https://openjfx.io/javadoc/13/javafx.graphics/javafx/stage/Window.html</a>
    * Android equivalent may be <code>isActive</code>? <a href="https://developer.android.com/reference/android/view/Window.html#isActive()" rel="nofollow" target="_blank">https://developer.android.com/reference/android/view/Window.html#isActive()</a>

<code>Ti.UI.View.focused</code> - <code>boolean</code>, <code>true</code> or <code>false</code>
* Potential alternates? <code>isFocused</code>, <code>hasFocus</code> (properties versus methods?)
    * <a href="https://developer.android.com/reference/android/view/View#hasFocus()" rel="nofollow" target="_blank">https://developer.android.com/reference/android/view/View#hasFocus()</a>

<h3>Comments</h3>

<ol>
<li>Christopher Williams 2020-01-14

   <a href="https://github.com/appcelerator/titanium_mobile/pull/11433" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11433</a></li>
<li>Joshua Quick 2020-01-14

   [~cwilliams], we should define what the focus behavior should be for a window when a dialog is displayed. Currently there is a parity issue as noted here: [TIMOB-26176]
   
   In my opinion, I agree with iOS' behavior. Window "focus" should be lost when a dialog appears. The dialog gets the "focus" instead and will receive user-input.</li>
<li>Christopher Williams 2020-06-22

   Merged to master for 9.1.0 target</li>
</ol>


<p><a href="/TIMOB/TIMOB-27711.json">JSON Source</a></p>