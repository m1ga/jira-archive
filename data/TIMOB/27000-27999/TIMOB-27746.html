---
title: "[TIMOB-27746] Android: Apps built with 9.0.0 can't upload to Firebase App Distribution when including certain modules"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-02-14T20:59:07.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 9.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, firebase, manifest, module, xml</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2020-02-04T22:53:36.000+0000</td></tr>
<tr><th>Updated</th><td>2020-02-14T20:59:07.000+0000</td></tr>
</table>

<h3>Description</h3>

_(This issue was caught before release.)_

*Summary:*
You cannot upload an Android app built with a pre-release version of Titanium 9.0.0 to [Firebase App Distribution](<a href="https://firebase.google.com/docs/app-distribution)" rel="nofollow" target="_blank">https://firebase.google.com/docs/app-distribution)</a> (used for beta testing) if it includes one of the following modules.
* aca
* cloudpush
* ti.admob
* ti.barcode
* ti.geofence
* ti.identity
* ti.map
* ti.playservices

*Result:*
Google's website shows the following error when attempting to upload the APK.
bq. There was an error processing your distribution. Ensure you are uploading a valid IPA or APK and try again.

 !FirebaseError.png|thumbnail! 

*Note:*
You can upload the APK to Google Play without issues. You can install/run the APK on devices as well. So far, this only appears to be an issue with Firebase.

*Steps to reproduce:*
<h4>Build [kitchensink-v2](<a href="https://github.com/appcelerator/kitchensink-v2)" rel="nofollow" target="_blank">https://github.com/appcelerator/kitchensink-v2)</a> for Android.</h4>
<h4>Go to the Firebase Console webpage: <a href="https://console.firebase.google.com" rel="nofollow" target="_blank">https://console.firebase.google.com</a></h4>
<h4>Select a Firebase project. (Create one if you don't have one.)</h4>
<h4>Go to the "App Distribution" section.</h4>
<h4>Drag-and-drop the built APK to the Releases section.</h4>
<h4>Notice the upload errors out with the message shown above.</h4>

*Cause:*
Any module that is set up to inject "AndroidManifest.xml" settings via its "timodule.xml" will have this problem. It's an issue with the XML merge handling code which is wrongly injecting <code>xmlns:android=""</code> namespace declarations within the child elements. Google requires the android namespace to be declared in the root <code>&lt;manifest/&gt;</code> element and will throw a fit if you add it to the child elements too.

This is really a bug in the node.js "xmldom" module. It's doing a string reference equality check via <code>==</code> instead of a string value equality check via <code>===</code>.
[xmldom - dom.js#L951](<a href="https://github.com/xmldom/xmldom/blob/0003c1a01a14e5bbad927b6fc36244aef83bf3ef/dom.js#L951)" rel="nofollow" target="_blank">https://github.com/xmldom/xmldom/blob/0003c1a01a14e5bbad927b6fc36244aef83bf3ef/dom.js#L951)</a>


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-27746_67261/FirebaseError.png">FirebaseError.png</td></td><td>2020-02-04T22:52:07.000+0000</td><td>43343</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2020-02-04

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/11462" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11462</a></li>
<li>Christopher Williams 2020-02-05

   merged to master for 9.0.0</li>
<li>Joshua Quick 2020-02-07

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/11467" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11467</a>
   
   ^ This updates modules "ti.playservices" and "ti.maps" included in Titanium SDK so that built APKs can be uploaded to Firebase App Distribution without error.</li>
<li>Lokesh Choudhary 2020-02-14

   Verified the fix with SDK 9.0.0.v20200214090043.
   Closing.</li>
</ol>


<p><a href="/TIMOB/TIMOB-27746.json">JSON Source</a></p>