---
title: "[TIMOB-27757] watchOS: Frameworks are referenced incorrectly"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-07-29T23:17:09.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.1.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2020-02-10T20:42:17.000+0000</td></tr>
<tr><th>Updated</th><td>2020-07-29T23:17:09.000+0000</td></tr>
</table>

<h3>Description</h3>

When including native watchOS frameworks (and the build doesn't fail because of TIMOB-27756), the build later fails because the source files cannot find the frameworks. After some research, I found out that the frameworks are linked incorrectly, although linked correctly in the source project. It seems like a simple path issue somewhere, but it nukes the frameworks and marks them with a white icon (showing that they cannot be found).

The issue can be reproduced in our app. 

*EDIT*: I found the reason:
<code><pre>
Current pbxproj line (invalid):

		3A870A3023F1EE1600E07E86 /* MyFramework.framework */ = {isa = PBXFileReference; lastKnownFileType = wrapper.framework; path = MyFramework.framework; sourceTree = "&lt;group&gt;"; };

should be:

		3A39B9AF23F2AE7800FF2AC3 /* MyFramework.framework */ = {isa = PBXFileReference; lastKnownFileType = wrapper.framework; name = MyFramework.framework; path = extensions/my_watch_app/MyFramework.framework; sourceTree = "&lt;group&gt;"; };
</pre></code>

The pbxproj entry is missing the „name“ and „path“. Also, there is a missing framework search path <code>$(PROJECT_DIR)/extensions/my_watch_app</code> which should be added when the other refs are written. The issue behind it is that frameworks are stored at different subdirectories when copied from <project>/extensions/xxxx to <project>/build/iphone/extensions/xxxx but the path is not updated.

 A workaround is to hardcode the following hacky code below [these lines](<a href="https://github.com/appcelerator/titanium_mobile/blob/master/iphone/cli/commands/_build.js#L3411):" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/iphone/cli/commands/_build.js#L3411):</a>
<code><pre>
const currentFileRef = Object.assign({}, xobjs.PBXFileReference[extFrameworkReference]);

if (!currentFileRef.path.includes('extensions/') && currentFileRef.sourceTree === '"&lt;group&gt;"') {
    xobjs.PBXFileReference[extFrameworkReference].path = <code>extensions/MyExtensionName/${currentFileRef.path}</code>;
    xobjs.PBXFileReference[extFrameworkReference].name = currentFileRef.path;
}
</pre></code>

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2020-05-17

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/11708" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11708</a></li>
<li>Satyam Sekhri 2020-06-12

   FR Passed</li>
<li>Satyam Sekhri 2020-07-29

   Verified on:
   Mac OS: 10.15.4
   SDK: 9.1.0.v20200727104531
   Appc CLI: 8.1.0-master.7
   JDK: 11.0.4
   Node: 10.17.0
   Studio: 6.0.0.202005141803
   Xcode: 12.0 beta
   Device: iOS simulator 13.5</li>
</ol>


<p><a href="/TIMOB/TIMOB-27757.json">JSON Source</a></p>