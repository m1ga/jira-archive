---
title: "[TIMOB-27801] Android: Building the SDK should auto-download NDK if not installed"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2021-06-22T15:29:33.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 10.0.1</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, build, ndk, sdk</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2020-03-10T23:50:31.000+0000</td></tr>
<tr><th>Updated</th><td>2021-06-22T15:29:53.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
Google's gradle tool supports downloading the Android NDK for C/C++ builds. We should let it do so if the Titanium SDK is unable to find the NDK.

*Note:*
Currently, the SDK's <code>node scons</code> build scripts will fail the build if it can't find the NDK directory. Instead, it should generate a <code>local.properties</code> file without the <code>ndk.dir</code> property.
[createLocalPropertiesFile ()](<a href="https://github.com/appcelerator/titanium_mobile/blob/9a3e46dbea8083bce98dbae5c3795f669a2b7928/build/lib/android/index.js#L285)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/9a3e46dbea8083bce98dbae5c3795f669a2b7928/build/lib/android/index.js#L285)</a>


<h3>Comments</h3>

<ol>
<li>Joshua Quick 2020-03-11

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/11531" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11531</a>
   PR (9.0.x): <a href="https://github.com/appcelerator/titanium_mobile/pull/11532" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11532</a>
   </li>
<li>Sohail Saddique 2020-03-19

   *FR Passed*
   
   NDK auto installs if it isn't already installed. Verified with the test case listed on the PR.</li>
<li>Satyam Sekhri 2020-04-08

   The builds fails if NDK not installed
   
   <code><pre>
   [INFO]  [GRADLE] WARNING: Compatible side by side NDK version was not found. Default is 20.0.5594570.
   [INFO]  [GRADLE] Compatible side by side NDK version was not found. Default is 20.0.5594570.
   [ERROR] [GRADLE] 
   [ERROR] [GRADLE] FAILURE: Build failed with an exception.
   [ERROR] [GRADLE] 
   [ERROR] [GRADLE] * What went wrong:
   [ERROR] [GRADLE] A problem occurred configuring project ':module'.
   [ERROR] [GRADLE] &gt; Failed to notify project evaluation listener.
   [ERROR] [GRADLE]    &gt; NDK not configured. Download it with SDK manager. Preferred NDK version is '20.0.5594570'. Log: /Users/satyamsekhri/Documents/GitRepos/ti.imagefactory-stable/android/build/module/.cxx/ndk_locator_record.json
   [ERROR] [GRADLE]    &gt; Could not get unknown property 'externalNativeBuildDebug' for project ':module' of type org.gradle.api.Project.
   [ERROR] [GRADLE] 
   [ERROR] [GRADLE] * Try:
   [ERROR] [GRADLE] Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.
   [ERROR] [GRADLE] 
   [ERROR] [GRADLE] * Get more help at <a href="https://help.gradle.org" rel="nofollow" target="_blank">https://help.gradle.org</a>
   [ERROR] [GRADLE] 
   [ERROR] [GRADLE] BUILD FAILED in 897ms
   [ERROR] "gradlew" tool returned exit code: 1
   [ERROR] An error occurred during build after 2s 441ms
   [ERROR] "gradlew" tool returned exit code: 1
   </pre></code>
   
   Verified on:
   Mac OS: 10.15.1
   SDK: 9.0.1.v20200408050151, 9.1.0.v20200406120646
   Appc CLI: 8.0.0
   JDK: 11.0.4
   Node: 10.17.0</li>
<li>Joshua Quick 2020-04-08

   This started happening when we updated Android gradle tool to <code>3.6.0</code> via [TIMOB-27778].
   
   This appears to be a bug in Android gradle tool <code>3.6.0</code>, <code>3.6.1</code>, and <code>3.6.2</code>. If an <code>ndk.dir</code> is not provided via a "local.properties" file, then the Android gradle tool defaults to NDK version <code>20.0.5594570</code> which is an *unstable* release. The gradle tools only supports downloading *stable* releases listed by the links below, which is why it fails.
   <a href="https://developer.android.com/ndk/downloads" rel="nofollow" target="_blank">https://developer.android.com/ndk/downloads</a>
   <a href="https://developer.android.com/ndk/downloads/older_releases" rel="nofollow" target="_blank">https://developer.android.com/ndk/downloads/older_releases</a>
   
   I'll have to find a work-around.</li>
<li>Joshua Quick 2020-04-10

   I'm removing this ticket from the release.
   
   There doesn't appear to be a reliable way of doing this until Google makes this work better in their Android gradle tool. Although it's less of an issue here since you would normally work on the SDK code via Android Studio and you can easily add the NDK from the IDE.</li>
<li>Joshua Quick 2021-04-10

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/12711" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12711</a></li>
<li>Ewan Harris 2021-06-22

   master and 10_0_X backport merged</li>
</ol>


<p><a href="/TIMOB/TIMOB-27801.json">JSON Source</a></p>