---
title: "[TIMOB-27846] iOS: Calling Ti.Platform.openURL without all parameters causes the app to crash (regression)"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-07-20T14:12:30.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 9.0.1, Release 9.0.0, Release 9.0.2, Release 9.0.3</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.1.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>ios, regression</td></tr>
<tr><th>Reporter</th><td>Hugo Ramos Freire Neto</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2020-03-10T17:37:42.000+0000</td></tr>
<tr><th>Updated</th><td>2020-08-07T13:29:08.000+0000</td></tr>
</table>

<h3>Description</h3>

When I use Ti.Platform.openURL, and the app goes to background, the app crashes with this error:

[ERROR] Script Error {
[ERROR]     toJSON = "<KrollCallback: 0x600001e12380>";
[ERROR] } 

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-27846_67293/index.js">index.js</td></td><td>2020-03-10T17:34:18.000+0000</td><td>181</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Satyam Sekhri 2020-04-13

   The issue is a regression in SDK 9.0.0.GA. Do not see this issue with SDK 8.3.1.GA.
   Tested with
   Mac OS: 10.15.4
   SDK: 9.0.0.GA, 8.3.1.GA
   Appc CLI: 8.0.0
   JDK: 11.0.4
   Node: 10.17.0
   Studio: 6.0.0.202003181504
   Xcode: 11.4
   Device: iOS simulator 13.4, iOS simulator 12.2</li>
<li>Jonas Funk Johannessen 2020-06-12

   Seeing this as well. Adding the optional callback parameter will remove error: <code>Ti.Platform.openURL(url, null, ()=&gt;{});</code></li>
<li>Michael Gangolf 2020-06-26

   </li>
<li>Hans Knöchel 2020-07-19

   How can this issue not be scheduled so far? SDK 9 regression, critical crash, reproducible every time, already 3+ months old. Come on Axway!</li>
<li>Hans Knöchel 2020-07-19

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/11826" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11826</a>
   
   Example:
   <code><pre>
   function doInverval() {
       console.log('interval called');
   }
   
   function doClick(e) {
       Ti.Platform.openURL('<a href="https://google.com" rel="nofollow" target="_blank">https://google.com</a>', {}, function() {});
   }
   
   var win = Ti.UI.createWindow({
       backgroundColor: '#fff'
   });
   
   var btn = Ti.UI.createButton({
       title: 'Open URL'
   });
   
   btn.addEventListener('click', doClick);
   
   let interval = setInterval(doInverval, 1000);
   
   win.add(btn);
   win.open();
   </pre></code></li>
<li>Christopher Williams 2020-07-20

   Well this was a dumb error on my part. I misunderstood how the new JSC API would handle an optional callback argument - I assumed it'd be <code>nil</code>. It is not! It's a <code>JSValue \*</code> equivalent to <code>undefined</code>. So any APIs with an optional callback using the new JSC API need to explicitly check the arg is both not nil,  *and* is actually a function. Thanks for the PR [~hknoechel], that's what clued me in to the issue here. The fix is relatively straight-forward and I'll push it today.</li>
<li>Christopher Williams 2020-07-20

   Fixed in <a href="https://github.com/appcelerator/titanium_mobile/commit/31424c6c2e85ad5d18c5d45c156221545e8a0e22" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/31424c6c2e85ad5d18c5d45c156221545e8a0e22</a>
   
   (cherry-picked to 9_1_X and 9_3_X)</li>
<li>Christopher Williams 2020-07-20

   For good measure, I also cherry-picked back to 9_0_X branch</li>
<li>Samir Mohammed 2020-07-27

   *Closing ticket*. Fix verified in SDK version <code>9.1.0.v20200724110711</code>, <code>9.2.0.v20200724112452</code>, <code>9.0.4.v20200720071447</code> and <code>9.3.0.v20200724114100</code>.
   
   Tested using the following test case: 
   
   <code><pre>
   var win = Ti.UI.createWindow({
   	title: 'Ti.Platform.openURL Bug'
   });
   win.open();
   
   var button = Ti.UI.createButton({
   	top: 100,
   	height: Ti.UI.SIZE,
   	title: 'Open maps'
   });
   button.addEventListener('click', function() {
   	Ti.Platform.openURL('<a href="http://maps.apple.com/maps?q=-8.012960" rel="nofollow" target="_blank">http://maps.apple.com/maps?q=-8.012960</a>,110.308998');
   });
   win.add(button);
   
   setInterval(function() {
   	Ti.Platform.openURL('<a href="http://maps.apple.com/maps?q=-8.012960" rel="nofollow" target="_blank">http://maps.apple.com/maps?q=-8.012960</a>,110.308998');
   }, 10000);
   </pre></code>
   
   
   
   Test and other information can be found at:
   <a href="https://github.com/appcelerator/titanium_mobile/commit/31424c6c2e85ad5d18c5d45c156221545e8a0e22" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/31424c6c2e85ad5d18c5d45c156221545e8a0e22</a>
   
   *Test Environment*
   <code><pre>
   MacOS Big Sur: 11.0 Beta
   Xcode: 12.0 Beta 
   Java Version: 1.8.0_242
   Android NDK: 21.3.6528147
   Node.js: 12.18.1
   ""NPM":"5.0.0","CLI":"8.1.0-master.5""
   iphone 8 Sim (14.0 Beta)
   </pre></code>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-27846.json">JSON Source</a></p>