---
title: "[TIMOB-27859] Android: Add "badge" support to TabGroup"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-11-25T15:11:23.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>TabGroup, android, badge, parity, tab</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2020-04-21T17:29:12.000+0000</td></tr>
<tr><th>Updated</th><td>2020-11-25T15:11:23.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
We currently only support displaying badges in <code>TabGroup</code> tabs on iOS. We should add support to Android for parity.
<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI.Tab-property-badge
<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.UI.Tab-property-badgeColor

*To-Do:*
For the top tab style, we can use the "material" <code>TabLayout.Tab</code> class' <code>getOrCreateBadge()</code> and <code>removeBadge()</code> APIs.
<a href="https://developer.android.com/reference/com/google/android/material/tabs/TabLayout.Tab" rel="nofollow" target="_blank">https://developer.android.com/reference/com/google/android/material/tabs/TabLayout.Tab</a>

For the bottom tab style, we can use the "material" <code>BottomNavigationView</code> class' <code>getOrCreateBadge()</code> and <code>removeBadge()</code> APIs.
<a href="https://developer.android.com/reference/com/google/android/material/bottomnavigation/BottomNavigationView" rel="nofollow" target="_blank">https://developer.android.com/reference/com/google/android/material/bottomnavigation/BottomNavigationView</a>

Both of the above tab classes use the "material" <code>BadgeDrawable</code> class which provides APIs such as <code>setNumber()</code>, <code>setBackgroundColor()</code>, etc.
<a href="https://developer.android.com/reference/com/google/android/material/badge/BadgeDrawable" rel="nofollow" target="_blank">https://developer.android.com/reference/com/google/android/material/badge/BadgeDrawable</a>


<h3>Comments</h3>

<ol>
<li>Michael Gangolf 2020-04-26

   </li>
<li>Joshua Quick 2020-04-29

   [~michael], will the badges not render correctly without the material theme? Is it a layout issue? Color issue?
   
   _*Side Note:*_
   _Switching Titanium to use the material theme by default seemed like a breaking-change. So, we've punted on it for the moment. We'll probably look into it again for Titanium 10.0.0._</li>
<li>Michael Gangolf 2020-04-29

   the app will crash with:
   <code><pre>
   [ERROR] TiExceptionHandler: (main) [356,787] Unable to start activity ComponentInfo{com.bottom/org.appcelerator.titanium.TiActivity}: java.lang.IllegalArgumentException: The style on this component requires your app theme to be Theme.MaterialComponents (or a descendant).
   [ERROR] TiExceptionHandler:
   [ERROR] TiExceptionHandler:     com.google.android.material.internal.ThemeEnforcement.checkTheme(ThemeEnforcement.java:248)
   [ERROR] TiExceptionHandler:     com.google.android.material.internal.ThemeEnforcement.checkMaterialTheme(ThemeEnforcement.java:222)
   [ERROR] TiExceptionHandler:     com.google.android.material.badge.BadgeDrawable.<init>(BadgeDrawable.java:361)
   [ERROR] TiExceptionHandler:     com.google.android.material.badge.BadgeDrawable.createFromAttributes(BadgeDrawable.java:294)
   [ERROR] TiExceptionHandler:     com.google.android.material.badge.BadgeDrawable.create(BadgeDrawable.java:262)
   [ERROR] TiExceptionHandler:     com.google.android.material.bottomnavigation.BottomNavigationMenuView.getOrCreateBadge(BottomNavigationMenuView.java:647)
   [ERROR] TiExceptionHandler:     com.google.android.material.bottomnavigation.BottomNavigationView.getOrCreateBadge(BottomNavigationView.java:674)
   [ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.tabgroup.TiUIBottomNavigationTabGroup.updateBadge(TiUIBottomNavigationTabGroup.java:287)
   [ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.tabgroup.TiUIBottomNavigationTabGroup.updateDrawablesAfterNewItem(TiUIBottomNavigationTabGroup.java:188)
   [ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.tabgroup.TiUIBottomNavigationTabGroup.addTabItemInController(TiUIBottomNavigationTabGroup.java:170)
   [ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.tabgroup.TiUIAbstractTabGroup.addTab(TiUIAbstractTabGroup.java:247)
   [ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.tabgroup.TiUIBottomNavigationTabGroup.addTab(TiUIBottomNavigationTabGroup.java:64)
   [ERROR] TiExceptionHandler:     ti.modules.titanium.ui.TabGroupProxy.handlePostOpen(TabGroupProxy.java:480)
   [ERROR] TiExceptionHandler:     ti.modules.titanium.ui.TabGroupProxy.onWindowActivityCreated(TabGroupProxy.java:462)
   [ERROR] TiExceptionHandler:     org.appcelerator.titanium.TiBaseActivity.onCreate(TiBaseActivity.java:747)
   [ERROR] TiExceptionHandler:     org.appcelerator.titanium.TiActivity.onCreate(TiActivity.java:47)
   [ERROR] TiExceptionHandler:     android.app.Activity.performCreate(Activity.java:7825)
   [ERROR] TiExceptionHandler:     android.app.Activity.performCreate(Activity.java:7814)
   [ERROR] TiExceptionHandler:     android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1306)
   [ERROR] TiExceptionHandler:     android.app.ActivityThread.performLaunchActivity(ActivityThread.java:3245)
   [ERROR] TiExceptionHandler:     android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:3409)
   [ERROR] TiExceptionHandler:     android.app.servertransaction.LaunchActivityItem.execute(LaunchActivityItem.java:83)
   [ERROR] TiExceptionHandler:     android.app.servertransaction.TransactionExecutor.executeCallbacks(TransactionExecutor.java:135)
   [ERROR] TiExceptionHandler:     android.app.servertransaction.TransactionExecutor.execute(TransactionExecutor.java:95)
   [ERROR] TiExceptionHandler:     android.app.ActivityThread$H.handleMessage(ActivityThread.java:2016)
   [ERROR] TiExceptionHandler:     android.os.Handler.dispatchMessage(Handler.java:107)
   [ERROR] TiExceptionHandler:     android.os.Looper.loop(Looper.java:214)
   [ERROR] TiExceptionHandler:     android.app.ActivityThread.main(ActivityThread.java:7356)
   [ERROR] TiExceptionHandler:     java.lang.reflect.Method.invoke(Native Method)
   [ERROR] TiExceptionHandler:     com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:492)
   [ERROR] TiExceptionHandler:     com.android.internal.os.ZygoteInit.main(ZygoteInit.java:930)
   </pre></code></li>
<li>Michael Gangolf 2020-04-29

   I've added the missing <code>badgeColor</code></li>
<li>Joshua Quick 2020-04-29

   Hmm... perhaps a good interim solution is to change Titanium's default theme from...
   <code>Theme.AppCompat</code>
   
   ...to Google's material "bridge" themes...
   <a href="https://github.com/material-components/material-components-android/blob/master/docs/getting-started.md#bridge-themes-bridge-themes" rel="nofollow" target="_blank">https://github.com/material-components/material-components-android/blob/master/docs/getting-started.md#bridge-themes-bridge-themes</a>
   <a href="https://material.io/develop/android/docs/getting-started/#bridge-themes" rel="nofollow" target="_blank">https://material.io/develop/android/docs/getting-started/#bridge-themes</a>
   
   I'll have to experiment with this on my end.</li>
<li>Joshua Quick 2020-08-13

   [~michael], I'm working on switching Titanium's default theme from <code>"Theme.AppCompat"</code> to <code>"Theme.MaterialComponents.Bridge"</code> for 9.3.0 now. Google's Bridge theme derives from AppCompat and so far looks to be completely backward compatible... and it preserves the current color scheme which avoids breaking-changes. It's looking pretty positive so far.
   
   The only problem is app developers can replace the default app theme with their own. Most people usually make their own custom theme which derives from <code>"Theme.AppCompat"</code>, which will cause a crash with any AndroidX widget that requires the material theme. Not sure what we can do other than to let it crash and tell people to change the parent theme.</li>
<li>Samir Mohammed 2020-10-08

   FR Passed, Waiting on Jenkins build. </li>
<li>Samir Mohammed 2020-11-25

   *Closing ticket*. Improvement verified in SDK version <code>9.3.0.v20201125050632</code>.
   
   Test and other information can be found at:
   <a href="https://github.com/appcelerator/titanium_mobile/pull/11659" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11659</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-27859.json">JSON Source</a></p>