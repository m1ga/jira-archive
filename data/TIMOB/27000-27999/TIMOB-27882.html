---
title: "[TIMOB-27882] Android: Unable to do a production build after switching SDK on Windows"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-08-14T18:03:13.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 9.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.1.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, build, gradle</td></tr>
<tr><th>Reporter</th><td>Samir Mohammed</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2020-05-06T15:01:33.000+0000</td></tr>
<tr><th>Updated</th><td>2020-08-14T18:03:13.000+0000</td></tr>
</table>

<h3>Description</h3>

When creating a production build with two different SDKs the following error can be seen: 
<code><pre>
[ERROR] :  Error: EBUSY: resource busy or locked, unlink 'C:\Users\APPC\Documents\Appcelerator_Studio_Workspace\elloello\build\android\app\build\intermediates\metadata_library_dependencies_report\release\dependencies.pb'
</pre></code>

*Note*: If you manually end the java-tm process you are able to build

*Test Steps:*
<h4>Open Appcelerator studio </h4>
<h4>Create a new alloy application using SDK: 9.0.2.v20200505111803</h4>
<h4>Package using the Android store option in the drop down menu </h4>
<h4>Go through the prompts and select an output destination </h4>
<h4>Wait for .APK and .AAB to be created</h4>
<h4>Change SDK in the tiapp.xml to SDK: 9.1.0.v20200505112143</h4>
<h4>Package again using the Android store option in the drop down menu </h4>
<h4>Go through the prompts and select an output destination </h4>

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2020-05-06

   [~smohammed], would you mind trying something out for me please?
   (I don't have access to a Windows machine right now.)
   
   Please do this:
   <h4>Do a "production" build with 9.0.2.</h4>
   <h4>Open the Windows Command Prompt.</h4>
   <h4><code>CD</code> to directory: <code>&lt;YourProject&gt;/build/android</code></h4>
   <h4>Enter: <code>gradlew :app:clean</code></h4>
   <h4>Do a "production" build with 9.1.0.</h4>
   
   The above checks to see if telling the gradle tools to clean the build folder will release the file lock for us. Thanks!</li>
<li>Samir Mohammed 2020-05-07

   [~jquick] Following those steps I was able to do a production build without any issues. 
   
   Console showed this output when doing: <code>gradlew :app:clean</code>
   <code><pre>
   Deprecated Gradle features were used in this build, making it incompatible with Gradle 7.0.lean
   Use '--warning-mode all' to show the individual deprecation warnings.
   See <a href="https://docs.gradle.org/6.3/userguide/command_line_interface.html#sec:command_line_warnings" rel="nofollow" target="_blank">https://docs.gradle.org/6.3/userguide/command_line_interface.html#sec:command_line_warnings</a>
   
   BUILD SUCCESSFUL in 1s
   1 actionable task: 1 executed
   </pre></code>
   
   
   If I tried doing <code>gradlew :app:clean</code> after a failed production build (as mentioned in the ticket description) console would show this message:
   <code><pre>
   'gradlew' is not recognized as an internal or external command
   </pre></code>
   </li>
<li>Samir Mohammed 2020-05-18

   Error is also seen when running a Hyperloop application. (In this instance first ran on a Sim and then a device straight after where the below error was seen) 
   <code><pre>
   [ERROR] :  Error: EBUSY: resource busy or locked, unlink 'C:\Users\APPC\Documents\Appcelerator_Studio_Workspace\aaaaanewapp\build\hyperloop\android\gradle\wrapper\gradle-wrapper.jar'
   [ERROR] Application Installer abnormal process termination. Process exit value was 1
   </pre></code>
   </li>
<li>Joshua Quick 2020-05-19

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/11712" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11712</a>
   
   _*Edit:*_
   _The below PRs have been closed and are not needed._
   -PR (hyperloop):- <a href="https://github.com/appcelerator/hyperloop.next/pull/338" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/338</a>
   -PR (9.0.x):- <a href="https://github.com/appcelerator/titanium_mobile/pull/11713" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11713</a>
   </li>
<li>Joshua Quick 2020-05-19

   [~smohammed], theoretically, cleaning a module via <code>appc ti clean</code> should have a file locking issue on Windows too. Since I don't have a Windows machine available to me, I'm not able to confirm this. So, I added a "Module Clean Test" to my PR posted above.</li>
<li>Srinivasan Pulipakkam 2020-05-21

   Moving to Open Status</li>
<li>Christopher Williams 2020-06-17

   merged to master for 9.1.0 target</li>
<li>Samir Mohammed 2020-08-14

   Closing ticket, Fix verified in SDK Version 9.1.0.v20200814072027
   
   Test and other information can be found at: 
   <a href="https://github.com/appcelerator/titanium_mobile/pull/11712" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/11712</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-27882.json">JSON Source</a></p>