---
title: "[TIMOB-28127] iOS: TiUIListItemProxy overreleased causing intermittent crashing w/ macOS"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-10-02T14:38:26.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 9.2.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.2.1</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>engSchedule</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2020-09-11T17:22:29.000+0000</td></tr>
<tr><th>Updated</th><td>2020-10-02T14:38:26.000+0000</td></tr>
</table>

<h3>Description</h3>

Occasionally our unit test suite is crashing due to this issue, but it's always spitting out lots of warnings.
<code><pre>
objc[14701]: TiUIListItemProxy object 0x7fdd2a8c4e00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a070000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a04f600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a056c00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a04ca00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a17ec00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a059a00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a1a6000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a1a2400 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a0fc800 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a1a2a00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a1a3400 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a1a3e00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2b959200 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2b95e000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2b95e600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2b962000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a8c8800 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a8c3400 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a8c3a00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
objc[14701]: TiUIListItemProxy object 0x7fdd2a8cb000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
</pre></code>

So I suppose we're double releasing the proxies?

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-28127_67541/mocha_2020-09-11-095125_macos-walle.crash">mocha_2020-09-11-095125_macos-walle.crash</td></td><td>2020-09-11T17:21:10.000+0000</td><td>146435</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-28127_67542/mocha_2020-09-11-104957_macos-walle.crash">mocha_2020-09-11-104957_macos-walle.crash</td></td><td>2020-09-11T18:03:23.000+0000</td><td>145383</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-28127_67547/mocha_2020-09-14-113832_slapchop-macos.crash">mocha_2020-09-14-113832_slapchop-macos.crash</td></td><td>2020-09-14T18:41:08.000+0000</td><td>145366</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-28127_67548/mocha_2020-09-14-113909_slapchop-macos.crash">mocha_2020-09-14-113909_slapchop-macos.crash</td></td><td>2020-09-14T18:41:08.000+0000</td><td>148568</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Christopher Williams 2020-09-11

   These positions of the code look awfully suspicious:
   - <a href="https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/TiUIListView.m#L376-L382" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/TiUIListView.m#L376-L382</a>
   - <a href="https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/TiUIListView.m#L1518-L1539" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/iphone/Classes/TiUIListView.m#L1518-L1539</a>
   
   In both cases we have a <code>TiUIListItem</code> and a <code>TiUIListItemProxy</code> linked and ask to <code>release</code> both (in the latter we release the proxy but autorelease the cell). But <code>TiUIListItem</code>'s <code>dealloc</code> method seems to release the linked proxy as well.</li>
<li>Hans Kn√∂chel 2020-09-12

   Holy moly! We had some very similar crashes related to list items in the past already - this one is definitely the cause. In both of your snippets, the proxy should deallocate / be GC'd automatically, because it is initialized in the same scope. You can use the "Profiler" mode in Xcode to see if the change causes a new memory leak.</li>
<li>Christopher Williams 2020-09-14

   I am also seeing these in the logs, so presumably TableView suffers from he same sort of issue:
   <code><pre>
    TiUITableViewSectionProxy object 0x7f9a7c0b2200 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c17b600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c1c7600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c04dc00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c184600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c210200 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c175000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c147c00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c06d600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c125600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c176000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c0eac00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c16a200 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c068600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c1bd800 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c106000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c171a00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c094000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c0b7c00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c179600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7c20dc00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewSectionProxy object 0x7f9a7d966600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7d938c00 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewSectionProxy object 0x7f9a7d86c800 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7d82d200 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewSectionProxy object 0x7f9a7b866200 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.631Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7b8f5200 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.632Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7b98d800 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.632Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7d930000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.632Z] [INFO] :   objc[46360]: TiUITableViewSectionProxy object 0x7f9a7d935000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.632Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7d97a000 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   [2020-09-14T17:31:56.632Z] [INFO] :   objc[46360]: TiUITableViewRowProxy object 0x7f9a7d98e600 overreleased while already deallocating; break on objc_overrelease_during_dealloc_error to debug
   </pre></code></li>
<li>Vijay Singh 2020-09-15

   Test Case -
   
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor: '#fff'
   });
   
   var btn = Ti.UI.createButton({
       title: 'Trigger'
   });
   
   btn.addEventListener('click', function() {
   
   			var myTemplate = {
   				childTemplates: [
   					{
   						type: 'Ti.UI.ImageView',
   						bindId: 'pic',
   						properties: {
   							width: '50', height: '50', left: 0
   						}
   					},
   					{
   						type: 'Ti.UI.Label',
   						bindId: 'info',
   						properties: {
   							color: 'black',
   							font: { fontSize: '20', fontWeight: 'bold' },
   							left: '60', top: 0,
   						}
   					},
   					{
   						type: 'Ti.UI.Label',
   						bindId: 'es_info',
   						properties: {
   							color: 'gray',
   							font: { fontSize: '14' },
   							left: '60', top: '25',
   						}
   					}
   				]
   			},
   			listView = Ti.UI.createListView({
   				templates: { template: myTemplate },
   				defaultItemTemplate: 'template'
   			}),
   			sections = [],
   			fruitSection,
   			fruitDataSet,
   			vegSection,
   			vegDataSet,
   			grainSection,
   			grainDataSet;
   		    window = Ti.UI.createWindow({ backgroundColor: 'green' });
   
   		fruitSection = Ti.UI.createListSection({ headerTitle: 'Fruits / Frutas' });
   		fruitDataSet = [
   			{ info: { text: 'Apple' }, es_info: { text: 'Manzana' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Apple' }, es_info: { text: 'Manzana' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Apple' }, es_info: { text: 'Manzana' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Apple' }, es_info: { text: 'Manzana' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Apple' }, es_info: { text: 'Manzana' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Apple' }, es_info: { text: 'Manzana' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Apple' }, es_info: { text: 'Manzana' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Banana' }, es_info: { text: 'Banana' }, pic: { image: 'Logo.png' } }
   		];
   		fruitSection.setItems(fruitDataSet);
   		sections.push(fruitSection);
   
   		vegSection = Ti.UI.createListSection({ headerTitle: 'Vegetables / Verduras' });
   		vegDataSet = [
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Carrot' }, es_info: { text: 'Zanahoria' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Potato' }, es_info: { text: 'Patata' }, pic: { image: 'Logo.png' } }
   		];
   		vegSection.setItems(vegDataSet);
   		sections.push(vegSection);
   
   		grainSection = Ti.UI.createListSection({ headerTitle: 'Grains / Granos' });
   		grainDataSet = [
   			{ info: { text: 'Corn' }, es_info: { text: 'Maiz' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Corn' }, es_info: { text: 'Maiz' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Corn' }, es_info: { text: 'Maiz' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Corn' }, es_info: { text: 'Maiz' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Corn' }, es_info: { text: 'Maiz' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Corn' }, es_info: { text: 'Maiz' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Corn' }, es_info: { text: 'Maiz' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Corn' }, es_info: { text: 'Maiz' }, pic: { image: 'Logo.png' } },
   			{ info: { text: 'Rice' }, es_info: { text: 'Arroz' }, pic: { image: 'Logo.png' } }
   		];
   		grainSection.setItems(grainDataSet);
   		sections.push(grainSection);
   
   		listView.setSections(sections);
   
   		window.addEventListener('focus', function () {
   
   		});
   		listView.addEventListener('itemclick',  function(e){
   			window.close();
   		});
   
   		window.add(listView);
   		window.open();
   });
   
   win.add(btn);
   win.open();
   </pre></code>
   </li>
<li>Vijay Singh 2020-09-15

   1. I am seeing the overrelease message in Mac app only, not on iOS simulator and no crash.
   2. As Hans has mentioned theTiUIListItemProxy and TiUIListItem creation, at given code snippet, are in local scope and it should be released. If we do not release it, memory is leaking.
   Need to check in detail.
    </li>
<li>Christopher Williams 2020-09-18

   <a href="https://github.com/appcelerator/titanium_mobile/pull/12104" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12104</a></li>
<li>Christopher Williams 2020-09-28

   <a href="https://github.com/appcelerator/titanium_mobile/pull/12104" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12104</a></li>
<li>Samir Mohammed 2020-09-29

   FR Passed, waiting on Jenkins build and 9.2.1 build.</li>
<li>Samir Mohammed 2020-10-02

   *Closing ticket*. Fix verified in SDK version <code>9.2.1.v20201001120538</code>, and <code>9.3.0.v20201001144501</code>. Unable to see any crashing. 
   
   *Test and other information can be found at:*
   <a href="https://github.com/appcelerator/titanium_mobile/pull/12104" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12104</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-28127.json">JSON Source</a></p>