---
title: "[TIMOB-28151] iOS: Compile error if using Ti.Media APIs without openPhotoGallery"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-09-24T14:45:32.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 9.2.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.2.1</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>nicolomonili</td></tr>
<tr><th>Assignee</th><td>Ewan Harris</td></tr>
<tr><th>Created</th><td>2020-09-24T09:38:43.000+0000</td></tr>
<tr><th>Updated</th><td>2020-10-02T14:45:19.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

Using Ti.Media APIs without using openPhotoGallery will cause a compile error

<code><pre>
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1837:17: error: expected a type
[TRACE]  - (void)picker:(PHPickerViewController *)picker didFinishPicking:(NSArray<PHPickerResult *> *)results
[TRACE]                  ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1837:75: error: unknown type name 'PHPickerResult'
[TRACE]  - (void)picker:(PHPickerViewController *)picker didFinishPicking:(NSArray<PHPickerResult *> *)results
[TRACE]                                                                            ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1792:7: error: use of undeclared identifier '_phPicker'
[TRACE]    if (_phPicker != nil) {
[TRACE]        ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1799:3: error: unknown type name 'PHPickerConfiguration'; did you mean 'UIPasteConfiguration'?
[TRACE]    PHPickerConfiguration *configuration = [[PHPickerConfiguration alloc] init];
[TRACE]    ^~~~~~~~~~~~~~~~~~~~~
[TRACE]    UIPasteConfiguration
[TRACE]  In module 'UIKit' imported from /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:33:
[TRACE]  /Applications/Xcodebeta.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS14.0.sdk/System/Library/Frameworks/UIKit.framework/Headers/UIPasteConfiguration.h:16:12: note: 'UIPasteConfiguration' declared here
[TRACE]  @interface UIPasteConfiguration : NSObject <NSSecureCoding, NSCopying>
[TRACE]             ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1799:44: error: unknown receiver 'PHPickerConfiguration'; did you mean 'UIPasteConfiguration'?
[TRACE]    PHPickerConfiguration *configuration = [[PHPickerConfiguration alloc] init];
[TRACE]                                             ^~~~~~~~~~~~~~~~~~~~~
[TRACE]                                             UIPasteConfiguration
[TRACE]  In module 'UIKit' imported from /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:33:
[TRACE]  /Applications/Xcodebeta.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS14.0.sdk/System/Library/Frameworks/UIKit.framework/Headers/UIPasteConfiguration.h:16:12: note: 'UIPasteConfiguration' declared here
[TRACE]  @interface UIPasteConfiguration : NSObject <NSSecureCoding, NSCopying>
[TRACE]             ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1806:19: error: property 'selectionLimit' not found on object of type 'UIPasteConfiguration *'
[TRACE]      configuration.selectionLimit = [TiUtils intValue:[args objectForKey:@"selectionLimit"] def:allowMultiple ? 0 : 1];
[TRACE]                    ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1812:33: error: use of undeclared identifier 'PHPickerFilter'
[TRACE]            [filterList addObject:PHPickerFilter.imagesFilter];
[TRACE]                                  ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1814:33: error: use of undeclared identifier 'PHPickerFilter'
[TRACE]            [filterList addObject:PHPickerFilter.livePhotosFilter];
[TRACE]                                  ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1816:33: error: use of undeclared identifier 'PHPickerFilter'
[TRACE]            [filterList addObject:PHPickerFilter.videosFilter];
[TRACE]                                  ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1823:27: error: use of undeclared identifier 'PHPickerFilter'
[TRACE]      [filterList addObject:PHPickerFilter.imagesFilter];
[TRACE]                            ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1826:3: error: use of undeclared identifier 'PHPickerFilter'
[TRACE]    PHPickerFilter *filter = [PHPickerFilter anyFilterMatchingSubfilters:filterList];
[TRACE]    ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1826:19: error: use of undeclared identifier 'filter'
[TRACE]    PHPickerFilter *filter = [PHPickerFilter anyFilterMatchingSubfilters:filterList];
[TRACE]                    ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1826:29: error: use of undeclared identifier 'PHPickerFilter'
[TRACE]    PHPickerFilter *filter = [PHPickerFilter anyFilterMatchingSubfilters:filterList];
[TRACE]                              ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1827:17: error: property 'filter' not found on object of type 'UIPasteConfiguration *'
[TRACE]    configuration.filter = filter;
[TRACE]                  ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1827:26: error: use of undeclared identifier 'filter'
[TRACE]    configuration.filter = filter;
[TRACE]                           ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1829:3: error: use of undeclared identifier '_phPicker'
[TRACE]    _phPicker = [[PHPickerViewController alloc] initWithConfiguration:configuration];
[TRACE]    ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1829:17: error: use of undeclared identifier 'PHPickerViewController'
[TRACE]    _phPicker = [[PHPickerViewController alloc] initWithConfiguration:configuration];
[TRACE]                  ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1831:4: error: use of undeclared identifier '_phPicker'
[TRACE]    [_phPicker setDelegate:self];
[TRACE]     ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1832:9: warning: instance method '-displayModalPicker:settings:' not found (return type defaults to 'id') [-Wobjc-method-access]
[TRACE]    [self displayModalPicker:_phPicker settings:args];
[TRACE]          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[TRACE]  In file included from /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:11:
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.h:25:12: note: receiver is instance of class declared here
[TRACE]  @interface MediaModule : TiModule <
[TRACE]             ^
[TRACE]  /Users/awam/Documents/Appcelerator_Studio_Workspace/ticreateapp/build/iphone/Classes/MediaModule.m:1832:28: error: use of undeclared identifier '_phPicker'
[TRACE]    [self displayModalPicker:_phPicker settings:args];
[TRACE]                             ^
[TRACE]  fatal error: too many errors emitted, stopping now [-ferror-limit=]
</pre></code>

<code><pre>
var window = Ti.UI.createWindow();
Ti.Media.beep();
window.open()
</pre></code>

<h4>Steps to reproduce</h4>

1. Add the above code to an existing app.js
2. Build for an iOS device <code>appc run -p ios -T device --build-only</code>

<h4>Actual</h4>

Compile error

<h4>Expected</h4>

No compile error

<h3>Comments</h3>

<ol>
<li>Ewan Harris 2020-09-24

   PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/12129" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12129</a></li>
<li>Ewan Harris 2020-09-24

   Also verify that the test case in TIMOB-27984 still functions as expected</li>
<li>Christopher Williams 2020-09-24

   simple guard, confirmed the fix locally by reproducing and confirming the updated code fixes the issue.</li>
<li>Samir Mohammed 2020-10-02

   *Closing ticket*. Fix verified in SDK version <code>9.2.1.v20201001120538</code>, and <code>9.3.0.v20201001144501</code>. Tested using the test case mentioned in the description. 
   
   *Test and other information can be found at:*
   <a href="https://github.com/appcelerator/titanium_mobile/pull/12129" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12129</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-28151.json">JSON Source</a></p>