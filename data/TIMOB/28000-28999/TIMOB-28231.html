---
title: "[TIMOB-28231] Android: Change Ti.Filesystem.externalStorageDirectory to use scoped storage"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2020-11-16T21:39:39.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, externalstorage, filesystem</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2020-11-06T04:33:16.000+0000</td></tr>
<tr><th>Updated</th><td>2020-11-16T21:39:39.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
The Android [externalStorageDirectory](<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Filesystem-property-externalStorageDirectory) is currently set to a location outside of "scoped storage". As of Android 10, you cannot write to this location unless you set "AndroidManfiest.xml" <code>&lt;application/&gt;</code> attribute <code>requestLegacyExternalStorage</code> to <code>true</code>.
<a href="https://developer.android.com/about/versions/11/privacy/storage" rel="nofollow" target="_blank">https://developer.android.com/about/versions/11/privacy/storage</a>

*Solution:*
Use the folder location returned by the Java [Context.getExternalFilesDir()](<a href="https://developer.android.com/reference/android/content/Context#getExternalFilesDir(java.lang.String))" rel="nofollow" target="_blank">https://developer.android.com/reference/android/content/Context#getExternalFilesDir(java.lang.String))</a> method. This is a private sandboxed directory for the app that falls under scoped storage.

*Note 1:*
With this change, you do *+NOT+* need the following permissions anymore.
* READ_EXTERNAL_STORAGE
* WRITE_EXTERNAL_STORAGE

*Note 2:*
With this change, you do *+NOT+* need to use the following APIs anymore.
* [Ti.Filesystem.hasStoragePermissions()](<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Filesystem-method-hasStoragePermissions)
* [Ti.Filesystem.requestStoragePermissions()](<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Filesystem-method-requestStoragePermissions)

*Note 3:*
The new folder location supports automatic back-up by the Android OS. This means when you uninstall and re-install the app, the files you've written to external storage will be restored.

*Work-Around:*
For apps built with Titanium 8.3.0 - 9.2x, you can read/write to <code>externalStorageDirectory</code> by doing the following in your "tiapp.xml" file.
<code><pre>
&lt;ti:app&gt;
	&lt;android xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"&gt;
		&lt;manifest&gt;
			&lt;!-- You MUST target Android 10 for "requestLegacyExternalStorage" support. --&gt;
			&lt;!-- The "requestLegacyExternalStorage" attribute is ignored by Android 11. --&gt;
			&lt;uses-sdk android:targetSdkVersion="29"/&gt;
			&lt;application android:requestLegacyExternalStorage="true"/&gt;
		&lt;/manifest&gt;
	&lt;/android&gt;
&lt;/ti:app&gt;
</pre></code>


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-28231_67638/FileExternalTest.js">FileExternalTest.js</td></td><td>2020-11-09T22:04:46.000+0000</td><td>1447</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2020-11-07

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/12253" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12253</a></li>
<li>Lokesh Choudhary 2020-11-16

   FR Passed.
   PR Merged.</li>
</ol>


<p><a href="/TIMOB/TIMOB-28231.json">JSON Source</a></p>