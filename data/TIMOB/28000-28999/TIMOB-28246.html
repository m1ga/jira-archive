---
title: "[TIMOB-28246] Android: Ti.Media.previewImage() fails to display in-memory blobs as of 9.1.0"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 9.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, blob, media, preview, regression</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2020-11-19T03:28:18.000+0000</td></tr>
<tr><th>Updated</th><td>2020-11-20T23:36:23.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
The [Ti.Media.previewImage()](<a href="https://docs.appcelerator.com/platform/latest/#" rel="nofollow" target="_blank">https://docs.appcelerator.com/platform/latest/#</a>!/api/Titanium.Media-method-previewImage) method fails to display in-memory blobs (ie: blobs not referencing a file) as of Titanium 9.1.0.

*Steps to reproduce:*
<h4>Build and run the below on Android.</h4>
<h4>Tap on the "Preview" button. (Will try to display screenshot of app.)</h4>
<h4>Notice it fails to display image.</h4>

<code><pre>
var window = Ti.UI.createWindow();
var button = Ti.UI.createButton({ title: "Preview" });
button.addEventListener("click", function(e) {
	window.toImage(function(imageBlob) {
		if (!imageBlob) {
			return;
		}
		Ti.Media.previewImage({
			image: imageBlob,
			success: function(e) {
				Ti.API.info("@@@ Successfully displayed preview.");
			},
			error: function(e) {
				Ti.API.error("@@@ Failed to display preview");
			},
		});
	});
});
window.add(button);
window.open();
</pre></code>

*Work-Around:*
Save the blob to file and preview the file instead.
<code><pre>
var window = Ti.UI.createWindow();
var button = Ti.UI.createButton({ title: "Preview" });
button.addEventListener("click", function(e) {
	window.toImage(function(imageBlob) {
		if (!imageBlob) {
			return;
		}

		// Write the blob to file.
		var targetFile = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, "image.png");
		targetFile.write(imageBlob, false);
		imageBlob = targetFile.read();

		// Preview the above file.
		Ti.Media.previewImage({
			image: imageBlob,
			success: function(e) {
				Ti.API.info("@@@ Successfully displayed preview.");
			},
			error: function(e) {
				Ti.API.error("@@@ Failed to display preview");
			},
		});
	});
});
window.add(button);
window.open();
</pre></code>


<h3>Comments</h3>

<ol>
<li>Joshua Quick 2020-11-19

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/12271" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12271</a></li>
<li>Satyam Sekhri 2020-11-20

   FR Passed</li>
<li>Christopher Williams 2020-11-20

   merged to master and 9_3_X for 9.3.0 target.</li>
<li>Joshua Quick 2020-11-20

   Fixed minor regression within <code>TiFileHelper</code> class' <code>deployFromAssets()</code> and <code>deployFromZip()</code> methods. Note that nobody uses these methods. It is dead code... but "could" potentially be used in the future.
   
   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/12281" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12281</a>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-28246.json">JSON Source</a></p>