---
title: "[TIMOB-28283] Android: Hyperloop based requires fail to load when using "remote" encryption policy"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 9.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.3.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, encryption, hyperloop, regression, remote</td></tr>
<tr><th>Reporter</th><td>Ewan Harris</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2020-12-10T15:19:59.000+0000</td></tr>
<tr><th>Updated</th><td>2020-12-11T18:01:02.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Description</h4>

When using Hyperloop with appc-sourcecode-encryption-policy enabled, Hyperloop requires fail to load.

<h4>Steps to reproduce</h4>

1. Add <code><property name="appc-sourcecode-encryption-policy">remote</property></code> to a hyperloop-examples project that is registered with the platform
2. Build to Android

<h4>Actual</h4>

App will error on a Hyperloop require like below

<code><pre>
[ERROR] TiExceptionHandler: Error: Requested module not found: android.provider.Settings
[ERROR] TiExceptionHandler:     at Module.require (ti:/module.js:297:8)
[ERROR] TiExceptionHandler:     at Module.global.Module.require (<embedded>:5051:34)
</pre></code>

<h4>Expected</h4>

No error should occur

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2020-12-10

   The real issue is that <code>\*.bootstrap.js</code> scripts are not being executed on app startup when remote policy encryption is used.
   
   This is an issue with our "ti.playserivces" module. It's bootstrap script isn't being loaded on startup and it is used to check/update Google Play Services on the device if needed before running the "app.js". This step is being skipped due to this remote policy issue.</li>
<li>Joshua Quick 2020-12-10

   I've isolated the issue. The problem is that our <code>File.exists()</code> method returns <code>false</code> for remote-policy encrypted files. This is preventing Titanium from loading our "bootstrap.json" file. The <code>read()</code> method works fine. It's just a file existence check issue.
   <a href="https://github.com/appcelerator/titanium_mobile/blob/master/common/Resources/ti.internal/bootstrap.loader.js#L33" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/common/Resources/ti.internal/bootstrap.loader.js#L33</a>
   
   I can see the same issue when doing the below. The below will return <code>false</code> when checking if the "app.js" exists, which of course isn't true.
   <code><pre>
   const file = Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory, 'app.js');
   console.log("### app.js exists:" + file.exists());
   </pre></code>
   </li>
<li>Joshua Quick 2020-12-11

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/12336" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12336</a></li>
<li>Christopher Williams 2020-12-11

   merged to master for 10.0.0 target, back port PRs for 9_3_X and 9_2_X are in progress for 9.3.0 GA target and maintenance branch build target.</li>
<li>Christopher Williams 2020-12-11

   backport PRs for 9.3.0 GA target and 9_2_X branches have been merged/landed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-28283.json">JSON Source</a></p>