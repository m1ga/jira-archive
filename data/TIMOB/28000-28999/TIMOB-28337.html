---
title: "[TIMOB-28337] Android: ListView properties missing in \"longpress\" event in Alloy as of 9.3.0"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2021-02-10T16:35:29.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 9.3.1, Release 10.0.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 9.3.2</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>listview, longpress, regression</td></tr>
<tr><th>Reporter</th><td>Hans Knöchel</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2021-02-05T20:42:00.000+0000</td></tr>
<tr><th>Updated</th><td>2021-02-12T08:48:30.000+0000</td></tr>
</table>

<h3>Description</h3>

When using the "longpress" event on the Android ListView in 9.3.0+, the itemIndex / sectionIndex are not supplied via the event when the longpress occured on a child view of the list item template. I don't have an isolated test case so far, but it should be reproducible on any custom-templates test case that adds the "longpress" event to the view wrapper.

The same used to work on both iOS and Android. What I can share immediately is the Alloy sample:
<code><pre>
&lt;Alloy&gt;
	&lt;ListView id="listView" defaultItemTemplate="MyCell"&gt;
		&lt;Templates&gt;
			&lt;ItemTemplate name="MyCell"&gt;
				&lt;View height="43" onLongpress="onLongPress"&gt;
					&lt;ImageView bindId="image" /&gt;
					&lt;Label bindId="titleLabel" /&gt;
				&lt;/View&gt;
			&lt;/ItemTemplate&gt;
		&lt;/Templates&gt;
	&lt;/ListView&gt;
&lt;/Alloy&gt;
</pre></code>

Important to note is that the longpress event is added to the item template, not the list view itself as this used to be the only way to handle this. If there are better ways, let me know!

*EDIT*: Just checked it: The longpress event does not work on the ListView at all (like the itemclick and others), so the above is the only feasible workaround thats now also broken :(

<h3>Comments</h3>

<ol>
<li>Hans Knöchel 2021-02-08

   Thanks for looking into this Gary :) Many thanks for this amazing work!</li>
<li>Gary Mathews 2021-02-09

   [~hknoechel] I'm having trouble reproducing this in JS, adding an event listener to a child label will inherit <code>sectionIndex</code> and <code>itemIndex</code> etc.. correctly.
   
   <code><pre>
   const win = Ti.UI.createWindow({
       backgroundColor: 'gray'
   });
   const listView = Ti.UI.createListView({
       backgroundColor: 'white',
       templates: {
           template: {
               properties: {
                   borderRadius: 16,
                   height: 50
               },
               childTemplates: [{
                   type: 'Ti.UI.Label',
                   bindId: 'label',
                   events: {
                   	longpress (e) {
                   		console.log('longpress: ' + JSON.stringify(Object.keys(e), null, 2));
                   	}
                   },
                   properties: {
                       color: 'white'
                   }
               }]
           }
       },
       defaultItemTemplate: 'template'
   });
   listView.sections = [
       Ti.UI.createListSection({
           items: [{
                   properties: {
                       backgroundColor: 'red'
                   },
                   label: {
                       text: 'Red'
                   }
               },
               {
                   properties: {
                       backgroundColor: 'green'
                   },
                   label: {
                       text: 'Green'
                   }
               },
               {
                   properties: {
                       backgroundColor: 'blue'
                   },
                   label: {
                       text: 'Blue'
                   }
               },
               {
                   properties: {
                       backgroundColor: 'yellow'
                   },
                   label: {
                       text: 'Yellow'
                   }
               },
               {
                   properties: {
                       backgroundColor: 'cyan'
                   },
                   label: {
                       text: 'Cyan'
                   }
               },
               {
                   properties: {
                       backgroundColor: 'pink'
                   },
                   label: {
                       text: 'Pink'
                   }
               },
           ]
       })
   ];
   
   win.add(listView);
   win.open();
   </pre></code>
   
   I'll look into what Alloy is doing, as it may not be making use of the <code>events</code> property in the template.</li>
<li>Gary Mathews 2021-02-09

   master: <a href="https://github.com/appcelerator/titanium_mobile/pull/12456" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12456</a></li>
<li>Lokesh Choudhary 2021-02-09

   FR Passed.
   Waiting for jenkins.</li>
<li>Rodrigo Farfán 2021-02-12

   This was also reported in TIMOB-28291.</li>
<li>Hans Knöchel 2021-02-12

   Thanks Rodrigo! I believe now it's fully fixed. You can try the latest 9.3.2 version (ti sdk install -b 9_3_X)!</li>
</ol>


<p><a href="/TIMOB/TIMOB-28337.json">JSON Source</a></p>