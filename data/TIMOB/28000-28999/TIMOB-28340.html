---
title: "[TIMOB-28340] TiAPI: Return Promise for Ti.UI.Window open() and close()"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2021-02-08T18:59:19.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 10.0.0</td></tr>
<tr><th>Components</th><td>TiAPI</td></tr>
<tr><th>Labels</th><td>engSchedule</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2021-02-08T18:58:38.000+0000</td></tr>
<tr><th>Updated</th><td>2021-04-13T12:28:08.000+0000</td></tr>
</table>

<h3>Description</h3>

We have a number of basic operations that rely on event listener based usage to handle notifying when the operation is "complete". While this works, it can lead to a lot of boilerplate code for hanging simple one-time callback logic when the operation is complete.

i.e. We often have a single listener on Ti.UI.Window#close() where we want to clean up after the windows is closed. Compare:
<code><pre>
win.addEventListener('close', function listener (e) {
  win.removeEventListener('close', listener); // clean up this callback listener
  // do whatever other cleanup we want
});
win.close();

// versus

window.close(e =&gt; {
  // do whatever other cleanup we want
});
</pre></code>

It would be good to review our APIs and the events we fire and see if they are explicitly tied to methods called by the developer - and if so, provide optional callback functions as the final arguments so that developers could use a more Node.JS style usage and streamline cases where you only expect a single listener/callback (though for backwards compatibility and for supporting multiple listeners we shoulder retain the event firing as well).

Note that this would also position us well to add "shims" to convert these methods calls into Promise-based APIs at the JS level.
<code><pre>
win.close().then(e =&gt; {
  // do whatever other cleanup we want
});
// or...
const closeEvent = await win.close();
// do whatever other cleanup we want
</pre></code>

<h3>Comments</h3>

<ol>
<li>Christopher Williams 2021-02-08

   <a href="https://github.com/appcelerator/titanium_mobile/pull/12407" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12407</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-28340.json">JSON Source</a></p>