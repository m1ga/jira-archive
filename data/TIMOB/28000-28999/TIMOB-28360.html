---
title: "[TIMOB-28360] iOS: DocumentViewer setAnnotation method causing a crash"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2021-05-18T18:31:49.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 10.0.0, Release 9.3.3</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>DocumentViewer, annotation, iOS</td></tr>
<tr><th>Reporter</th><td>Brian Garc√≠a</td></tr>
<tr><th>Assignee</th><td>Vijay Singh</td></tr>
<tr><th>Created</th><td>2021-02-19T10:31:58.000+0000</td></tr>
<tr><th>Updated</th><td>2021-05-18T18:31:52.000+0000</td></tr>
</table>

<h3>Description</h3>

<code><pre>
const docViewer = Ti.UI.iOS.createDocumentViewer({
        url:'tempfile',
      });
      docViewer.setAnnotation("annotation");
docViewer.show();
</pre></code>
<code><pre>
Application Specific Information:
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString count]: unrecognized selector sent to instance 0x7ff2c7a8fc00'
terminating with uncaught exception of type NSException
abort() called
CoreSimulator 732.18.0.2 - Device: iPhone 12 Pro Max (DB20DFA5-B2F2-44DF-BE15-DEF47939E33E) - Runtime: iOS 14.2 (18B79) - DeviceType: iPhone 12 Pro Max

Application Specific Backtrace 1:
0   CoreFoundation                      0x00007fff2041daf2 __exceptionPreprocess + 242
1   libobjc.A.dylib                     0x00007fff20177e78 objc_exception_throw + 48
2   CoreFoundation                      0x00007fff2042c6f7 +[NSObject(NSObject) instanceMethodSignatureForSelector:] + 0
3   CoreFoundation                      0x00007fff20422032 ___forwarding___ + 1489
4   CoreFoundation                      0x00007fff20424068 _CF_forwarding_prep_0 + 120
5   TitaniumKit                         0x00000001020aeb85 -[TiScriptError formattedNativeStack] + 133
6   TitaniumKit                         0x00000001020aea8b -[TiScriptError description] + 1127
7   Foundation                          0x00007fff2084637a _NSDescriptionWithLocaleFunc + 82
8   CoreFoundation                      0x00007fff203b6e09 __CFStringAppendFormatCore + 12102
9   CoreFoundation                      0x00007fff203b889d _CFStringCreateWithFormatAndArgumentsReturningMetadata + 145
10  CoreFoundation                      0x00007fff203b8806 _CFStringCreateWithFormatAndArgumentsAux2 + 20
11  TitaniumKit                         0x000000010206e678 TiLogMessage + 175
12  TitaniumKit                         0x00000001020ae040 -[TiExceptionHandler reportScriptError:] + 74
13  TitaniumKit                         0x000000010209ad7e TiBindingEventProcess + 731
14  TitaniumKit                         0x00000001020bc3ff -[KrollContext invoke:] + 109
15  TitaniumKit                         0x00000001020bc472 -[KrollContext enqueue:] + 93
16  TitaniumKit                         0x00000001020c3a81 TiBindingRunLoopEnqueue + 77
17  TitaniumKit                         0x00000001020c2200 -[TiProxy fireEvent:withObject:propagate:reportSuccess:errorCode:message:] + 187
18  TitaniumKit                         0x00000001020a2a73 -[TiViewProxy fireEvent:withObject:propagate:reportSuccess:errorCode:message:] + 224
19  TitaniumKit                         0x00000001020c1ff6 -[TiProxy fireEvent:withObject:propagate:] + 76
20  TitaniumKit                         0x0000000102093c83 -[TiUIView touchesEnded:withEvent:] + 110
21  UIKitCore                           0x00007fff241a76fb _UIGestureEnvironmentUpdate + 8849
22  UIKitCore                           0x00007fff241a4fee -[UIGestureEnvironment _updateForEvent:window:] + 887
23  UIKitCore                           0x00007fff246b9bcd -[UIWindow sendEvent:] + 4752
24  UIKitCore                           0x00007fff246938f6 -[UIApplication sendEvent:] + 633
25  UIKit                               0x0000000104cc32ca -[UIApplicationAccessibility sendEvent:] + 85
26  MHM                                 0x00000001019f8d71 -[TiUIApplication sendEvent:] + 577
27  UIKitCore                           0x00007fff2472439c __processEventQueue + 13895
28  UIKitCore                           0x00007fff2471ad0f __eventFetcherSourceCallback + 104
29  CoreFoundation                      0x00007fff2038c37a __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 17
30  CoreFoundation                      0x00007fff2038c272 __CFRunLoopDoSource0 + 180
31  CoreFoundation                      0x00007fff2038b754 __CFRunLoopDoSources0 + 248
32  CoreFoundation                      0x00007fff20385f1f __CFRunLoopRun + 878
33  CoreFoundation                      0x00007fff203856c6 CFRunLoopRunSpecific + 567
34  GraphicsServices                    0x00007fff2b76adb3 GSEventRunModal + 139
35  UIKitCore                           0x00007fff24675187 -[UIApplication _run] + 912
36  UIKitCore                           0x00007fff2467a038 UIApplicationMain + 101
37  MHM                                 0x000000010196ea7b main + 1115
38  libdyld.dylib                       0x00007fff20256409 start + 1

Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
0   libsystem_kernel.dylib        	0x00007fff5e707462 __pthread_kill + 10
1   libsystem_pthread.dylib       	0x00007fff5e740610 pthread_kill + 263
2   libsystem_c.dylib             	0x00007fff200fac2e __abort + 139
3   libsystem_c.dylib             	0x00007fff200faba3 abort + 135
4   libc++abi.dylib               	0x00007fff2024f818 abort_message + 231
5   libc++abi.dylib               	0x00007fff20240e7d demangling_terminate_handler() + 266
6   libobjc.A.dylib               	0x00007fff201780d1 _objc_terminate() + 96
7   libc++abi.dylib               	0x00007fff2024ec47 std::__terminate(void (*)()) + 8
8   libc++abi.dylib               	0x00007fff202515b6 __cxa_rethrow + 99
9   libobjc.A.dylib               	0x00007fff2017800c objc_exception_rethrow + 37
10  com.apple.CoreFoundation      	0x00007fff203857ec CFRunLoopRunSpecific + 861
11  com.apple.GraphicsServices    	0x00007fff2b76adb3 GSEventRunModal + 139
12  com.apple.UIKitCore           	0x00007fff24675187 -[UIApplication _run] + 912
13  com.apple.UIKitCore           	0x00007fff2467a038 UIApplicationMain + 101
14  com.itinerarium.mhm           	0x000000010196ea7b main + 1115 (main.m:77)
15  libdyld.dylib                 	0x00007fff20256409 start + 1


</pre></code>


<h3>Comments</h3>

<ol>
<li>Vijay Singh 2021-02-24

   PR - <a href="https://github.com/appcelerator/titanium_mobile/pull/12496" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12496</a></li>
<li>Satyam Sekhri 2021-03-16

   FR Passed.
   Waiting for Jenkins build</li>
<li>Christopher Williams 2021-03-17

   merged to master and 10_0_X for 10.0.0 target</li>
</ol>


<p><a href="/TIMOB/TIMOB-28360.json">JSON Source</a></p>