---
title: "[TIMOB-28399] Android: TableView setData does not preserve TableViewRow child views"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2021-03-29T21:40:33.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 10.0.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Joe Falcone</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2021-02-17T06:39:25.000+0000</td></tr>
<tr><th>Updated</th><td>2021-03-29T21:40:33.000+0000</td></tr>
</table>

<h3>Description</h3>

It appears that the rewrite of TableView to use RecyclerView has left a few loose ends.  We were shocked to see code that had run for years and years broken.  The problem is that the new TableView (and probably ListView) implementations don't handle TableViewRows with child views properly.  In particular, say you start by creating TableViewRows which are composed of multiple child views like images and labels and push those TableViewRows into an array.  Then you create a TableView and then TableView.setData(TableViewRows).  Everything is fine.

Then later you use TableView.setData(TableViewRows) to set new information into the rows.  When you do that, [theory] the attributes of the child views of the TableViewRows are zeroed [/theory] so it looks as though the child views have disappeared when the TableView is shown after the setData.  But the bottom line is that the child views of the TableViewRow disappear after the setData with SDK 9.3 and above, and the child views continue to be displayed after the setData with SDK 9.2.2 and prior.

BEFORE:
<code><pre>
"children":[],"size":{"height":20,"width":34,"y":0,"x":0},"rect":{"absoluteX":0,"height":20,"width":34,"y":0,"absoluteY":80,"x":0}
</pre></code>
AFTER:
<code><pre>
"children":[],"size":{"height":0,"width":0,"y":0,"x":0},"rect":{"absoluteX":0,"height":0,"width":0,"y":0,"absoluteY":0,"x":0}
</pre></code>

I've attached a test program where it creates a TableView with several composite rows with a colored label and image.  Then if you click on any row, the TableView has setData applied with the same TableViewRow data array and (voila) the label and image disappear replaced by the title field - they are still children, but they have zero dimensions.  Sounds crazy but it is really happening.   I won't speculate as to whether this is a deep copy vs shallow copy bug or some other mischief but this really disrupted our release schedule. 

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-28399_67793/tvtest.zip">tvtest.zip</td></td><td>2021-02-17T06:28:09.000+0000</td><td>8657535</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-28399_67794/tvtest 2.zip">tvtest 2.zip</td></td><td>2021-02-17T20:05:21.000+0000</td><td>8657647</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Joe Falcone 2021-02-17

   I've modified the test program to use forEach to print out the contents of the tableData array (and I shortened the array to 2 rows).  Initially, the tableData row children have reasonable rendered values and then after either the first or second setData(tableData), they disappear.  I'm not sure whether this is just a rendering time artifact or evidence of a problem.  The bottom line is that the child objects are no longer rendered after the setData is repeated which is not the behavior we see with SDK 9.2.2 and prior.</li>
<li>Gary Mathews 2021-03-18

   master: <a href="https://github.com/appcelerator/titanium_mobile/pull/12620" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12620</a></li>
<li>Christopher Williams 2021-03-23

   merged to master and 10_0_X for 10.0.0 target.</li>
<li>Lokesh Choudhary 2021-03-25

   FR Passed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-28399.json">JSON Source</a></p>