---
title: "[TIMOB-28433] Android: Setting value resets keyboard layout (parity issue)"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>None</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Hans Kn√∂chel</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2021-04-30T11:50:00.000+0000</td></tr>
<tr><th>Updated</th><td>2021-05-01T01:49:46.000+0000</td></tr>
</table>

<h3>Description</h3>

When setting the value of a text field (e.g. to force uppercase in our case), the keyboard resets, which is a pretty bad UX experience when entering numbers and letters in mix (like flight numbers).

Test case:
<code><pre>
const window = Ti.UI.createWindow({ backgroundColor: '#f0f0f0' });
const textField = Ti.UI.createTextField({ width: 300, height: 40, backgroundColor: '#fff' });

textField.addEventListener('change', event =&gt; {
    event.source.value = event.source.value.toUpperCase();
});

window.add(textField);
window.open();
</pre></code>

This does only happen on Android - iOS works correctly. If there is a workaround to force uppercase, I am happy to use that instead! Android natively solves this by using <code>textAllCaps</code> in the <code>EditText</code>, but unfortunately thats not available in Titanium.

<h3>Comments</h3>

<ol>
<li>Joshua Quick 2021-05-01

   [~hknoechel], we actually do support an all-caps features in Titanium. You can enable it by setting the <code>TextField</code> "autocapitalization" property to <code>Ti.UI.TEXT_AUTOCAPITALIZATION_ALL</code>. It works on both Android and iOS.
   <a href="https://titaniumsdk.com/api/titanium/ui/textfield.html#autocapitalization" rel="nofollow" target="_blank">https://titaniumsdk.com/api/titanium/ui/textfield.html#autocapitalization</a>
   
   I don't know if we can do anything about the virtual keyboard relayout after calling setText().
   
   That said, the *BEST* way to handle altering keyboard input before it's applied to the <code>EditText</code> is to do so synchronously via a native [InputFilter](<a href="https://developer.android.com/reference/android/text/InputFilter)" rel="nofollow" target="_blank">https://developer.android.com/reference/android/text/InputFilter)</a> and [KeyListener](<a href="https://developer.android.com/reference/android/text/method/KeyListener)..." rel="nofollow" target="_blank">https://developer.android.com/reference/android/text/method/KeyListener)...</a> which is exactly what we use to apply auto-capitalization, max length, emoji filtering, etc. So, we're already doing the *right* thing as can be seen [here](<a href="https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/ui/src/java/ti/modules/titanium/ui/widget/TiUIText.java#L970)" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/blob/master/android/modules/ui/src/java/ti/modules/titanium/ui/widget/TiUIText.java#L970)</a> . Since Android is a bit fussy on how these are configured, it's probably best to add these as filtering features like this.
   
   Does this help?</li>
</ol>


<p><a href="/TIMOB/TIMOB-28433.json">JSON Source</a></p>