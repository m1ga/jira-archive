---
title: "[TIMOB-28461] iOS: Support running LiveView with Hyperloop"
---
<table>
<tr><th>Type</th><td>Improvement</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2021-07-28T15:07:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 10.0.1</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>build, hyperloop, iOS, liveview</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2021-05-28T23:15:32.000+0000</td></tr>
<tr><th>Updated</th><td>2021-07-28T15:07:40.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
Running an iOS app with LiveView will cause runtime exceptions when modifying a JS file using hyperloop.
_(This works on Android as of Titanium 9.0.0 and we'd like to do the same on iOS.)_

*Cause:*
While the app is being built, hyperloop will string replace all <code>require</code>/<code>import</code> calls which reference a native Objective-C/Swift type with the hyperloop JS file which wraps that native type. This works fine for normal builds since the modified JS file is written to the app bundle. But this <code>require</code>/<code>import</code> string replacement does not happen with LiveView, causing the module lookup to fail.

*Recommended Solution:*
Modify the hyperloop build hook to not modify the JS source files anymore. Instead, create a bootstrap script (which is ran before the "app.js") that defines the require/import bindings between native types to the actual hyperloop JS file. The below is how Android handles it.
[generate-sources-task.js](<a href="https://github.com/appcelerator/hyperloop.next/blob/f98983db8aa19b73e2ec5458e04589cda900af2e/android/hooks/tasks/generate-sources-task.js#L208-L235)" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/blob/f98983db8aa19b73e2ec5458e04589cda900af2e/android/hooks/tasks/generate-sources-task.js#L208-L235)</a>

*Limitations:*
Do the following while LiveView is running still won't be supported. The below requires a native rebuild to integrate them into the app.
* Adding libraries.
* Adding <code>Hyperloop.defineClass()</code> method calls. _(Involves native code generation.)_


<h3>Comments</h3>

<ol>
<li>Joshua Quick 2021-05-29

   PR (hyperloop.next): <a href="https://github.com/appcelerator/hyperloop.next/pull/351" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/351</a>
   
   Also below PR fixes regression in above PR...
   PR (hyperloop.next): <a href="https://github.com/appcelerator/hyperloop.next/pull/355" rel="nofollow" target="_blank">https://github.com/appcelerator/hyperloop.next/pull/355</a></li>
<li>Joshua Quick 2021-06-17

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/12905" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/12905</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-28461.json">JSON Source</a></p>