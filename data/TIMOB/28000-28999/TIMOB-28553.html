---
title: "[TIMOB-28553] Android: Moving a ListView item into an empty section causes a crash"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2021-10-20T03:12:54.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 9.3.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 10.2.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>ListItem, ListView, android, move</td></tr>
<tr><th>Reporter</th><td>Joshua Quick</td></tr>
<tr><th>Assignee</th><td>Joshua Quick</td></tr>
<tr><th>Created</th><td>2021-10-12T19:25:03.000+0000</td></tr>
<tr><th>Updated</th><td>2021-10-20T03:12:54.000+0000</td></tr>
</table>

<h3>Description</h3>

*Summary:*
Moving a <code>ListView</code> item via edit mode and drag-and-drop will cause a crash if the <code>ListItem</code> is moved into an empty <code>ListSection</code>.

*Steps to reproduce:*
<h4>Build and run the below on Android.</h4>
<h4>Tap and hold "Row 1".</h4>
<h4>Drag it into "Section 1".</h4>
<h4>Notice the app crashes.</h4>

<code><pre>
const window = Ti.UI.createWindow();
const listView = Ti.UI.createListView({
	sections: [
		Ti.UI.createListSection({
			headerTitle: "Section 1",
		}),
		Ti.UI.createListSection({
			headerTitle: "Section 2",
			items: [{
				properties: {
					title: <code>Row 1</code>,
					canEdit: false,
					canMove: true,
				},
			}],
		}),
	],
	allowsSelectionDuringEditing: false,
	allowsMultipleSelectionDuringEditing: false,
	editing: true,
});
listView.addEventListener("move", (e) =&gt; {
	console.log(<code>@@@ "move" event: ${JSON.stringify(e)}</code>);
});
window.add(listView);
window.open();
</pre></code>

*Result:*
App immediately crashes with the following exception when dragged into an empty section. You don't have to release your finger (ie: drop) for the crash to occur.
<code><pre>
[ERROR] InputEventReceiver: Exception dispatching input event.
[ERROR] TiExceptionHandler: (main) [4739,4854] ti.modules.titanium.ui.widget.listview.ListViewProxy cannot be cast to ti.modules.titanium.ui.widget.listview.ListSectionProxy
[ERROR] TiExceptionHandler:
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.listview.ListViewProxy.moveItem(ListViewProxy.java:186)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.listview.ItemTouchHandler.onMove(ItemTouchHandler.java:281)
[ERROR] TiExceptionHandler:     androidx.recyclerview.widget.ItemTouchHelper.moveIfNecessary(ItemTouchHelper.java:885)
[ERROR] TiExceptionHandler:     androidx.recyclerview.widget.ItemTouchHelper$2.onTouchEvent(ItemTouchHelper.java:389)
[ERROR] TiExceptionHandler:     androidx.recyclerview.widget.RecyclerView.dispatchToOnItemTouchListeners(RecyclerView.java:3259)
[ERROR] TiExceptionHandler:     androidx.recyclerview.widget.RecyclerView.onTouchEvent(RecyclerView.java:3421)
[ERROR] TiExceptionHandler:     android.view.View.dispatchTouchEvent(View.java:14309)
[ERROR] TiExceptionHandler:     android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:3112)
[ERROR] TiExceptionHandler:     android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:2785)
[ERROR] TiExceptionHandler:     ti.modules.titanium.ui.widget.listview.TiNestedRecyclerView.dispatchTouchEvent(TiNestedRecyclerView.java:109)
[ERROR] TiExceptionHandler:     android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:3118)
</pre></code>


<h3>Comments</h3>

<ol>
<li>Joshua Quick 2021-10-14

   PR (master): <a href="https://github.com/appcelerator/titanium_mobile/pull/13120" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/13120</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-28553.json">JSON Source</a></p>