---
title: "[TIMOB-3080] Android: Deploy Corrupts UTF-8 Characters"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T02:00:51.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.7.0, Sprint 2011-10</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, release-1.6.1, release-1.7.0, reported-1.6.0, rplist</td></tr>
<tr><th>Reporter</th><td>Dawson Toth</td></tr>
<tr><th>Assignee</th><td>Don Thorp</td></tr>
<tr><th>Created</th><td>2011-04-15T03:36:18.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T02:00:51.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><h1>Problem</h1>
<p>UTF-8 characters in JavaScript get corrupted by the Android
deployment build scripts in Titanium.</p>
<h1>Sample Project</h1>
<ol>
<li>Run the attached project in the emulator. It is based on the
default, two tab project. The only difference is the labels have
UTF-8 characters in them. Notice there is an Umlaut above the
"&ouml;" in "Min f&ouml;rbrukning".<br></li>
<li>Create an apk of the project by using the "Distribute" &gt;
"Android" tab. If you run this APK on the device, you'll notice the
UTF-8 characters are now corrupt.<br></li>
<li>Without cleaning the build, run the project in the emulator.
The UTF-8 characters should be messed up here as well. On my
machine, the O with Umlaut was replaced with a check mark
(&#8730;).</li>
</ol>
<h1>Tested On</h1>
<p>Titanium SDK version: 1.6.0 (02/02/11 15:22 a02f7db...)<br>
Android Emulator 2.2</p>
<h2>Associated Helpdesk Ticket</h2>
<p><a href=
"<a href="http://developer.appcelerator.com/helpdesk/view/70681" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/70681</a>"><a href="http://developer.appcelerator.com/helpdesk/view/70681" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/70681</a></a></p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-3080_18260/utf8test.zip">utf8test.zip</td></td><td>2011-04-15T03:36:19.000+0000</td><td>4766874</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Dawson Toth 2011-04-15

   <div><p>It would help if I attached the project...</p></div></li>
<li>Rich Kilmer 2011-04-15

   <div><p>We have experienced this exact same issue today when we were
   about to release an application just updated to 1.5.1 to QA and
   (soon) the Marketplace. This issue is critical to us. If someone
   can point us to a place to look we will help out :)</p></div></li>
<li>Dawson Toth 2011-04-15

   <div><h1>2nd Associated Helpdesk Ticket</h1>
   <p><a href=
   "<a href="http://developer.appcelerator.com/helpdesk/view/76272" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/76272</a>"><a href="http://developer.appcelerator.com/helpdesk/view/76272" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/76272</a></a></p></div></li>
<li>Dawson Toth 2011-04-15

   <div><p>This 3rd customer actually has a patch for the build scripts,
   provided in the ticket:</p>
   <h1>3rd Associated Helpdesk Ticket</h1>
   <p><a href=
   "<a href="http://developer.appcelerator.com/helpdesk/view/76261" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/76261</a>"><a href="http://developer.appcelerator.com/helpdesk/view/76261" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/76261</a></a></p></div></li>
<li>Marco 2011-04-15

   <div><p>We have the same problem.<br>
   Encoding works on simulator an with "Run on Device".<br>
   As soon as we compile an apk for distribution all UTF-8 Characters
   are corrupted.</p>
   <p>This starts from version 1.5.x on.<br>
   As lon as we use 1.4.x it works.</p>
   <p>I noticed when I use the optional folder
   /platform/android/AndroidManifest.xml for a custom Manifest during
   compilation an additional AndroidManifest.xml.gen is created under
   /build/android/. This file is not identical with the custom one.
   Especially the header and the permissiona are different.</p>
   <p>This is a big problem for all countries using special characters
   (Germany, France, Spain etc.) as you cannot use Titanium anymore
   for compiling apps for distribution.</p>
   <p>We would use 1.4.x but lot of code designed for 1.5-x
   won&acute;t work.</p>
   <p>Any workarounds in sight?</p></div></li>
<li>Christian 2011-04-15

   <div><p>Also it seems that the problem exists on OS-X and Windows 7
   likewise.</p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/6d9b0f3e05ba71621da82c4ca98f4d5d1b250705"
   title=
   "Changeset [6d9b0f3e05ba71621da82c4ca98f4d5d1b250705]">[6d9b0f3e05ba71621da82c4ca98f4d5d1b250705]</a>)
   force utf8 encoding in the js compiler, correctly deal with an
   absolute prefix on an app:// URL for compiled JS, matching up with
   the behavior<br>
   in interpreted mode [<a href="/projects/32238/tickets/3312" title=
   "Ticket #3312">#3312</a> state:fixed-in-qa] [<a href=
   "/projects/32238/tickets/3080" title="Ticket #3080">#3080</a>
   state:fixed-in-qa]<br>
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/6d9b0f3e05ba71621da82c4ca98f4d5d1b250705" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/6d9b0f3e05ba71621da82c4ca98f4d5d1b250705</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/6d9b0f3e05ba..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/6d9b0f3e05ba...</a></a></p></div></li>
<li>Marshall Culpepper 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/89c196d407d96d587e0c7883d6670e6523ff52c3"
   title=
   "Changeset [89c196d407d96d587e0c7883d6670e6523ff52c3]">[89c196d407d96d587e0c7883d6670e6523ff52c3]</a>)
   force utf8 encoding in the js compiler, correctly deal with an
   absolute prefix on an app:// URL for compiled JS, matching up with
   the behavior<br>
   in interpreted mode [<a href="/projects/32238/tickets/3312" title=
   "Ticket #3312">#3312</a> state:fixed-in-qa] [<a href=
   "/projects/32238/tickets/3080" title="Ticket #3080">#3080</a>
   state:fixed-in-qa]<br>
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/89c196d407d96d587e0c7883d6670e6523ff52c3" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/89c196d407d96d587e0c7883d6670e6523ff52c3</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/89c196d407d9..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/89c196d407d9...</a></a></p></div></li>
<li>Natalie Huynh 2011-04-15

   <div><p>Tested with Titanium SDK version: 1.6.1 (03/10/11 13:25
   2e8c438...) on<br>
   Emulator 2.1<br>
   Samsung Galaxy 2.2 (Tested with distribution package)</p></div></li>
<li>Natalie Huynh 2011-04-15

    <div><p>Tested with Titanium SDK version: 1.7.0 (03/11/11 12:08 86cfe14)
    on<br>
    Emulator 2.1<br>
    Samsung Galaxy 2.2 (Tested with distribution package)</p></div></li>
<li>Marshall Culpepper 2011-04-15

    <div><p>(from <a href=
    "/projects/32238/changesets/727a5e1d7bc90e0c26ee528075f4648fe6fa14e7"
    title=
    "Changeset [727a5e1d7bc90e0c26ee528075f4648fe6fa14e7]">[727a5e1d7bc90e0c26ee528075f4648fe6fa14e7]</a>)
    force utf8 encoding in the js compiler, correctly deal with an
    absolute prefix on an app:// URL for compiled JS, matching up with
    the behavior<br>
    in interpreted mode [<a href="/projects/32238/tickets/3312" title=
    "Ticket #3312">#3312</a> state:fixed-in-qa] [<a href=
    "/projects/32238/tickets/3080" title="Ticket #3080">#3080</a>
    state:fixed-in-qa]<br>
    <a href=
    "<a href="https://github.com/appcelerator/titanium_mobile/commit/727a5e1d7bc90e0c26ee528075f4648fe6fa14e7" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/727a5e1d7bc90e0c26ee528075f4648fe6fa14e7</a>">
    <a href="https://github.com/appcelerator/titanium_mobile/commit/727a5e1d7bc9..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/727a5e1d7bc9...</a></a></p></div></li>
<li>Don Thorp 2011-04-15

    <div><p>Cherry-pick changed the state. Reversing that change.</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-3080.json">JSON Source</a></p>