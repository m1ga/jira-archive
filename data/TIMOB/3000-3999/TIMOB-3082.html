---
title: "[TIMOB-3082] Android: Vertical layout test in KS is missing header"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Trivial</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T02:00:52.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.6.0 M09</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, regression, release-1.6.0, reported-1.6.0</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-04-15T03:36:27.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T02:00:52.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Generally speaking: if a heavyweight window's
<code>layout</code> property is set to <code>vertical</code> via
its proxy <em>after</em> the window is already open, things added
to the window after that don't respect the vertical layout.</p>
<p>The KitchenSink vertical layout test is a good example: the
header doesn't show.</p>
<p>But here's a simpler app.js failcase:</p>
<pre>
<code class="javascript">Titanium.UI.setBackgroundColor('#000');

var win = Titanium.UI.createWindow({  
    backgroundColor:'#000',
    exitOnClose: true,
    fullscreen: true,
    navBarHidden: true
});

win.open();

win.layout = 'vertical';

for (var i = 0; i &lt; 10; i++) {
    win.add( Ti.UI.createLabel({ text: 'Label ' + i, height: 40 }) );
}</code>
</pre>
<p>The labels added there near the end will all stack up on each
other in the middle of the window.</p></div>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>The reason this happens is that when</p>
   <p><code>win.layout = 'vertical';</code></p>
   <p>occurs in the code above, the view (TiUIWindow) has not yet been
   set as a model listener on the window proxy. So though KrollProxy
   fires a property change when <code>layout</code> gets set,
   TiUIWindow doesn't know about it and doesn't set its layout
   accordingly (the <code>propertyChanged</code> code in TiUIWindow
   doesn't run.)</p>
   <p><code>setModelListener</code> gets called when the new activity
   sends the <code>MSG_ACTIVITY_CREATED</code> message back to
   TiUIWindow (see TiUIWindow's <code>handleMessage</code>). For
   reasons I don't understand, that doesn't happen until all these
   views (in the <code>for</code> loop in my code sample above) have
   already been created and added to the window.</p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>I misspoke in the previous comment. The
   <code>MSG_ACTIVITY_CREATED</code> handling in TiUIWindow occurs
   before views get added to the window. But <code>layout</code> was
   not being handled in <code>processProperties</code> (which runs
   when <code>setModelListener</code> is set). When he handle it in
   <code>processProperties</code>, everything works fine.</p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/bd9d12403051a464ec102f46aac9c4420a45a7e6"
   title=
   "Changeset [bd9d12403051a464ec102f46aac9c4420a45a7e6]">[bd9d12403051a464ec102f46aac9c4420a45a7e6]</a>)
   [<a href="/projects/32238/tickets/3082" title=
   "Ticket #3082">#3082</a> state:fixed-in-qa] Add 'layout' to one of
   the properties checked and handled in TiUIWindow processProperties
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/bd9d12403051a464ec102f46aac9c4420a45a7e6" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/bd9d12403051a464ec102f46aac9c4420a45a7e6</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/bd9d12403051..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/bd9d12403051...</a></a></p></div></li>
<li>Thomas Huelbert 2011-04-15

   <div><p><a href="/projects/32238/changesets/INFO" title=
   "Changeset [INFO]">[INFO]</a> Titanium SDK version: 1.6.0 (02/08/11
   20:55 bd9d124...) galaxy tab (2.2.2) G1 (1.6) Nexus S (2.3) sim
   2.1</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-3082.json">JSON Source</a></p>