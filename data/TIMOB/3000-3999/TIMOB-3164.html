---
title: "[TIMOB-3164] Android: Expose MediaScannerConnection"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T02:01:05.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.7.0, Sprint 2011-11</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, feature, release-1.7.0, rplist</td></tr>
<tr><th>Reporter</th><td>Dawson Toth</td></tr>
<tr><th>Assignee</th><td>Don Thorp</td></tr>
<tr><th>Created</th><td>2011-04-15T03:38:28.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T02:01:05.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><h1>Problem</h1>
<p>When you save an image to the SDCard, the media scanner won't
pick it up until the next time it runs (when the phone
restarts).</p>
<h1>Solution</h1>
<p>Exposing the MediaScannerConnection would let developers get the
image into the gallery right away.</p>
<h1>Android Documentation</h1>
<p><a href=
"<a href="http://developer.android.com/reference/android/media/MediaScannerConnection.html" rel="nofollow" target="_blank">http://developer.android.com/reference/android/media/MediaScannerConnection.html</a>">
<a href="http://developer.android.com/reference/android/media/MediaScannerCo..." rel="nofollow" target="_blank">http://developer.android.com/reference/android/media/MediaScannerCo...</a></a></p>
<h2>Associated Helpdesk Ticket</h2>
<p><a href=
"<a href="http://developer.appcelerator.com/helpdesk/view/69031" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/69031</a>"><a href="http://developer.appcelerator.com/helpdesk/view/69031" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/69031</a></a></p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-3164_18271/fj.jpg">fj.jpg</td></td><td>2011-04-15T03:38:29.000+0000</td><td>114242</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/8e7685715cea203abbe9df1c9e2f42f6aafe3e0a"
   title=
   "Changeset [8e7685715cea203abbe9df1c9e2f42f6aafe3e0a]">[8e7685715cea203abbe9df1c9e2f42f6aafe3e0a]</a>)
   Doc for scanMediaFiles [<a href="/projects/32238/tickets/3164"
   title="Ticket #3164">#3164</a>] <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/8e7685715cea203abbe9df1c9e2f42f6aafe3e0a" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/8e7685715cea203abbe9df1c9e2f42f6aafe3e0a</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/8e7685715cea..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/8e7685715cea...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/b4a40009d732f8a233f7fce967c7874c3f817790"
   title=
   "Changeset [b4a40009d732f8a233f7fce967c7874c3f817790]">[b4a40009d732f8a233f7fce967c7874c3f817790]</a>)
   Expose the Android media scanner's file scanning service via
   Ti.Media.Android.scanMediaFiles. [<a href=
   "/projects/32238/tickets/3164" title="Ticket #3164">#3164</a>]
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/b4a40009d732f8a233f7fce967c7874c3f817790" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/b4a40009d732f8a233f7fce967c7874c3f817790</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/b4a40009d732..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/b4a40009d732...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>QE testing:</p>
   <p>Here is a good test app.js:</p>
   <pre>
   <code class="javascript">Titanium.UI.setBackgroundColor('#000');
   var win = Titanium.UI.createWindow({  
       title:'Test',
       backgroundColor:'#000',
       exitOnClose: true
   });
   
   var lbl = Ti.UI.createLabel({
       backgroundColor: 'blue',
       color: 'yellow',
       bottom: '10dp',
       height: '80dp',
       left: '5dp',
       right: '5dp'
   });
   win.add(lbl);
   
   var btn = Ti.UI.createButton({
       title: 'Do scan'
   });
   btn.addEventListener('click', function(){
       var f = Ti.Filesystem.getFile('fj.jpg');
       f.copy("appdata://fj.jpg");
       f = Ti.Filesystem.getFile("appdata://fj.jpg");
       Ti.API.info(f.nativePath);
       Ti.Media.Android.scanMediaFiles([ f.nativePath ], null, function(e) {
           if (e.uri) {
               lbl.text = e.uri;
           } else {
               lbl.text = "No uri";
           }
       });
   });
   win.add(btn);
   win.open();</code>
   </pre>
   <p>Put the attach fj.jpg in your Resources folder. Run the app,
   click the button and confirm that you get a URI in the little
   console label at the bottom. "No Uri" means it didn't work. After
   you see that the uri is there, you can go to the Android Gallery
   application and see the photo (a picture of the casket of Emperor
   Franz Josef of Austria).</p></div></li>
<li>Natalie Huynh 2011-04-15

   <div><p>Tested with Titanium SDK version: 1.7.0 (03/22/11 09:36 42d2187)
   on<br>
   Emulator 2.1<br>
   Samsung Nexus S 2.3.2</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-3164.json">JSON Source</a></p>