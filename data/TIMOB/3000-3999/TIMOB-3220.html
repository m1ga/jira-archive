---
title: "[TIMOB-3220] Android:  new ActivityProxy being created for light weight windows"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-04-17T02:01:13.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Sprint-2011-08</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, listener, release-1.6.1, release-1.7.0, reported-1.6.0, window</td></tr>
<tr><th>Reporter</th><td>Opie Cyrus</td></tr>
<tr><th>Assignee</th><td>Don Thorp</td></tr>
<tr><th>Created</th><td>2011-04-15T03:39:46.000+0000</td></tr>
<tr><th>Updated</th><td>2011-04-17T02:01:13.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>When a light weight window is opened, a new ActivityProxy is
created rather than using the existing proxy for the activity. When
setting listeners in the new context for the window, events do not
fire back to the correct proxy and cannot be handled.</p>
<p>Work around is to open the new window as heavy weight or set the
activity listeners in the parent context where the activity was
created. Example of the work around attached.</p></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-3220_18283/resources_lh.zip">resources_lh.zip</td></td><td>2011-04-15T03:39:47.000+0000</td><td>825124</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-3220_18282/resources.zip">resources.zip</td></td><td>2011-04-15T03:39:47.000+0000</td><td>825123</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Opie Cyrus 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/115a4af5af5d168f9b07832ae3e1993125f900b7"
   title=
   "Changeset [115a4af5af5d168f9b07832ae3e1993125f900b7]">[115a4af5af5d168f9b07832ae3e1993125f900b7]</a>)
   [<a href="/projects/32238/tickets/3220" title=
   "Ticket #3220">#3220</a> state:fixed-in-qa] when creating light
   weight windows, use existing ActivityProxy</p>
   <p>When creating LW windows, use the existing ActivityProxy
   associated Activity rather than creating a new ActivityProxy which
   would cause activity listeners set on the new ActivityProxy to not
   fire correctly<br>
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/115a4af5af5d168f9b07832ae3e1993125f900b7" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/115a4af5af5d168f9b07832ae3e1993125f900b7</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/115a4af5af5d..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/115a4af5af5d...</a></a></p></div></li>
<li>Opie Cyrus 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/62eb136eb4ef9e4e6f0e260a295da565480169f4"
   title=
   "Changeset [62eb136eb4ef9e4e6f0e260a295da565480169f4]">[62eb136eb4ef9e4e6f0e260a295da565480169f4]</a>)
   [<a href="/projects/32238/tickets/3220" title=
   "Ticket #3220">#3220</a> state:fixed-in-qa] when creating light
   weight windows, use existing ActivityProxy</p>
   <p>When creating LW windows, use the existing ActivityProxy
   associated Activity rather than creating a new ActivityProxy which
   would cause activity listeners set on the new ActivityProxy to not
   fire correctly<br>
   <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/62eb136eb4ef9e4e6f0e260a295da565480169f4" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/62eb136eb4ef9e4e6f0e260a295da565480169f4</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/62eb136eb4ef..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/62eb136eb4ef...</a></a></p></div></li>
<li>Opie Cyrus 2011-04-15

   <div><p>I have attached the resources directory for a test to this
   issue. Upon opening the window, you should see the resume, pause,
   destroy events handled in the log.</p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>Uh oh, this seems to have broken KitchenSink. KS crashes
   immediately upon launching now, and I've traced it to this commit
   115a4af5af5d (I'm talking about the master branch here.) KS works
   fine with the commit before that.</p>
   <p>Can you have a look ASAP Opie? Thx.</p>
   <p>Trace:</p>
   <p><a href=
   "<a href="http://pastie.org/1617608" rel="nofollow" target="_blank">http://pastie.org/1617608</a>"><a href="http://pastie.org/1617608" rel="nofollow" target="_blank">http://pastie.org/1617608</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>fyi broken in 1_6_X as well.</p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>Simple fail case for the crash:</p>
   <p><strong>app.js</strong>:</p>
   <pre>
   <code class="javascript">Titanium.UI.setBackgroundColor('#000');
   var tabGroup = Titanium.UI.createTabGroup();
   var win1 = Titanium.UI.createWindow({  
       title:'Tab 1', backgroundColor:'#fff', url: 'win1.js'
   });
   var tab1 = Titanium.UI.createTab({  
       title:'Tab 1', window:win1
   });
   tabGroup.addTab(tab1);  
   tabGroup.open();</code>
   </pre>
   <p><strong>win1.js</strong>:</p>
   <pre>
   <code class="javascript">Ti.API.info('hi');</code>
   </pre></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/7b91bba6d4625743452c391adb05b3254d7ff7ce"
   title=
   "Changeset [7b91bba6d4625743452c391adb05b3254d7ff7ce]">[7b91bba6d4625743452c391adb05b3254d7ff7ce]</a>)
   Make sure activityProxy gets filled also for tab windows with urls
   [<a href="/projects/32238/tickets/3220" title=
   "Ticket #3220">#3220</a> state:fixed-in-qa] <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/7b91bba6d4625743452c391adb05b3254d7ff7ce" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/7b91bba6d4625743452c391adb05b3254d7ff7ce</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/7b91bba6d462..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/7b91bba6d462...</a></a></p></div></li>
<li>Bill Dawson 2011-04-15

   <div><p>(from <a href=
   "/projects/32238/changesets/671a39a2c51f6fe389bab2815258f59eac31b32d"
   title=
   "Changeset [671a39a2c51f6fe389bab2815258f59eac31b32d]">[671a39a2c51f6fe389bab2815258f59eac31b32d]</a>)
   Make sure activityProxy gets filled also for tab windows with urls
   [<a href="/projects/32238/tickets/3220" title=
   "Ticket #3220">#3220</a> state:fixed-in-qa] <a href=
   "<a href="https://github.com/appcelerator/titanium_mobile/commit/671a39a2c51f6fe389bab2815258f59eac31b32d" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/671a39a2c51f6fe389bab2815258f59eac31b32d</a>">
   <a href="https://github.com/appcelerator/titanium_mobile/commit/671a39a2c51f..." rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/commit/671a39a2c51f...</a></a></p></div></li>
<li>Natalie Huynh 2011-04-15

   <div><p>Tested with Titanium SDK version: 1.7.0 (03/02/11 13:57 5d8c78a)
   on<br>
   Galaxy Tab 2.2<br>
   Emulator 2.1<br>
   (Test specific to Android only)</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-3220.json">JSON Source</a></p>