---
title: "[TIMOB-3268] Android: View.toImage() Platform Inconsistency"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2016-09-28T12:08:52.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.0, Release 3.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>api, parity</td></tr>
<tr><th>Reporter</th><td>Dawson Toth</td></tr>
<tr><th>Assignee</th><td>Gary Mathews</td></tr>
<tr><th>Created</th><td>2011-04-15T03:40:51.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-24T17:58:25.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem Description </h4>

iOS and Android return different objects from the generic
"toImage()" function you can call on any view. iOS returns a blob,
but Android returns a dictionary (with width, height, x, y,
cropRect and media). So if you want to save the result to a file,
you need to have different code for the two platforms.</p>

<h4>Solution </h4>
I don't presume to know the solution to this one, but if the
result could be coerced to a blob when it is used as one, that
would allow for the same code to work on both platforms. This seems
like a sticky situation because existing code will be broken on
either platform, depending on the route taken.
<h4>Sample Code</h4>
The following sample code works, but it requires conditional
code for the platform: ".write(Ti.Android ? image.media ?
image)".
 
<code><pre>

var win = Ti.UI.createWindow({ backgroundColor: '#fff' });

var web = Ti.UI.createWebView({
    url: '<a href="http://www.google.com/" rel="nofollow" target="_blank">http://www.google.com/</a>'
});
web.addEventListener('load', function() {
    var image = web.toImage();
    i.Filesystem
            .getFile(Titanium.Filesystem.applicationDataDirectory, 'snapshot_blob.png')
            .write(Ti.Android ? image.media : image);
    alert('PASS: Image saved.');
});
win.add(web);

win.open();
</pre></code>
 
<h4>Associated API Docs </h4>
 The API Docs say toImage returns a blob. 
 <a href="http://developer.appcelerator.com/apidoc/mobile/latest/Titanium.UI.View.toImage-method.html" rel="nofollow" target="_blank">http://developer.appcelerator.com/apidoc/mobile/latest/Titanium.UI.View.toImage-method.html</a>  

<h4>Tested On </h4>
 Titanium SDK version: 1.7.0 (03/03/11 10:45 87a2113...) 
iPhone Simulator 4.2 
Android Emulator 2.2 APIs 
Android Device Epic 4G 2.2 

<h4>Associated Helpdesk Ticket </h4>
 <a href="http://developer.appcelerator.com/helpdesk/view/76200" rel="nofollow" target="_blank">http://developer.appcelerator.com/helpdesk/view/76200</a> 

<h3>Comments</h3>

<ol>
<li>Sasa Savic 2012-01-27

   Any updates on this issue?</li>
<li>Junaid Younus 2012-09-04

   Tested on a Samsung Galaxy S2 and the iOS simulator using TiSDK 2.2.0v20120904101713, issue still valid. </li>
<li>Lokesh Choudhary 2014-03-04

   Verified the issue is not reproducible. The view.toImage() successfully converts the webview to image in the above test code.
   
   Environment:
   Appc Studio : 3.2.1.201402061120
   Ti SDK : 3.2.1.GA
   Mac OSX : 10.8.5
   Alloy : 1.3.1	
   CLI - 3.2.1
   Nexus 5 - android 4.4.2
   Samsung S4 - android 4.2.2
   Samsung S3 - android 4.0.4</li>
<li>Fokke Zandbergen 2014-11-14

   I can reproduce this on 3.4.1.RC
   
   <h4>Test Case</h4>
   
   <code><pre>
   var b = Ti.UI.createView().toImage();
   
   console.log(typeof b);
   console.log(b.apiName);
   console.log(b);
   </pre></code>
   
   <h4>Android</h4>
   
   <code><pre>
   object
   undefined
   {
     "cropRect": {
       "height": 318,
       "width": 318,
       "x": 0
     },
     "height": 318,
     "media": {
       "height": 318,
       "bubbleParent": true,
       "type": 2,
       "mimeType": "image/png",
       "apiName": "Ti.Blob",
       "nativePath": null,
       "file": null,
       "text": null,
       "length": 29062,
       "width": 318
     },
     "mimeType": "image/png",
     "y": 0,
     "width": 318,
     "x": 0
   }
   </pre></code>
   
   <h4>iOS:</h4>
   
   <code><pre>
   object
   Ti.Blob
   {}
   </pre></code></li>
<li>Rainer Schleevoigt 2015-08-18

   I have the same issue. I tried to use [<a href="http://www.batasoft.com/appcelerator/app-icons" rel="nofollow" target="_blank">http://www.batasoft.com/appcelerator/app-icons</a>](<a href="http://www.batasoft.com/appcelerator/app-icons)" rel="nofollow" target="_blank">http://www.batasoft.com/appcelerator/app-icons)</a> and this lib uses toImage() to convert a label to a image for using in tabgroup.</li>
<li>Gary Mathews 2016-09-28

   This issue was fixed by <a href="https://github.com/appcelerator/titanium_mobile/pull/6907" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/6907</a>
   
   <code><pre>
   var b = Ti.UI.createView().toImage();
   Ti.API.info(typeof b);
   Ti.API.info(b.apiName);
   Ti.API.info(b);
   </pre></code>
   <code><pre>
   object
   Ti.Blob
   [object TiBlob]
   </pre></code>
   
   Resolved as invalid.</li>
<li>Lee Morris 2017-03-24

   Closing ticket as invalid with reference to the above comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-3268.json">JSON Source</a></p>