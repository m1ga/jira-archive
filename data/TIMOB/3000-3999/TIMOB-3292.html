---
title: "[TIMOB-3292] JS service does not start when called from Android background service"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2017-06-06T18:29:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, defect, reported-1.6.0</td></tr>
<tr><th>Reporter</th><td>Daniel Cameron</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2011-04-15T03:41:31.000+0000</td></tr>
<tr><th>Updated</th><td>2017-06-06T18:29:11.000+0000</td></tr>
</table>

<h3>Description</h3>

<div><p>Titanium Mobile Version: 1.6.0</p>
<p>Reproduction steps:<br>
* Create module that includes a service that runs when the
application has been closed (eg titanium-c2dm) * Add the following
the the service module:</p>
<pre>
<code>TiJSIntervalService service = new TiJSIntervalService("c2dmHandler.js");
Intent serviceIntent = new Intent(Intent.ACTION_SEND, Uri.parse("app://c2dmHandler.js"));
serviceIntent.putExtra("interval", 2000); // work-around for 
service.onStart(serviceIntent, 1);</code>
</pre>
<p>The following stack track is dumped:<br></p>
<pre>
<code>[TRACE] E/TiUncaughtHandler( 384): (IntentService[C2DMBaseReceiver]) [10,1896] Sending event: exception on thread: IntentService[C2DMBaseReceiver] msg:java.lang.NullPointerException; Titanium 1.6.0,2011/02/23 18:08,882e81
[TRACE] E/TiUncaughtHandler( 384): java.lang.NullPointerException
[TRACE] E/TiUncaughtHandler( 384): at org.appcelerator.titanium.TiBaseService.createTiContext(TiBaseService.java:126)
[TRACE] E/TiUncaughtHandler( 384): at ti.modules.titanium.android.TiJSService.createProxy(TiJSService.java:92)
[TRACE] E/TiUncaughtHandler( 384): at ti.modules.titanium.android.TiJSService.onStart(TiJSService.java:48)
[TRACE] E/TiUncaughtHandler( 384): at com.example.mobile.C2DMReceiver.jsHandleMessage(C2DMReceiver.java:92)
[TRACE] E/TiUncaughtHandler( 384): at com.example.mobile.C2DMReceiver.onMessage(C2DMReceiver.java:67)
[TRACE] E/TiUncaughtHandler( 384): at com.google.android.c2dm.C2DMBaseReceiver.onHandleIntent(C2DMBaseReceiver.java:101)
[TRACE] E/TiUncaughtHandler( 384): at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:59)
[TRACE] E/TiUncaughtHandler( 384): at android.os.Handler.dispatchMessage(Handler.java:99)
[TRACE] E/TiUncaughtHandler( 384): at android.os.Looper.loop(Looper.java:123)
[TRACE] E/TiUncaughtHandler( 384): at android.os.HandlerThread.run(HandlerThread.java:60)
[TRACE] E/AndroidRuntime( 384): FATAL EXCEPTION: IntentService[C2DMBaseReceiver]
[TRACE] E/AndroidRuntime( 384): java.lang.NullPointerException
[TRACE] E/AndroidRuntime( 384): at org.appcelerator.titanium.TiBaseService.createTiContext(TiBaseService.java:126)
[TRACE] E/AndroidRuntime( 384): at ti.modules.titanium.android.TiJSService.createProxy(TiJSService.java:92)
[TRACE] E/AndroidRuntime( 384): at ti.modules.titanium.android.TiJSService.onStart(TiJSService.java:48)
[TRACE] E/AndroidRuntime( 384): at com.example.mobile.C2DMReceiver.jsHandleMessage(C2DMReceiver.java:92)
[TRACE] E/AndroidRuntime( 384): at com.example.mobile.C2DMReceiver.onMessage(C2DMReceiver.java:67)
[TRACE] E/AndroidRuntime( 384): at com.google.android.c2dm.C2DMBaseReceiver.onHandleIntent(C2DMBaseReceiver.java:101)
[TRACE] E/AndroidRuntime( 384): at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:59)
[TRACE] E/AndroidRuntime( 384): at android.os.Handler.dispatchMessage(Handler.java:99)
[TRACE] E/AndroidRuntime( 384): at android.os.Looper.loop(Looper.java:123)
[TRACE] E/AndroidRuntime( 384): at android.os.HandlerThread.run(HandlerThread.java:60)</code>
</pre></div>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-3292_18297/servicenotification.zip">servicenotification.zip</td></td><td>2011-04-15T03:41:34.000+0000</td><td>10394531</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Daniel Cameron 2011-04-15

   <div><p>Workaround: fire the intent directly instead of creating a
   TiService</p>
   <pre>
   <code>String serviceClass = "com.hyro.mobile.C2dmBackgroundService";
   Intent serviceIntent = new Intent(Intent.ACTION_SEND, Uri.parse("app://c2dmBackground.js"));
   serviceIntent.putExtra("interval", 2000); // .currentService undefined for non-interval services
   serviceIntent.setClassName(context, serviceClass);
   context.startService(serviceIntent);</code>
   </pre></div></li>
<li>Daniel Cameron 2011-04-15

   <div><p>Assigning to hopefully the correct person.</p></div></li>
<li>Don Thorp 2011-04-15

   <div><p>Daniel it would be helpful if you could attach a complete
   example to speed up the reproduction and possible fix.</p></div></li>
<li>Daniel Cameron 2011-04-15

   <div><p>Full source for reproduction against 1.6.1 attached.</p>
   <p>Reproduction steps:</p>
   <p>Start "Ticket3292" app<br>
   Start "Ticket3292 invoker" app<br>
   Select the "Notification to native service invoking js"
   notification</p></div></li>
</ol>


<p><a href="/TIMOB/TIMOB-3292.json">JSON Source</a></p>