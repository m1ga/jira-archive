---
title: "[TIMOB-3571] Android: Network - responseText of createHTTPClient invalid for UTF8 encoding"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Do</td></tr>
<tr><th>Resolution Date</th><td>2020-01-09T19:01:50.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>sakira</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2011-04-15T03:46:46.000+0000</td></tr>
<tr><th>Updated</th><td>2020-01-09T19:01:50.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>

When my app received a UTF-8 text form HTTP Server, the encoding of responseText of Titanium.Network.HTTPClient can be seen invalid.
An ASCII text is OK and for iPhone is OK, but for Android, I cannot guess in which encoding method is the received test.

<h4>Workaround</h4>

We avoid this problem as like below:

<code><pre>
var httpc = Ti.Network.createHTTPClient();

httpc.onload = function() {
var canvases = [];
var lines = "";
if (Ti.Platform.osname == 'iphone') {
    lines = this.responseText.split("\n");
} else if (Ti.Platform.osname == 'android') {
    lines = ("" + this.responseData).split("\n");
}
</pre></code>

Then, my app can get the desired string in variable 'lines'.

<h3>Comments</h3>

<ol>
<li>Paul Dowsett 2011-12-21

   As indicated by the reporter in the original title, this ticket relates to android. Hence, correcting Component field.
   
   </li>
<li>Leonardo Leal 2015-01-07

   Explicitly declare the charset on your service's response header, and It will be fixed. I had this very same problem, and It seems that when you don't declare the response charset on the "content-type" header, Android tries to use the current locale of the OS for response texts, which changes from user to user around the world.
   
   Set your response header to something like "Content-Type: application/json;charset=utf-8" and your problem will be solved.</li>
</ol>


<p><a href="/TIMOB/TIMOB-3571.json">JSON Source</a></p>