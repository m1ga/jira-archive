---
title: "[TIMOB-4235] Android: taking a picture crashes app on Sony Xperia X10"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Needs more info</td></tr>
<tr><th>Resolution Date</th><td>2011-06-09T08:33:45.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.6.2</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-23</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>andoid</td></tr>
<tr><th>Reporter</th><td>Jon Alter</td></tr>
<tr><th>Assignee</th><td>Jon Alter</td></tr>
<tr><th>Created</th><td>2011-05-27T13:59:27.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T22:31:53.000+0000</td></tr>
</table>

<h3>Description</h3>

Taking a picture crashes app on Sony Xperia X10.
Can be reproduced reliably with Kitchen Sink, by executing "Phone -> Camera -> Camera Basic" and taking a picture.
The example below causes the same error. Only crashes on "Sony Xperia X10".

Step 1: run the code below
Step 2: take a picture
Step 3: notice the app crash

<code><pre>
var win = Ti.UI.createWindow({ fullscreen: true });

var cameraOverlay = Ti.UI.createView();
var cameraButton = Ti.UI.createButton({
	title:"Take Picture",
	bottom: 10
});
cameraButton.addEventListener('click', function(e){
	Ti.Media.takePicture();
});
cameraOverlay.add(cameraButton);

var open = Ti.UI.createButton({
	title: 'Open',
	bottom: 100,
	height: 40,
	width: 200
});
open.addEventListener('click', function(){
	Titanium.Media.showCamera({

		success:function(event)
		{
			var cropRect = event.cropRect;
			var image = event.media;

			Ti.API.debug('Our type was: '+event.mediaType);
			if(event.mediaType == Ti.Media.MEDIA_TYPE_PHOTO)
			{
				var imageView = Ti.UI.createImageView({
					width:win.width,
					height:win.height,
					image:event.media
				});
				win.add(imageView);
			}
			else
			{
				alert("got the wrong type back ="+event.mediaType);
			}
		},
		cancel:function()
		{
		},
		error:function(error)
		{
			// create alert
			var a = Titanium.UI.createAlertDialog({title:'Camera'});

			// set message
			if (error.code == Titanium.Media.NO_CAMERA)
			{
				a.setMessage('Please run this test on device');
			}
			else
			{
				a.setMessage('Unexpected error: ' + error.code);
			}

			// show alert
			a.show();
		},
		saveToPhotoGallery:true,
		allowEditing:true,
		mediaTypes:[Ti.Media.MEDIA_TYPE_VIDEO,Ti.Media.MEDIA_TYPE_PHOTO],
		// overlay: cameraOverlay
	});
});

win.add(open);
win.open();
</pre></code>

<h4>Stack Trace:</h4>

    java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=1, result=-1, data=Intent { act=inline-data dat=file:///sdcard/dcim/Camera/Memonic/tia608277175.jpg typ=image/jpeg (has extras) }} to activity {com.memonic.mobile/org.appcelerator.titanium.TiModalActivity}: java.lang.NullPointerException
    at android.app.ActivityThread.deliverResults(ActivityThread.java:2504)
    at android.app.ActivityThread.handleSendResult(ActivityThread.java:2546)
    at android.app.ActivityThread.access$2000(ActivityThread.java:121)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:966)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:123)
    at android.app.ActivityThread.main(ActivityThread.java:3652)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:862)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:620)
    at dalvik.system.NativeStart.main(Native Method)
    Caused by: java.lang.NullPointerException
    at java.io.File.fixSlashes(File.java:205)
    at java.io.File.init(File.java:189)
    at java.io.File.<init>(File.java:139)
    at ti.modules.titanium.media.MediaModule$CameraResultHandler.onResult(MediaModule.java:318)
    at org.appcelerator.titanium.util.TiActivitySupportHelper$1.onResult(TiActivitySupportHelper.java:52)
    at org.appcelerator.titanium.util.TiActivitySupportHelper.onActivityResult(TiActivitySupportHelper.java:68)
    at org.appcelerator.titanium.TiBaseActivity.onActivityResult(TiBaseActivity.java:354)
    at android.app.Activity.dispatchActivityResult(Activity.java:3907)
    at android.app.ActivityThread.deliverResults(ActivityThread.java:2500)
    ... 11 more

<h4>Workaround</h4>
Use an overlay. In the example above, uncomment "// overlay: cameraOverlay" and the camera will work as expected.

<h4>Associated Helpdesk Ticket</h4>
<a href="http://appc.me/c/APP-791753" rel="nofollow" target="_blank">http://appc.me/c/APP-791753</a>


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-4235_21447/Screen shot 2011-06-23 at 12.08.09 PM.png">Screen shot 2011-06-23 at 12.08.09 PM.png</td></td><td>2011-06-23T12:18:31.000+0000</td><td>120831</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Don Thorp 2011-06-01

   Try and reproduce on the Play. If we can't we may have to get the X10.</li>
<li>Ygor Lemos 2013-10-12

   </li>
<li>Lee Morris 2017-03-22

   Closing ticket due to the information that was requested not being provided.</li>
</ol>


<p><a href="/TIMOB/TIMOB-4235.json">JSON Source</a></p>