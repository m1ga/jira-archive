---
title: "[TIMOB-4737] Tooling: Allow substitution parameters for Android package name"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-08-29T13:28:20.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.2</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-34, Release 1.8.0</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Jeff English</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-07-20T17:07:07.000+0000</td></tr>
<tr><th>Updated</th><td>2014-06-19T12:46:13.000+0000</td></tr>
</table>

<h3>Description</h3>

Enhance the build tools for android so that substitution parameters can be applied in the timodule.xml. The timodule.xml file contains manifest information that gets inserted into the android.manifest file during the build process. The Urban Airship module, for example, requires that the package name be set as part of the category name. Currently the user must update the timodule.xml with the package name, but it should be possible to automate this by allowing the specification of substitution parameters (for example, __PACKAGE_NAME__) so that the build process replaces __PACKAGE_NAME__ with the name of the package.

Example:

<code><pre>
  &lt;manifest&gt;
    &lt;application&gt;
	&lt;!-- REQUIRED for C2DM and Hybrid --&gt;
	&lt;receiver android:name="com.urbanairship.push.c2dm.C2DMPushReceiver"
			android:permission="com.google.android.c2dm.permission.SEND"&gt;        
	  &lt;!-- Receive the actual message --&gt;
	  &lt;intent-filter&gt;
		  &lt;action android:name="com.google.android.c2dm.intent.RECEIVE" /&gt;
		  &lt;category android:name="__PACKAGE_NAME__" /&gt;
	  &lt;/intent-filter&gt;
	  &lt;!-- Receive the registration id --&gt;
	  &lt;intent-filter&gt;
		  &lt;action android:name="com.google.android.c2dm.intent.REGISTRATION" /&gt;
		  &lt;category android:name="__PACKAGE_NAME__" /&gt;
	  &lt;/intent-filter&gt;
	&lt;/receiver&gt;
    &lt;/application&gt;

	&lt;!-- REQUIRED for C2DM --&gt;
	&lt;!-- Only this application can receive the messages and registration result --&gt;
	&lt;permission android:name="__PACKAGE_NAME__.permission.C2D_MESSAGE"
		android:protectionLevel="signature" /&gt;
	&lt;uses-permission android:name="__PACKAGE_NAME__.permission.C2D_MESSAGE" /&gt;		
	&lt;!-- This app has permission to register and receive messages --&gt;
	&lt;uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" /&gt;
		
  &lt;/manifest&gt;
</pre></code>

When built would be inserted into the android.manifest file as

<code><pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="<a href="http://schemas.android.com/apk/res/android" rel="nofollow" target="_blank">http://schemas.android.com/apk/res/android</a>"
      package="com.appcelerator.urbanairshiptest"
      android:versionCode="1"
      android:versionName="1"
&gt;
...

	&lt;permission android:name="com.appcelerator.urbanairshiptest.permission.C2D_MESSAGE" android:protectionLevel="signature"/&gt;

...
	  &lt;intent-filter&gt;
		  &lt;action android:name="com.google.android.c2dm.intent.RECEIVE"/&gt;
		  &lt;category android:name="com.appcelerator.urbanairshiptest"/&gt;
	  &lt;/intent-filter&gt;
	  &lt;!-- Receive the registration id --&gt;
	  &lt;intent-filter&gt;
		  &lt;action android:name="com.google.android.c2dm.intent.REGISTRATION"/&gt;
		  &lt;category android:name="com.appcelerator.urbanairshiptest"/&gt;
	  &lt;/intent-filter&gt;
...
	&lt;uses-permission android:name="com.appcelerator.urbanairshiptest.permission.C2D_MESSAGE"/&gt;
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-4737_22626/ti.bogus-android-0.1.zip">ti.bogus-android-0.1.zip</td></td><td>2011-08-22T13:28:22.000+0000</td><td>12361</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Jeff English 2011-08-15

   Use the ${...} notation instead of the notation shown in the initial example</li>
<li>Bill Dawson 2011-08-22

   Bogus titanium module to use for testing</li>
<li>Bill Dawson 2011-08-22

   Testing Notes:
   
   * Create a titanium project.
   
   * Dump the attached module zip into its root folder.
   
   * Build the project.
   
   * Open <code>modules/android/ti.bogus/0.1/timodule.xml</code> just so you can see what I put in there.  You'll notice the mako (template engine) tokens in a few places, namely in the attribute values for the <code>bogus</code> and <code>bogus2</code> elements.  The idea here is that the token <code>${tiapp.properties\['id\]}</code> will be replaced with the id of the app you create.
   
   * Now open <code>build/android/AndroidManifest.xml</code> and look for those <code>bogus</code> and <code>bogus2</code> elements.  Also make sure that the <code>android.permission.DEVICE_POWER</code> permission is in the AndroidManifest.xml.  Because I touched that area of code, I want to be sure permissions still get in there correctly.</li>
<li>Bill Dawson 2011-08-22

   Pull request ready:
   
   <a href="https://github.com/appcelerator/titanium_mobile/pull/403" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/403</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-4737.json">JSON Source</a></p>