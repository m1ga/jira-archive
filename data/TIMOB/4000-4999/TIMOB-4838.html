---
title: "[TIMOB-4838] iOS: push notification callbacks invoked twice"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Needs more info</td></tr>
<tr><th>Resolution Date</th><td>2011-08-01T12:28:59.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.2</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-31</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>callback, ios, look1, notifications, push</td></tr>
<tr><th>Reporter</th><td>Eduardo Gomez</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-07-29T13:44:36.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-16T20:44:07.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
When the app is running and a push message is sent, the callback is called and the message is displayed.

But when the app has been closed and a push message was sent, iOS displays an alert with the message, and then when the app is opened by clicking 'View' from the alert, the callback is called which displays a second alert with the same message.

According to a development comment, that method shouldn't be called if the app is started by a Notification.

<h4>Core source code</h4>
<code><pre>
#pragma mark Push Notification Delegates

#ifdef USE_TI_NETWORKREGISTERFORPUSHNOTIFICATIONS

- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo
{
	// NOTE: this is called when the app is *running* after receiving a push notification
	// otherwise, if the app is started from a push notification, this method will not be 
	// called
	RELEASE_TO_NIL(remoteNotification);
	[self generateNotification:userInfo];
	
	if (remoteNotificationDelegate!=nil)
	{
		[remoteNotificationDelegate performSelector:@selector(application:didReceiveRemoteNotification:) withObject:application withObject:remoteNotification];
	}
}
</pre></code>

<h4>Associated HD ticket</h4>
As an ENT customer relies on this,  I set Customer priority to Immediate.
<a href="http://appc.me/c/APP-919486" rel="nofollow" target="_blank">http://appc.me/c/APP-919486</a>

<h4>Additional info</h4>
The message is being sent to the device using Urban Airship. Let me know please if anymore data is needed.

<h3>Comments</h3>

<ol>
<li>Blain Hamon 2011-08-01

   Will need a sample app/source that shows what the app does with the payload once they receive it. I have a sneaking suspicion that the JS code presents a dialog from notification. If this is the case, then the bug is invalid:
   
   If an application is running when the notification comes in, it should NOT present a dialog -- the user is already in the application -- but should update the information in the background with the payload. Similarly, when launched from an alert, the payload can be used to direct the application onto where to focus.
   
   For example, in an SMS app, if you receive an SMS, you do NOT get a dialog alerting you. Instead, the list of conversations is updated. When not in an SMS app and a notification happens, the OS provides an alert as an offering to view the SMS in detail. If the user so takes the offer, the payload is passed onto the app in order for the app to update the focus.</li>
<li>Lee Morris 2017-03-16

   Closing ticket as the information that was requested was never provided.</li>
</ol>


<p><a href="/TIMOB/TIMOB-4838.json">JSON Source</a></p>