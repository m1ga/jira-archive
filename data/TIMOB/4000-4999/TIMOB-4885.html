---
title: "[TIMOB-4885] Android: evalJS for javascript functions in webview results in a crash"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-09-27T09:55:53.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.2</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-37, Release 1.8.0</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>module_webview, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Anirudh Nagesh</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-08-03T14:51:11.000+0000</td></tr>
<tr><th>Updated</th><td>2014-06-19T12:46:21.000+0000</td></tr>
</table>

<h3>Description</h3>

Evaluating a javascript function inside an html results in a crash. works fine on iOS
Step1: copy the below code to app.js
<code><pre>
var win = Ti.UI.createWindow({ backgroundColor: '#cccccc' });
	    
var webView = Ti.UI.createWebView({ width: 300, height: 200, top: 0, left: 0,backgroundColor: 'white', 
url:'test.html'
});  	
win.add(webView);

webView.addEventListener('load', function(){
	
	Ti.API.debug('webivew loaded');
//	 var title = webView.evalJS("document.title");   // this works fine!
//	Ti.API.debug(title);
	var foo_return = webView.evalJS("foo('Hi')");   
	Ti.API.debug(foo_return);


});

win.open();
</pre></code>

Step2: Copy the below code to 'test.html' under the resources.
<code><pre>
&lt;!doctype html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;title&gt;Test Webview Page&lt;/title&gt;
		
&lt;/head&gt;
	&lt;body&gt;&lt;h1&gt;My hovercraft is full of eels.&lt;/h1&gt;
	&lt;script type="text/javascript"&gt;
			function foo(msg) { alert(msg); };
		&lt;/script&gt;
		
	&lt;/body&gt;
&lt;/html&gt;
</pre></code>

Step3: Crash log from ddms is attached.


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-4885_22214/crash_log.txt">crash_log.txt</td></td><td>2011-08-03T14:51:11.000+0000</td><td>12769</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-4885_22925/timob4885.zip">timob4885.zip</td></td><td>2011-09-13T15:58:09.000+0000</td><td>7563598</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-08-22

   Still working on it, but a quick note: I can only re-create this if the function being called has an <code>alert()</code>, <code>prompt()</code> or <code>confirm()</code> call in it.  If anybody can re-create with a JS function (in the html file) that does not use one of these functions that pops up a dialog, please post another example failcase.</li>
<li>Bill Dawson 2011-09-13

   See attached test app timob4885.zip for easy testing of evalJS that causes a UI to appear from within webview (alert()) and evalJS that does not cause a UI to appear from within webview.
   
   The original problem was with using evalJS to show an alert.  That should be fixed now.  This test app incorporates the original fail case.</li>
<li>Don Thorp 2011-09-27

   Merge.</li>
<li>Alan Vaghti 2011-11-22

   Fix verified in SDK 1.8.0.1.v20111122105459 with a Nexus One running 2.2.2.</li>
<li>jithinpv 2013-11-25

   Anvil test case added.
   PR link:
   <a href="https://github.com/appcelerator/titanium_mobile/pull/5020" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5020</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-4885.json">JSON Source</a></p>