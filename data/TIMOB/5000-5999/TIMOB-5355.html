---
title: "[TIMOB-5355] Javascript parser crash on device when using commonJS modules"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-01-09T12:12:03.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 1.8.0.1</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>module_build, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Shannon Hicks</td></tr>
<tr><th>Assignee</th><td>Blain Hamon</td></tr>
<tr><th>Created</th><td>2011-08-30T08:19:32.000+0000</td></tr>
<tr><th>Updated</th><td>2012-01-09T12:12:03.000+0000</td></tr>
</table>

<h3>Description</h3>

Here's what the app.js file looks like:

<code><pre>
var TextEditWindow = require('TextEditWindow').TextEditWindow;
</pre></code>

Here's the TextEditWindow.js file:

<code><pre>
exports.TextEditWindow = function() {

	var win = Titanium.UI.createWindow();
	
	return win;
};

exports.TextEditWindow.prototype.calculateBottom = function(orientation) {
	var calculatedBottom = 10;
	
	return calculateBottom;
}
</pre></code>

Without a ";" at the end of TextEditWindow, it crashes on-device, but works in the Simulator. The crash said there was a parse error at line 3 (obviously nowhere near the problem), and doesn't specify which file. Either the parser should be a little less strict, or we should be able to get a more accurate error message.

<h3>Comments</h3>

<ol>
<li>Rick Blalock 2011-09-14

   </li>
<li>Paul Dowsett 2011-09-23

   Shannon
   
   Which device did you test this on, please?
   
   Thanks</li>
<li>Shannon Hicks 2011-09-23

   I tried it on an iPhone 4 running the latest [REDACTED], and a 3G running 4.2.1</li>
<li>Blain Hamon 2011-11-07

   Hours recorded on 4825. Pull pending. <a href="https://github.com/appcelerator/titanium_mobile/pull/647" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/647</a></li>
<li>Dustin Hyde 2011-12-08

   Bug fixed. Verified on:
   SDK: 1.8.0.1.v20111208104316
   Studio: 1.0.7.201112080131
   OS: OS X Lion
   Devices Tested: iPod 4.3.3</li>
<li>Dustin Hyde 2012-01-09

   Added label qe-testadded.</li>
</ol>


<p><a href="/TIMOB/TIMOB-5355.json">JSON Source</a></p>