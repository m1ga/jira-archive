---
title: "[TIMOB-5358] titanium.py script doesn't exit with non-zero exit code when failing to create module project"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-10-05T10:20:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.2</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-40, Release 1.8.0</td></tr>
<tr><th>Components</th><td>Tooling</td></tr>
<tr><th>Labels</th><td>module, module.py, modules</td></tr>
<tr><th>Reporter</th><td>Christopher Williams</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2011-09-26T08:28:47.000+0000</td></tr>
<tr><th>Updated</th><td>2011-12-21T15:28:35.000+0000</td></tr>
</table>

<h3>Description</h3>

I'm trying to work on module tooling in Titanium Studio and while testing generation of an Android mobile module project I ended up with an empty directory. After debugging, I see that the underlying process is returning a 0 exit code, but is actually failing. We typically use the exit code as an indicator of success or failure for native processes, and bubble up the failure based on that. In this case we got a 0 so we assumed success and never notified the user of the root cause.

Here's what I saw as the output of the process in the debugger:
<code><pre>
Traceback (most recent call last):
File "/Library/Application Support/Titanium/mobilesdk/osx/1.7.2/module/module.py", line 319, in &lt;module&gt;
main(sys.argv)
File "/Library/Application Support/Titanium/mobilesdk/osx/1.7.2/module/module.py", line 316, in main
module = ModuleProject(config['platform'],project_dir,config)
File "/Library/Application Support/Titanium/mobilesdk/osx/1.7.2/module/module.py", line 63, in __init__
self.platform_delegate = ModulePlatform.create_platform(platform, project_dir, config, self)
File "/Library/Application Support/Titanium/mobilesdk/osx/1.7.2/module/module.py", line 34, in create_platform
return platform_module_class(project_dir, config, module)
File "/Library/Application Support/Titanium/mobilesdk/osx/1.7.2/module/android/android.py", line 26, in __init__
print "[ERROR] Couldn't find the Google APIs r%s add-on directory" % self.sdk.DEFAULT_API_LEVEL
AttributeError: AndroidSDK instance has no attribute 'DEFAULT_API_LEVEL'
Created android module project null
</pre></code>

<h3>Comments</h3>

<ol>
<li>Bill Dawson 2011-10-04

   To test:
   
   * In your Android SDK folders, rename the add-ons/addon_google_apis_google_inc_7 folder so that it can't be found by the scripts. I.e., rename it to anything you want.
   * run this command in your terminal (if you're running OSX, if not please adjust the command intelligently :) -- and if your android sdk is not in /opt/android-sdk-mac_x86, you'll need to change that too in this command.  Also you need to either make sure <code>titanium</code> is aliased to the <code>titanium.py</code> file in your installed 1.8.0 mobilesdk or otherwise give a complete path to it.):
   
   <code><pre>
   titanium create --type=module --platform=android --android=/opt/android-sdk-mac_86 --name=testmod --id=ti.testmod
   </pre></code>
   
   You should see an error similar to what Chris describes in the Description field of this JIRA ticket.
   
   * run <code>echo $?</code> to check the return value, and you'll see in the failcase that it is 0.  When testing the fix, it should be 1.
   
   * Don't forget to put your add-ons/addon_google_apis_google_inc_7 folder back where it belongs when you're done testing. :)</li>
<li>Bill Dawson 2011-10-04

   Pull request ready:
   
   <a href="https://github.com/appcelerator/titanium_mobile/pull/527" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/527</a></li>
<li>Natalie Huynh 2011-12-21

   Tested with 1.8.0.1.v20111220190134 when build fails echo $? returns 1 and when it passes it will return 0</li>
</ol>


<p><a href="/TIMOB/TIMOB-5358.json">JSON Source</a></p>