---
title: "[TIMOB-5443] iOS: EmailDialog not sending attachments"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2011-10-14T14:50:30.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-41</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>attachment, bug, email, emaildialog, image, ios</td></tr>
<tr><th>Reporter</th><td>Karol Pomaski</td></tr>
<tr><th>Assignee</th><td>Sabil Rahim</td></tr>
<tr><th>Created</th><td>2011-10-05T12:08:04.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-02T22:20:46.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
While sending the image files as a attachment using EmailDialog the receive image is empty. 

<h4>Reproducible Steps</h4>
1. Execute the project that was attached
2. Install the application to some iOS device
3. Send an email to you
4. Check your inbox - the image received is empty

<h4>Sample Code</h4>
<code><pre>
// this sets the background color of the master UIView (when there are no windows/tab groups on it)
Titanium.UI.setBackgroundColor('#000');

var win1 = Titanium.UI.createWindow({  
    title:'Tab 1',
    backgroundColor:'#fff'
});

win1.open();
var emailDialog = Titanium.UI.createEmailDialog();

emailDialog.subject = 'Take a look at this great app I found!';

emailDialog.toRecipients = [];

emailDialog.messageBody = "u";

var f = Ti.Filesystem.getFile('off.png');


if(f.exists())

{

emailDialog.addAttachment(f);

}

else

{

emailDialog.messageBody = "test";

}

emailDialog.open();
</pre></code>

<h4>Associated HelpDesk Ticket</h4>
<a href="http://appc.me/c/APP-353882" rel="nofollow" target="_blank">http://appc.me/c/APP-353882</a>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-5443_23325/emaildialog.zip">emaildialog.zip</td></td><td>2011-10-05T12:08:04.000+0000</td><td>2877242</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Sabil Rahim 2011-10-13

   This is not a problem on our SDK, This happens as the PNG files in the resources folder are being transfered to iOS device ,the build process compresses the file for optimization and as a result of which any PNG file in the app's resources folder that you may send as a email attachment won't show up on a computer , but can be seen through any iOS device. 
   
   NOTE : THIS ONLY HAPPENS FOR PNG FILES AND NO OTHER TYPES OF FILE HAVE ANY PROBLEM ... AND HAPPENS FOR PNG FILES SHIPPED ALONG WITH THE APP, IT SHOULDN'T CREATE A PROBLEM IF YOU ARE TYRING TO SEND A PNG FILE FROM THE PHOTO LIBRARY INSIDE THE PHONE. 
   </li>
<li>Sabil Rahim 2011-10-14

   blog post  that explains the whole process . <a href="http://iphonedevelopment.blogspot.com/2008/10/iphone-optimized-pngs.html" rel="nofollow" target="_blank">http://iphonedevelopment.blogspot.com/2008/10/iphone-optimized-pngs.html</a></li>
<li>Blain Hamon 2011-10-14

   Further commentary: To turn off the png compression would be a speed hit to the app in general, possibly to file size as well, and is generally frowned upon. Emailing resources that were compiled into the app is the exception, not the norm.
   
   Solutions:
   1) Save the png under a different extension so it doesn't get compressed at build time
   2) Use a different file type
   3) Open the png, resize it to itself, and save the new, uncompressed image and send that.
   
   All of these solutions to this odd edge case can be done completely in javascript.</li>
<li>Sabil Rahim 2011-10-14

   //workaround code :
   
   Titanium.UI.setBackgroundColor('#000');
   
   var win1 = Titanium.UI.createWindow({  
       title:'Tab 1',
       backgroundColor:'#fff'
   });
   win1.open();
   
   var emailDialog = Titanium.UI.createEmailDialog();
   
   emailDialog.subject = 'Take a look at this great app I found!';
   emailDialog.toRecipients = [];
   emailDialog.messageBody = "u";
   
   //var f = Ti.Filesystem.getFile('off.png'); <- Remove this line
   
   var file = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory, 'convert.PNG'); //<-- insert
   file.write(Ti.UI.createImageView({image:'off.PNG',}).toImage()); //<-- insert
   
   if(f.exists())
   {
        emailDialog.addAttachment(f);
   }
   else
   {
        emailDialog.messageBody = "test";
   }
   emailDialog.open();
   </li>
<li>Reggie Seagraves 2011-10-14

   This is a known issue with the way Apple preprocesses PNG files for inclusion into an app.  Use the workaround in the ticket for png files from the Resources directory.</li>
<li>Lee Morris 2017-03-02

   Closing ticket as invalid.</li>
</ol>


<p><a href="/TIMOB/TIMOB-5443.json">JSON Source</a></p>