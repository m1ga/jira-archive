---
title: "[TIMOB-5933] iOS: Error of authentication using TiNetworkHTTPClientProxy.m in http client under iOS 5"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-07-10T22:38:19.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.3, Release 1.7.5, Release 1.8.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>api, tbs-1.9.0</td></tr>
<tr><th>Reporter</th><td>Francisco Antonio Duran Ramirez</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2011-11-01T09:49:03.000+0000</td></tr>
<tr><th>Updated</th><td>2017-07-10T22:38:19.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
 
Error of authentication using TiNetworkHTTPClientProxy.m in http client under iOS 5
 
<h4>Reproducible steps:</h4>
 
1.     Locate the TiNetworkHTTPClientProxy.m  file in the next path: 

/ Users/your_username/Library/Application Support/Titanium/mobilesdk/osx/ 1.8.0.v20111028154620/iphone/Classes/

2. Locate, and update the code of the file.
-(void)open:(id)args method implementation and add right after request initialization string (1) authorization strings (2 and 3), see below: â€¨    
 
request = [[ASIFormDataRequest  requestWithURL:url] retain]; (1)
[request setUsername:@"xxxxxx"]; (2)
[request setPassword:@"xxxxxx"]; (3)

Please go to the ticket(APP-915216) to see the setUsername, and setPassword. 

3. Run the code below.
 
<h4>Expected behavior:</h4>
Customer wants to keep the same behavior of iOS 4.3 in the 5  iOS SDK version.
<h4>Sample code:</h4>
 
<code><pre>
var miwin = Ti.UI.createWindow({
            backgroundColor : 'white'
});
 
var xhr = Titanium.Network.createHTTPClient()
xhr.timeout = 30000;
xhr.open('GET', '<a href="https://ios.plainscapital.com/_vti_bin/listdata.svc/Locations?" rel="nofollow" target="_blank">https://ios.plainscapital.com/_vti_bin/listdata.svc/Locations?</a>$select=Id,Title,Latitude,Longitude,City,StateProvince');
xhr.onload = function() {
            alert('succeed');
};
xhr.onerror = function(e) {
            alert(e.error);
};
xhr.tlsVersion = Ti.Network.TLS_VERSION_1_0;
xhr.send();
 
miwin.open();

</pre></code>

<h4>Additional info:</h4>
The application does not create any logs in the next path:
Library/Logs/CrashReporter/
<h4>Associated HD Ticket:</h4>
APP-915216

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-5933_23978/1.8.0.v20111028154620 with iOS 4.3 SDK.png">1.8.0.v20111028154620 with iOS 4.3 SDK.png</td></td><td>2011-11-01T09:51:58.000+0000</td><td>209220</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-5933_23977/1.8.0.v20111028154620 with iOS 5 SDK.png">1.8.0.v20111028154620 with iOS 5 SDK.png</td></td><td>2011-11-01T09:51:58.000+0000</td><td>215782</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2011-11-01

   This is effectively the iOS-specific version of TIMOB-5435 (and may require an update to the ASI library as well). We need to provide API access to username/password (and domain) properties of ASI. This should provide the requested functionality.</li>
<li>Stephen Tramer 2011-11-01

   Quick note; this bug appears to be due to the fact that iOS 5 no longer fires (kCFStreamEventEndEncountered) events to the read callback after an error occurs, as it previously did. This prevents the system from picking up the (401) error result and responding to the challenge appropriately. It could be a behavior change based on unrecognized certificate rejection.</li>
<li>Stephen Tramer 2011-11-02

   It turns out that this is an error with the 3rd party library we're using, which currently has a bug report revolving around this issue:
   
   <a href="https://github.com/pokeb/asi-http-request/issues/273" rel="nofollow" target="_blank">https://github.com/pokeb/asi-http-request/issues/273</a>
   
   Unfortunately, we are blocked on them being able to resolve this problem. Information about, and verification of, the relevant system serving the certificate may be necessary to provide further information to the 3rd party so that they can solve the issue faster. It could also be the case that there is a configuration error with the SSL certificate or serving process which is preventing the handshake from occurring correctly. We cannot resolve any configuration issues ourselves - only pass on information to assist in the resolution of bugs where possible.
   
   ----
   
   We will still be able to offer new API points for username/password/domain as per TIMOB-5435, removing the need for custom modifications, but are waiting on internal testing infrastructure to verify the changes.</li>
<li>Stephen Tramer 2011-11-03

   Ticket TIMOB-5973 indicates ASI is no longer under active development, meaning it needs to be replaced and we should not expect any fixes to come through that pipeline. We will be required to implement them ourselves.</li>
<li>Stephen Tramer 2011-11-28

   Please see this technical note; this is likely a server configuration problem.
   
   <a href="http://developer.apple.com/library/ios/#technotes/tn2287/_index.html#//apple_ref/doc/uid/DTS40011309" rel="nofollow" target="_blank">http://developer.apple.com/library/ios/#technotes/tn2287/_index.html#//apple_ref/doc/uid/DTS40011309</a></li>
<li>Stephen Tramer 2011-11-28

   Probably SSL versioning support as above.</li>
<li>Stephen Tramer 2012-05-04

   Requires a retest with sslVersion set.</li>
</ol>


<p><a href="/TIMOB/TIMOB-5933.json">JSON Source</a></p>