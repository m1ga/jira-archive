---
title: "[TIMOB-6231] Android: Ti.include doesn't work correctly in event handler"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2012-02-10T00:26:40.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.0, Release 1.7.5, Release 1.7.6, Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>parity</td></tr>
<tr><th>Reporter</th><td>Arthur Evans</td></tr>
<tr><th>Assignee</th><td>Ping Wang</td></tr>
<tr><th>Created</th><td>2011-11-17T23:39:02.000+0000</td></tr>
<tr><th>Updated</th><td>2012-02-10T00:26:40.000+0000</td></tr>
</table>

<h3>Description</h3>

This is related to the customer issue reported in TIMOB-1662. In trying to describe the behavior of Ti.include to resolve the related doc bug, TIMOB-4108, I came across the following parity issue: Ti.include works correctly when called from an event handler on iOS, but not on Android. Consider the following code:

<code>app.js</code>:
<code><pre>
var win1 = Titanium.UI.createWindow({
  title:'Window 1',
  backgroundColor:'blue',
  fullscreen:false
});

win1.open();



var testVar1 = "I can see the global context.";

var testMe = function(){
  Ti.API.info("In the function");
  Ti.include('include_test2.js');

  Ti.API.info("testVar2 defined in include_test2.js and output in app.js: " + testVar2);
};

testMe();
win1.addEventListener('click', function()
{
	Ti.API.info("In the event handler");
	testMe();
});
win1.fireEvent('click', {});
</pre></code>

And the include file, <code>include_test2.js</code>:

<code><pre>
var testVar2 = "Variable defined in the include file.";
Ti.API.info("In the include file.")
Ti.API.info("testVar1: " + testVar1);
</pre></code>

On iOS, whether the testMe function is called directly or from inside the event handler, the include file can access the global context. On Android, though, it succeeds when the function is called directly, and fails with a reference error when called from the event handler.

<h4>Attached new test case (whole small runnable project).</h4>

<h4>Reproducible Steps</h4>
1. Press "Click button"

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-6231_24540/namespace2.zip">namespace2.zip</td></td><td>2011-12-09T12:07:28.000+0000</td><td>2321943</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ping Wang 2012-01-10

   Can not reproduce with the latest master.</li>
</ol>


<p><a href="/TIMOB/TIMOB-6231.json">JSON Source</a></p>