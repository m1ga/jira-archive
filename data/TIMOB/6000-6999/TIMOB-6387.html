---
title: "[TIMOB-6387] iOS: The Webview's "error" event is not handled properly and cause crash."
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-03-14T13:25:13.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.5, Release 1.8.0, Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-48, Release 1.7.6, Release 1.8.0.1</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>merge-1.7.6, module_webview, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Qing Gao</td></tr>
<tr><th>Assignee</th><td>Sabil Rahim</td></tr>
<tr><th>Created</th><td>2011-11-30T12:25:55.000+0000</td></tr>
<tr><th>Updated</th><td>2016-01-15T10:16:43.000+0000</td></tr>
</table>

<h3>Description</h3>

The "error" event is not handled properly in WebView and crash the app.

<h4>Repro Steps</h4>
Step 1. Create a project based on the following code.
Step 2. Input "www.yahoo.com," and return. The webview will open up it correctly
Step 3. Input some random word and hit enter. the app would crash.

<code><pre>
var win = Ti.UI.createWindow({ backgroundColor: '#fff' });

var input = Ti.UI.createTextArea({
	top:40,
	height:60,
	borderColor:'#333',
	borderRadius: 10,
	autocapitalization:Titanium.UI.TEXT_AUTOCAPITALIZATION_NONE
});

function makeweb(url2){
	var web = Ti.UI.createWebView({
		html:null,
		url:url2
	});
	var window = Titanium.UI.createWindow({});
	
	//
	//
	// Attaching the 'error' event listener results in a crash on poorly formed URLS
	//
	//
	web.addEventListener('error', function(e) {
		alert('error');
	});
	
	window.add(web);
	return window;
};

win.add(input);

input.addEventListener('return', function(e) {
	var link = input.value.toString();
	web = makeweb('http://'+link);
	web.open();
});
win.addEventListener('open', function() {
	input.focus();
});

win.open();
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-6387_24389/testLinkCrash_2011-11-30-094839_qgaombp.crash">testLinkCrash_2011-11-30-094839_qgaombp.crash</td></td><td>2011-11-30T12:25:55.000+0000</td><td>40881</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Michael Pettiford 2011-12-05

   Tested on Ti Studio 1.0.7.201112041107
   Ti Mob SDK 1.8.0.1.v20111205011857
   OSX Lion
   iPod Touch 4.3.5, iPhone 4S OS 5.0.1, iPad 2 OS 4.3.5
   
   Expected behavior shown of proper error handling with a invalid url</li>
<li>Natalie Huynh 2012-01-04

   Open to add label</li>
<li>Dustin Hyde 2012-03-13

   Bug still exists under certain conditions:
   
   - Invalid characters such as: % and : (ascii 37 and 58).
   - Spaces in the url.
   
   SDK: 1.8.2 githash=59b3a90s, 2.0.0.v20120312213243
   Studio: 2.0.0.201203121914
   OS: Snow Leopard
   Devices Tested: iPod 4.3.3, iOS Simulator 5.0
   
   Crash does not occur on Android.
   
   Steps to Reproduce:
   
   1. Run code below.
   
   <code><pre>
   var win = Ti.UI.createWindow({
   	backgroundColor:'blue',
   	top:0,
   	layout:'vertical'
   	});
   	
   var asciiButton = Ti.UI.createButton({
   	title:'ascii char url test',
   	top:0,
   	width:'100%',
   	height:'20%'
   });
   
   asciiButton.addEventListener('click', function(){
   	var webView = Ti.UI.createWebView();
   	
   	win.add(webView);
   	
   	var asciiCount = 1024;
   	
   	for(var i = 0; i &lt; asciiCount; i++)
   	{		
   		var string = String.fromCharCode(i);
   		
   		Ti.API.info(i + ': ' + string);
   		
   		webView.url = string;
   	}
   	
   	win.remove(webView);
   });
   
   win.add(asciiButton);
   
   var intButton = Ti.UI.createButton({
   	title:'int url test',
   	width:'100%',
   	top:0,
   	height:'20%'
   });
   
   intButton.addEventListener('click', function(){
   	var webView = Ti.UI.createWebView();
   	
   	win.add(webView);
   	
   	var intCount = 2500;
   	
   	for(var i = 0; i &lt; intCount; i++)
   	{
   		var string = i.toString();
   		
   		Ti.API.info(i + ': ' + string);
   		
   		webView.url = string;
   	}
   	
   	win.remove(webView);
   });
   
   win.add(intButton);
   
   var floatButton = Ti.UI.createButton({
   	title:'float url test',
   	width:'100%',
   	top:0,
   	height:'20%'
   });
   
   floatButton.addEventListener('click', function(){
   	var webView = Ti.UI.createWebView();
   	
   	win.add(webView);
   	
   	var floatCount = 10.0;
   	
   	for(var i = 0.0; i &lt; floatCount; i += 0.01)
   	{
   		var string = i.toString();
   		
   		Ti.API.info(i + ': ' + string);
   		
   		webView.url = string;
   	}
   	
   	win.remove(webView);
   });
   
   win.add(floatButton);
   
   var objectButton = Ti.UI.createButton({
   	title:'object url test',
   	width:'100%',
   	top:0,
   	height:'20%'
   });
   
   objectButton.addEventListener('click', function(){
   	var webView = Ti.UI.createWebView();
   	
   	win.add(webView);
   	
   	var objectList = [
   		true,
   		{},
   		[],
   		1,
   		0.9,
   		null,
   		undefined
   	];
   	
   	for(var i in objectList)
   	{
   		var object = objectList[i];
   		
   		Ti.API.info(i + ': ' + object);
   		
   		try
   		{
   			webView.url = object;
   		}
   		catch(e)
   		{
   			Ti.API.info(e.toString());
   		}
   	}
   	
   	win.remove(webView);
   });
   
   win.add(objectButton);
   
   var urlStringButton = Ti.UI.createButton({
   	title:'url string url test',
   	width:'100%',
   	top:0,
   	height:'20%'
   });
   
   urlStringButton.addEventListener('click', function(){
   	var webView = Ti.UI.createWebView();
   	
   	win.add(webView);
   	
   	var urlList = [
   		'www.yahoo.com',
   		'www.notarealwebsiteatall.com',
   		's p a c e s'
   	];
   	
   	for(var i in urlList)
   	{
   		var url = 'http://';
   		
   		url += urlList[i];
   		
   		Ti.API.info(i + ': ' + url);
   		
   		webView.url = url;
   	}
   	
   	win.remove(webView);
   });
   
   win.add(urlStringButton);
   
   win.open();
   </pre></code>
   
   2. Click 'ascii char url test' or 'url string url test'.
   
   Expected Result:
   
   App should not crash.
   
   Actual Result:
   
   App crashes.</li>
<li>Dustin Hyde 2012-03-14

   </li>
<li>jithinpv 2013-11-25

   Anvil test case added.
   PR link:
   <a href="https://github.com/appcelerator/titanium_mobile/pull/5020" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5020</a></li>
</ol>


<p><a href="/TIMOB/TIMOB-6387.json">JSON Source</a></p>