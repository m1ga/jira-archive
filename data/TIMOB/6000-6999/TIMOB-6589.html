---
title: "[TIMOB-6589] Android: Modules: runOnUiThread needs to be supported"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2011-12-13T13:07:16.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-50</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>branch-v8</td></tr>
<tr><th>Reporter</th><td>Jeff English</td></tr>
<tr><th>Assignee</th><td>Opie Cyrus</td></tr>
<tr><th>Created</th><td>2011-12-12T16:54:58.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-22T17:48:39.000+0000</td></tr>
</table>

<h3>Description</h3>

Specifying "@Kroll.setProperty(runOnUiThread = true)" has no effect on the thread that the method is executed. This is exhibited in the StyledLabel and Gigya modules. The StyledLabel module sets a property during an event notification from a button click. When the property is updated it makes a call to refresh the display of the label. Since the execution thread is different than the thread that created the view a CalledFromWrongThreadExeption is thrown. The label, in this case, was created on the main thread but the property update and subsequent attempt to update the view is running on the Kroll runtime thread.

<code><pre>
12-12 16:38:39.466: ERROR/RhinoObject(544): (KrollRuntimeThread) [119,93332] Only the original thread that created a view hierarchy can touch its views.
12-12 16:38:39.466: ERROR/RhinoObject(544): android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
</pre></code>

To duplicate this issue, 
1. Build the StyedLabel module from the apilevel2 branch of my module fork. 
2. Run the example application from the module. The styled label will display correctly.
3. Click on the "Only allow links" button -- this will force an update of the property that attempts to update the styled label view


<h3>Comments</h3>

<ol>
<li>Marshall Culpepper 2011-12-12

   We need to support runOnUiThread for the following annotations:
   
   * <code>@Kroll.method</code>
   * <code>@Kroll.getProperty</code>
   * <code>@Kroll.setProperty</code>
   
   FWIW, The original behavior was also blocking.</li>
<li>Opie Cyrus 2011-12-13

   Discussed with Marshall Culpepper and Jeff English.  Decided that runOnUIThread will not be added back in and instead we will require async and sync thread behavior to use the handler.callback mechanism shown in platform already.  
   
   Jeff English will provide documentation and guide regarding the shift.</li>
<li>Lee Morris 2017-03-22

   Closing ticket as the issue will not fix and with reference to the above comments. </li>
</ol>


<p><a href="/TIMOB/TIMOB-6589.json">JSON Source</a></p>