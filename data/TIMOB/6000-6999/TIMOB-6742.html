---
title: "[TIMOB-6742] iOS: Video duration not available on device"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2011-12-17T17:51:58.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2011-50</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Stephen Tramer</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2011-12-17T15:59:49.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-03T23:17:20.000+0000</td></tr>
</table>

<h3>Description</h3>

Apparently the video duration is not available on device, even after the video begins playing or goes through a thumbnail grab (it may not be available beforehand, due to Apple bugs or other issues).

<code><pre>
var win = Titanium.UI.currentWindow;
win.backgroundColor = '#FFFFFF'

var close_button = Titanium.UI.createButton({
    title:'Close'
});

win.leftNavButton = close_button;

close_button.addEventListener('click', function(e) {
    win.close();
});

var activeMovie = Titanium.Media.createVideoPlayer(
{
    url : '<a href="http://c0222252.cdn.cloudfiles.rackspacecloud.com/0032_MotoBlur.m4v" rel="nofollow" target="_blank">http://c0222252.cdn.cloudfiles.rackspacecloud.com/0032_MotoBlur.m4v</a>',
    mediaControlStyle:Titanium.Media.VIDEO_CONTROL_DEFAULT,
    scalingMode:Titanium.Media.VIDEO_SCALING_ASPECT_FIT,
    autoplay : false
});

activeMovie.addEventListener('complete',function()
{
    Ti.API.info ("[test_duration.js] Movie completed");
    Ti.API.info ("[test_duration.js] duration after playing: " + activeMovie.duration);
});


//win.add(activeMovie);


var selected_video_thumbnail = activeMovie.thumbnailImageAtTime (5, Titanium.Media.VIDEO_TIME_OPTION_NEAREST_KEYFRAME);
Ti.API.info ("[test_duration.js] duration after getting thumbnail: " + activeMovie.duration);
</pre></code>

Support ticket: <a href="http://support.appcelerator.com/tickets/APP-792614/tickets" rel="nofollow" target="_blank">http://support.appcelerator.com/tickets/APP-792614/tickets</a>

Should make a drillbit or KS test available.

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2011-12-17

   Duration cannot be retrieved until the "durationAvailable" event is triggered. Looking into the best way to manually trigger that event now, because there is no guarantee that the duration is valid until that event is received.
   
   For large video stored remotely, this could take some time, especially on radio connections.</li>
<li>Stephen Tramer 2011-12-17

   Tested iPod 4GT / iOS 5.0.1 over WiFi (no WWAN support). Here are the findings:
   
   Video does not necessarily have all of its metadata loaded immediately after a request, especially for large remote files. You cannot get the duration until a video specifically says that the duration is available via the "durationAvailable" event. This property is documented, and so this bug is being marked "WON'T FIX" instead of being handled to docs (although the documentation could probably be better).
   
   Sample code which displays the MOST CORRECT behavior:
   
   <code><pre>
   var win = Ti.UI.createWindow();
   win.backgroundColor = '#FFFFFF'
   
   var close_button = Titanium.UI.createButton({
       title:'Close'
   });
   
   win.leftNavButton = close_button;
   
   close_button.addEventListener('click', function(e) {
       win.close();
   });
   
   var activeMovie = Titanium.Media.createVideoPlayer(
   {
       url : '<a href="http://c0222252.cdn.cloudfiles.rackspacecloud.com/0032_MotoBlur.m4v" rel="nofollow" target="_blank">http://c0222252.cdn.cloudfiles.rackspacecloud.com/0032_MotoBlur.m4v</a>',
       mediaControlStyle:Titanium.Media.VIDEO_CONTROL_DEFAULT,
       scalingMode:Titanium.Media.VIDEO_SCALING_ASPECT_FIT,
       autoplay : false
   });
   
   activeMovie.addEventListener('complete',function()
   {
       Ti.API.info ("[test_duration.js] Movie completed");
       Ti.API.info ("[test_duration.js] duration after playing: " + activeMovie.duration);
   });
   
   
   //win.add(activeMovie);
   
   activeMovie.addEventListener("durationAvailable", function() {
   	Ti.API.info ("[test_duration.js] duration after getting thumbnail: " + activeMovie.duration);
   });
   
   var selected_video_thumbnail = activeMovie.thumbnailImageAtTime (5, Titanium.Media.VIDEO_TIME_OPTION_NEAREST_KEYFRAME);
   </pre></code></li>
<li>Stephen Tramer 2011-12-17

   Filed a doc bug (TIMOB-6743) indicating that there may be a lack of useful information available about when certain metadata values are valid.</li>
<li>David Geller 2011-12-25

   The 'durationAvailable' event never seems to appear for Android in 1.8.0.1.</li>
<li>Lee Morris 2017-03-03

   Closing ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-6742.json">JSON Source</a></p>