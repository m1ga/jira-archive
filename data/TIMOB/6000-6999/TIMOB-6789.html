---
title: "[TIMOB-6789] Android: KrollFunction Doesn't Allow for Return Values"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2011-12-30T16:38:55.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.0.0, Release 1.8.1</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>module_module, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Dawson Toth</td></tr>
<tr><th>Assignee</th><td>Dawson Toth</td></tr>
<tr><th>Created</th><td>2011-12-20T12:38:28.000+0000</td></tr>
<tr><th>Updated</th><td>2014-06-19T12:44:40.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
With the 1.8.0.1 changes and KrollFunction being introduced, return values were overlooked.

<h4>Why it was Overlooked</h4>
Nothing in core or our private modules utilizes this portion of the API. But our demo module in the public repository makes use of it, and there may be third party developers that are using it.

<h4>How to Test</h4>
Create a new module:
{quote}
titanium create --type=module --name=testcb --id=ti.testcb --platform=android
{quote}

Update the TestcbModule.java:
<code><pre>
package ti.testcb;

import java.util.HashMap;

import org.appcelerator.kroll.KrollModule;
import org.appcelerator.kroll.KrollFunction;
import org.appcelerator.kroll.annotations.Kroll;

@Kroll.module(name="Testcb", id="ti.testcb")
public class TestcbModule extends KrollModule
{
        public TestcbModule()
        {
                super();
        }

        @Kroll.method     
        public String initiateCrank(KrollFunction crank) {
                return crank.call(getKrollObject(), new HashMap()).toString();
        }
}
</pre></code>

Update the example/app.js:

<code><pre>
var win = Ti.UI.createWindow({
        backgroundColor: '#fff'
});
win.add(Ti.UI.createLabel({
        text: require('ti.testcb').initiateCrank(function() {
                return 'PASS: Is your refrigerator running? Tee hee.';
        }) || 'FAIL: Critical failure of joke Kroll traversal!'
}));
win.open();
</pre></code>

<h4>Pull Request</h4>
Master: <a href="https://github.com/appcelerator/titanium_mobile/pull/1072" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/1072</a>
1_8_X: <a href="https://github.com/appcelerator/titanium_mobile/pull/1073" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/1073</a>

<h3>Comments</h3>

<ol>
<li>Wilson Luu 2012-01-12

   Closing bug. Verified fix on:
   
   SDK build: 1.9.0.v20120112104633
   Runtime: V8, Rhino
   Titanium Studio, build: 1.0.8.201201111843
   Device: Droid 3 (2.3.4)</li>
</ol>


<p><a href="/TIMOB/TIMOB-6789.json">JSON Source</a></p>