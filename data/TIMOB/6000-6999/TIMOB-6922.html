---
title: "[TIMOB-6922] Android: Network - HTTPClient cannot retrieve non-ascii data"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-04-18T10:38:13.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.7.5, Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.0.2, Release 2.1.0, Sprint 2012-08, Release 1.8.3</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>SupportTeam, api, parity</td></tr>
<tr><th>Reporter</th><td>Felix Alcala</td></tr>
<tr><th>Assignee</th><td>Ping Wang</td></tr>
<tr><th>Created</th><td>2011-10-23T13:15:03.000+0000</td></tr>
<tr><th>Updated</th><td>2012-05-07T16:17:40.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>

When loading some JSON file (UFT-8) from the web and displaying the data, the Non-Ascii-chars text is garbled.

See attached screenshot of this problem on 1.7.2

Note that this works fine on iPhone.

The Kitchen Sink Demo of XHR has the same problem. It works on the iPhone but fails on Android.

<h4>Test case</h4>

<code><pre>
Ti.UI.setBackgroundColor('#ddd'); 
var win = Ti.UI.createWindow({});

var loadDataButton = Ti.UI.createButton({
  title: "Let's load UTF-8 from the web!", width: 260, top: 50, height: 40
});
win.add(loadDataButton);
loadDataButton.addEventListener('click', function() {
  var test1 = loadFromWeb("<a href="http://crossplattformvergleich.dnsalias.org/test.js" rel="nofollow" target="_blank">http://crossplattformvergleich.dnsalias.org/test.js</a>");  /* file contains in UTF8: { "result" : "áäüÖßÉ?" }  and a comment */
  var test2 = loadFromWeb("<a href="http://crossplattformvergleich.dnsalias.org/test2.js" rel="nofollow" target="_blank">http://crossplattformvergleich.dnsalias.org/test2.js</a>");  /* this is a 36-byte file. Appears as 0 bytes on android */
});

function loadFromWeb(url) {
  var asyncRequest = Ti.Network.createHTTPClient();
  asyncRequest.timeout = 30*1000;
  asyncRequest.open("GET", url); 
  asyncRequest.onload = loadCallback;
  asyncRequest.send();
}

function loadCallback() {
  alert(this.responseText);
}

win.open();
</pre></code>

<h4>Discussions</h4>

Q&A: [problem fetching uft-8 content on android](<a href="http://developer.appcelerator.com/question/126712/problem-fetching-uft-8-content-on-android#comment-101538)" rel="nofollow" target="_blank">http://developer.appcelerator.com/question/126712/problem-fetching-uft-8-content-on-android#comment-101538)</a>


<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-6922_24867/00000028.png">00000028.png</td></td><td>2011-12-29T06:15:44.000+0000</td><td>163773</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Paul Dowsett 2011-12-29

   Thanks for raising this ticket, Felix. Please note the changes I have made, that were necessary before I could escalate it. Keeping to the [How to Submit a Bug Report](<a href="https://wiki.appcelerator.org/display/guides/How+to+Submit+a+Bug+Report)" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides/How+to+Submit+a+Bug+Report)</a> guide means that your tickets can be escalated more quickly.
   
   Hence, all information must be included in the ticket, rather than rely on external sources.
   
   Regarding the following, note that a ticket may only describe a single bug. If you have found a second bug, please raise another ticket.
   
   <code><pre>
   Also, I found another bug where an UTF-8 file fetched by android is very small (&lt; 50 bytes), then in the callback this.responseText is NULL. On the iPhone, it all works as intended.
   </pre></code>
   
   I will move this to the main project now.
   
   Cheers
   </li>
<li>Natalie Huynh 2012-05-07

   Tested with 2.0.2.v20120505151714 with Samsung Nexus S 4.0.4</li>
</ol>


<p><a href="/TIMOB/TIMOB-6922.json">JSON Source</a></p>