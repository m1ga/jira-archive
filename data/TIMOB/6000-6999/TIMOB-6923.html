---
title: "[TIMOB-6923] iOS: App.iOS - LocalNotification scheduled from a background process dismiss after 40 seconds"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2017-05-02T22:04:11.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Jeevan Takhar</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2011-11-08T16:14:30.000+0000</td></tr>
<tr><th>Updated</th><td>2017-05-02T22:04:11.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>

* [Titanium.App.iOS.LocalNotification](<a href="http://developer.appcelerator.com/apidoc/mobile/latest/Titanium.App.iOS.LocalNotification-object)" rel="nofollow" target="_blank">http://developer.appcelerator.com/apidoc/mobile/latest/Titanium.App.iOS.LocalNotification-object)</a> notifications scheduled from a background process last for exactly 40 seconds
* Firing an event from a background process causing app.js to schedule a local notification does not solve the problem. In this case the notification lasts for exactly 30 seconds

Note that Local notifications scheduled directly from <code>app.js</code> work as expected (last forever)

<h4>Test case</h4>

<code><pre>
Ti.Geolocation.purpose = 'Geolocation';
Ti.App.service = Ti.App.iOS.registerBackgroundService({url: 'service.js'});
</pre></code> 

<code><pre>
var fired = false;

function location(e) {
    if (e.error) { return false; };
    if (fired === false) {
        fired = true;
        var notification = Ti.App.iOS.scheduleLocalNotification({
            alertBody:"Bananas was put in background",
            alertAction:"Re-Launch!",
            userInfo:{"hello":"world"},
            date:new Date(new Date().getTime() + 1000) // 1 second after backgrounding
        });
    Ti.Geolocation.removeEventListener('location', location);
    };
    return;
};

Ti.Geolocation.addEventListener('location', location);
Ti.App.service.addEventListener('stop', function() {
    Ti.Geolocation.removeEventListener('location', location);
});
</pre></code> 


<h4>Discussions</h4>

Helpdesk: [APP-564871](<a href="http://support.appcelerator.com/tickets/APP-564871)" rel="nofollow" target="_blank">http://support.appcelerator.com/tickets/APP-564871)</a>

<h3>Comments</h3>

<ol>
<li>Paul Dowsett 2011-12-29

   Thanks for raising this ticket.
   
   Please check the environment field against the [JIRA Ticket Checklist](<a href="https://wiki.appcelerator.org/display/guides/How+to+Submit+a+Bug+Report#HowtoSubmitaBugReport-JIRATicketChecklist)" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides/How+to+Submit+a+Bug+Report#HowtoSubmitaBugReport-JIRATicketChecklist)</a>, and add any missing information.
   
   I will mark this resolved for now. Please reopen it once it is complete, and I will move it to the main project.
   
   Cheers</li>
<li>Jeevan Takhar 2011-12-29

   I've updated the field with relevant information.</li>
<li>Gruber Krist√≥f 2012-01-12

   I think the main issue is this:
   
   "Based on my understanding of the titanium source when you create a new notification they return a TiAppiOSLocalNotificationProxy....which you cannot really do anything with such as save it to a property or anything. However, as soon as the proxy loses scope and it gets cleared up the dealloc will cause the notification to be cancelled. This is one reason in the KitchenSink example the notifications are included in the background example, because with their implementation if you closed the app and still didn't have a variable holding on to it....it would cancel the notification. This is not a requirement in normal iOS but with the Titanium implementation you have to hold on to the variable."</li>
<li>Lee Morris 2017-05-02

   Resolving ticket as Invalid as there is now a new version of Kitchen Sink available and we no longer support the version which relates to this ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-6923.json">JSON Source</a></p>