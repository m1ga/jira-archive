---
title: "[TIMOB-7039] iOS: Network - HTTPClient over SSL generates ASIHTTPRequestErrorDomain error"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2012-02-09T23:53:24.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Gerry High</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2011-12-15T21:03:49.000+0000</td></tr>
<tr><th>Updated</th><td>2012-02-09T23:53:24.000+0000</td></tr>
</table>

<h3>Description</h3>



<h3>Comments</h3>

<ol>
<li>Gerry High 2011-12-15

   Fix is in this article: <a href="http://stackoverflow.com/questions/7792949/ios-5-https-asihttprequest-stop-working" rel="nofollow" target="_blank">http://stackoverflow.com/questions/7792949/ios-5-https-asihttprequest-stop-working</a>
   
   
   In our setup the problem was fixed by inserting
   
   [sslProperties setObject:(NSString *)kCFStreamSocketSecurityLevelSSLv3 forKey:(NSString *)kCFStreamSSLLevel];
   just above
   
   CFReadStreamSetProperty((CFReadStreamRef)[self readStream], kCFStreamPropertySSLSettings, sslProperties);
   </li>
<li>Paul Dowsett 2011-12-19

   Thank you for raising this ticket.
   
   If you are able to provide all the information described in the [JIRA Ticket Checklist](<a href="http://wiki.appcelerator.org/display/guides/How+to+Submit+a+Bug+Report#HowtoSubmitaBugReport-JIRATicketChecklist)" rel="nofollow" target="_blank">http://wiki.appcelerator.org/display/guides/How+to+Submit+a+Bug+Report#HowtoSubmitaBugReport-JIRATicketChecklist)</a> guidelines, *in the correct fields and using the right format*, I will be able to escalate it to the core team. Please click *edit* to amend the body of the ticket, rather than adding a comment. Remember to include a test case.
   
   I will mark this resolved for now. Please reopen when the ticket is complete.
   
   Thanks in advance.</li>
<li>Paul Dowsett 2011-12-20

   Gerry, thank you for updating the ticket.
   
   Would you mind sending the test case to community [at] appcelerator.com? You can mark it "Not to be shared publicly", if it is private.
   
   Kind regards
   
   
   </li>
<li>Gerry High 2011-12-22

   I provided a URL to test via email.  This is still marked as resolved.  Can you comment as to whether you have the information  you need to repro?  Thanks.</li>
<li>Paul Dowsett 2011-12-22

   I am very sorry, Gerry, but I did not receive the email :/  Would you check the address and send again?
   
   There should be a button at the top of this ticket to reopen it.
   
   Cheers</li>
<li>Gerry High 2011-12-22

   I resent it to community@appcelerator.com and jira@appcelerator.com.  I guess I'm blind but don't see a button at the top of this ticket to reopen it.</li>
<li>Gerry High 2011-12-27

   Paul--can you comment on how I'm supposed to re-open this ticket?
   
   Gerry</li>
<li>Gerry High 2012-01-04

   Just following up as I haven't gotten a response since 12/22.</li>
<li>Paul Dowsett 2012-01-04

   Gerry, would you please resend the email. We have not received it.
   
   Thank you</li>
<li>Gerry High 2012-01-08

    Paul--I've resent it multiple times.  Are you certain you have not gotten it?  Thanks.</li>
<li>Paul Dowsett 2012-01-08

    Gerry, I can't find it. Send it again, today, and let me know when you have done so. I will check as soon as I see your comment.
    
    Thank you</li>
<li>Stephen Tramer 2012-01-09

    We already offer TLS versioning on clients in iOS. Please see this document:
    
    <a href="http://developer.appcelerator.com/apidoc/mobile/latest/Titanium.Network.HTTPClient.tlsVersion-property.html" rel="nofollow" target="_blank">http://developer.appcelerator.com/apidoc/mobile/latest/Titanium.Network.HTTPClient.tlsVersion-property.html</a>
    
    This ticket will be closed as WON'T FIX once it is confirmed that this feature solves the issue.</li>
<li>Gerry High 2012-01-09

    Yeah, I tried that but it makes no difference.  It fails the same way. And if you look at the code in ASIHTTPRequest.m this is what I see:
    
    With tlsVersion set to 1.2 you get this line of code executed:
    
       [sslProperties setObject:sslVersion forKey:(NSString*)kCFStreamSSLLevel];
    
    where sslVersion becomes: "kCFStreamSocketSecurityLevelTLSv1_2SSLv3"
    
    versus this line which I had to add to make it work:
    
       [sslProperties setObject:(NSString *)kCFStreamSocketSecurityLevelSSLv3 forKey:(NSString *)kCFStreamSSLLevel];   
    
    I'm not sure how iOS is handling the difference between the 2 strings but can tell you that the first string does not work with my SSL service.</li>
<li>Mauro Parra-Miranda 2012-01-11

    Hello,
    the customer's mobilesdk was tainted. He downloaded the sdk again, and everything worked just fine. 
    
    Closing. 
    
    Mauro</li>
<li>Mauro Parra-Miranda 2012-01-11

    Fixed. Customer's mobilesdk was corrupted. He downloaded it again and everything worked as expected. </li>
<li>Gerry High 2012-01-11

    Huh? I think you are mistaken with someone else? I never indicated that my sdk was corrupted.  Was there someone else you are thinking of?</li>
<li>Stephen Tramer 2012-01-11

    This may need to be reopened so that we can support legacy servers (or protocols?) which don't even support TLS 1.0 and only accept SSLv3.</li>
<li>Neeraj Gupta 2012-01-12

    Reopening this bug based on Gerry's last comment.</li>
<li>Stephen Tramer 2012-01-18

    Gerry -
    
    I don't know if you provided us with the sample code, but <code>tlsVersion</code> <code>Ti.Network.TLS_VERSION_1_0</code> works with the REST request in that. Again, see the documentation I referenced earlier. There is a description of when you need to manually set a lower TLS version than 1.2, and you are required to test these values before submitting a bug regarding SSL connectivity over <code>Ti.Network.HTTPClient</code>.
    
    If setting a <code>tlsVersion</code> lower than 1.2 resolves your issue please inform us so that we can close this bug as INVALID.</li>
<li>Gerry High 2012-01-19

    Stephen-you are correct in that it does work with the 1.0 setting so just mark this as working.
    
    Thanks-Gerry</li>
<li>Thomas Huelbert 2012-01-23

    closing based on Gerry and Steven comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-7039.json">JSON Source</a></p>