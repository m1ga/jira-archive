---
title: "[TIMOB-7249] Android: Intent - getData(), getAction(), and getType() do not work"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-05-02T10:42:22.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.1.0, Sprint 2012-09 Core</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>android, core, dr-list, parity</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Bill Dawson</td></tr>
<tr><th>Created</th><td>2012-01-17T06:53:32.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-24T21:04:18.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>

When deciding how an app should handle an incoming Android Intent, knowing the type, action, and data values that were sent with the Intent are critical. If your app only handles one very specific Intent, this is OK, but if you have an app that handles images, URIs, video,, etc... you need to know these values. 

Right now when an Intent is received via Intent Filter in Titanium, the following lists the values/errors you will get for the data, type, and action functions and properties of an Intent:

* <code>getData()</code> always equals <code>null</code> 
* <code>getType()</code> and <code>getAction()</code> always throw this exception, despite the fact that logic and documentation dictates that these functions do not require arguments:
<code><pre>Uncaught Error: Requires property name as first argument</pre></code>
* The <code>data</code> property always returns <code>null</code>
* The <code>action</code> and <code>type</code> properties always return <code>undefined</code>

<h4>Proposed Solution</h4>

The above listed functions and properties need to return the appropriate values for <code>data</code>, <code>type</code>, and <code>action</code> so that developers will know what to do with the Android Intent that they are receiving. Like I said, if you are handling only one type of data as dictated by your Intent Filter, you are OK. But if you plan to handle images, video, etc... and you need to read them from Ti.Android.EXTRA_STREAM, you have no way of knowing which type of Intent you are receiving.

Also, I believe the implementation of <code>getAction()</code> and <code>getType()</code> need to change so that they do not require a parameter.

<h4>Test Case</h4>

<code><pre>
var win = Ti.UI.createWindow({
    backgroundColor: '#fff',
    fullscreen: false,
    exitOnClose: true
});
win.addEventListener('open', function(e) {
    var intent = Ti.Android.currentActivity.getIntent();
    var iname = Ti.Android.EXTRA_STREAM;
 
    if (intent && intent.hasExtra(iname)) {
    	Ti.API.info(intent.getAction());
    	Ti.API.info(intent.getData());
    	Ti.API.info(intent.getType());
    } else {
        Ti.API.info('No extra named "' + iname + '" found in Intent');
    }
});
win.open();
</pre></code>

It will also be necessary to add an intent filter to a custom AndroidManifest.xml to get this test case to receive intents. The only below needs to go in the main activity and will receive all image share intents. You can easily trigger an image share intent by long clicking on an image in the android gallery then select 'share' from the intent list. Then just select your test case app from the list.

<code><pre>
&lt;intent-filter&gt;
    &lt;action android:name="android.intent.action.SEND" /&gt;
    &lt;category android:name="android.intent.category.DEFAULT" /&gt;
    &lt;data android:mimeType="image/*" /&gt;
&lt;/intent-filter&gt;
</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-7249_34845/Jan18.txt">Jan18.txt</td></td><td>2013-01-18T15:17:05.000+0000</td><td>2914</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Tony Lukasavage 2012-01-17

   If you need a test case, let me know, but this should be present in all handling of Android Intents. It's also worth noting that my testing was done using the <code>Ti.Android.EXTRA_STREAM</code> extra. No handling of the actual Intent stream data is necessary to create the above issues, though.</li>
<li>Allen Yeung 2012-04-26

   Hey Tony, would it possible to provide a test case?  I checked the methods on the android side and getType() and getAction() don't require any arguments, so I'm not sure what the issue is there.  If you could provide a test case that reproduces the failure, that would be great.</li>
<li>Tony Lukasavage 2012-04-27

   Test case added. Every run will result in the errors I've listed above. I am aware that getType() and getAction() _should not_ require arguments, but they throw an exception if they are not supplied with one.</li>
<li>Josh Roesslein 2012-04-27

   Looks like this is the same issue as TIMOB-8751. Looks like an easy fix, will have a PR ready soon.</li>
<li>Bill Dawson 2012-05-01

   <h4>Testing Notes</h4>
   
   Use the test case in the description of this JIRA item, except change the line...
   
   <code><pre>
   Ti.API.info(intent.getData());
   </pre></code>
   
   ... to ...
   
   <code><pre>
   Ti.API.info(intent.getStringExtra(Ti.Android.EXTRA_STREAM));
   </pre></code>
   
   ... because Gallery puts the Uri to the selected image in that instead of the <code>data</code> property.
   
   I expanded the utility of <code>getStringExtra</code> such that if it doesn't find a string extra with the given name, it will also try <code>getParcelableExtra</code> with the given name and, if it finds a result, return the <code>toString()</code> value of it.  This is useful because it would be hard for us to support <code>getParcelableExtra</code> given the myriad of possible return types it has.  Unfortunately, one of the most common intent properties, <code>Intent.EXTRA_STREAM</code>, is retrievable only as a parcelable extra, so it would suck to not have access to that.  Thus the expanded capability of <code>getStringExtra</code> at least helps with things like Uris, since their string representations are reasonable equivalents of their actual value.</li>
<li>Bill Dawson 2012-05-01

   Pull request
   
   <a href="https://github.com/appcelerator/titanium_mobile/pull/2114" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/2114</a></li>
<li>Olga Romero 2013-01-18

   Need additional review.
   Tested with:
   Titanium Studio, build: 3.0.1.201212181159
   Titanium SDK, build: 3.0.2.v20130117161659
   Devices:
   Droid3 4.0.3
   Nexus4 4.2
   Actual result:
   See log for details (Jan18.txt)</li>
<li>Lee Morris 2017-03-24

   Closing ticket as fixed with reference to previous comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-7249.json">JSON Source</a></p>