---
title: "[TIMOB-7501] Android: Network.createHTTPClient - URL not encoded correctly with autoEncodeUrl enabled"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2017-06-12T22:43:33.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.1</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Justin Szczurowski</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2012-01-29T06:51:43.000+0000</td></tr>
<tr><th>Updated</th><td>2017-06-12T22:43:33.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>

Using HTTPClient, the URL is not encoded properly with the <code>autoEncodeUrl</code> property set to true (default).

<h4>Test case</h4>

<code><pre>
var socket = Ti.Network.createHTTPClient();

socket.onload = function(){
  /*
    Returns:  <a href="http://www.bosscube.com/flash/clock.swf?param1=%20&param2=%EF%BF%BD%EF%BF%BD" rel="nofollow" target="_blank">http://www.bosscube.com/flash/clock.swf?param1=%20&param2=%EF%BF%BD%EF%BF%BD</a>
    Expected: <a href="http://www.bosscube.com/flash/clock.swf?param1=%20&param2=%25" rel="nofollow" target="_blank">http://www.bosscube.com/flash/clock.swf?param1=%20&param2=%25</a>
  */
  alert(this.location);
  Ti.API.info('this.location: ' + this.location);
};

socket.open("GET", "<a href="http://www.bosscube.com/flash/clock.swf?param1=&param2=%" rel="nofollow" target="_blank">http://www.bosscube.com/flash/clock.swf?param1=&param2=%</a>");
socket.send();
</pre></code>

<h4>Logs</h4>
<code><pre>
  778          AndroidRuntime  D  &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; AndroidRuntime START &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
  778          AndroidRuntime  D  CheckJNI is ON
  778          AndroidRuntime  D  --- registering native functions ---
   60         ActivityManager  I  Starting activity: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=com.appcelerator.testing10/.Testing10Activity }
   60         ActivityManager  I  Start proc com.appcelerator.testing10 for activity com.appcelerator.testing10/.Testing10Activity: pid=784 uid=10040 gids={1015, 3003}
  778          AndroidRuntime  D  Shutting down VM
  784           TiApplication  I  (main) [0,0] checkpoint, app created.
  784           TiApplication  I  (main) [391,391] Titanium 1.8.1 (2012/01/27 17:31 a24502a)
  784               TiFastDev  D  (main) [94,485] Enabling Fastdev on port 33817
  784               TiFastDev  D  (main) [9,494] sent tokens successfully
  784               TiFastDev  D  (main) [1,495] Fastdev session handshake succesful.
  784           TiApplication  I  (main) [9,504] Titanium Javascript runtime: v8
  784           TiApplication  W  (main) [61,565] activity stack is emtpy, unable to get current activity
  784          TiRootActivity  I  (main) [0,0] checkpoint, on root activity create, savedInstanceState: null
  784           TiApplication  W  (main) [119,119] activity stack is emtpy, unable to get current activity
  784           TiApplication  W  (main) [0,119] activity stack is emtpy, unable to get current activity
  784           TiApplication  W  (main) [2,121] activity stack is emtpy, unable to get current activity
  784           TiApplication  E  (KrollRuntimeThread) [922,1043] APP PROXY: ti.modules.titanium.app.AppModule@44f0ced8
  784           TiAssetHelper  D  Fetching "app.js" with Fastdev...
   60     NotificationService  W  Object died trying to hide notification android.app.ITransientNotification$Stub$Proxy@4513c8a0 in package com.appcelerator.testing10
   60         ActivityManager  W  setProcessForeground called on unknown pid: 755
  784           dalvikvm-heap  I  Grow heap (frag case) to 2.932MB for 69224-byte allocation
  784            TiHttpClient  D  (KrollRuntimeThread) [442,1485] Setting ready state to 1
  784          TiRootActivity  I  (main) [0,0] checkpoint, on root activity resume. activity = com.appcelerator.testing10.Testing10Activity@44eba488
   60         ActivityManager  I  Displayed activity com.appcelerator.testing10/.Testing10Activity: 3155 ms (total 3155 ms)
  784            TiHttpClient  D  (TiHttpClient-1) [968,968] Setting ready state to 2
  784            TiHttpClient  D  (TiHttpClient-1) [2,970] Setting ready state to 3
  784            TiHttpClient  D  (TiHttpClient-1) [158,1128] Setting ready state to 4
  784                   ALERT  I  (KrollRuntimeThread) [4,1132] <a href="http://www.bosscube.com/flash/clock.swf?param1=&param2=%EF%BF%BD%EF%BF%BD" rel="nofollow" target="_blank">http://www.bosscube.com/flash/clock.swf?param1=&param2=%EF%BF%BD%EF%BF%BD</a>
  784                   TiAPI  I  this.location: <a href="http://www.bosscube.com/flash/clock.swf?param1=&param2=0.000000E+00FBFBD1.237263E-317FBFBD" rel="nofollow" target="_blank">http://www.bosscube.com/flash/clock.swf?param1=&param2=0.000000E+00FBFBD1.237263E-317FBFBD</a>
  784           TypeConverter  W  jsValueToJavaObject returning null
</pre></code>


<h4>Related Issues</h4>

I've also noticed that parts of the URL are encoded that shouldn't be.  For example:

<code><pre>
var socket = Ti.Network.createHTTPClient();

socket.onload = function() {
    /*
        Returns:  <a href="http://www.example.com/abcdef%3D%3D?param1=example" rel="nofollow" target="_blank">http://www.example.com/abcdef%3D%3D?param1=example</a>
        Expected: <a href="http://www.example.com/abcdef==?param1=example" rel="nofollow" target="_blank">http://www.example.com/abcdef==?param1=example</a>
    */
    alert(this.location);
};

socket.open("GET", "<a href="http://www.example.com/abcdef==?param1=example" rel="nofollow" target="_blank">http://www.example.com/abcdef==?param1=example</a>");
socket.send();
</pre></code>


<h3>Comments</h3>

<ol>
<li>Paul Dowsett 2012-01-30

   Thanks for raising this ticket.
   
   In order for me to escalate it to the core team, please would you complete the environment field?
   
   Also, a console log of the test case in action would be appreciated.
   
   Please review the [JIRA Ticket Checklist](<a href="https://wiki.appcelerator.org/display/guides/How+to+Submit+a+Bug+Report#HowtoSubmitaBugReport-JIRATicketChecklist)" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides/How+to+Submit+a+Bug+Report#HowtoSubmitaBugReport-JIRATicketChecklist)</a> when raising tickets, and always start with the [JIRA Ticket Template](<a href="https://wiki.appcelerator.org/display/guides/JIRA+Ticket+Template)" rel="nofollow" target="_blank">https://wiki.appcelerator.org/display/guides/JIRA+Ticket+Template)</a> to ensure they are in the recommended format.
   
   Thanks</li>
<li>Lee Morris 2017-06-12

   Closing ticket due to the time passed, lack of information and lack of progress. Any problems, please file a new ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-7501.json">JSON Source</a></p>