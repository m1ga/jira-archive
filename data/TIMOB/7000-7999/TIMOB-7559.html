---
title: "[TIMOB-7559] iOS: CommonJS require: undeclared variable referenced from module fails to generate error"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Do</td></tr>
<tr><th>Resolution Date</th><td>2020-01-09T19:48:22.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.0.1, Release 2.0.0, Release 1.8.1, Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>parity</td></tr>
<tr><th>Reporter</th><td>Dustin Hyde</td></tr>
<tr><th>Assignee</th><td>Ingo Muschenetz</td></tr>
<tr><th>Created</th><td>2012-02-06T16:36:11.000+0000</td></tr>
<tr><th>Updated</th><td>2020-01-09T19:48:22.000+0000</td></tr>
</table>

<h3>Description</h3>

Undeclared variables referenced from a module fail to generate an error. Android does generate the error. Screenshot attached.

The undeclared variable can then be used in further logic, such as adding it to a window. Screenshot attached.

If an undeclared variable is used in the module itself, there is an error.
If an undeclared variable is returned from an exports function-call, there is an error.
If an undeclared variable is defined as a return value in an exports function, but the function is never called, there is no error.
If an undeclared variable is returned from an exports function-call and assigned to a new variable outside the module, there is no error, and the variable can continue to be used.

Steps to Reproduce:

1. Run Code (also attached):

<code><pre>
var undeclaredVar = require('Module').getUndeclaredVar();

Ti.UI.createWindow().add(undeclaredVar);
</pre></code>

<code><pre>
exports.getUndeclaredVar = function()
{
	return undeclaredVar;
};
</pre></code>

Expected Result:

Runtime error indicating undeclared variable.

Actual Result:

No runtime error.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-7559_25632/android.png">android.png</td></td><td>2012-02-06T16:36:11.000+0000</td><td>75640</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-7559_25633/ios - undeclared var added to window.png">ios - undeclared var added to window.png</td></td><td>2012-02-06T16:36:11.000+0000</td><td>96191</td></tr>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-7559_25631/RequireTest.zip">RequireTest.zip</td></td><td>2012-02-06T16:36:11.000+0000</td><td>2322325</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Ivan Skugor 2012-02-07

   Hi.
   
   
   This should be duplicate (I think).
   
   
   The problem is that global variables are still allowed in CommonJS implementation on iOS (so, the problem is not undeclared variable as test case suggests).
   
   
   "undeclaredVar" is actually in global scope (in "app.js"). Since there is a bug on iOS that allows referening global scope variables from module scope, when "getUndeclaredVar" is called from module scope, it references "undeclaredVar" global variable and therefore does not produce JS reference error.
   
   
   Change "undeclaredVar" to "undeclaredGlobalVar" and error should be thrown.</li>
<li>Neeraj Gupta 2012-02-07

   This issue can be taken up during JSCore upgrade.</li>
<li>Ivan Skugor 2012-02-08

   </li>
<li>Shameer Jan 2013-04-19

   Issue reproduces 
   
   Tested with
   
   Titanium Studio, build: 3.0.1.201212181159
   Titanium SDK version: 3.1.0 
   Titanium SDK version: 3.0.2 
   iOS iPhone Simulator: iOS SDK version: 6.0
   </li>
<li>Alan Hutton 2020-01-09

   It has been decided that this issue should be closed as “Won’t do.” This issue is out of date with our current supported SDK release (7.5.2.GA as of the date of closure), and out of date with mobile OS versions. 
   
   If community members feel that the issue is still valid, please create a new ticket. Please reference this closed ticket number, include SDK used, comments, and code that demonstrates/reproduces the issue.</li>
</ol>


<p><a href="/TIMOB/TIMOB-7559.json">JSON Source</a></p>