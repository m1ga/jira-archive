---
title: "[TIMOB-7642] iOS: Memory Leak when local html file is used in a WebView"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-04-19T13:19:58.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.1</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2012-04, Release 2.0.0, Release 1.8.3</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>memory, module_webview, qe-testadded, webview</td></tr>
<tr><th>Reporter</th><td>Sandeep Bhimavarapu</td></tr>
<tr><th>Assignee</th><td>Max Stepanov</td></tr>
<tr><th>Created</th><td>2012-02-13T19:07:37.000+0000</td></tr>
<tr><th>Updated</th><td>2012-04-19T13:19:58.000+0000</td></tr>
</table>

<h3>Description</h3>

Memory is not being released when a webview, with a local HTML file, is added to a window and then removed from it. But this does not happen when a remote URL is used. Below is the sample code and the local HTML file has been attached.

*Sample Code*
{noformat}
var win = Ti.UI.createWindow({
    backgroundColor : 'white'
});

var webview = null;

var btnAdd = Ti.UI.createButton({
    title : 'Add',
    top : 0,
    left : 0,
    height : 50,
    width : 100
});

btnAdd.addEventListener('click', function() {
    webview = Ti.UI.createWebView({
        url : 'local_webview.html',
        // url : '<a href="http://www.google.com" rel="nofollow" target="_blank">http://www.google.com</a>',
        height : 200,
        bottom : 10
    });
    
    win.add(webview);
});

var btnRemove = Ti.UI.createButton({
    title : 'Remove',
    top : 0,
    right : 0,
    height : 50,
    width : 100
});

btnRemove.addEventListener('click', function() {
    win.remove(webview);
    webview = null;
});
win.add(btnAdd);
win.add(btnRemove);
win.open();
{noformat}

*STEPS TO REPRODUCE*
- Drop the above sample code into app.js and copy the attached 'local_webview.html' to Resources folder.
- Start the application and open Instruments to profile it.
- Click the 'Add' button and then the 'Remove' button.
- Search for 'proxy' in instruments and it can be seen that webview proxies are not released even if memory warnings are simulated.

*EXPECTED BEHAVIOR*
Proxies related to webview should be released.

*OBSERVED BEHAVIOR*
Memory is not being freed.

*OTHER OBSERVATIONS*
Memory is being freed when a remote URL (uncomment the line with google.com and comment out the line with local_webview.html) is used.

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-7642_25757/local_webview.html">local_webview.html</td></td><td>2012-02-13T19:07:37.000+0000</td><td>1021</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Michael Pettiford 2012-03-19

   Reopening issue
   
   Tested with Ti Studio build 2.0.0.201203182248
   Ti Mob SDK 2.0.0.v20120319003254 hash r60b6da4c
   OSX Lion 10.7.3
   iPhone 4 OS 5.0.1
   
   I'm still seeing the fail case as noted in the ticket. When I change the url it works as expected.</li>
<li>Max Stepanov 2012-03-19

   To force JS GC on a device: press Home button, launch another app (Stocks/Clock), return back to the app.</li>
<li>Michael Pettiford 2012-03-19

   Closing issue
   
   Tested with Ti Studio build 2.0.0.201203182248
   Ti Mob SDK 2.0.0.v20120319003254 hash r60b6da4c
   OSX Lion 10.7.3
   iPhone 4 OS 5.0.1
   
   *Note that in instruments > allocations hit the info button and deselect the option for only track active allocations*
   
   Verified that the proxy is being released
   </li>
<li>Stephen Tramer 2012-03-29

   Reopening to fixversion</li>
<li>Michael Pettiford 2012-04-19

   Reopening/closing to add/remove labels</li>
</ol>


<p><a href="/TIMOB/TIMOB-7642.json">JSON Source</a></p>