---
title: "[TIMOB-7668] iOS: Facebook - login in with dialog produces (NSURLErrorDomain error -999.) error"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Open</td></tr>
<tr><th>Resolution</th><td>Unresolved</td></tr>

<tr><th>Affected Version/s</th><td>Release 1.7.5, Release 1.8.0.1, Release 1.8.1, Release 3.0.2</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Jon Alter</td></tr>
<tr><th>Assignee</th><td>Unknown</td></tr>
<tr><th>Created</th><td>2012-02-15T13:10:11.000+0000</td></tr>
<tr><th>Updated</th><td>2018-03-06T18:58:01.000+0000</td></tr>
</table>

<h3>Description</h3>

Logging into facebook using the facebook dialog causes this error "The operation couldn't be completed. (NSURLErrorDomain error -999.)".

<h4>Steps to reproduce:</h4>
Step 1: run the code below
Step 2: click on the window
Step 3: enter your facebook creds and hit Login
Step 4: notice that the dialog closes
Step 5: check the console and see the error below
<code><pre>
{"type":"result","source":{},"error":"The operation couldn't be completed. (NSURLErrorDomain error -999.)","success":false,"cancelled":false}
</pre></code>
Step 6: notice that the app will sometimes crash at this point
Step 7: click the window again and  you will already be logged in and ready to post

<code><pre>
Titanium.Facebook.appid = '171500626234399';
Titanium.Facebook.permissions = ['publish_stream'];
var win = Ti.UI.createWindow({backgroundColor:'white'});
win.open();
win.addEventListener('click', function(){
	var data = {
	    link: "<a href="http://www.appcelerator.com" rel="nofollow" target="_blank">http://www.appcelerator.com</a>",
	    name: "Appcelerator Titanium Mobile",
	    message: "Checkout this cool open source project for creating mobile apps",
	    caption: "Appcelerator Titanium Mobile",
	    picture: "<a href="http://developer.appcelerator.com/assets/img/DEV_titmobile_image.png" rel="nofollow" target="_blank">http://developer.appcelerator.com/assets/img/DEV_titmobile_image.png</a>",
	    description: "You've got the ideas, now you've got the power.",
	};
	Titanium.Facebook.dialog("feed", data, function(e) {
		Ti.API.info('## FB RESULT: '+JSON.stringify(e) );
	    if (e.success) {
	        alert("Success!  From FB: " + e.result);
	    } else {
	        if (e.error) {
	            alert(e.error);
	        } else if (e.cancelled) {
	            alert('Cancelled');
	        } else {
	            alert("Unkown result");
	        }
	    }
	});
});
</pre></code>

<h3>Comments</h3>

<ol>
<li>Neeraj Gupta 2012-02-16

   Jon - Is this a regression or a new issue?</li>
<li>Pedro Enrique 2012-02-16

   Reproduced this error on 1.7.5 and 1.8.0.1</li>
<li>Jon Alter 2012-02-16

   Works fine if you authorize before showing the dialog. The dialog will authorize you, but it can't authorize and post.
   
   <code><pre>
   Titanium.Facebook.appid = '171500626234399';
   Titanium.Facebook.permissions = ['publish_stream'];
   var win = Ti.UI.createWindow({backgroundColor:'white'});
   win.open();
   win.addEventListener('click', function(){
   	Titanium.Facebook.addEventListener('login', function(e) {
   	    if (e.success) {
   	        // alert('Logged In');
   			var data = {
   			    link: "<a href="http://www.appcelerator.com" rel="nofollow" target="_blank">http://www.appcelerator.com</a>",
   			    name: "Appcelerator Titanium Mobile",
   			    message: "Checkout this cool open source project for creating mobile apps",
   			    caption: "Appcelerator Titanium Mobile",
   			    picture: "<a href="http://developer.appcelerator.com/assets/img/DEV_titmobile_image.png" rel="nofollow" target="_blank">http://developer.appcelerator.com/assets/img/DEV_titmobile_image.png</a>",
   			    description: "You've got the ideas, now you've got the power.",
   			};
   			Titanium.Facebook.dialog("feed", data, function(e) {
   				Ti.API.info('## FB RESULT: '+JSON.stringify(e) );
   			    if (e.success) {
   			        alert("Success!  From FB: " + e.result);
   			    } else {
   			        if (e.error) {
   			            alert(e.error);
   			        } else if (e.cancelled) {
   			            alert('Cancelled');
   			        } else {
   			            alert("Unkown result");
   			        }
   			    }
   			});
   	    } else if (e.error) {
   	        alert(e.error);
   	    } else if (e.cancelled) {
   	        alert("Cancelled");
   	    }
   	});
   	Titanium.Facebook.authorize();
   });
   </pre></code></li>
</ol>


<p><a href="/TIMOB/TIMOB-7668.json">JSON Source</a></p>