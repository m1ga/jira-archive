---
title: "[TIMOB-7713] Parity: Android does not write downloaded file to directory while iOS writes it to the directory"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Low</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Won't Fix</td></tr>
<tr><th>Resolution Date</th><td>2017-07-26T23:46:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 1.8.2</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>TiAPI</td></tr>
<tr><th>Labels</th><td>api, parity</td></tr>
<tr><th>Reporter</th><td>Natalie Huynh</td></tr>
<tr><th>Assignee</th><td>Eric Merriman </td></tr>
<tr><th>Created</th><td>2012-02-17T15:21:08.000+0000</td></tr>
<tr><th>Updated</th><td>2017-07-26T23:46:08.000+0000</td></tr>
</table>

<h3>Description</h3>

Steps to Reproduce:
1. Run the following code:
<code><pre>
var win1 = Titanium.UI.createWindow({  
    title:'Tab 1',
    backgroundColor:'#fff'
});

win1.open();

/*
 * TEST 1.8.X DOWNLOADING THE SAME FILE MULTIPLE TIMES
 * 
 * NOTE: Will need to create: Titanium.Filesystem.applicationDataDirectory + "/projects/" + p[1-5] to write into
 */

for (var i=1; i<=5; i++) {
	var file = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, "projects", "p"+i);
	if (!file.exists()) {
		file.createDirectory(true);
	}
}

function jsleep(s){
	s=s*1000;
	var a=true;
	var n=new Date();
	var w;
	var sMS=n.getTime();
	while(a){
		w=new Date();
		wMS=w.getTime();
		if(wMS-sMS>s) a=false;
	}
}

var button1 = Titanium.UI.createButton({
	top:'10', 
	title:'Test Downloading Same File 5 Times (1.8.X)',
	width:'400',
	height:'40'
});

button1.addEventListener('click', function()
{
downloadafile("p1", "g.jpg", "<a href="http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg" rel="nofollow" target="_blank">http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg</a>");
jsleep(1);
downloadafile("p2", "g.jpg", "<a href="http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg" rel="nofollow" target="_blank">http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg</a>");
//jsleep(1);
downloadafile("p3", "g.jpg", "<a href="http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg" rel="nofollow" target="_blank">http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg</a>");
//jsleep(1);
downloadafile("p4", "g.jpg", "<a href="http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg" rel="nofollow" target="_blank">http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg</a>");
//jsleep(1);
downloadafile("p5", "g.jpg", "<a href="http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg" rel="nofollow" target="_blank">http://www.gonzoville.com/wp-content/uploads/2011/12/0.jpeg</a>");

});

win1.add(button1);

Ti.API.info("BASE PATH: " + Titanium.Filesystem.applicationDataDirectory);


/* NOW LETS MAKE IT WORK WITH 1.8.1 ... NOT! */

function downloadafile(foldername, filename, fileurl) {
	//var file = Ti.Filesystem.pathFromComponents(Ti.Filesystem.applicationDataDirectory, "projects", foldername, filename);
	var c = Titanium.Network.createHTTPClient({
		timeout : 10000,

		onload : function(e) {
			Ti.API.info('LOADED ' + filename + " TO " + foldername);
			Ti.API.info(c.status);
		},
		ondatastream : function(e) {
			Ti.API.info('ONDATASTREAM - PROGRESS: ' + e.progress);
		},
		onerror : function(e) {
			Ti.API.info('XHR Error ' + e.error);
		}
	});
	
	c.clearCookies("all");
	c.open('GET', fileurl);
	c.file = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory + "/projects/" + foldername + "/" + filename);
	c.send();

}
</pre></code>

Actual:
The downloaded files are saved on iOS, but not on Android

Expected:
For files to be saved to Android

<h3>Comments</h3>

<ol>
<li>Lee Morris 2017-07-26

   Closing due to inactivity. If this issue still exists, please raise a new ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-7713.json">JSON Source</a></p>