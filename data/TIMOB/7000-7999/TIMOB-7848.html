---
title: "[TIMOB-7848] Android: Cannot save rotated camera images"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2013-10-29T21:08:02.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.0.0, Release 3.1.0</td></tr>
<tr><th>Fix Version/s</th><td>2013 Sprint 23, 2013 Sprint 23 API</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Varun Joshi</td></tr>
<tr><th>Assignee</th><td>Ping Wang</td></tr>
<tr><th>Created</th><td>2012-02-29T10:36:13.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-23T21:38:23.000+0000</td></tr>
</table>

<h3>Description</h3>

The attached app.js file reproduces the issue. Here are the steps:

1. Start the app and take a picture and save it.
2. It is saved to an imageview. Click on the imageview to rotate the image.
3. Now, you will get an alert showing the location of the rotated image. I have it saved on the sdcard.
4. View the sdcard to see the image (you will need a file manager to view it). 
5. The image is saved as the originally taken and not the rotated.

Here is the sample file:

{noformat}

var win = Titanium.UI.createWindow({
    backgroundColor:'white'
});

Titanium.Media.showCamera({

    success:function(event)
    {
        var cropRect = event.cropRect;
        var image = event.media;

        Ti.API.debug('Our type was: '+event.mediaType);
        if(event.mediaType == Ti.Media.MEDIA_TYPE_PHOTO)
        {
             /********  capture image in a imageView  ********/
            
            var imageView = Ti.UI.createImageView({  
                width:win.width,
                height:win.height,
                image:event.media
            });
            win.add(imageView);
            
            /******** rotate the imageView ************/
           
          var transformCurrentPicture = Titanium.UI.create2DMatrix();
            imageView.addEventListener('click',function(e){
                transformCurrentPicture = transformCurrentPicture.rotate(90);
                imageView.animate({transform:transformCurrentPicture});
                savePhoto('Hello.png',imageView.toBlob());   
            });
           
         
           
           // savePhoto('Hello',imageView.toBlob());         
        }
        else
        {
            alert("got the wrong type back ="+event.mediaType);
        }
    },
    cancel:function()
    {
    },
    error:function(error)
    {
        // create alert
        var a = Titanium.UI.createAlertDialog({title:'Camera'});

        // set message
        if (error.code == Titanium.Media.NO_CAMERA)
        {
            a.setMessage('Please run this test on device');
        }
        else
        {
            a.setMessage('Unexpected error: ' + error.code);
        }

        // show alert
        a.show();
    },
    saveToPhotoGallery:true,
    allowEditing:true,
    mediaTypes:[Ti.Media.MEDIA_TYPE_VIDEO,Ti.Media.MEDIA_TYPE_PHOTO]
});

win.open();

/******* function to save the image **********/

function savePhoto(photoName,photoToSave){
    var photoPath = '';
    var photoDir = '';         
    
    //Check for photo dir and create if not there                   
    
    if (Titanium.Filesystem.isExternalStoragePresent()){                 
        photoDir = Titanium.Filesystem.getFile(Titanium.Filesystem.externalStorageDirectory, 'PlayGroundPhotos');
        if ( ! photoDir.exists()){
            photoDir.createDirectory();                       
        }
    }
 
    //check for photo dir and create if not there locally since no external storage
    
    else{              
        photoDir = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory, 'PlayGroundPhotos');
        if ( ! photoDir.exists()) {
            photoDir.createDirectory();                         
        }
        else{
            alert('photoDir exists');
        }
   }             
        
    //At this point we know if SD card exists and have created photo directory if needed
    
    photoPath = photoDir.nativePath;
    alert('The photopath is: '+photoPath);
    var f = Titanium.Filesystem.getFile(photoPath,photoName);   
    f.write(photoToSave);       
}   



{noformat}

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-7848_36487/1.png">1.png</td></td><td>2013-03-20T09:47:44.000+0000</td><td>509265</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-7848_36488/2.png">2.png</td></td><td>2013-03-20T09:47:44.000+0000</td><td>285136</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-7848_36489/3.png">3.png</td></td><td>2013-03-20T09:47:44.000+0000</td><td>146186</td></tr>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-7848_36490/4.jpg">4.jpg</td></td><td>2013-03-20T09:47:44.000+0000</td><td>2817928</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Shameer Jan 2013-03-20

   It seems to be a bug, Here i attached my observation .
   
   1.After taking photo 
   2.After click save, it shows 90 degree rotated imageview
   3.when clicking on imageview it rotate to original state
   4.photo in sdcard </li>
<li>Ping Wang 2013-10-29

   This is not a valid test case. The method <code><pre>imageView.animate({transform:transformCurrentPicture});</pre></code> only applies a rotation matrix to the canvas to render the imageview but not changes/rotates the image itself. Therefore the saved file is always the original image. Resolved the ticket as Invalid.</li>
<li>Lee Morris 2017-03-23

   Closing ticket as invalid with reference to the previous comments.</li>
</ol>


<p><a href="/TIMOB/TIMOB-7848.json">JSON Source</a></p>