---
title: "[TIMOB-8063] Android: Backing out of a window with its own activity while it's still opening leads to bad state."
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Cannot Reproduce</td></tr>
<tr><th>Resolution Date</th><td>2012-03-17T19:25:46.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>n/a</td></tr>
<tr><th>Reporter</th><td>Josh Roesslein</td></tr>
<tr><th>Assignee</th><td>Josh Roesslein</td></tr>
<tr><th>Created</th><td>2012-03-16T13:44:42.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-27T18:23:39.000+0000</td></tr>
</table>

<h3>Description</h3>

Windows which have their own activity and take a long time to open can crash
the application if the user "backs" out of the new activity before the
window has finished opening. This is mostly seen on emulator which runs into the global
reference count limit due to a large number of Phantom references which build up.

<h4>Test case: Opening a window with a high number of child views.</h4>

This test case is taken from TIMOB-7897 and demonstrates the issue nicely.
Run the application in the emulator. Click the button to load a new window with
a large number of views. Notice the new activity becomes active (black screen).
Hit the back button before the window finishes opening. Repeat this process until you
crash the application due to the global reference limit being reached.

<code><pre>
function mainViews() {
    
    var newWin = Ti.UI.createWindow({ navBarHidden: true });
    
    Ti.API.info('****** mainViews function has started ******');
    var views =[];
    var view = null;
    for (var i=0; i &lt; 500; i++) {
        view = Ti.UI.createView();
        views.push(view);
        newWin.add(view);
    }
    
    
    newWin.open();
    
    alert("You may click back now.");
    
    Ti.API.info('Titanium views created and added to array');
    Ti.API.info('****** mainViews function has stopped ******');
}

var win = Ti.UI.createWindow({
    backgroundColor: "white"
});

var button = Ti.UI.createButton({
    title: "create 5k views"
});
button.addEventListener("click", function(e) {
    mainViews();
    Ti.API.info('Available memory: ' + Ti.Platform.availableMemory);
});

win.add(button);
win.open();
</pre></code>

<h3>Comments</h3>

<ol>
<li>Josh Roesslein 2012-03-17

   Not seeing this issue anymore with latest master and updated test case (views reduced to 500).</li>
<li>Lee Morris 2017-03-27

   Closing ticket as I am unable to reproduce this issue with the following environment;
   Pixel (7.1)
   MacOS 10.11.6 (15G31)
   Studio 4.8.1.201612050850
   Ti SDK 6.0.3 GA
   Appc NPM 4.2.8
   Appc CLI 6.1.0
   Ti CLI 5.0.11
   Alloy 1.9.5
   Arrow 1.10.1
   Xcode 8.2 (8C38)
   Node v4.6.0
   Java 1.7.0_80</li>
</ol>


<p><a href="/TIMOB/TIMOB-8063.json">JSON Source</a></p>