---
title: "[TIMOB-8280] iOS: Titanium.UI.Button: Layout of the button is getting distorted intermittently"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2012-03-27T08:42:43.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.0.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>qe-ios031912</td></tr>
<tr><th>Reporter</th><td>Anshu Mittal</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2012-03-24T13:23:17.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-09T23:14:12.000+0000</td></tr>
</table>

<h3>Description</h3>

Layout of the button is getting distorted intermittently.

Steps to reproduce:
1.Launch app a couple of times.

Expected results:
Should see random numbered buttons in 4 toolbars and will not crash. Layout of all buttons should be correct every time.

Actual:
The layout of the last button gets distorted when test steps are repeated couple of times. Please find the screenshot attached.

App.js
<code><pre>

var win = Ti.UI.createWindow({
    backgroundColor : 'black'
});
        
            var goal = Math.floor(Math.random() * 21) + 10;

            var solutionValue = [];
            solutionValue[0] = Math.floor(Math.random() * (goal - (goal / 2) - 1)) + 1;
            solutionValue[1] = Math.floor(Math.random() * (goal - (goal / 2) - 1)) + 1;
            solutionValue[2] = goal - (solutionValue[0] + solutionValue[1]);

    
            for(var i = 3; i &lt; 12; i++) {
                solutionValue[i] = Math.floor(Math.random() * (goal - (goal / 2) - 1)) + 1;
            }
            Titanium.API.info("Goal: " + goal);
            for( i = 0; i &lt; 12; i++) {
                Titanium.API.info("Solution " + i + ": " + solutionValue[i]);
            }

            // Create a banner with the goal
            var goalLabel = Titanium.UI.createButton({
                title : goal,
                color : '#fff', // white text
                style : Titanium.UI.iPhone.SystemButtonStyle.PLAIN
            });
            win.add(goalLabel);

            var assigned = [];
            for( i = 0; i &lt; 12; i++) {
                assigned[i] = 0;
            }

            var solutionButton = [];
            for( i = 0; i &lt; 12; i++) {
                var valueIndex = Math.floor(Math.random() * 12);
                if(valueIndex == 12) {
                    valueIndex = 11;
                }

                while(assigned[valueIndex] == 1) {
                    valueIndex += 1;
                }
                assigned[valueIndex] = 1;

                Titanium.API.info("Creating a button ...");
                solutionButton[i] = Titanium.UI.createButton({
                    title : solutionValue[valueIndex],
                    style : Titanium.UI.iPhone.SystemButtonStyle.BORDERED
                });
            }

            Titanium.API.info("All buttons created");

            var flexSpace = Titanium.UI.createButton({
                systemButton : Titanium.UI.iPhone.SystemButton.FLEXIBLE_SPACE
            });

            var toolbar = [];
            for( i = 0; i &lt; 4; i++) {
                Titanium.API.info("Creating a toolbar ...");

                toolbar[i] = Titanium.UI.iOS.createToolbar({
                    items : [solutionButton[i], flexSpace, solutionButton[i + 1], flexSpace, solutionButton[i + 2]],
                    top : 40 * i,
                    borderTop : false,
                    borderBottom : true
                });
                win.add(toolbar[i]);
            }

            Titanium.API.info("Opening the window ...");    
    
win.open();

</pre></code>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.titaniumsdk.com/TIMOB/TIMOB-8280_26576/Screenshot 2012.03.23 17.54.23.png">Screenshot 2012.03.23 17.54.23.png</td></td><td>2012-03-24T13:23:17.000+0000</td><td>26844</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Vishal Duggal 2012-03-26

   Need test code</li>
<li>Vishal Duggal 2012-03-27

   The code is adding the same button to different toolbars which will result in undefined behavior on IOS. Use this code instead which ensures that a button is added to a toolbar only once.
   <code><pre>
   var win = Ti.UI.createWindow({
       backgroundColor : 'black'
   });
            
               var goal = Math.floor(Math.random() * 21) + 10;
    
               var solutionValue = [];
               solutionValue[0] = Math.floor(Math.random() * (goal - (goal / 2) - 1)) + 1;
               solutionValue[1] = Math.floor(Math.random() * (goal - (goal / 2) - 1)) + 1;
               solutionValue[2] = goal - (solutionValue[0] + solutionValue[1]);
    
        
               for(var i = 3; i &lt; 12; i++) {
                   solutionValue[i] = Math.floor(Math.random() * (goal - (goal / 2) - 1)) + 1;
               }
               Titanium.API.info("Goal: " + goal);
               for( i = 0; i &lt; 12; i++) {
                   Titanium.API.info("Solution " + i + ": " + solutionValue[i]);
               }
    
               // Create a banner with the goal
               var goalLabel = Titanium.UI.createButton({
                   title : goal,
                   color : '#fff', // white text
                   style : Titanium.UI.iPhone.SystemButtonStyle.PLAIN
               });
               win.add(goalLabel);
    
               var assigned = [];
               for( i = 0; i &lt; 12; i++) {
                   assigned[i] = 0;
               }
    
               var solutionButton = [];
               for( i = 0; i &lt; 12; i++) {
                   var valueIndex = Math.floor(Math.random() * 12);
                   if(valueIndex == 12) {
                       valueIndex = 11;
                   }
    
                   while(assigned[valueIndex] == 1) {
                       valueIndex += 1;
                   }
                   assigned[valueIndex] = 1;
    
                   Titanium.API.info("Creating a button ...");
                   solutionButton[i] = Titanium.UI.createButton({
                       title : solutionValue[valueIndex],
                       style : Titanium.UI.iPhone.SystemButtonStyle.BORDERED
                   });
               }
    
               Titanium.API.info("All buttons created");
    
               var flexSpace = Titanium.UI.createButton({
                   systemButton : Titanium.UI.iPhone.SystemButton.FLEXIBLE_SPACE
               });
    
               var toolbar = [];
               for( i = 0,j=0; i &lt; 12,j&lt;4; j++,i+=3) {
                   Titanium.API.info("Creating a toolbar ...");
    
                   toolbar[j] = Titanium.UI.iOS.createToolbar({
                       items : [solutionButton[i], flexSpace, solutionButton[i + 1], flexSpace, solutionButton[i + 2]],
                       top : 40 * j,
                       borderTop : false,
                       borderBottom : true
                   });
                   win.add(toolbar[j]);
               }
    
               Titanium.API.info("Opening the window ...");    
        
   win.open();
   </pre></code></li>
<li>Lee Morris 2017-03-09

   Closing ticket as invalid.</li>
</ol>


<p><a href="/TIMOB/TIMOB-8280.json">JSON Source</a></p>