---
title: "[TIMOB-9084] iOS: XML xmlns:xmlns definition"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-06-01T17:07:15.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.1.0, Sprint 2012-11 API</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>api, parity, qe-port</td></tr>
<tr><th>Reporter</th><td>Dawson Toth</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2012-05-09T14:55:36.000+0000</td></tr>
<tr><th>Updated</th><td>2012-08-17T12:40:43.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>
When defining namespaces, xmlns:xmlns is explicitly defined. This isn't a valid definition, and if it isn't stripped out, other xml validators or libraries will choke on it.

<h4>Workaround</h4>
Stringify the XML and rip out the xmlns:xmlns attribute.

<h4>Reproduction</h4>
<code><pre>
(function (document, Ti) {
    document = document || Ti && Ti.XML.parseString('&lt;a/&gt;');

    function xmlAddNamespaceAttribute(domNode, name, attributeNamespace) {
        var doc = domNode.ownerDocument || document;
        var attribute = doc.createAttributeNS('<a href="http://www.w3.org/2000/xmlns/" rel="nofollow" target="_blank">http://www.w3.org/2000/xmlns/</a>', name);
        attribute.nodeValue = attributeNamespace;
        (domNode.documentElement || domNode).setAttributeNode(attribute);
    }

    var feed = document.implementation.createDocument('<a href="http://www.w3.org/2005/Atom" rel="nofollow" target="_blank">http://www.w3.org/2005/Atom</a>', 'atom:feed', null);
    xmlAddNamespaceAttribute(feed, "xmlns:m", '<a href="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" rel="nofollow" target="_blank">http://schemas.microsoft.com/ado/2007/08/dataservices/metadata</a>');
    xmlAddNamespaceAttribute(feed, "xmlns:d", '<a href="http://schemas.microsoft.com/ado/2007/08/dataservices" rel="nofollow" target="_blank">http://schemas.microsoft.com/ado/2007/08/dataservices</a>');

    var expected = '&lt;?xml version="1.0" encoding="UTF-8"?&gt;\
            &lt;atom:feed xmlns:atom="<a href="http://www.w3.org/2005/Atom" rel="nofollow" target="_blank">http://www.w3.org/2005/Atom</a>"\
            xmlns:m="<a href="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" rel="nofollow" target="_blank">http://schemas.microsoft.com/ado/2007/08/dataservices/metadata</a>"\
            xmlns:d="<a href="http://schemas.microsoft.com/ado/2007/08/dataservices" rel="nofollow" target="_blank">http://schemas.microsoft.com/ado/2007/08/dataservices</a>"/&gt;'.replace(/\s{1,}/ig, ' ').replace(/&gt; &lt;/ig, '&gt;&lt;');

    var actual = '&lt;?xml version="1.0" encoding="UTF-8"?&gt;' + ((Ti && Ti.XML) || new XMLSerializer()).serializeToString(feed);

    if (Ti) {
        Ti.API.info('Expected:\n' + expected);
        Ti.API.info('Actual:\n' + actual);
    }
    else {
        console.log('Expected:\n' + expected);
        console.log('Actual:\n' + actual);
    }

    if (expected != actual) {
        alert('FAIL! Check logs for more information.');
    }
    else {
        alert('PASS!');
    }
})(this['document'], this['Ti']);
</pre></code>

<h4>Tested With</h4>
Passes in Chrome 18.0
Fails in iOS Simulator with Titanium Mobile 2.1.0 (05/03/12 17:34 c366287)

Expected XML results:
<code><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;atom:feed xmlns:atom="<a href="http://www.w3.org/2005/Atom" rel="nofollow" target="_blank">http://www.w3.org/2005/Atom</a>"
    xmlns:m="<a href="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" rel="nofollow" target="_blank">http://schemas.microsoft.com/ado/2007/08/dataservices/metadata</a>"
    xmlns:d="<a href="http://schemas.microsoft.com/ado/2007/08/dataservices" rel="nofollow" target="_blank">http://schemas.microsoft.com/ado/2007/08/dataservices</a>"/&gt;
</pre></code>

Actual XML results:
<code><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;atom:feed xmlns:xmlns="<a href="http://www.w3.org/2000/xmlns/" rel="nofollow" target="_blank">http://www.w3.org/2000/xmlns/</a>" 
    xmlns:m="<a href="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" rel="nofollow" target="_blank">http://schemas.microsoft.com/ado/2007/08/dataservices/metadata</a>" 
    xmlns:d="<a href="http://schemas.microsoft.com/ado/2007/08/dataservices" rel="nofollow" target="_blank">http://schemas.microsoft.com/ado/2007/08/dataservices</a>"/&gt;
</pre></code>

Discrepancies:
- xmlns:xmlns
- absence of xmlns:atom

<h3>Comments</h3>

<ol>
<li>Jeff English 2012-06-01

   Creating a document without a prefix for the root item should output a default namespace definition when serialized. For example, 
   <code><pre>
   var entry = document.implementation.createDocument('<a href="http://www.w3.org/2005/Atom" rel="nofollow" target="_blank">http://www.w3.org/2005/Atom</a>', 'entry', null);
   </pre></code>
   should result in the following when serialized:
   <code><pre>
   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;entry xmlns="<a href="http://www.w3.org/2005/Atom" rel="nofollow" target="_blank">http://www.w3.org/2005/Atom</a>" /&gt;
   </pre></code>
   instead I'm getting this:
   <code><pre>
   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;entry xmlns="<a href="http://www.w3.org/2000/xmlns/" rel="nofollow" target="_blank">http://www.w3.org/2000/xmlns/</a>" xmlns="<a href="http://www.w3.org/2005/Atom" rel="nofollow" target="_blank">http://www.w3.org/2005/Atom</a>" /&gt;
   </pre></code></li>
<li>Max Stepanov 2012-06-01

   PR merged <a href="https://github.com/appcelerator/titanium_mobile/pull/2302" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/2302</a></li>
<li>Olga Romero 2012-08-17

   Verified fix with:
   Titanium Studio, build: 2.1.1.201207271312
   Titanium SDK: 2.2.0.v20120816212512
   Devices:
   iPhone 4s 5.0.1
   Simulator 5.1
   Mac osx 10.8 Mountain Lion</li>
</ol>


<p><a href="/TIMOB/TIMOB-9084.json">JSON Source</a></p>