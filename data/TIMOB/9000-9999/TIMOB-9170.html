---
title: "[TIMOB-9170] Android: run V8 against x86 emulator"
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-06-07T12:02:41.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.0, Release 2.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.1.0, Sprint 2012-11 Core</td></tr>
<tr><th>Components</th><td>Android</td></tr>
<tr><th>Labels</th><td>core, look1, qe-port</td></tr>
<tr><th>Reporter</th><td>Tony Lukasavage</td></tr>
<tr><th>Assignee</th><td>Stephen Tramer</td></tr>
<tr><th>Created</th><td>2012-05-18T06:52:47.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-16T22:05:37.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem</h4>

Currently developers familiar with how to using Android's command line tooling can run Titanium-built APKs against Android new x86 emulator, so long as those APKs were built to run against the Rhino runtime. If the apps are built to run against the V8 runtime, they fail with the following errors from logcat indicating issues with missing stlport libraries. If necessary I can recreate these logs, but they should occur anytime you run a Titanium-built android app using V8 on the Android x86 emulator.

<h4>Proposed Solution</h4>

The way I understand it is that V8 is compiled with the Android NDK. All code compiled with the Android NDK is architecture-specific, and to this point it has only been built for ARM architectures. I'm sure I'm oversimplifying, but a build of V8 against the x86 architecture would likely make it possible for V8-driven Titanium Android apps to be run on the Android x86 emulator.

<h3>Comments</h3>

<ol>
<li>Stephen Tramer 2012-05-25

   Notes on x86 limitations:
   
   * x86 emulators do not support google APIs. In particular this means the android manifest cannot reference maps, and any applications which use maps will crash/not work in the x86 emulator.
   * x86 only works with android SDK r10 (2.3.3) and SDK r15 (4.0.3). Those emulators have to be installed separately from ARM emulators.
   * x86 may have launch errors involving HAXM (intel hardware acceleration) on some platforms. This is a known issue and Google/Intel are apparently working on fixing it.</li>
<li>Stephen Tramer 2012-06-01

   <h4>TESTING</h4>
   ----
   
   Before testing, make sure that you have both of the currently available x86 emulators installed (currently available for API r15 and r10). They can be retrieved through the android package management tool. For testing to provide the correct results you *must* install both currently available x86 emulators.
   
   <h4>Testing TiStudio</h4>
   
   *NOTE:* These steps are for Studio 2.0.2. Studio will eventually add ABI selection support and then testing will change significantly.
   
   Step 1.
   
   <h4>Create a new app</h4>
   <h4>Go to Run -> Run Configurations ...</h4>
   <h4>Select "Titanium Android Emulator"</h4>
   <h4>Select an API level which is NOT an x86 system image</h4>
   <h4>Click "Run"</h4>
   
   PASS: App runs
   FAIL: Any other result
   
   Step 2.
   
   <h4>Go to Run -> Run Configurations ...</h4>
   <h4>Select "Titanium Android Emulator"</h4>
   <h4>Select an API level which IS an x86 system image (currently only "Intel Atom x86 System Image Android 2.3.3")</h4>
   <h4>Click "Run"</h4>
   
   PASS: App runs
   FAIL: Any other result
   
   <h4>Testing avd detection</h4>
   
   Run the following, where <code>$TITANIUM_SDK</code> is the directory where your 2.1.0 SDK is installed, and <code>$ANDROID_SDK</code> is the directory where the Android SDK is installed
   
   <code><pre>
   $TITANIUM_SDK/android/avd.py $ANDROID_SDK
   </pre></code>
   
   You should see the following information in the output:
   
   * Every listed device will have an "abis" property, which is an array of the supported ABI levels; only the AVD associated with "4.0.3" is expected to have more than one value (<code>[armeabi-v7a, x86]</code>.
   
   <h4>Testing build scripts</h4>
   
   <code>$TITANIUM_SDK</code> and <code>$ANDROID_SDK</code> are as above. You should run this command from the directory which contains the app, which has the name <code>$APP_NAME</code> and ID <code>$APP_ID</code>. <code>$EMU_ID</code> should be the emulator ID for an emulator which supports more than one ABI.
   
   <code><pre>
   &gt; $TITANIUM_SDK/android/builder.py simulator $APP_NAME $ANDROID_SDK <code>pwd</code> $APP_ID $EMU_ID "HVGA" x86 ""
   </pre></code>
   
   PASS: The x86 emulator for 4.0.3 launches, and the app runs in it.
   FAIL: Any other result.
   
   You should then also test the other available ABI (likely <code>armeabi-v7a</code>):
   
   <code><pre>
   &gt; $TITANIUM_SDK/android/builder.py simulator $APP_NAME $ANDROID_SDK <code>pwd</code> $APP_ID $EMU_ID "HVGA" armeabi-v7a ""
   </pre></code>
   
   PASS: The x86 emulator for 4.0.3 launches, and the app runs in it.
   FAIL: Any other result.</li>
<li>Lee Morris 2017-03-16

   Closing ticket as fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-9170.json">JSON Source</a></p>