---
title: "[TIMOB-9314] Native Module Projects (Android/iOS): At runtime, support execution of code originally from both CommonJS file and from native source files."
---
<table>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-06-15T15:25:14.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.1.0, Sprint 2012-12 Core</td></tr>
<tr><th>Components</th><td>TiAPI</td></tr>
<tr><th>Labels</th><td>core</td></tr>
<tr><th>Reporter</th><td>Bill Dawson</td></tr>
<tr><th>Assignee</th><td>Neeraj Gupta</td></tr>
<tr><th>Created</th><td>2012-05-30T15:12:38.000+0000</td></tr>
<tr><th>Updated</th><td>2017-03-24T21:02:01.000+0000</td></tr>
</table>

<h3>Description</h3>

This is the super task (specific iOS and Android sub-tasks exist).

<h4>Description</h4>

Currently, module projects for both Android and iOS have the option to put Javascript (rather than native) code in assets/[moduleid].js.  If that file exists, then at build time the source is compiled/protected and, when distributed, the module is simply whatever is exported in that Javascript -- any code that happened to be on the native (*.m, *.java) files -- though compiled -- is ignored.

For example, when create either an iOS or Android module project, you get the .m and .java files for the module and a method named <code>example</code>.  If you also add a commonjs module file in the form of assets/[moduleid].js, then that <code>example</code> method inside the native source file is _not_ reachable at runtime when the module is used.

We wish to make the optional CommonJS module file "additive" in the sense that it extends whatever is available via the native source, rather than replaces it.

<h4>Test Case</h4>

* Create a module project for the platform you're testing (iOS or Android).

* Create a file assets/moduleid.js (replace moduleid with the actual module id) and enter this code:

<code><pre>
exports.test = function() {return "hello from inside the module's commonjs file";};
</pre></code>

* Build/package the module (./build.py for iOS, ant for Android.)

* Create a Titanium Mobile app.

* Install the module zip to the app (or up in the Titanium root).  No instructions here -- it's assumed you know how to install a module.

* Update tiapp.xml to include the module. (assuming you know how).

* Put this in app.js:

<code><pre>
var m = require("moduleid"); // replace moduleid with actual module id
Ti.API.info(m.test());
Ti.API.info(m.example());
</pre></code>

* In the console/logcat, you should see info statements for "hello from inside the module's commonjs file" and "hello world".

<h3>Comments</h3>

<ol>
<li>Lee Morris 2017-03-24

   Closing ticket as fixed.</li>
</ol>


<p><a href="/TIMOB/TIMOB-9314.json">JSON Source</a></p>