---
title: "[TIMOB-9481] iOS: cancelLocalNotification on iOS is broken"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Invalid</td></tr>
<tr><th>Resolution Date</th><td>2017-05-02T21:41:43.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.0.2, Release 3.4.0</td></tr>
<tr><th>Fix Version/s</th><td>Release 2.1.0, Sprint 2012-12 API</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>api, ios8, module_notification_manager, qe-3.4.0, qe-testadded, regression</td></tr>
<tr><th>Reporter</th><td>Anirudh Nagesh</td></tr>
<tr><th>Assignee</th><td>Jon Alter</td></tr>
<tr><th>Created</th><td>2012-06-11T11:12:10.000+0000</td></tr>
<tr><th>Updated</th><td>2017-05-02T21:41:43.000+0000</td></tr>
</table>

<h3>Description</h3>

In 'bg.js' of kitchensink, notifications cannot be cancelled using 'id' passed as userinfo dictionary to the notification.

{panel:title=bg.js}
<code><pre>

var notification = Ti.App.iOS.scheduleLocalNotification({
	alertBody:"Kitchen Sink was put in background",
	alertAction:"Re-Launch!",
	userInfo:{id:"1"},
	sound:"pop.caf",
	date:new Date(new Date().getTime() + 3000) // 3 seconds after backgrounding
});

// we cancel our notification if we don't want it to continue
// notification.cancel(); //this works!!!!


Ti.App.iOS.cancelLocalNotification("1");// this does not work.

</pre></code>

This is fixed by Pedro and the fix is available here.

<a href="https://gist.github.com/48a765c50f64aa7c47ed" rel="nofollow" target="_blank">https://gist.github.com/48a765c50f64aa7c47ed</a>

<h3>Comments</h3>

<ol>
<li>Pedro Enrique 2012-06-13

   Pull Request: <a href="https://github.com/appcelerator/titanium_mobile/pull/2383" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/2383</a></li>
<li>Blain Hamon 2012-06-13

   Pull merged. Kudos to Pedro.</li>
<li>Michael Pettiford 2012-06-19

   Closing issue
   
   Tested with Ti Studio build 2.1.0.201206172244
   Ti Mobile SDK 2.1.0.v20120618154152 hash r7830c03d
   OSX Lion 10.7.3
   iPhone 4S OS 5.1
   
   The expected behavior is shown</li>
<li>Satyam Sekhri 2014-09-02

   The cancelLocalNotification is not working on iOS8 device. It works fine for the same build on iOS 7.1 device.
   
   Tested On:
   SDK: 3.4.0.v20140829184521, 3.3.0.GA
   Studio: 3.4.0.201408291834
   CLI: 3.4.0-dev
   Xcode: Xcode  6 Beta6, XCode5.1.1
   Device: iPhone 5S (v8.0), iPhone 4 (v7.1)
   
   While testing on iOS 8, the notification sometimes might not come the first time or might take time. On second try it shows the notification despite of cancelLocalNotification</li>
<li>Jon Alter 2014-09-05

   <h4>Why aren't we fixing this?</h4>
   This is an iOS 8 issue that is easily worked around. When we schedule a notification, it does not immediately show up in the list of scheduled notifications. Because of this, when we call <code>cancelLocalNotification</code> immediately after scheduling a notification, the new notification does not show up in the list of scheduled notifications and therefor can not be cancelled.
   
   <h4>Alternatives</h4>
   1. Do not call <code>cancelLocalNotification</code> immediately after scheduling the notification, but set a small timeout first. See the example code below.
   2. Call the <code>cancel</code> method no the notification object returned by <code>scheduleLocalNotification</code>.
   
   <code><pre>
   var win1 = Titanium.UI.createWindow({  
       title:'Tab 1',
       backgroundColor:'#fff'
   });
   
   var setButton = Titanium.UI.createButton({
   	title:'set',
   	width:500,
   	height:40,
   	top:40
   });
   setButton.addEventListener('click', function()
   {
   
       Ti.App.iOS.registerForLocalNotifications({
           types: Ti.App.iOS.NOTIFICATION_TYPE_SOUND | 
   				Ti.App.iOS.NOTIFICATION_TYPE_ALERT | 
   				Ti.App.iOS.NOTIFICATION_TYPE_SOUND
       });
   
   	var notification = Ti.App.iOS.scheduleLocalNotification({
           alertBody:"Kitchen Sink was put in background",
           alertAction:"Re-Launch!",
           userInfo:{id:"1"},
           date:new Date(new Date().getTime() + 3000) // 3 seconds after backgrounding
       });
   
       // we cancel our notification if we don't want it to continue
       // notification.cancel(); //this works!!!!
   
       setTimeout(function() {
       	Ti.App.iOS.cancelLocalNotification("1");
       }, 500);
   });
   
   win1.add(setButton);
   
   win1.open();
   </pre></code></li>
<li>Lee Morris 2017-05-02

   Resolving ticket as Invalid as there is now a new version of Kitchen Sink available and we no longer support the version which relates to this ticket.</li>
</ol>


<p><a href="/TIMOB/TIMOB-9481.json">JSON Source</a></p>