---
title: "[TIMOB-9509] iOS: webview local storage broken after app update on iOS 5.1"
---
<table>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Not Our Bug</td></tr>
<tr><th>Resolution Date</th><td>2012-09-06T16:56:08.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.0, Release 1.8.2, Release 2.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2012-17 Core, Sprint 2012-18 Core</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>core</td></tr>
<tr><th>Reporter</th><td>Federico Casali</td></tr>
<tr><th>Assignee</th><td>Max Stepanov</td></tr>
<tr><th>Created</th><td>2012-06-12T19:45:01.000+0000</td></tr>
<tr><th>Updated</th><td>2013-03-13T15:06:23.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
Webview local storage it's broken on iOS 5.1. Performing an App update, local storage for webview it's no longer persistant.

<h4>Steps to reproduce and sample code</h4>
1. Run the sample code, run the app and click "add" a few times
Result: The data is shown and being stored in local storage
2. Close completely the app and restart app
Result: stored data is correctly shown
3. Install over the app from Xcode
Result: contents it's no longer available. Also, subsequently added data (like in step 1 and 2) it's no longer kept in the local storage.

Attaching also log file

<code><pre>
//  app.js

var win1 = Titanium.UI.createWindow({  
    backgroundColor:'#fff'
});

var webview = Ti.UI.createWebView({
  url: '/localstorage.html'
});

win1.add(webview);
win1.open();	
</pre></code>


<code><pre>
// localstorage.html

<html>
  <head>
    <meta name="viewport" content="width=device-width, maximum-scale=1.0, initial-scale=1.0">
    <script type="text/javascript">
      if(!localStorage["offline_submissions"]) {
        localStorage["offline_submissions"] = JSON.stringify([]);
      }

      var submissions = JSON.parse(localStorage["offline_submissions"]);

      var show = function(){
        var al = document.getElementById('alertbox');
        al.innerHTML = submissions.map(function(x){return x.a;});
      }

      var addItem = function(){
        submissions.push({a: (new Date()).toString()});
        localStorage["offline_submissions"] = JSON.stringify(submissions);
        show();
      }

      show();
    </script>
  </head>
  <body>
    <div id='alertbox'></div>

    <input type="button" onClick='addItem();' value="add"/>
    <br/>
    <br/>
    <input type="button" onClick='localStorage["offline_submissions"] = JSON.stringify([]);' value="clear"/>
  </body>

  <script type="text/javascript">
    show();
  </script>
</html>
</pre></code>


<h4>Additional notes</h4>
Customer ticket: <a href="http://support-admin.appcelerator.com/display/APP-523422" rel="nofollow" target="_blank">http://support-admin.appcelerator.com/display/APP-523422</a>

<h3>Attachments</h3>

<table>
<thead>
<tr><th>File</th><th>Date</th><th>Size</th></tr><thead>
<tbody>
<tr><td><a href="https://jira-attachments.tisdk.com/TIMOB/TIMOB-9509_28311/localStorageLOG.log">localStorageLOG.log</td></td><td>2012-06-12T19:46:15.000+0000</td><td>7424</td></tr>
</tbody>
<table>

<h3>Comments</h3>

<ol>
<li>Max Stepanov 2012-08-23

   Unable to reproduce following the provided steps.</li>
<li>Max Stepanov 2012-09-04

   It seems to be related to this:
   <a href="http://forrst.com/posts/Security_err_dom_exception_18_and_how_to_avoid-1Ge" rel="nofollow" target="_blank">http://forrst.com/posts/Security_err_dom_exception_18_and_how_to_avoid-1Ge</a>
   <a href="http://www.iphonewarroom.com/2012/07/how-to-fix-iphone-securityerr-dom.html" rel="nofollow" target="_blank">http://www.iphonewarroom.com/2012/07/how-to-fix-iphone-securityerr-dom.html</a></li>
<li>Max Stepanov 2012-09-06

   Unable to reproduce when update app via iTunes, or iPhone Configuration Utility or Xcode Run/Debug.
   Could reproduce via XCode Organizer, Devices tab, Add button.
   
   This problem is somehow related to the way application is updated. Probably installing via Xcode Organizer does not update the app properly.
   </li>
<li>Natalie Huynh 2012-12-04

   Closing as not our bug</li>
</ol>


<p><a href="/TIMOB/TIMOB-9509.json">JSON Source</a></p>