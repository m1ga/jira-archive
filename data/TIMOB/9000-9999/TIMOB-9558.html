---
title: "[TIMOB-9558] iOS: XHR calls fail if the response data has invalid encoding"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>Bug</td></tr>
<tr><th>Priority</th><td>Medium</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2012-06-26T10:11:19.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.0, Release 2.0.1</td></tr>
<tr><th>Fix Version/s</th><td>Sprint 2012-13 API, Release 2.1.1, Release 3.0.0</td></tr>
<tr><th>Components</th><td>iOS</td></tr>
<tr><th>Labels</th><td>api, module_xml, qe-testadded</td></tr>
<tr><th>Reporter</th><td>Federico Casali</td></tr>
<tr><th>Assignee</th><td>Vishal Duggal</td></tr>
<tr><th>Created</th><td>2012-06-14T16:24:07.000+0000</td></tr>
<tr><th>Updated</th><td>2013-12-10T06:02:38.000+0000</td></tr>
</table>

<h3>Description</h3>

<h4>Problem description</h4>
XHR calls fail if the response data has invalid encoding 

<h4>Steps to reproduce and sample code</h4>
Run the sample code using the url provided in the bug comments below
Result: responseText it's null

This behavior it's only reproducible with the provided url page. 
The page it's recognized from the browser as encoded with Western (ISO-8859-1). Encoding it with Unicode (UTF-8) would solve the issue and response text it's returned as expected.

<code><pre>
var win = Titanium.UI.createWindow({
	title:'test',
	backgroundColor:'white'
});

var xhr = Titanium.Network.createHTTPClient({
	enableKeepAlive: true,	
});

xhr.onerror = function(e) {
    Ti.API.error('#### Error received while requesting intraday data: ' + JSON.stringify(e));
};

xhr.onreadystatechange = function(e) {
	Ti.API.info("#### " + this.readyState);
};

xhr.onload = function(e) {
    if(this.status == 200) {
        Ti.API.info('#### response text: ' + this.responseText);
    }
};
xhr.open('GET', "SEE COMMENT FOR URLs");
xhr.send();

win.open();
</pre></code>


<h3>Comments</h3>

<ol>
<li>Vishal Duggal 2012-07-12

   Pull pending <a href="https://github.com/appcelerator/titanium_mobile/pull/2546" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/2546</a> against 2_1_X</li>
<li>Satyam Sekhri 2012-07-16

   Response data shown for the XHR call. Verified on:
   Titanium Studio: 2.1.1.201207161421
   Titanium SDK: 2.1.1.v2012071618060
   iOS: iPhone simulator 5.0</li>
<li>Shameer Jan 2013-12-10

   Anvil testcase PR <a href="https://github.com/appcelerator/titanium_mobile/pull/5039" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/5039</a>
   </li>
</ol>


<p><a href="/TIMOB/TIMOB-9558.json">JSON Source</a></p>