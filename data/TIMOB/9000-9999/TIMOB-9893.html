---
title: "[TIMOB-9893] TiAPI: CommonJS 1.1 compliance"
---
<table>
<tr><th>Type</th><td>Story</td></tr>
<tr><th>Priority</th><td>High</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2018-06-11T15:53:48.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>Release 2.1.0</td></tr>
<tr><th>Fix Version/s</th><td>n/a</td></tr>
<tr><th>Components</th><td>TiAPI</td></tr>
<tr><th>Labels</th><td>core, parity</td></tr>
<tr><th>Reporter</th><td>Stephen Tramer</td></tr>
<tr><th>Assignee</th><td>Christopher Williams</td></tr>
<tr><th>Created</th><td>2012-07-05T16:47:25.000+0000</td></tr>
<tr><th>Updated</th><td>2018-06-11T15:53:48.000+0000</td></tr>
</table>

<h3>Description</h3>

Needs to implement the "minispec" for require() that was decided on by core:

<h4>Conform to commonjs spec: <a href="http://wiki.commonjs.org/wiki/Modules/1.1" rel="nofollow" target="_blank">http://wiki.commonjs.org/wiki/Modules/1.1</a></h4>
-> Testing to be <a href="https://github.com/commonjs/commonjs/tree/master/tests/modules" rel="nofollow" target="_blank">https://github.com/commonjs/commonjs/tree/master/tests/modules</a>
<h4>non-MW platforms throw an exception when confronted with async syntax</h4>
-> <code> require(["foo"], callbackFunction); </code>

There is also the possibility of:
<h4>Leading '/' not allowed in module names</h4>
<h4>Leading '/' always indicates a resource at the root of the project</h4>

This should be done for all platforms.

<h3>Comments</h3>

<ol>
<li>Ivan Skugor 2012-07-10

   Hello.
   
   
   I'm not sure about second point. The path is relative if it begins with "." or "..", otherwise is absolute. Hope that "require" will work even without leading slash.</li>
<li>Chris Barber 2012-07-11

   On Mobile Web, require("/some/module") and require("some/module") are the same absolute path.</li>
<li>Stephen Tramer 2012-07-11

   If you have questions about how commonjs will work, read the linked specification. We will be following it exactly except for the root path addition.</li>
<li>Ivan Skugor 2012-07-12

   I don't have questions regarding CommonJs, but I'm a bit worried about root path addition. If scripts that uses that addition will work in other JS environments that supports CommonJs specification (which is the point of CommonJs), then OK, the problem does not exist. But will they work? I haven't worked much in other CommonJs environments, but for example, in NodeJs "require('console')" works, but "require('/console')" does not work.
   
   
   I don't see the point in having addition (that copies existing functionality) that could cause scripts not to work in other CommonJs environments.</li>
<li>Bryan Hughes 2012-07-12

   It's not actually an addition. Titanium has supported a forward slash to indicate absolute on Android and iOS for a long time, for better or worse, and changing that behavior now would break a lot of existing apps. Titanium is the only platform I am aware of that supports forward slash in a require.</li>
<li>Chris Barber 2012-07-12

   I'm all for removing support for the '/' in module ids. It's not standard. Mobile Web resisted supporting this for quite a while before we caved. Removing support is 2 small changes. Then any module id that starts with '/' would signify a resource file such as require('/some/file.js').
   
   How about we detect and show a deprecation message if someone tries to use a '/' in a module id?</li>
<li>Stephen Tramer 2012-07-12

   Bryan -
   
   Yes, it is an addition. In fact iOS doesn't support it because it had to be added in a recent PR.</li>
<li>Ivan Skugor 2012-07-13

   Brake of existing apps shouldn't be big issue because it is not hard task to remove leading slash (everyone should be able to do that within 1 minute). A deprecation message is fine, but IMO unnecessary because leading slash in module id should be considered as a bug and not as a feature.</li>
<li>Chris Barber 2016-08-24

   [~cwilliams] You worked on some of the <code>require()</code> behavior, right? Can you say that we have fixed this issue? Do we have correctly load module where the module id begins and does not begin with a '/'? All of the scoping works? Requiring modules with relative paths work correctly?</li>
<li>Christopher Williams 2018-06-11

    Marking as closed/fixed as we implemented this behavior as well as node-compatible require in TIMOB-16078 in the 6.0.0 timeframe.</li>
</ol>


<p><a href="/TIMOB/TIMOB-9893.json">JSON Source</a></p>